{"ast":null,"code":"import _slicedToArray from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useEffect,useContext,useImperativeHandle,forwardRef}from'react';import{useTranslation,withTranslation}from\"react-i18next\";import{useLocation,useHistory}from'react-router-dom';import{Card,CardBody,Row,Col,Button,Label}from\"reactstrap\";import{AvForm,AvField,AvGroup}from\"availity-reactstrap-validation\";import RiesgoCreditoContext from'../RiesgoCreditoContext';import ServicioRiesgoCredito from'../../../../services/RiesgoCredito/RiesgoCredito';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var FormConclusiones=/*#__PURE__*/forwardRef(function(props,ref){var history=useHistory();var location=useLocation();var _useTranslation=useTranslation(),t=_useTranslation.t,i18n=_useTranslation.i18n;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),formValid=_useState2[0],setFormValid=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),conclusions=_useState4[0],setConclusions=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isUpdatingRecord=_useState6[0],setIsUpdatingRecord=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),locationData=_useState8[0],setLocationData=_useState8[1];// services\nvar context=useContext(RiesgoCreditoContext);var servicioRiesgoCredito=new ServicioRiesgoCredito();useImperativeHandle(ref,function(){return{submit:function submit(){var form=document.getElementById('formRiesgoCreditoConclusiones');form.requestSubmit();return formValid;},getFormValidation:function getFormValidation(){return formValid;}};});useEffect(function(){var dataSession=null;if(location.data!==null&&location.data!==undefined){if(location.data.transactionId===undefined||location.data.transactionId.length<=0){//location.data.transactionId = 0;\n//checkAndCreateProcedure(location.data);\n}else{sessionStorage.setItem('locationData',JSON.stringify(location.data));setLocationData(location.data);dataSession=location.data;}}else{//chequeamos si tenemos guardado en session\nvar result=sessionStorage.getItem('locationData');if(result!==undefined&&result!==null){result=JSON.parse(result);setLocationData(result);dataSession=result;}}// load data\nservicioRiesgoCredito.consultarRiesgoCreditoComercial(dataSession.transactionId).then(function(info){console.log(\"riesgo\",info);if(info.transactId){setIsUpdatingRecord(true);}setConclusions(info.conclusions);}).catch(function(error){console.error('error fetch riesgo credito',error);});},[]);function handleSubmit(event,errors,values){event.preventDefault();var isValid=errors.length===0;setFormValid(isValid);if(isValid){servicioRiesgoCredito.guardarInformacionRiesgoCredito(locationData.transactionId,values,isUpdatingRecord).then(function(result){props.onSaveSuccess();}).catch(function(error){console.error('save error',error);});}}return/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(\"h5\",{className:\"card-sub-title\",children:t(\"ConclusionsAndRecomendations\")}),/*#__PURE__*/_jsx(CardBody,{children:/*#__PURE__*/_jsx(AvForm,{id:\"formRiesgoCreditoConclusiones\",className:\"needs-validation\",onSubmit:handleSubmit,children:/*#__PURE__*/_jsx(Row,{className:\"my-3\",children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsxs(AvGroup,{children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"conclusions\"}),/*#__PURE__*/_jsx(AvField,{className:\"form-control\",name:\"conclusions\",type:\"textarea\",disabled:(props===null||props===void 0?void 0:props.validacion)?true:false,id:\"conclusions\",value:conclusions,rows:\"7\"})]})})})})})]});});export default FormConclusiones;","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/pages/CommercialCredit/17_RiesgoCredito/riesgoCredito/Conclusiones.js"],"names":["useState","useEffect","useContext","useImperativeHandle","forwardRef","useTranslation","withTranslation","useLocation","useHistory","Card","CardBody","Row","Col","Button","Label","AvForm","AvField","AvGroup","RiesgoCreditoContext","ServicioRiesgoCredito","FormConclusiones","props","ref","history","location","t","i18n","formValid","setFormValid","conclusions","setConclusions","isUpdatingRecord","setIsUpdatingRecord","locationData","setLocationData","context","servicioRiesgoCredito","submit","form","document","getElementById","requestSubmit","getFormValidation","dataSession","data","undefined","transactionId","length","sessionStorage","setItem","JSON","stringify","result","getItem","parse","consultarRiesgoCreditoComercial","then","info","console","log","transactId","catch","error","handleSubmit","event","errors","values","preventDefault","isValid","guardarInformacionRiesgoCredito","onSaveSuccess","validacion"],"mappings":"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","sourcesContent":["import { useState, useEffect, useContext, useImperativeHandle, forwardRef } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { useTranslation, withTranslation } from \"react-i18next\"\r\nimport { useLocation, useHistory } from 'react-router-dom'\r\n\r\n\r\nimport {\r\n  Card,\r\n  CardBody,\r\n  Row,\r\n  Col,\r\n  Button,\r\n  Label\r\n} from \"reactstrap\"\r\n\r\nimport { AvForm, AvField, AvGroup } from \"availity-reactstrap-validation\"\r\nimport RiesgoCreditoContext from '../RiesgoCreditoContext';\r\nimport ServicioRiesgoCredito from '../../../../services/RiesgoCredito/RiesgoCredito';\r\n\r\nconst FormConclusiones = forwardRef((props, ref) => {\r\n  const history = useHistory();\r\n  const location = useLocation()\r\n  const { t, i18n } = useTranslation();\r\n\r\n  const [formValid, setFormValid] = useState(false);\r\n  const [conclusions, setConclusions] = useState('');\r\n  const [isUpdatingRecord, setIsUpdatingRecord] = useState(false);\r\n  const [locationData, setLocationData] = useState(null);\r\n\r\n  // services\r\n  const context = useContext(RiesgoCreditoContext);\r\n  const servicioRiesgoCredito = new ServicioRiesgoCredito();\r\n\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    submit: () => {\r\n      const form = document.getElementById('formRiesgoCreditoConclusiones');\r\n      form.requestSubmit();\r\n      return formValid;\r\n    },\r\n    getFormValidation: () => {\r\n      return formValid;\r\n    }\r\n  }));\r\n\r\n  useEffect(() => {\r\n    let dataSession=null;\r\n    if (location.data !== null && location.data !== undefined) {\r\n      if (location.data.transactionId === undefined || location.data.transactionId.length <= 0) {\r\n        //location.data.transactionId = 0;\r\n        //checkAndCreateProcedure(location.data);\r\n      }\r\n      else {\r\n        sessionStorage.setItem('locationData', JSON.stringify(location.data));\r\n        setLocationData(location.data);\r\n        dataSession=location.data;\r\n      }\r\n    }\r\n    else {\r\n      //chequeamos si tenemos guardado en session\r\n      var result = sessionStorage.getItem('locationData');\r\n      if (result !== undefined && result !== null) {\r\n        result = JSON.parse(result);\r\n        setLocationData(result);\r\n        dataSession=result\r\n      }\r\n    }\r\n    // load data\r\n    servicioRiesgoCredito.consultarRiesgoCreditoComercial(dataSession.transactionId)\r\n      .then((info) => {\r\n\r\n        console.log(\"riesgo\", info);\r\n        if (info.transactId) {\r\n          setIsUpdatingRecord(true);\r\n        }\r\n        setConclusions(info.conclusions);\r\n      })\r\n      .catch((error) => {\r\n        console.error('error fetch riesgo credito', error);\r\n      });\r\n  }, []);\r\n\r\n  function handleSubmit(event, errors, values) {\r\n    event.preventDefault();\r\n    const isValid = errors.length === 0;\r\n    setFormValid(isValid);\r\n    if (isValid) {\r\n      servicioRiesgoCredito.guardarInformacionRiesgoCredito(locationData.transactionId, values, isUpdatingRecord)\r\n        .then((result) => {\r\n          props.onSaveSuccess();\r\n        })\r\n        .catch((error) => {\r\n          console.error('save error', error);\r\n        });\r\n    }\r\n  }\r\n\r\n\r\n  return (\r\n    <Card>\r\n      <h5 className=\"card-sub-title\">{t(\"ConclusionsAndRecomendations\")}</h5>\r\n\r\n      <CardBody>\r\n        <AvForm id=\"formRiesgoCreditoConclusiones\" className=\"needs-validation\" onSubmit={handleSubmit}>\r\n          <Row className=\"my-3\">\r\n            <Col md=\"12\">\r\n              <AvGroup>\r\n                <Label htmlFor=\"conclusions\"></Label>\r\n                <AvField className=\"form-control\"\r\n                  name=\"conclusions\"\r\n                  type=\"textarea\"\r\n                  disabled={props?.validacion ? true : false}\r\n                  id=\"conclusions\"\r\n                  value={conclusions}\r\n                  rows=\"7\" />\r\n              </AvGroup>\r\n            </Col>\r\n          </Row>\r\n        </AvForm>\r\n      </CardBody>\r\n    </Card>\r\n  );\r\n});\r\n\r\n\r\nFormConclusiones.propTypes = {\r\n  onSaveSuccess: PropTypes.func\r\n};\r\n\r\nexport default FormConclusiones;\r\n"]},"metadata":{},"sourceType":"module"}