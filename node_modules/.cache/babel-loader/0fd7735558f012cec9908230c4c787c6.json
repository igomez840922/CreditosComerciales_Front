{"ast":null,"code":"import _regeneratorRuntime from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import{useTranslation,withTranslation}from\"react-i18next\";import{Row,Col,Button,Label,Input,Modal,Card,CardBody,CardFooter,InputGroup,CardHeader,Table}from\"reactstrap\";import Switch from\"react-switch\";import{AvForm,AvField,AvGroup}from\"availity-reactstrap-validation\";import{BackendServices}from\"../../../services\";import{useLocation,useHistory}from'react-router-dom';import FinancialReportComp from\"./FinancialReportComp\";import{translationHelpers}from\"../../../helpers\";import{Background,ExchangeRisk,FinancialInformation,Projections,Workload}from\"../../../components/InformeFinanciero\";import Guarantees from\"../../../components/InformeFinanciero/background/Guarantees\";import{FormCreditRisk,FormRecommendations}from\"../../../components/InformeFinanciero\";import LoadingOverlay from\"react-loading-overlay\";import FinancialReportContent from\"./FinancialReportContent\";import*as url from\"../../../helpers/url_helper\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var PrevicualizarAIF=function PrevicualizarAIF(props){var _location$data;var location=useLocation();var _useState=useState((_location$data=location.data)!==null&&_location$data!==void 0?_location$data:JSON.parse(sessionStorage.getItem('locationData'))),_useState2=_slicedToArray(_useState,2),locationData=_useState2[0],setLocationData=_useState2[1];var _useState3=useState(new BackendServices()),_useState4=_slicedToArray(_useState3,2),backendServices=_useState4[0],setbackendServices=_useState4[1];var _translationHelpers=translationHelpers('translation','common','translation'),_translationHelpers2=_slicedToArray(_translationHelpers,3),t=_translationHelpers2[0],c=_translationHelpers2[1],tr=_translationHelpers2[2];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),Opinion=_useState6[0],setOpinion=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),Recomendation=_useState8[0],setRecomendation=_useState8[1];var isOpen=props.isOpen,toggle=props.toggle;var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),isActiveLoading=_useState10[0],setIsActiveLoading=_useState10[1];var history=useHistory();useEffect(function(){if(location.data!==null&&location.data!==undefined){if(location.data.transactionId===undefined||location.data.transactionId.length<=0){//location.data.transactionId = 0;\n//checkAndCreateProcedure(location.data);\nhistory.push(url.URL_DASHBOARD);}else{sessionStorage.setItem('locationData',JSON.stringify(location.data));setLocationData(location.data);fetchFinancialReport(location.data);}}else{//chequeamos si tenemos guardado en session\nvar result=sessionStorage.getItem('locationData');if(result!==undefined&&result!==null){result=JSON.parse(result);setLocationData(result);fetchFinancialReport(result);}}},[]);function fetchFinancialReport(_x){return _fetchFinancialReport.apply(this,arguments);}function _fetchFinancialReport(){_fetchFinancialReport=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(locationData){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setIsActiveLoading(true);Promise.allSettled([LoadOpinion(locationData),LoadRecomendacion(locationData)]).then(function(){setIsActiveLoading(false);}).catch(function(err){setIsActiveLoading(false);});case 2:case\"end\":return _context.stop();}}},_callee);}));return _fetchFinancialReport.apply(this,arguments);}function LoadOpinion(locationData){return new Promise(function(resolve,reject){backendServices.consultarDetalleOpinionRiesgoCredito(locationData.transactionId).then(function(resp){var data=resp[0];(data!=null||data!=undefined)&&setOpinion(data);resolve();}).catch(function(err){resolve();});});}function LoadRecomendacion(locationData){return new Promise(function(resolve,reject){backendServices.consultarConclusionesRecomendacionesAnalisisFinanciero(locationData.transactionId).then(function(resp){var data=resp[0];(data!=null||data!=undefined)&&setRecomendation(data);resolve();}).catch(function(err){resolve();});});}return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(Card,{className:\"m-0\",children:/*#__PURE__*/_jsxs(CardBody,{children:[/*#__PURE__*/_jsx(FinancialReportContent,{preview:true}),/*#__PURE__*/_jsxs(LoadingOverlay,{active:isActiveLoading,spinner:true,text:t(\"WaitingPlease\"),children:[/*#__PURE__*/_jsx(Col,{className:\"mt-4\",children:/*#__PURE__*/_jsx(FormCreditRisk,{preview:true,Opinion:Opinion===null||Opinion===void 0?void 0:Opinion.opinion})}),/*#__PURE__*/_jsx(Col,{className:\"mt-4\",children:/*#__PURE__*/_jsx(FormRecommendations,{preview:true,strengths:Recomendation===null||Recomendation===void 0?void 0:Recomendation.strengths,weakness:Recomendation===null||Recomendation===void 0?void 0:Recomendation.weakness,conclusion:Recomendation===null||Recomendation===void 0?void 0:Recomendation.conclusion})})]})]})})});};export default PrevicualizarAIF;","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/pages/CommercialCredit/6_AnalisisCredito/previsualizarAIFcomponente.js"],"names":["React","useEffect","useState","useTranslation","withTranslation","Row","Col","Button","Label","Input","Modal","Card","CardBody","CardFooter","InputGroup","CardHeader","Table","Switch","AvForm","AvField","AvGroup","BackendServices","useLocation","useHistory","FinancialReportComp","translationHelpers","Background","ExchangeRisk","FinancialInformation","Projections","Workload","Guarantees","FormCreditRisk","FormRecommendations","LoadingOverlay","FinancialReportContent","url","PrevicualizarAIF","props","location","data","JSON","parse","sessionStorage","getItem","locationData","setLocationData","backendServices","setbackendServices","t","c","tr","Opinion","setOpinion","Recomendation","setRecomendation","isOpen","toggle","isActiveLoading","setIsActiveLoading","history","undefined","transactionId","length","push","URL_DASHBOARD","setItem","stringify","fetchFinancialReport","result","Promise","allSettled","LoadOpinion","LoadRecomendacion","then","catch","err","resolve","reject","consultarDetalleOpinionRiesgoCredito","resp","consultarConclusionesRecomendacionesAnalisisFinanciero","opinion","strengths","weakness","conclusion"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\"\r\nimport { useTranslation, withTranslation } from \"react-i18next\"\r\nimport PropTypes from 'prop-types';\r\nimport {\r\n    Row,\r\n    Col,\r\n    Button,\r\n    Label,\r\n    Input,\r\n    Modal,\r\n    Card,\r\n    CardBody,\r\n    CardFooter,\r\n    InputGroup,\r\n    CardHeader,\r\n    Table,\r\n} from \"reactstrap\"\r\nimport Switch from \"react-switch\";\r\nimport { AvForm, AvField, AvGroup } from \"availity-reactstrap-validation\"\r\nimport { BackendServices } from \"../../../services\";\r\nimport { useLocation, useHistory } from 'react-router-dom'\r\nimport FinancialReportComp from \"./FinancialReportComp\";\r\nimport { translationHelpers } from \"../../../helpers\"\r\nimport { Background, ExchangeRisk, FinancialInformation, Projections, Workload } from \"../../../components/InformeFinanciero\";\r\nimport Guarantees from \"../../../components/InformeFinanciero/background/Guarantees\";\r\nimport { FormCreditRisk, FormRecommendations } from \"../../../components/InformeFinanciero\"\r\nimport LoadingOverlay from \"react-loading-overlay\";\r\n\r\nimport FinancialReportContent from \"./FinancialReportContent\";\r\nimport * as url from \"../../../helpers/url_helper\"\r\n\r\n\r\nconst PrevicualizarAIF = (props) => {\r\n    const location = useLocation();\r\n    const [locationData, setLocationData] = useState(location.data ?? JSON.parse(sessionStorage.getItem('locationData')));\r\n    const [backendServices, setbackendServices] = useState(new BackendServices());\r\n    const [t, c, tr] = translationHelpers('translation', 'common', 'translation');\r\n    const [Opinion, setOpinion] = useState(null);\r\n    const [Recomendation, setRecomendation] = useState(null);\r\n    const { isOpen, toggle } = props;\r\n    const [isActiveLoading, setIsActiveLoading] = useState(false);\r\n    const history = useHistory();\r\n\r\n    useEffect(() => {\r\n        if (location.data !== null && location.data !== undefined) {\r\n            if (location.data.transactionId === undefined || location.data.transactionId.length <= 0) {\r\n                //location.data.transactionId = 0;\r\n                //checkAndCreateProcedure(location.data);\r\n                history.push(url.URL_DASHBOARD);\r\n            }\r\n            else {\r\n                sessionStorage.setItem('locationData', JSON.stringify(location.data));\r\n                setLocationData(location.data);\r\n                fetchFinancialReport(location.data);\r\n            }\r\n        }\r\n        else {\r\n            //chequeamos si tenemos guardado en session\r\n            var result = sessionStorage.getItem('locationData');\r\n            if (result !== undefined && result !== null) {\r\n                result = JSON.parse(result);\r\n                setLocationData(result);\r\n                fetchFinancialReport(result);\r\n            }\r\n        }\r\n    }, []);\r\n\r\n    async function fetchFinancialReport(locationData) {\r\n        setIsActiveLoading(true);\r\n        Promise.allSettled([\r\n            LoadOpinion(locationData),\r\n            LoadRecomendacion(locationData),\r\n        ]).then(() => {\r\n            setIsActiveLoading(false);\r\n        }).catch(err => {\r\n            setIsActiveLoading(false);\r\n        });\r\n    }\r\n\r\n    function LoadOpinion(locationData) {\r\n        return new Promise(function (resolve, reject) {\r\n\r\n            backendServices.consultarDetalleOpinionRiesgoCredito(locationData.transactionId).then(resp => {\r\n                let data = resp[0];\r\n                (data != null || data != undefined) && setOpinion(data);\r\n                resolve();\r\n            }).catch(err => {\r\n                resolve();\r\n            });\r\n        })\r\n    }\r\n\r\n    function LoadRecomendacion(locationData) {\r\n        return new Promise(function (resolve, reject) {\r\n            backendServices.consultarConclusionesRecomendacionesAnalisisFinanciero(locationData.transactionId).then(resp => {\r\n                let data = resp[0];\r\n                (data != null || data != undefined) && setRecomendation(data);\r\n                resolve();\r\n            }).catch(err => {\r\n                resolve();\r\n            });\r\n        })\r\n    }\r\n\r\n    return (\r\n       \r\n            <>\r\n                <Card className=\"m-0\">\r\n\r\n                    <CardBody>\r\n                        {/* <FinancialReportComp\r\n                    customerNumberT24={customerNumberT24}\r\n                    debtorId={debtorId}\r\n\r\n                    client={financialSummary.client}\r\n                    financialStatus={financialSummary.financialStatus}\r\n                    balances={financialSummary.balances}\r\n                    debts={financialSummary.debts}\r\n                    history={financialSummary.history}\r\n                    preview={true}\r\n                />\r\n\r\n                <Col className=\"m-4\">\r\n                    <FinancialInformation preview={true} />\r\n                </Col>\r\n                <Col className=\"m-4\">\r\n                    <ExchangeRisk preview={true} />\r\n                </Col>\r\n\r\n                <Col className=\"m-4\">\r\n                    <Workload preview={true} />\r\n                </Col>\r\n\r\n                <Col className=\"m-4\">\r\n                    <Projections preview={true} />\r\n                </Col>\r\n\r\n                <Col className=\"m-4\">\r\n                    <Background items={background.items}\r\n                        facilities={background.facilities}\r\n                        restructuring={background.restructuring}\r\n                        guarantees={background.guarantees}\r\n                        preview={true}\r\n                    />\r\n                </Col>\r\n                <Col className=\"m-4\">\r\n                    <Guarantees preview={true} />\r\n                </Col> */}\r\n                        <FinancialReportContent\r\n                            preview={true}\r\n                        />\r\n\r\n                        <LoadingOverlay active={isActiveLoading} spinner text={t(\"WaitingPlease\")}>\r\n\r\n                            <Col className=\"mt-4\">\r\n                                <FormCreditRisk preview={true} Opinion={Opinion?.opinion} />\r\n                            </Col>\r\n\r\n\r\n                            <Col className=\"mt-4\">\r\n                                <FormRecommendations preview={true} strengths={Recomendation?.strengths} weakness={Recomendation?.weakness} conclusion={Recomendation?.conclusion} />\r\n                            </Col>\r\n                        </LoadingOverlay>\r\n\r\n                        {/* <Row>\r\n                    <Col lg=\"12\" style={{ textAlign: \"right\" }}>\r\n                        <Button color=\"danger\" style={{ margin: '5px 0px' }} type=\"button\" onClick={props.toggle}>\r\n                            <i className=\"mdi mdi mdi-cancel mid-12px\"></i>{\" \"}{c(\"Cancel\")}\r\n                        </Button>\r\n                    </Col>\r\n                </Row> */}\r\n                    </CardBody>\r\n                </Card>\r\n\r\n            </>\r\n    );\r\n};\r\n\r\n\r\nexport default PrevicualizarAIF;\r\n"]},"metadata":{},"sourceType":"module"}