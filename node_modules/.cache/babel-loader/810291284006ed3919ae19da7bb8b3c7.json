{"ast":null,"code":"import _regeneratorRuntime from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _createForOfIteratorHelper from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _asyncToGenerator from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useRef}from'react';import{useTranslation}from'react-i18next';import{useLocation,useHistory}from'react-router-dom';import moment from\"moment\";import*as OPTs from\"../../helpers/options_helper\";import\"flatpickr/dist/themes/material_blue.css\";import Flatpickr from\"react-flatpickr\";import{Row,Col,Card,CardBody,Button,Label,Table,Pagination,PaginationItem,PaginationLink,CardFooter,Modal}from\"reactstrap\";import{AvForm,AvField,AvInput}from\"availity-reactstrap-validation\";import{Link}from\"react-router-dom\";import DocumentModel from\"../../models/Core/DocumentModel\";import DocumentoAnexoModel from\"../../models/Backend/DocumentoAnexoModel\";import functionshelper from\"../../helpers/functions_helper\";import LoadingOverlay from'react-loading-overlay';import{CoreServices,BackendServices,BpmServices}from'../../services';import Alert from'react-bootstrap/Alert';import{number}from'yargs';import{uniqueId}from'lodash';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CheckList=function CheckList(props){var _useTranslation=useTranslation(),t=_useTranslation.t,i18n=_useTranslation.i18n;var attachmentFileInputModel=props.attachmentFileInputModel;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showModelAttachment=_useState2[0],setShowModelAttachment=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),attachments=_useState4[0],setAttachments=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isActiveLoading=_useState6[0],setIsActiveLoading=_useState6[1];var _useState7=useState({}),_useState8=_slicedToArray(_useState7,2),fileData=_useState8[0],setfileData=_useState8[1];var _useState9=useState(undefined),_useState10=_slicedToArray(_useState9,2),mainPerson=_useState10[0],setmainPerson=_useState10[1];//Servicios\nvar _useState11=useState(new BpmServices()),_useState12=_slicedToArray(_useState11,2),bpmServices=_useState12[0],setbpmServices=_useState12[1];var _useState13=useState(new BackendServices()),_useState14=_slicedToArray(_useState13,2),backendServices=_useState14[0],setbackendServices=_useState14[1];var _useState15=useState(new CoreServices()),_useState16=_slicedToArray(_useState15,2),coreServices=_useState16[0],setcoreServices=_useState16[1];var _useState17=useState({show:false,msg:\"\",isError:false}),_useState18=_slicedToArray(_useState17,2),msgData=_useState18[0],setmsgData=_useState18[1];var _useState19=useState({show:false,msg:\"\",isError:false}),_useState20=_slicedToArray(_useState19,2),msgModal=_useState20[0],setmsgModal=_useState20[1];var _useState21=useState(undefined),_useState22=_slicedToArray(_useState21,2),selectedAttachment=_useState22[0],setselectedAttachment=_useState22[1];var _useState23=useState(null),_useState24=_slicedToArray(_useState23,2),facilidadesList=_useState24[0],setfacilidadesList=_useState24[1];var _useState25=useState(false),_useState26=_slicedToArray(_useState25,2),exception=_useState26[0],setException=_useState26[1];//On Mounting (componentDidMount) if selectedData has changes\nReact.useEffect(function(){loadData();},[]);function loadData(){return _loadData.apply(this,arguments);}//abrimos modal para adjunar archivos\nfunction _loadData(){_loadData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _propousalData$0$requ,_propousalData$,_generalData$bank$cod,_generalData$bank;var mainDebtor,generalData,propousalData,lfacilities,lCheckValidation,bankingType,facilityType,requestType,processStage,guaranteeType,bailType,procId,_iterator,_step,facility,lguarantees,lbails,_iterator4,_step4,guarantee,_iterator5,_step5,bail,data,lCheckListDocs,lCheckListDocsArray,_attachmentFileInputM,_mainDebtor$personId,_ref,_lCheckListDocs$gener,_ref2,_lCheckListDocs$gener2,lCheckListTramite,i,_iterator2,_step2,chkDoc,_iterator3,_step3,item,datosCheckList;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return backendServices.consultPrincipalDebtor(attachmentFileInputModel.transactId);case 2:mainDebtor=_context.sent;setmainPerson(mainDebtor);//mainDebtor.personId\n_context.next=6;return backendServices.consultGeneralDataIGR(attachmentFileInputModel.transactId);case 6:generalData=_context.sent;_context.next=9;return backendServices.consultGeneralDataPropCred(attachmentFileInputModel.transactId);case 9:propousalData=_context.sent;_context.next=12;return backendServices.consultarFacilidades((_propousalData$0$requ=(_propousalData$=propousalData[0])===null||_propousalData$===void 0?void 0:_propousalData$.requestId)!==null&&_propousalData$0$requ!==void 0?_propousalData$0$requ:\"\");case 12:lfacilities=_context.sent;setfacilidadesList(lfacilities);_context.next=16;return bpmServices.listCheckValidation(attachmentFileInputModel.processId);case 16:lCheckValidation=_context.sent;console.log(\"lCheckValidation\",lCheckValidation);bankingType=[];//es del IGR ... generalData.bank.code;\nfacilityType=[];//facilityType\nrequestType=[];//proposedType\nprocessStage=[];//processId\nguaranteeType=[];bailType=[];bankingType.push((_generalData$bank$cod=generalData===null||generalData===void 0?void 0:(_generalData$bank=generalData.bank)===null||_generalData$bank===void 0?void 0:_generalData$bank.code)!==null&&_generalData$bank$cod!==void 0?_generalData$bank$cod:\"\");procId=attachmentFileInputModel.processId===OPTs.PROCESS_BUSQUEDADESCARTE?0:attachmentFileInputModel.processId===OPTs.PROCESS_ACEPTACIONCLIENTE?13:attachmentFileInputModel.processId;processStage.push(procId);_iterator=_createForOfIteratorHelper(lfacilities);_context.prev=28;_iterator.s();case 30:if((_step=_iterator.n()).done){_context.next=44;break;}facility=_step.value;facilityType.push(facility.facilityTypeId);requestType.push(facility.proposalTypeId);_context.next=36;return backendServices.consultarGarantiaPropCred(facility.facilityId);case 36:lguarantees=_context.sent;_context.next=39;return backendServices.consultarFianzaPropCred(facility.facilityId);case 39:lbails=_context.sent;if(lguarantees!==undefined){_iterator4=_createForOfIteratorHelper(lguarantees);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){guarantee=_step4.value;guaranteeType.push(Number(guarantee.guaranteeTypeName));}}catch(err){_iterator4.e(err);}finally{_iterator4.f();}}if(lbails!==undefined){_iterator5=_createForOfIteratorHelper(lbails);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){bail=_step5.value;bailType.push(bail.typeBail);}}catch(err){_iterator5.e(err);}finally{_iterator5.f();}}case 42:_context.next=30;break;case 44:_context.next=49;break;case 46:_context.prev=46;_context.t0=_context[\"catch\"](28);_iterator.e(_context.t0);case 49:_context.prev=49;_iterator.f();return _context.finish(49);case 52:if(facilityType.length==0){facilityType=[\"\"];}if(guaranteeType.length==0){guaranteeType=[\"\"];}if(bankingType.length==0){bankingType=[\"\"];}if(processStage.length==0){processStage=[\"\"];}if(requestType.length==0){requestType=[\"\"];}if(bailType.length==0){bailType=[\"\"];}data={\"bankingType\":bankingType,\"guaranteeType\":guaranteeType,\"facilityType\":facilityType,\"requestType\":requestType,\"processStage\":processStage,\"bailType\":bailType,\"guarantorCustomer\":true,\"transactId\":attachmentFileInputModel.transactId};/* data={\r\n       \"bankingType\": [\"PYME\"],\r\n       \"guaranteeType\": [100],\r\n       \"facilityType\": [\"LCR\"],\r\n       \"requestType\": [\"NU\"],\r\n       \"processStage\": [2]\r\n     }*/ //  console.log(data);\n_context.next=61;return backendServices.getCheckListDocuments(data);case 61:lCheckListDocs=_context.sent;lCheckListDocsArray=[];lCheckListDocsArray=Object.keys(lCheckListDocs);if(!(lCheckListDocs!==undefined)){_context.next=72;break;}_context.next=67;return backendServices.consultarCheckListTramite((_attachmentFileInputM=attachmentFileInputModel===null||attachmentFileInputModel===void 0?void 0:attachmentFileInputModel.transactId)!==null&&_attachmentFileInputM!==void 0?_attachmentFileInputM:0,(_mainDebtor$personId=mainDebtor===null||mainDebtor===void 0?void 0:mainDebtor.personId)!==null&&_mainDebtor$personId!==void 0?_mainDebtor$personId:0);case 67:lCheckListTramite=_context.sent;if(lCheckListTramite!==undefined&&lCheckListTramite!==null&&lCheckListTramite.length>0){for(i=0;i<lCheckListDocsArray.length;i++){try{_iterator2=_createForOfIteratorHelper(lCheckListDocs[lCheckListDocsArray[i]]);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){chkDoc=_step2.value;_iterator3=_createForOfIteratorHelper(lCheckListTramite);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){item=_step3.value;if(item.checklistId===chkDoc.id){chkDoc[\"onbaseId\"]=item.onbaseId;//chkDoc[\"date\"] = moment(item.date).add(chkDoc.validityPeriodDays, \"days\");\nchkDoc[\"expirationDate\"]=\"\";if(item.expirationDate!==null&&item.expirationDate!==undefined&&moment(item.expirationDate).diff(moment(),'years')<50){chkDoc[\"expirationDate\"]=moment(item.expirationDate).format(\"DD/MM/YYYY\");}console.log();if(item.excluded!==null&&item.excluded!==undefined){chkDoc.excepted=item.excluded;}}}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}}catch(err){}}}datosCheckList=[];((_ref=(_lCheckListDocs$gener=lCheckListDocs===null||lCheckListDocs===void 0?void 0:lCheckListDocs.general)!==null&&_lCheckListDocs$gener!==void 0?_lCheckListDocs$gener:[])===null||_ref===void 0?void 0:_ref.length)>0&&(datosCheckList=[/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"6\",className:\"tr-subtitle\",children:/*#__PURE__*/_jsx(\"b\",{children:\"Documentos Generales\"})})},Math.pow(+uniqueId(),2))].concat(_toConsumableArray((_ref2=(_lCheckListDocs$gener2=lCheckListDocs===null||lCheckListDocs===void 0?void 0:lCheckListDocs.general)!==null&&_lCheckListDocs$gener2!==void 0?_lCheckListDocs$gener2:[])===null||_ref2===void 0?void 0:_ref2.map(function(data){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{}),/*#__PURE__*/_jsx(\"td\",{children:data.document}),/*#__PURE__*/_jsx(\"td\",{children:data.excepted?\"Si\":\"No\"}),/*#__PURE__*/_jsx(\"td\",{children:data.expirationDate}),/*#__PURE__*/_jsx(\"td\",{children:data[\"onbaseId\"]!==undefined?/*#__PURE__*/_jsx(Link,{to:\"#\",title:t(\"View\"),onClick:function onClick(){return viewAttachment(data.onbaseId);},children:/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-file-eye-outline mdi-24px\"})}):null}),/*#__PURE__*/_jsx(\"td\",{style:{textAlign:\"right\"},children:lCheckValidation?data[\"onbaseId\"]!==undefined?/*#__PURE__*/_jsx(Link,{to:\"#\",title:t(\"Remove\"),onClick:function onClick(){return removeAttachment(data,mainDebtor);},children:/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-file-remove-outline mdi-24px\"})}):/*#__PURE__*/_jsx(Link,{to:\"#\",title:t(\"Attach\"),color:\"danger\",onClick:function onClick(){return openAddAttachment(data);},children:/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-file-upload-outline mdi-24px\"})}):null})]},uniqueId()+data.id);}))));/*\r\n        (lCheckListDocs?.mandatory ?? [])?.length > 0 && (datosCheckList = [(\r\n          <tr key={(+uniqueId()) ** 2}>\r\n            <td colSpan=\"6\" className='tr-subtitle'><b>Documentos Generales</b></td>\r\n          </tr>), ...(lCheckListDocs?.mandatory ?? [])?.map((data) => (\r\n            <tr key={uniqueId() + data.id}>\r\n              <td></td>\r\n              <td>{data.document}</td>\r\n              <td>{data.excepted ? \"Si\" : \"No\"}</td>\r\n              <td>\r\n                {data.expirationDate}\r\n              </td>\r\n              <td>\r\n                {data[\"onbaseId\"] !== undefined ?\r\n                  <Link to=\"#\" title={t(\"View\")} onClick={() => viewAttachment(data.onbaseId)}><i className=\"mdi mdi-file-eye-outline mdi-24px\"></i></Link>\r\n                  : null}\r\n              </td>\r\n              <td style={{ textAlign: \"right\" }}>\r\n                {lCheckValidation ? (data[\"onbaseId\"] !== undefined ?\r\n                  <Link to=\"#\" title={t(\"Remove\")} onClick={() => removeAttachment(data, mainDebtor)}><i className=\"mdi mdi-file-remove-outline mdi-24px\"></i></Link>\r\n                  :\r\n                  <Link to=\"#\" title={t(\"Attach\")} color=\"danger\" onClick={() => openAddAttachment(data)}><i className=\"mdi mdi-file-upload-outline mdi-24px\"></i></Link>) : null\r\n                }\r\n              </td>\r\n            </tr>\r\n          ))]);\r\n          */backendServices.retrieveFacilityType().then(function(facilidad){console.log(\"facilidad\",facilidad);console.log(\"lfacilities\",lfacilities);for(var k=0;k<lCheckListDocsArray.length;k++){if(lCheckListDocsArray[k]!=\"general\"){console.log(\"lCheckListDocsArray[k]\",lCheckListDocsArray[k]);var _loop=function _loop(_i){if(lfacilities[_i].facilityId==lCheckListDocsArray[k]){var _facilidad$find;console.log(\"facilidad Encontrada\");datosCheckList=[].concat(_toConsumableArray(datosCheckList),[/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"6\",className:\"tr-subtitle\",children:/*#__PURE__*/_jsx(\"b\",{children:(_facilidad$find=facilidad.find(function(x){return x.id===lfacilities[_i].facilityTypeId;}))===null||_facilidad$find===void 0?void 0:_facilidad$find.description})})},Math.pow(uniqueId(),3))]);datosCheckList=[].concat(_toConsumableArray(datosCheckList),_toConsumableArray(lCheckListDocs[lfacilities[_i].facilityId].map(function(data){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{}),/*#__PURE__*/_jsx(\"td\",{children:data.document}),/*#__PURE__*/_jsx(\"td\",{children:data.excepted?\"Si\":\"No\"}),/*#__PURE__*/_jsx(\"td\",{children:data.expirationDate}),/*#__PURE__*/_jsx(\"td\",{children:data[\"onbaseId\"]!==undefined?/*#__PURE__*/_jsx(Link,{to:\"#\",title:t(\"View\"),onClick:function onClick(){return viewAttachment(data.onbaseId);},children:/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-file-eye-outline mdi-24px\"})}):null}),/*#__PURE__*/_jsx(\"td\",{style:{textAlign:\"right\"},children:lCheckValidation?data[\"onbaseId\"]!==undefined?/*#__PURE__*/_jsx(Link,{to:\"#\",title:t(\"Remove\"),onClick:function onClick(){return removeAttachment(data,mainDebtor);},children:/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-file-remove-outline mdi-24px\"})}):/*#__PURE__*/_jsx(Link,{to:\"#\",title:t(\"Attach\"),color:\"danger\",onClick:function onClick(){openAddAttachment(data);},children:/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-file-upload-outline mdi-24px\"})}):null})]},uniqueId()+data.id);})));return\"break\";}};for(var _i=0;_i<lfacilities.length;_i++){var _ret=_loop(_i);if(_ret===\"break\")break;}}}/*\r\n          for (let i = 0; i < lfacilities.length; i++) {\r\n            datosGenerales = [...datosGenerales,(<tr>\r\n              <td>{facilidad.find(x => x.id === lfacilities[i].facilityTypeId)?.description}</td>\r\n              <td></td>\r\n              <td></td>\r\n              <td></td>\r\n              <td></td>\r\n              <td></td>\r\n            </tr>)];\r\n            // datosGenerales = [...datosGenerales,...lCheckListDocs[594].map((data) => (\r\n            datosGenerales = [...datosGenerales,...lCheckListDocs[lfacilities[i].facilityId].map((data) => (\r\n              <tr key={data.id}>\r\n                <td></td>\r\n                <td>{data.document}</td>\r\n                <td>{data.excepted ? \"Si\" : \"No\"}</td>\r\n                <td>\r\n                  {data.expirationDate}\r\n                </td>\r\n                <td>\r\n                  {data[\"onbaseId\"] !== undefined ?\r\n                    <Link to=\"#\" title={t(\"View\")} onClick={() => viewAttachment(data.onbaseId)}><i className=\"mdi mdi-file-eye-outline mdi-24px\"></i></Link>\r\n                    : null}\r\n                </td>\r\n                <td style={{ textAlign: \"right\" }}>\r\n                  {data[\"onbaseId\"] !== undefined ?\r\n                    <Link to=\"#\" title={t(\"Remove\")} onClick={() => removeAttachment(data)}><i className=\"mdi mdi-file-remove-outline mdi-24px\"></i></Link>\r\n                    :\r\n                    <Link to=\"#\" title={t(\"Attach\")} color=\"danger\" onClick={() => openAddAttachment(data)}><i className=\"mdi mdi-file-upload-outline mdi-24px\"></i></Link>\r\n                  }\r\n                </td>\r\n              </tr>\r\n            )) ]\r\n          }*/console.log(\"datosCheckList\",datosCheckList);setAttachments(datosCheckList);});// setAttachments(lCheckListDocs);\ncase 72:case\"end\":return _context.stop();}}},_callee,null,[[28,46,49,52]]);}));return _loadData.apply(this,arguments);}function toggleShowModelAttachment(){setException(false);if(!showModelAttachment){fileData[\"name\"]=\"\";fileData[\"description\"]=\"\";setfileData(fileData);}setShowModelAttachment(!showModelAttachment);removeBodyCss();}function removeBodyCss(){document.body.classList.add(\"no_padding\");}//ABRIR PARA ADJNTAR ARCHIVO\nfunction openAddAttachment(data){setselectedAttachment(data);setShowModelAttachment(true);}//GUARDAR ADJUNTO\nfunction addAttachment(_x){return _addAttachment.apply(this,arguments);}//BORRAR ADJUNTO\nfunction _addAttachment(){_addAttachment=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(filedata){var _selectedAttachment$d,_mainPerson$personId,_resultCore$documentI,clientName,clientNumber,clientType,identification,data,resultCore;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setIsActiveLoading(true);console.log(\"selectedAttachment\",selectedAttachment.documentTypeId);_context2.prev=2;//GUARDAR EN GESTOR DOCUMENTAL ONBASE\n//filedata.name, filedata.description, filedata.fileName, filedata.fileExtension, filedata.fileBase64 \nclientName=mainPerson!==undefined?mainPerson.name+mainPerson.secondName+mainPerson.lastName+mainPerson.secondSurname:\"Attachment\";clientNumber=mainPerson!==undefined?mainPerson.customerNumberT24:attachmentFileInputModel.transactId.toString();clientType=mainPerson!==undefined&&mainPerson.personType!==\"1\"?\"J\":\"N\";identification=mainPerson!==undefined&&mainPerson.clientDocId.length>0?mainPerson.clientDocId:attachmentFileInputModel.transactId.toString();data={ApplicationNumber:attachmentFileInputModel.transactId,ClientName:clientName.trim(),ClientNumber:clientNumber.trim(),//\"98765432\",\nClientType:clientType,//\"N\",\nDocumentTypeId:(_selectedAttachment$d=selectedAttachment===null||selectedAttachment===void 0?void 0:selectedAttachment.documentTypeId)!==null&&_selectedAttachment$d!==void 0?_selectedAttachment$d:\"167\",//selectedAttachment.documentaryType,//,\nExpirationDate:moment().add(selectedAttachment.validityPeriodDays,\"days\").format(\"DD/MM/YYYY\"),FileExtension:filedata.fileExtension,Identification:identification.trim()+selectedAttachment.id,//\"9-728-1643\",\nImageBase64:filedata.fileBase64,ProcessCode:attachmentFileInputModel.processId,//\"7\",\nToken:attachmentFileInputModel.transactId+attachmentFileInputModel.processId+attachmentFileInputModel.activityId+selectedAttachment.id,//\"34543\",\nUploadDate:moment().format(\"DD/MM/YYYY\")//ProductNumber:\"456\"\n};/*\r\n      filedata['transactId'] = attachmentFileInputModel.transactId;\r\n      filedata['processId'] = attachmentFileInputModel.processId;\r\n      filedata['activityId'] = attachmentFileInputModel.activityId;\r\n      filedata['personId'] = attachmentFileInputModel.personId;\r\n      filedata['documentId'] = resultCore.documentId;\r\n      filedata['docName'] = resultCore.docName;\r\n      */_context2.next=10;return coreServices.postDocument(data).then(function(resultCore){return resultCore;}).catch(function(error){showMessage(t(\"Error\")+\" \"+error.message,true);}).finally(function(){setIsActiveLoading(false);});case 10:resultCore=_context2.sent;console.log(\"addAttachment\",resultCore);data={\"transactId\":attachmentFileInputModel.transactId,\"personId\":(_mainPerson$personId=mainPerson===null||mainPerson===void 0?void 0:mainPerson.personId)!==null&&_mainPerson$personId!==void 0?_mainPerson$personId:0,\"checklistId\":selectedAttachment.id,\"document\":selectedAttachment.document,\"onbaseId\":(_resultCore$documentI=resultCore===null||resultCore===void 0?void 0:resultCore.documentId)!==null&&_resultCore$documentI!==void 0?_resultCore$documentI:'',\"date\":moment().valueOf(),\"expirationDate\":fileData.expirationDate!==undefined?fileData.expirationDate:moment().add(100,'years').format(\"YYYY-MM-DD\"),\"excluded\":fileData.excluded!==undefined?fileData.excluded:false,\"commitmentDate\":moment().format(\"YYYY-MM-DD\"),\"status\":true};backendServices.guardarCheckListTramite(data).then(function(resultBackend){if(resultBackend){// SI TODO OK ACTUALIZAR LA LISTA DE ADJUNTOS\nloadData();setException(false);}}).catch(function(error){showMessage(t(\"Error\")+\" \"+error.message,true);}).finally(function(){setIsActiveLoading(false);});_context2.next=20;break;case 16:_context2.prev=16;_context2.t0=_context2[\"catch\"](2);showMessage(t(\"Error\")+\" \"+_context2.t0.message,true);setIsActiveLoading(false);case 20:case\"end\":return _context2.stop();}}},_callee2,null,[[2,16]]);}));return _addAttachment.apply(this,arguments);}function removeAttachment(data){var mainPersonL=arguments.length>1&&arguments[1]!==undefined?arguments[1]:mainPerson;//BORRAR EN GESTOR DOCUMENTAL ONBASE\n////BORRAR EN BD \n// data = { transactId: data.transactId, onBaseIdentification: data.onBaseIdentification };\nbackendServices.eliminarCheckListTramite(attachmentFileInputModel.transactId,mainPersonL.personId,data.id).then(function(resultBackend){if(resultBackend){// SI TODO OK ACTUALIZAR LA LISTA DE ADJUNTOS\nloadData();}}).catch(function(error){showMessage(t(\"Error\")+\" \"+error.message,true);}).finally(function(){});//})\n//.catch((error) => {console.error('api error', error);})\n//.finally (() => {  });        \n}//VER ADJUNTO\nfunction viewAttachment(docId){coreServices.postViewDocument(docId).then(function(resultCore){console.log(\"viewAttachment\",resultCore);if(resultCore!==null){window.open(resultCore,\"_blank\");}}).catch(function(error){console.error('api error',error);}).finally(function(){setIsActiveLoading(false);});}function saveAttachment(){var form=document.getElementById('frmAttachment');form.requestSubmit();}// Submitimos formulario para busqueda de clientes\nfunction handleSubmitfrmAttachment(event,errors,values){event.preventDefault();if(errors.length>0){return;}if(fileData['fileName']===undefined&&!exception){return;}addAttachment(fileData);toggleShowModelAttachment();}//On change Inputs\nfunction handleChangeInputfrm(_x2){return _handleChangeInputfrm.apply(this,arguments);}function _handleChangeInputfrm(){_handleChangeInputfrm=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e){var file,base64;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:fileData[e.target.name]=e.target.value;_context3.t0=e.target.name;_context3.next=_context3.t0===\"attachment\"?4:17;break;case 4:fileData['fileName']=undefined;if(!(e.target.files[0].size>1024*1024*5)){_context3.next=8;break;}//1024*1024*5 => 5MB\nshowMessageModal(t(\"FileToBigOnlyAcceptFilesUntil\")+\" 5MB\",true);return _context3.abrupt(\"return\");case 8:;file=e.target.files[0];fileData['fileName']=file.name;fileData['fileExtension']=\".\"+file.name.split('.').pop();_context3.next=14;return functionshelper.convertBase64(file);case 14:base64=_context3.sent;//console.log(\"base64\",base64.split(','))\nfileData['fileBase64']=base64.split(',')[1];return _context3.abrupt(\"break\",18);case 17:return _context3.abrupt(\"break\",18);case 18:console.log(\"fileData\",fileData);setfileData(fileData);case 20:case\"end\":return _context3.stop();}}},_callee3);}));return _handleChangeInputfrm.apply(this,arguments);}function handleChangeInputChkClient(e){fileData[e.target.name]=e.target.checked;setException(e.target.checked);}//mostrar mensaje \nfunction showMessage(message){var isError=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;setmsgData({show:true,msg:message,isError:isError});}function showMessageModal(message){var isError=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;setmsgModal({show:true,msg:message,isError:isError});}return/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsxs(LoadingOverlay,{active:isActiveLoading,spinner:true,text:t(\"WaitingPlease\"),children:[/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{md:\"6\",children:/*#__PURE__*/_jsx(\"h5\",{className:\"card-sub-title\",children:t(\"CheckList\")})})}),/*#__PURE__*/_jsx(CardBody,{children:/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{md:\"12\",className:\"table-responsive styled-table-div\",children:attachments!==null?/*#__PURE__*/_jsxs(Table,{className:\"table table-striped table-hover table-condensed styled-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{}),/*#__PURE__*/_jsx(\"th\",{children:t(\"Name\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"Exception\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"Expiration\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"File\")}),/*#__PURE__*/_jsx(\"th\",{})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:attachments})]})// </Col>\n:/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{Col:true,md:12,children:/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-info\",children:t(\"NoData\")})})})})})}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsx(Alert,{className:\"text-center\",show:msgData.show,variant:msgData.isError?\"danger\":\"success\",dismissible:true,onClose:function onClose(){setmsgData({show:false,msg:\"\",isError:false});},children:msgData.msg})})})]}),showModelAttachment?/*#__PURE__*/_jsxs(Modal,{size:\"md\",isOpen:showModelAttachment,toggle:toggleShowModelAttachment,centered:true,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"modal-title mt-0\",children:t(\"Attach File\")}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:toggleShowModelAttachment,className:\"close\",\"data-dismiss\":\"modal\",\"aria-label\":\"Close\",children:/*#__PURE__*/_jsx(\"span\",{\"aria-hidden\":\"true\",children:\"\\xD7\"})})]}),/*#__PURE__*/_jsxs(AvForm,{id:\"frmAttachment\",className:\"needs-validation\",onSubmit:handleSubmitfrmAttachment,children:[/*#__PURE__*/_jsx(\"div\",{className:\"modal-body\",children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"name\",children:t(\"Name\")}),/*#__PURE__*/_jsx(AvField,{className:\"form-control\",type:\"text\",name:\"name\",onChange:handleChangeInputfrm,errorMessage:t(\"Required Field\"),validate:{required:{value:!exception}}})]})}),/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"name\",children:t(\"ExpirationDate\")}),/*#__PURE__*/_jsx(Flatpickr,{id:\"expirationDate\",name:\"expirationDate\",className:\"form-control d-block\",placeholder:OPTs.FORMAT_DATE_SHOW,options:{dateFormat:OPTs.FORMAT_DATE//maxDate: new Date().setFullYear(new Date().getFullYear() - 18),\n//defaultDate: dataGeneral !== undefined && dataGeneral !==null ? new Date(moment(dataGeneral.issuedDate, 'YYYY-MM-DD').format()) : new Date()\n},onChange:function onChange(selectedDates,dateStr,instance){handleChangeInputfrm({target:{name:\"expirationDate\",value:moment(dateStr,\"DD/MM/YYYY\").format(\"YYYY-MM-DD\")}});}})]})}),/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"name\",children:t(\"Exception\")}),/*#__PURE__*/_jsx(AvInput,{type:\"checkbox\",name:\"excluded\",onChange:handleChangeInputChkClient})]})}),/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"attachment\",children:t(\"File\")}),/*#__PURE__*/_jsx(AvField,{className:\"form-control\",type:\"file\",name:\"attachment\",onChange:handleChangeInputfrm,errorMessage:t(\"Required Field\"),validate:{required:{value:!exception}},accept:\".jpg,.jpeg,.png,.doc,.docx,.xls,.xlsx,.pdf\"})]})}),exception?/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"name\",children:t(\"Fecha de reposici√≥n\")}),/*#__PURE__*/_jsx(Flatpickr,{id:\"expirationDate2\",name:\"expirationDate2\",className:\"form-control d-block\",placeholder:OPTs.FORMAT_DATE_SHOW,options:{dateFormat:OPTs.FORMAT_DATE//maxDate: new Date().setFullYear(new Date().getFullYear() - 18),\n//defaultDate: dataGeneral !== undefined && dataGeneral !==null ? new Date(moment(dataGeneral.issuedDate, 'YYYY-MM-DD').format()) : new Date()\n},onChange:function onChange(selectedDates,dateStr,instance){handleChangeInputfrm({target:{name:\"expirationDate2\",value:moment(dateStr,\"DD/MM/YYYY\").format(\"YYYY-MM-DD\")}});}})]})}):null,/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"attachment\",children:t(\"Comment\")}),/*#__PURE__*/_jsx(AvField,{className:\"form-control\",type:\"textarea\",name:\"comment\",rows:\"7\"})]})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-footer\",children:[/*#__PURE__*/_jsxs(Button,{color:\"danger\",style:{margin:'5px 0px'},type:\"button\",onClick:toggleShowModelAttachment,\"data-dismiss\":\"modal\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi mdi-cancel mid-12px\"}),\" \",t(\"Cancel\")]}),/*#__PURE__*/_jsxs(Button,{color:\"success\",type:\"submit\",style:{margin:'5px'},children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-content-save mid-12px\"}),\" \",t(\"Save\")]})]})]}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsx(Alert,{className:\"text-center\",show:msgModal.show,variant:msgModal.isError?\"danger\":\"success\",dismissible:true,onClose:function onClose(){setmsgModal({show:false,msg:\"\",isError:false});},children:msgModal.msg})})})]}):null]})});};//export default (withTranslation()(DatosGenerales));\nexport default CheckList;","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/components/Common/CheckList.js"],"names":["React","useState","useRef","useTranslation","useLocation","useHistory","moment","OPTs","Flatpickr","Row","Col","Card","CardBody","Button","Label","Table","Pagination","PaginationItem","PaginationLink","CardFooter","Modal","AvForm","AvField","AvInput","Link","DocumentModel","DocumentoAnexoModel","functionshelper","LoadingOverlay","CoreServices","BackendServices","BpmServices","Alert","number","uniqueId","CheckList","props","t","i18n","attachmentFileInputModel","showModelAttachment","setShowModelAttachment","attachments","setAttachments","isActiveLoading","setIsActiveLoading","fileData","setfileData","undefined","mainPerson","setmainPerson","bpmServices","setbpmServices","backendServices","setbackendServices","coreServices","setcoreServices","show","msg","isError","msgData","setmsgData","msgModal","setmsgModal","selectedAttachment","setselectedAttachment","facilidadesList","setfacilidadesList","exception","setException","useEffect","loadData","consultPrincipalDebtor","transactId","mainDebtor","consultGeneralDataIGR","generalData","consultGeneralDataPropCred","propousalData","consultarFacilidades","requestId","lfacilities","listCheckValidation","processId","lCheckValidation","console","log","bankingType","facilityType","requestType","processStage","guaranteeType","bailType","push","bank","code","procId","PROCESS_BUSQUEDADESCARTE","PROCESS_ACEPTACIONCLIENTE","facility","facilityTypeId","proposalTypeId","consultarGarantiaPropCred","facilityId","lguarantees","consultarFianzaPropCred","lbails","guarantee","Number","guaranteeTypeName","bail","typeBail","length","data","getCheckListDocuments","lCheckListDocs","lCheckListDocsArray","Object","keys","consultarCheckListTramite","personId","lCheckListTramite","i","chkDoc","item","checklistId","id","onbaseId","expirationDate","diff","format","excluded","excepted","err","datosCheckList","general","map","document","viewAttachment","textAlign","removeAttachment","openAddAttachment","retrieveFacilityType","then","facilidad","k","find","x","description","toggleShowModelAttachment","removeBodyCss","body","classList","add","addAttachment","filedata","documentTypeId","clientName","name","secondName","lastName","secondSurname","clientNumber","customerNumberT24","toString","clientType","personType","identification","clientDocId","ApplicationNumber","ClientName","trim","ClientNumber","ClientType","DocumentTypeId","ExpirationDate","validityPeriodDays","FileExtension","fileExtension","Identification","ImageBase64","fileBase64","ProcessCode","Token","activityId","UploadDate","postDocument","resultCore","catch","error","showMessage","message","finally","documentId","valueOf","guardarCheckListTramite","resultBackend","mainPersonL","eliminarCheckListTramite","docId","postViewDocument","window","open","saveAttachment","form","getElementById","requestSubmit","handleSubmitfrmAttachment","event","errors","values","preventDefault","handleChangeInputfrm","e","target","value","files","size","showMessageModal","file","split","pop","convertBase64","base64","handleChangeInputChkClient","checked","required","FORMAT_DATE_SHOW","dateFormat","FORMAT_DATE","selectedDates","dateStr","instance","margin"],"mappings":"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","sourcesContent":["import React, { useState, useRef } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { useTranslation } from 'react-i18next'\r\nimport { useLocation, useHistory } from 'react-router-dom'\r\n\r\nimport moment from \"moment\";\r\nimport * as OPTs from \"../../helpers/options_helper\"\r\nimport \"flatpickr/dist/themes/material_blue.css\";\r\nimport Flatpickr from \"react-flatpickr\";\r\n\r\n\r\nimport {\r\n  Row,\r\n  Col,\r\n  Card,\r\n  CardBody,\r\n  Button,\r\n  Label,\r\n  Table,\r\n  Pagination,\r\n  PaginationItem,\r\n  PaginationLink,\r\n  CardFooter,\r\n  Modal,\r\n} from \"reactstrap\"\r\n\r\nimport { AvForm, AvField, AvInput } from \"availity-reactstrap-validation\"\r\nimport { Link } from \"react-router-dom\"\r\nimport DocumentModel from \"../../models/Core/DocumentModel\";\r\nimport DocumentoAnexoModel from \"../../models/Backend/DocumentoAnexoModel\";\r\nimport functionshelper from \"../../helpers/functions_helper\"\r\nimport LoadingOverlay from 'react-loading-overlay';\r\n\r\nimport { CoreServices, BackendServices, BpmServices } from '../../services';\r\nimport Alert from 'react-bootstrap/Alert'\r\nimport { number } from 'yargs';\r\nimport { uniqueId } from 'lodash';\r\n\r\nconst CheckList = (props) => {\r\n\r\n  const { t, i18n } = useTranslation();\r\n\r\n  const { attachmentFileInputModel } = props;\r\n\r\n  const [showModelAttachment, setShowModelAttachment] = useState(false);\r\n  const [attachments, setAttachments] = useState([]);\r\n  const [isActiveLoading, setIsActiveLoading] = useState(false);\r\n  const [fileData, setfileData] = useState({});\r\n  const [mainPerson, setmainPerson] = useState(undefined);\r\n\r\n  //Servicios\r\n  const [bpmServices, setbpmServices] = useState(new BpmServices());\r\n  const [backendServices, setbackendServices] = useState(new BackendServices());\r\n  const [coreServices, setcoreServices] = useState(new CoreServices());\r\n\r\n  const [msgData, setmsgData] = useState({ show: false, msg: \"\", isError: false });\r\n  const [msgModal, setmsgModal] = useState({ show: false, msg: \"\", isError: false });\r\n\r\n  const [selectedAttachment, setselectedAttachment] = useState(undefined);\r\n  const [facilidadesList, setfacilidadesList] = useState(null);\r\n  const [exception, setException] = useState(false);\r\n\r\n  //On Mounting (componentDidMount) if selectedData has changes\r\n  React.useEffect(() => {\r\n    loadData();\r\n  }, []);\r\n\r\n\r\n  async function loadData() {    \r\n       \r\n    var mainDebtor = await backendServices.consultPrincipalDebtor(attachmentFileInputModel.transactId);\r\n    setmainPerson(mainDebtor);//mainDebtor.personId\r\n\r\n    var generalData = await backendServices.consultGeneralDataIGR(attachmentFileInputModel.transactId);\r\n    //generalData.bank.code;\r\n\r\n    var propousalData = await backendServices.consultGeneralDataPropCred(attachmentFileInputModel.transactId);\r\n    //propousalData[0].requestId;\r\n\r\n    var lfacilities = await backendServices.consultarFacilidades(propousalData[0]?.requestId ?? \"\");\r\n    setfacilidadesList(lfacilities)\r\n\r\n    var lCheckValidation = (await bpmServices.listCheckValidation(attachmentFileInputModel.processId));\r\n    console.log(\"lCheckValidation\", lCheckValidation)\r\n\r\n    var bankingType = []; //es del IGR ... generalData.bank.code;\r\n    var facilityType = []; //facilityType\r\n    var requestType = []  //proposedType\r\n    var processStage = [] //processId\r\n    var guaranteeType = [];\r\n    var bailType = [];\r\n\r\n    bankingType.push(generalData?.bank?.code ?? \"\");\r\n\r\n    var procId = attachmentFileInputModel.processId === OPTs.PROCESS_BUSQUEDADESCARTE?0:(attachmentFileInputModel.processId === OPTs.PROCESS_ACEPTACIONCLIENTE?13:attachmentFileInputModel.processId);   \r\n    processStage.push(procId)\r\n    \r\n    for (var facility of lfacilities) {\r\n      facilityType.push(facility.facilityTypeId);\r\n      requestType.push(facility.proposalTypeId);\r\n      var lguarantees = await backendServices.consultarGarantiaPropCred(facility.facilityId);\r\n      var lbails = await backendServices.consultarFianzaPropCred(facility.facilityId);\r\n      if (lguarantees !== undefined) {\r\n        for (var guarantee of lguarantees) {\r\n          guaranteeType.push(Number(guarantee.guaranteeTypeName))\r\n        }\r\n      }\r\n      if (lbails !== undefined) {\r\n        for (var bail of lbails) {\r\n          bailType.push(bail.typeBail)\r\n        }\r\n      }\r\n    }\r\n    if (facilityType.length == 0) {\r\n      facilityType = [\"\"];\r\n    }\r\n    if (guaranteeType.length == 0) {\r\n      guaranteeType = [\"\"];\r\n    }\r\n    if (bankingType.length == 0) {\r\n      bankingType = [\"\"];\r\n    }\r\n    if (processStage.length == 0) {\r\n      processStage = [\"\"];\r\n    }\r\n    if (requestType.length == 0) {\r\n      requestType = [\"\"];\r\n    }\r\n    if (bailType.length == 0) {\r\n      bailType = [\"\"];\r\n    }\r\n    var data = {\r\n      \"bankingType\": bankingType,\r\n      \"guaranteeType\": guaranteeType,\r\n      \"facilityType\": facilityType,\r\n      \"requestType\": requestType,\r\n      \"processStage\": processStage,\r\n      \"bailType\": bailType,\r\n      \"guarantorCustomer\": true,\r\n      \"transactId\": attachmentFileInputModel.transactId\r\n    }\r\n\r\n    /* data={\r\n       \"bankingType\": [\"PYME\"],\r\n       \"guaranteeType\": [100],\r\n       \"facilityType\": [\"LCR\"],\r\n       \"requestType\": [\"NU\"],\r\n       \"processStage\": [2]\r\n     }*/\r\n    //  console.log(data);\r\n    var lCheckListDocs = await backendServices.getCheckListDocuments(data);\r\n    \r\n    var lCheckListDocsArray = [];\r\n    lCheckListDocsArray = Object.keys(lCheckListDocs);\r\n   \r\n    if (lCheckListDocs !== undefined) {\r\n     \r\n      var lCheckListTramite = await backendServices.consultarCheckListTramite(attachmentFileInputModel?.transactId??0, mainDebtor?.personId??0);\r\n      \r\n      if (lCheckListTramite !== undefined && lCheckListTramite!==null && lCheckListTramite.length > 0) {\r\n        for (var i = 0; i < lCheckListDocsArray.length; i++) {\r\n          try{\r\n\r\n            for (var chkDoc of lCheckListDocs[lCheckListDocsArray[i]]) {\r\n              for (var item of lCheckListTramite) {\r\n                if (item.checklistId === chkDoc.id) {\r\n                  chkDoc[\"onbaseId\"] = item.onbaseId;\r\n                  //chkDoc[\"date\"] = moment(item.date).add(chkDoc.validityPeriodDays, \"days\");\r\n                  chkDoc[\"expirationDate\"] = \"\";\r\n                  if (item.expirationDate !== null && item.expirationDate !== undefined && moment(item.expirationDate).diff(moment(), 'years') < 50) {\r\n                    chkDoc[\"expirationDate\"] = moment(item.expirationDate).format(\"DD/MM/YYYY\");\r\n                  }\r\n                  console.log()\r\n                  if (item.excluded !== null && item.excluded !== undefined) {\r\n                    chkDoc.excepted = item.excluded;\r\n                  }\r\n                }\r\n              }\r\n            }\r\n  \r\n          }\r\n          catch(err){}          \r\n        }\r\n      }\r\n      \r\n      let datosCheckList = [];\r\n      (lCheckListDocs?.general ?? [])?.length > 0 && (datosCheckList = [(\r\n        <tr key={(+uniqueId()) ** 2}>\r\n          <td colSpan=\"6\" className='tr-subtitle'><b>Documentos Generales</b></td>\r\n        </tr>), ...(lCheckListDocs?.general ?? [])?.map((data) => (\r\n          <tr key={uniqueId() + data.id}>\r\n            <td></td>\r\n            <td>{data.document}</td>\r\n            <td>{data.excepted ? \"Si\" : \"No\"}</td>\r\n            <td>\r\n              {data.expirationDate}\r\n            </td>\r\n            <td>\r\n              {data[\"onbaseId\"] !== undefined ?\r\n                <Link to=\"#\" title={t(\"View\")} onClick={() => viewAttachment(data.onbaseId)}><i className=\"mdi mdi-file-eye-outline mdi-24px\"></i></Link>\r\n                : null}\r\n            </td>\r\n            <td style={{ textAlign: \"right\" }}>\r\n              {lCheckValidation ? (data[\"onbaseId\"] !== undefined ?\r\n                <Link to=\"#\" title={t(\"Remove\")} onClick={() => removeAttachment(data, mainDebtor)}><i className=\"mdi mdi-file-remove-outline mdi-24px\"></i></Link>\r\n                :\r\n                <Link to=\"#\" title={t(\"Attach\")} color=\"danger\" onClick={() => openAddAttachment(data)}><i className=\"mdi mdi-file-upload-outline mdi-24px\"></i></Link>) : null\r\n              }\r\n            </td>\r\n          </tr>\r\n        ))]);\r\n\r\n        /*\r\n        (lCheckListDocs?.mandatory ?? [])?.length > 0 && (datosCheckList = [(\r\n          <tr key={(+uniqueId()) ** 2}>\r\n            <td colSpan=\"6\" className='tr-subtitle'><b>Documentos Generales</b></td>\r\n          </tr>), ...(lCheckListDocs?.mandatory ?? [])?.map((data) => (\r\n            <tr key={uniqueId() + data.id}>\r\n              <td></td>\r\n              <td>{data.document}</td>\r\n              <td>{data.excepted ? \"Si\" : \"No\"}</td>\r\n              <td>\r\n                {data.expirationDate}\r\n              </td>\r\n              <td>\r\n                {data[\"onbaseId\"] !== undefined ?\r\n                  <Link to=\"#\" title={t(\"View\")} onClick={() => viewAttachment(data.onbaseId)}><i className=\"mdi mdi-file-eye-outline mdi-24px\"></i></Link>\r\n                  : null}\r\n              </td>\r\n              <td style={{ textAlign: \"right\" }}>\r\n                {lCheckValidation ? (data[\"onbaseId\"] !== undefined ?\r\n                  <Link to=\"#\" title={t(\"Remove\")} onClick={() => removeAttachment(data, mainDebtor)}><i className=\"mdi mdi-file-remove-outline mdi-24px\"></i></Link>\r\n                  :\r\n                  <Link to=\"#\" title={t(\"Attach\")} color=\"danger\" onClick={() => openAddAttachment(data)}><i className=\"mdi mdi-file-upload-outline mdi-24px\"></i></Link>) : null\r\n                }\r\n              </td>\r\n            </tr>\r\n          ))]);\r\n          */\r\n\r\n      backendServices.retrieveFacilityType()\r\n        .then((facilidad) => {\r\n\r\n          console.log(\"facilidad\", facilidad);\r\n          console.log(\"lfacilities\", lfacilities);\r\n\r\n\r\n          for (let k = 0; k < lCheckListDocsArray.length; k++) {\r\n            if (lCheckListDocsArray[k] != \"general\") {\r\n              console.log(\"lCheckListDocsArray[k]\", lCheckListDocsArray[k]);\r\n              for (let i = 0; i < lfacilities.length; i++) {\r\n                if (lfacilities[i].facilityId == lCheckListDocsArray[k]) {\r\n                  console.log(\"facilidad Encontrada\");\r\n\r\n                  datosCheckList = [...datosCheckList, (<tr key={(uniqueId()) ** 3}>\r\n                    <td colSpan=\"6\" className='tr-subtitle'><b>{facilidad.find(x => x.id === lfacilities[i].facilityTypeId)?.description}</b></td>\r\n                  </tr>)];\r\n\r\n\r\n                  datosCheckList = [...datosCheckList, ...lCheckListDocs[lfacilities[i].facilityId].map((data) => (\r\n                    <tr key={uniqueId() + data.id}>\r\n                      <td></td>\r\n                      <td>{data.document}</td>\r\n                      <td>{data.excepted ? \"Si\" : \"No\"}</td>\r\n                      <td>\r\n                        {data.expirationDate}\r\n                      </td>\r\n                      <td>\r\n                        {data[\"onbaseId\"] !== undefined ?\r\n                          <Link to=\"#\" title={t(\"View\")} onClick={() => viewAttachment(data.onbaseId)}><i className=\"mdi mdi-file-eye-outline mdi-24px\"></i></Link>\r\n                          : null}\r\n                      </td>\r\n                      <td style={{ textAlign: \"right\" }}>\r\n                        {lCheckValidation ? (data[\"onbaseId\"] !== undefined ?\r\n                          <Link to=\"#\" title={t(\"Remove\")} onClick={() => removeAttachment(data, mainDebtor)}><i className=\"mdi mdi-file-remove-outline mdi-24px\"></i></Link>\r\n                          :\r\n                          <Link to=\"#\" title={t(\"Attach\")} color=\"danger\" onClick={() => { openAddAttachment(data) }}><i className=\"mdi mdi-file-upload-outline mdi-24px\"></i></Link>) : null\r\n                        }\r\n                      </td>\r\n                    </tr>\r\n                  ))];\r\n\r\n                  break;\r\n                }\r\n              }\r\n            }\r\n          }\r\n\r\n\r\n\r\n\r\n          /*\r\n          for (let i = 0; i < lfacilities.length; i++) {\r\n            datosGenerales = [...datosGenerales,(<tr>\r\n              <td>{facilidad.find(x => x.id === lfacilities[i].facilityTypeId)?.description}</td>\r\n              <td></td>\r\n              <td></td>\r\n              <td></td>\r\n              <td></td>\r\n              <td></td>\r\n            </tr>)];\r\n            // datosGenerales = [...datosGenerales,...lCheckListDocs[594].map((data) => (\r\n            datosGenerales = [...datosGenerales,...lCheckListDocs[lfacilities[i].facilityId].map((data) => (\r\n              <tr key={data.id}>\r\n                <td></td>\r\n                <td>{data.document}</td>\r\n                <td>{data.excepted ? \"Si\" : \"No\"}</td>\r\n                <td>\r\n                  {data.expirationDate}\r\n                </td>\r\n                <td>\r\n                  {data[\"onbaseId\"] !== undefined ?\r\n                    <Link to=\"#\" title={t(\"View\")} onClick={() => viewAttachment(data.onbaseId)}><i className=\"mdi mdi-file-eye-outline mdi-24px\"></i></Link>\r\n                    : null}\r\n                </td>\r\n                <td style={{ textAlign: \"right\" }}>\r\n                  {data[\"onbaseId\"] !== undefined ?\r\n                    <Link to=\"#\" title={t(\"Remove\")} onClick={() => removeAttachment(data)}><i className=\"mdi mdi-file-remove-outline mdi-24px\"></i></Link>\r\n                    :\r\n                    <Link to=\"#\" title={t(\"Attach\")} color=\"danger\" onClick={() => openAddAttachment(data)}><i className=\"mdi mdi-file-upload-outline mdi-24px\"></i></Link>\r\n                  }\r\n                </td>\r\n              </tr>\r\n            )) ]\r\n          }*/\r\n\r\n          console.log(\"datosCheckList\", datosCheckList);\r\n          setAttachments(datosCheckList);\r\n        });\r\n\r\n\r\n      // setAttachments(lCheckListDocs);\r\n    } \r\n  }\r\n\r\n  //abrimos modal para adjunar archivos\r\n  function toggleShowModelAttachment() {\r\n    setException(false)\r\n    if (!showModelAttachment) {\r\n      fileData[\"name\"] = \"\";\r\n      fileData[\"description\"] = \"\";\r\n      setfileData(fileData);\r\n    }\r\n    setShowModelAttachment(!showModelAttachment);\r\n    removeBodyCss()\r\n  }\r\n\r\n  function removeBodyCss() {\r\n    document.body.classList.add(\"no_padding\")\r\n  }\r\n\r\n  //ABRIR PARA ADJNTAR ARCHIVO\r\n  function openAddAttachment(data) {\r\n    setselectedAttachment(data);\r\n    setShowModelAttachment(true);\r\n  }\r\n\r\n  //GUARDAR ADJUNTO\r\n  async function addAttachment(filedata) {\r\n\r\n    setIsActiveLoading(true);\r\n    console.log(\"selectedAttachment\",selectedAttachment.documentTypeId);\r\n    try {\r\n      //GUARDAR EN GESTOR DOCUMENTAL ONBASE\r\n      //filedata.name, filedata.description, filedata.fileName, filedata.fileExtension, filedata.fileBase64 \r\n      var clientName = mainPerson !== undefined ? (mainPerson.name + mainPerson.secondName + mainPerson.lastName + mainPerson.secondSurname) : \"Attachment\";\r\n      var clientNumber = mainPerson !== undefined ? (mainPerson.customerNumberT24) : attachmentFileInputModel.transactId.toString();\r\n      var clientType = mainPerson !== undefined && mainPerson.personType !== \"1\" ? \"J\" : \"N\";\r\n      var identification = mainPerson !== undefined && mainPerson.clientDocId.length > 0 ? mainPerson.clientDocId : attachmentFileInputModel.transactId.toString();\r\n      var data = {\r\n        ApplicationNumber: attachmentFileInputModel.transactId,\r\n        ClientName: clientName.trim(),\r\n        ClientNumber: clientNumber.trim(),//\"98765432\",\r\n        ClientType: clientType,//\"N\",\r\n        DocumentTypeId: selectedAttachment?.documentTypeId??\"167\",//selectedAttachment.documentaryType,//,\r\n        ExpirationDate: moment().add(selectedAttachment.validityPeriodDays, \"days\").format(\"DD/MM/YYYY\"),\r\n        FileExtension: filedata.fileExtension,\r\n        Identification: identification.trim() + selectedAttachment.id,//\"9-728-1643\",\r\n        ImageBase64: filedata.fileBase64,\r\n        ProcessCode: attachmentFileInputModel.processId,//\"7\",\r\n        Token: attachmentFileInputModel.transactId + attachmentFileInputModel.processId + attachmentFileInputModel.activityId + selectedAttachment.id,//\"34543\",\r\n        UploadDate: moment().format(\"DD/MM/YYYY\"),\r\n        //ProductNumber:\"456\"\r\n      };\r\n      /*\r\n      filedata['transactId'] = attachmentFileInputModel.transactId;\r\n      filedata['processId'] = attachmentFileInputModel.processId;\r\n      filedata['activityId'] = attachmentFileInputModel.activityId;\r\n      filedata['personId'] = attachmentFileInputModel.personId;\r\n      filedata['documentId'] = resultCore.documentId;\r\n      filedata['docName'] = resultCore.docName;\r\n      */\r\n      let resultCore = await coreServices.postDocument(data).then((resultCore) => resultCore).catch((error) => {\r\n        showMessage(t(\"Error\") + \" \" + error.message, true);\r\n      }).finally(() => { setIsActiveLoading(false); });\r\n\r\n      console.log(\"addAttachment\",resultCore);\r\n      var data = {\r\n        \"transactId\": attachmentFileInputModel.transactId,\r\n        \"personId\": mainPerson?.personId??0,\r\n        \"checklistId\": selectedAttachment.id,\r\n        \"document\": selectedAttachment.document,\r\n        \"onbaseId\": resultCore?.documentId ?? '',\r\n        \"date\": moment().valueOf(),\r\n        \"expirationDate\": fileData.expirationDate !== undefined ? fileData.expirationDate : moment().add(100, 'years').format(\"YYYY-MM-DD\"),\r\n        \"excluded\": fileData.excluded !== undefined ? fileData.excluded : false,\r\n        \"commitmentDate\": moment().format(\"YYYY-MM-DD\"),\r\n        \"status\": true\r\n      }\r\n\r\n      backendServices.guardarCheckListTramite(data).then((resultBackend) => {\r\n        if (resultBackend) {\r\n          // SI TODO OK ACTUALIZAR LA LISTA DE ADJUNTOS\r\n          loadData();\r\n          setException(false)\r\n        }\r\n      }).catch((error) => {\r\n        showMessage(t(\"Error\") + \" \" + error.message, true);\r\n      }).finally(() => { setIsActiveLoading(false); });\r\n    }\r\n    catch (error) { showMessage(t(\"Error\") + \" \" + error.message, true); setIsActiveLoading(false); }\r\n  }\r\n\r\n  //BORRAR ADJUNTO\r\n  function removeAttachment(data, mainPersonL = mainPerson) {\r\n\r\n    //BORRAR EN GESTOR DOCUMENTAL ONBASE\r\n\r\n    ////BORRAR EN BD \r\n    // data = { transactId: data.transactId, onBaseIdentification: data.onBaseIdentification };\r\n    backendServices.eliminarCheckListTramite(attachmentFileInputModel.transactId, mainPersonL.personId, data.id).then((resultBackend) => {\r\n\r\n      if (resultBackend) {\r\n        // SI TODO OK ACTUALIZAR LA LISTA DE ADJUNTOS\r\n        loadData();\r\n      }\r\n\r\n    }).catch((error) => {\r\n      showMessage(t(\"Error\") + \" \" + error.message, true);\r\n    })\r\n      .finally(() => { });\r\n    //})\r\n    //.catch((error) => {console.error('api error', error);})\r\n    //.finally (() => {  });        \r\n  }\r\n\r\n  //VER ADJUNTO\r\n  function viewAttachment(docId) {\r\n    coreServices.postViewDocument(docId).then((resultCore) => {\r\n      console.log(\"viewAttachment\",resultCore);\r\n    \r\n      if (resultCore !== null) {\r\n        window.open(resultCore, \"_blank\")\r\n      }\r\n    }).catch((error) => { console.error('api error', error); })\r\n      .finally(() => { setIsActiveLoading(false); });\r\n  }\r\n\r\n  function saveAttachment() {\r\n    let form = document.getElementById('frmAttachment');\r\n    form.requestSubmit();\r\n  }\r\n\r\n  // Submitimos formulario para busqueda de clientes\r\n  function handleSubmitfrmAttachment(event, errors, values) {\r\n    event.preventDefault();\r\n    if (errors.length > 0) {\r\n      return;\r\n    }\r\n\r\n    if (fileData['fileName'] === undefined && !exception) {\r\n      return;\r\n    }\r\n\r\n    addAttachment(fileData);\r\n    toggleShowModelAttachment();\r\n  }\r\n  //On change Inputs\r\n  async function handleChangeInputfrm(e) {\r\n    fileData[e.target.name] = e.target.value;\r\n    switch (e.target.name) {\r\n      case \"attachment\": {\r\n        fileData['fileName'] = undefined;\r\n\r\n        if (e.target.files[0].size > (1024 * 1024 * 5)) {  //1024*1024*5 => 5MB\r\n          showMessageModal(t(\"FileToBigOnlyAcceptFilesUntil\") + \" 5MB\", true);\r\n          return;\r\n        };\r\n\r\n        const file = e.target.files[0]\r\n        fileData['fileName'] = file.name;\r\n        fileData['fileExtension'] = \".\" + file.name.split('.').pop();\r\n        var base64 = await functionshelper.convertBase64(file);\r\n        //console.log(\"base64\",base64.split(','))\r\n        fileData['fileBase64'] = base64.split(',')[1];\r\n        break;\r\n      }\r\n      default:\r\n        break;\r\n    }\r\n    console.log(\"fileData\", fileData)\r\n    setfileData(fileData);\r\n  }\r\n  function handleChangeInputChkClient(e) {\r\n    fileData[e.target.name] = e.target.checked;\r\n    setException(e.target.checked)\r\n  }\r\n  //mostrar mensaje \r\n  function showMessage(message, isError = false) {\r\n    setmsgData({ show: true, msg: message, isError: isError })\r\n  }\r\n  function showMessageModal(message, isError = false) {\r\n    setmsgModal({ show: true, msg: message, isError: isError })\r\n  }\r\n\r\n  return (\r\n\r\n    <React.Fragment>\r\n      <LoadingOverlay active={isActiveLoading} spinner text={t(\"WaitingPlease\")}>\r\n\r\n        <Card>\r\n          <Row>\r\n            <Col md=\"6\">\r\n              <h5 className=\"card-sub-title\">{t(\"CheckList\")}</h5>\r\n            </Col>\r\n          </Row>\r\n\r\n          <CardBody>\r\n            <Row>\r\n              {/* <Col md={12}> */}\r\n\r\n              <Col md=\"12\" className=\"table-responsive styled-table-div\">\r\n                {attachments !== null ?\r\n                  <Table className=\"table table-striped table-hover table-condensed styled-table\">\r\n                    <thead>\r\n                      <tr>\r\n                        <th></th>\r\n                        <th>{t(\"Name\")}</th>\r\n                        <th>{t(\"Exception\")}</th>\r\n                        <th>{t(\"Expiration\")}</th>\r\n                        <th>{t(\"File\")}</th>\r\n                        <th></th>\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                      {attachments}\r\n                    </tbody>\r\n                  </Table>\r\n                  // </Col>\r\n                  : (\r\n                    <Row>\r\n                      <Col Col md={12}>\r\n                        <div className=\"alert alert-info\">{t(\"NoData\")}</div>\r\n                      </Col>\r\n                    </Row>\r\n                  )}\r\n\r\n              </Col>\r\n            </Row>\r\n\r\n\r\n          </CardBody>\r\n\r\n          <Row>\r\n            <Col md=\"12\">\r\n              <Alert className='text-center' show={msgData.show} variant={msgData.isError ? \"danger\" : \"success\"} dismissible onClose={() => { setmsgData({ show: false, msg: \"\", isError: false }) }}>\r\n                {msgData.msg}\r\n              </Alert>\r\n            </Col>\r\n          </Row>\r\n        </Card>\r\n        {showModelAttachment ?\r\n          <Modal size=\"md\" isOpen={showModelAttachment} toggle={toggleShowModelAttachment} centered={true}>\r\n            <div className=\"modal-header\">\r\n              <h5 className=\"modal-title mt-0\">{t(\"Attach File\")}</h5>\r\n              <button\r\n                type=\"button\"\r\n                onClick={toggleShowModelAttachment}\r\n                className=\"close\"\r\n                data-dismiss=\"modal\"\r\n                aria-label=\"Close\">\r\n                <span aria-hidden=\"true\">&times;</span>\r\n              </button>\r\n            </div>\r\n\r\n            <AvForm id=\"frmAttachment\" className=\"needs-validation\" onSubmit={handleSubmitfrmAttachment}>\r\n              <div className=\"modal-body\">\r\n                <Row>\r\n                  <Col md=\"12\">\r\n                    <div className=\"mb-3\">\r\n                      <Label htmlFor=\"name\">{t(\"Name\")}</Label>\r\n                      \r\n                      <AvField\r\n                        className=\"form-control\"\r\n                        type=\"text\"\r\n                        name=\"name\" onChange={handleChangeInputfrm}\r\n                        errorMessage={t(\"Required Field\")}\r\n                        validate={{ required: { value: !exception } }}\r\n                      />\r\n                    </div>\r\n                  </Col>\r\n                  <Col md=\"12\">\r\n                    <div className=\"mb-3\">\r\n                      <Label htmlFor=\"name\">{t(\"ExpirationDate\")}</Label>\r\n                      <Flatpickr\r\n                        id=\"expirationDate\"\r\n                        name=\"expirationDate\"\r\n                        className=\"form-control d-block\"\r\n                        placeholder={OPTs.FORMAT_DATE_SHOW}\r\n                        options={{\r\n                          dateFormat: OPTs.FORMAT_DATE,\r\n                          //maxDate: new Date().setFullYear(new Date().getFullYear() - 18),\r\n                          //defaultDate: dataGeneral !== undefined && dataGeneral !==null ? new Date(moment(dataGeneral.issuedDate, 'YYYY-MM-DD').format()) : new Date()\r\n                        }}\r\n                        onChange={(selectedDates, dateStr, instance) => { handleChangeInputfrm({ target: { name: \"expirationDate\", value: moment(dateStr, \"DD/MM/YYYY\").format(\"YYYY-MM-DD\") } }) }}\r\n                      />\r\n\r\n                    </div>\r\n                  </Col>\r\n                  <Col md=\"12\">\r\n                    <div className=\"mb-3\">\r\n                      <Label htmlFor=\"name\">{t(\"Exception\")}</Label>\r\n                      <AvInput type=\"checkbox\" name=\"excluded\" onChange={handleChangeInputChkClient} />\r\n                    </div>\r\n                  </Col>\r\n                  <Col md=\"12\">\r\n                    <div className=\"mb-3\">\r\n                      <Label htmlFor=\"attachment\">{t(\"File\")}</Label>\r\n                      <AvField\r\n                        className=\"form-control\"\r\n                        type=\"file\"\r\n                        name=\"attachment\" onChange={handleChangeInputfrm}\r\n                        errorMessage={t(\"Required Field\")}\r\n                        validate={{ required: { value: !exception } }}\r\n                        accept=\".jpg,.jpeg,.png,.doc,.docx,.xls,.xlsx,.pdf\"\r\n                      />\r\n\r\n                    </div>\r\n                  </Col>\r\n                  {exception?\r\n                  <Col md=\"12\">\r\n                    <div className=\"mb-3\">\r\n                      <Label htmlFor=\"name\">{t(\"Fecha de reposici√≥n\")}</Label>\r\n                      <Flatpickr\r\n                        id=\"expirationDate2\"\r\n                        name=\"expirationDate2\"\r\n                        className=\"form-control d-block\"\r\n                        placeholder={OPTs.FORMAT_DATE_SHOW}\r\n                        options={{\r\n                          dateFormat: OPTs.FORMAT_DATE,\r\n                          //maxDate: new Date().setFullYear(new Date().getFullYear() - 18),\r\n                          //defaultDate: dataGeneral !== undefined && dataGeneral !==null ? new Date(moment(dataGeneral.issuedDate, 'YYYY-MM-DD').format()) : new Date()\r\n                        }}\r\n                        onChange={(selectedDates, dateStr, instance) => { handleChangeInputfrm({ target: { name: \"expirationDate2\", value: moment(dateStr, \"DD/MM/YYYY\").format(\"YYYY-MM-DD\") } }) }}\r\n                      />\r\n\r\n                    </div>\r\n                  </Col>:null}\r\n                  <Col md=\"12\">\r\n                    <div className=\"mb-3\">\r\n                      <Label htmlFor=\"attachment\">{t(\"Comment\")}</Label>\r\n                      <AvField\r\n                        className=\"form-control\"\r\n                        type=\"textarea\"\r\n                        name=\"comment\" \r\n                        rows=\"7\"\r\n                      />\r\n\r\n                    </div>\r\n                  </Col>\r\n\r\n                </Row>\r\n              </div>\r\n              <div className=\"modal-footer\">\r\n                <Button color=\"danger\" style={{ margin: '5px 0px' }} type=\"button\" onClick={toggleShowModelAttachment} data-dismiss=\"modal\">\r\n                  <i className=\"mdi mdi mdi-cancel mid-12px\"></i> {t(\"Cancel\")}\r\n                </Button>\r\n\r\n                <Button color=\"success\" type=\"submit\" style={{ margin: '5px' }}>\r\n                  <i className=\"mdi mdi-content-save mid-12px\"></i> {t(\"Save\")}\r\n                </Button>\r\n              </div>\r\n            </AvForm>\r\n\r\n            <Row>\r\n              <Col md=\"12\">\r\n                <Alert className='text-center' show={msgModal.show} variant={msgModal.isError ? \"danger\" : \"success\"} dismissible onClose={() => { setmsgModal({ show: false, msg: \"\", isError: false }) }}>\r\n                  {msgModal.msg}\r\n                </Alert>\r\n              </Col>\r\n            </Row>\r\n\r\n          </Modal>\r\n          : null}\r\n\r\n      </LoadingOverlay>\r\n    </React.Fragment >\r\n\r\n  )\r\n}\r\n\r\nCheckList.propTypes = {\r\n  attachmentFileInputModel: PropTypes.any\r\n}\r\n\r\n//export default (withTranslation()(DatosGenerales));\r\nexport default CheckList;\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}