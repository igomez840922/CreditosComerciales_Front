{"ast":null,"code":"import _regeneratorRuntime from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import{useLocation,useHistory}from'react-router-dom';import*as url from\"../../../helpers/url_helper\";import{useTranslation,withTranslation}from\"react-i18next\";import{Row,Col,Button,Card,CardBody,CardFooter,CardHeader}from\"reactstrap\";import{Link}from\"react-router-dom\";// UI Components\nimport Breadcrumbs from\"../../../components/Common/Breadcrumb\";import{FacilityListBpm,FacilityListCore,ChangeSummaryReadOnly,CorporateExposure,CorporateExposureClient,FacilityList,FinancialSummary,GeneralSection}from\"../../../components/PropuestaCreditoComercial\";import SweetAlert from\"react-bootstrap-sweetalert\";import AttachmentFileCore from\"../../../components/Common/AttachmentFileCore\";import*as OPTs from\"../../../helpers/options_helper\";import{AttachmentFileInputModel}from'../../../models/Common/AttachmentFileInputModel';import HeaderSections from\"../../../components/Common/HeaderSections\";import ModalEndProcess from\"../../../components/EndProcess/ModalEndProcess\";// Services\nimport{BackendServices,CoreServices,BpmServices}from\"../../../services\";import LoadingOverlay from\"react-loading-overlay\";import{translationHelpers,formatCurrency}from'../../../helpers';import{success}from\"toastr\";import LogProcess from\"../../../components/LogProcess/index\";import{InfoBpmModel}from'../../../models/Common/InfoBpmModel';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CommercialCreditProposalPage=function CommercialCreditProposalPage(props){var history=useHistory();var location=useLocation();var _useTranslation=useTranslation(),t=_useTranslation.t,i18n=_useTranslation.i18n;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),locationData=_useState2[0],setLocationData=_useState2[1];var sumaryData={client:{name:'Nombre Deudor'},financialStatus:{headers:['Auditados Dic-18','Auditados Dic-19','Auditados Dic-20','Proyecciones Dic-21'],items:[{label:'Clasificación SAFI',data:['-','-','5:6 Riesgo','-']},{label:'Crecimiento',data:['-','-3.4%','-12.5%','0.0%']},{label:'Costo de Ventas',data:['(1550)66.2%','(1510)66.8%','(1360)68.8%','(1360)68.8%']},{label:'Beneficio Mutuo en Operaciones',data:['(790)66.2%','(751)66.8%','(618)68.8%','(618)68.8%']},{label:'Margen Bruto',data:['','','','']}]},balances:{active:{title:t('Active Balance'),headers:[t('Period Date'),'','',''],items:[[t('Months'),'','',''],[t('Auditor'),'','',''],[t('Balance Type'),'','',''],[t('Figures Types'),'','',''],[t('Coins Types'),'','',''],[t('Exchange Rates'),'','','']]},passive:{title:t('Passive Balance and Capital'),headers:[t('Period Date'),'','',''],items:[[t('Months'),'','',''],[t('Auditor'),'','',''],[t('Balance Type'),'','',''],[t('Figures Types'),'','',''],[t('Coins Types'),'','',''],[t('Exchange Rates'),'','','']]},application:{title:t('Origin and Application Status'),headers:[t('Period Date'),'','',''],items:[[t('Months'),'','',''],[t('Auditor'),'','',''],[t('Balance Type'),'','',''],[t('Figures Types'),'','',''],[t('Coins Types'),'','',''],[t('Exchange Rates'),'','','']]},indicators:{title:t('Indicators'),headers:[t('Period Date'),'','',''],items:[[t('Months'),'','',''],[t('Auditor'),'','',''],[t('Balance Type'),'','',''],[t('Figures Types'),'','',''],[t('Coins Types'),'','',''],[t('Exchange Rates'),'','','']]}},debts:{short:{items:[{bank:'Capital Bank',purpose:'Linea de Crédito',approvedAmount:200,balanceLastYear:200,balanceLast6Months:154,balanceForecast:200,rate:7.0,surety:'Fianza'},{bank:'St Georges',purpose:'Linea de Crédito',approvedAmount:320,balanceLastYear:200,balanceLast6Months:436,balanceForecast:450,rate:7.5,surety:'Fianza'},{bank:'St Georges',purpose:'TDC',approvedAmount:11,balanceLastYear:11,balanceLast6Months:0,balanceForecast:11,rate:null,surety:''}]},long:{items:[{bank:'Banesco',purpose:'Préstamo',approvedAmount:126,balanceLastYear:0,balanceLast6Months:0,balanceForecast:126,rate:6.5,surety:'Bien Inmueble'}]}},history:{headers:[t('# days',{days:30}),t('# days',{days:60}),t('# days',{days:90}),t('# days',{days:120}),t('# days',{days:150}),t('# days',{days:180}),t('# days',{days:210}),t('# days',{days:240}),t('# days',{days:270}),t('# days',{days:300}),t('# days',{days:330}),t('+# days',{days:331}),t('Totals')],data:[{name:'Banesco',data:[100,80,80,80,100,80,80,80,100,80,80,200,0]},{name:'Banesco',data:[100,80,80,80,100,80,80,80,100,80,80,200,0]}]}};var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),proposal=_useState4[0],setProposal=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),changeSummaryItems=_useState6[0],setChangeSummaryItems=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),facilityListItems=_useState8[0],setFacilityListItems=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),identificationList=_useState10[0],setIdentificationList=_useState10[1];var _useState11=useState(sumaryData),_useState12=_slicedToArray(_useState11,2),financialSummary=_useState12[0],setFinancialSummary=_useState12[1];var _useState13=useState({}),_useState14=_slicedToArray(_useState13,2),prospect=_useState14[0],setProspect=_useState14[1];var _useState15=useState(true),_useState16=_slicedToArray(_useState15,2),isActiveLoading=_useState16[0],setIsActiveLoading=_useState16[1];var _useState17=useState(null),_useState18=_slicedToArray(_useState17,2),personId=_useState18[0],setpersonId=_useState18[1];var _useState19=useState(null),_useState20=_slicedToArray(_useState19,2),mainDebtor=_useState20[0],setmainDebtor=_useState20[1];//mostrar el modal para la opción de finalizar proceso\nvar _useState21=useState(false),_useState22=_slicedToArray(_useState21,2),displayModalEndProcess=_useState22[0],setdisplayModalEndProcess=_useState22[1];var _useState23=useState({msg:\"\",show:false,error:false}),_useState24=_slicedToArray(_useState23,2),messageDlg=_useState24[0],setmessageDlg=_useState24[1];//Servicios\nvar _useState25=useState(new BackendServices()),_useState26=_slicedToArray(_useState25,2),backendServices=_useState26[0],setbackendServices=_useState26[1];var _useState27=useState(new BpmServices()),_useState28=_slicedToArray(_useState27,2),bpmServices=_useState28[0],setbpmServices=_useState28[1];var _useState29=useState(new CoreServices()),_useState30=_slicedToArray(_useState29,2),coreServices=_useState30[0],setcoreServices=_useState30[1];//On Mounting (componentDidMount)\nuseEffect(function(){if(location.data!==null&&location.data!==undefined){if(location.data.transactionId===undefined||location.data.transactionId.length<=0){//location.data.transactionId = 0;\n//checkAndCreateProcedure(location.data);\nhistory.push(url.URL_DASHBOARD);}else{sessionStorage.setItem('locationData',JSON.stringify(location.data));setLocationData(location.data);fetchData(location.data);}}else{//chequeamos si tenemos guardado en session\nvar result=sessionStorage.getItem('locationData');if(result!==undefined&&result!==null){result=JSON.parse(result);setLocationData(result);fetchData(result);}}},[]);//Caraga Inicial de datos\nfunction fetchData(locationData){console.log(\"fetchData\",locationData);//chequear si la tarea no ha sido iniciada\nbpmServices.checkAndStartTask(locationData).then(function(iniresult){if(iniresult===false){history.push(url.URL_DASHBOARD);}});loadUserProspect(locationData.transactionId);getProspect();}function loadUserProspect(transactionId){// consultarDeudorPrincipal\nbackendServices.consultPrincipalDebtor(transactionId).then(function(data){if(data!==undefined){setmainDebtor(data);}});}function fetchProposal(){setProposal({proposal:{id:1010,revisionType:'Bimensual',preapproved:false,minSib:'Provision',relatedPart:false,approvalLevel:'Nivel',flowType:'Normal',applicationDate:'24-sep-2021',lastApplicationDate:'24-sep-2021',nextRevisionDate:'24-sep-2021',expirationDate:'24-sep-2021'},client:{number:'3223213'},economicGroup:{number:'32132006176',name:'Grupo Tova SA',business:'Actividad seleccionada'},risk:{countryClass:'Panamá',classification:'Medio',countryRisk:'Nicaragua'},accountExecutive:{name:'Elibeth'},responsibleUnit:{name:'Unidad'}});setChangeSummaryItems([{description:'Incremento / Disminución (Exposición)'},{description:'Plazos: Fac 1'},{description:'Tasa: Fac 1'},{description:'Cuotas'},{description:'Garantías'},{description:'Covenats'},{description:'Fiadores / Codeudores'},{description:'Otras condiciones'}]);setFinancialSummary({client:{name:'Nombre Deudor'},financialStatus:{headers:['Auditados Dic-18','Auditados Dic-19','Auditados Dic-20','Proyecciones Dic-21'],items:[{label:'Clasificación SAFI',data:['-','-','5:6 Riesgo','-']},{label:'Crecimiento',data:['-','-3.4%','-12.5%','0.0%']},{label:'Costo de Ventas',data:['(1550)66.2%','(1510)66.8%','(1360)68.8%','(1360)68.8%']},{label:'Beneficio Mutuo en Operaciones',data:['(790)66.2%','(751)66.8%','(618)68.8%','(618)68.8%']},{label:'Margen Bruto',data:['','','','']}]},balances:{active:{title:t('Active Balance'),headers:[t('Period Date'),'','',''],items:[[t('Months'),'','',''],[t('Auditor'),'','',''],[t('Balance Type'),'','',''],[t('Figures Types'),'','',''],[t('Coins Types'),'','',''],[t('Exchange Rates'),'','','']]},passive:{title:t('Passive Balance and Capital'),headers:[t('Period Date'),'','',''],items:[[t('Months'),'','',''],[t('Auditor'),'','',''],[t('Balance Type'),'','',''],[t('Figures Types'),'','',''],[t('Coins Types'),'','',''],[t('Exchange Rates'),'','','']]},application:{title:t('Origin and Application Status'),headers:[t('Period Date'),'','',''],items:[[t('Months'),'','',''],[t('Auditor'),'','',''],[t('Balance Type'),'','',''],[t('Figures Types'),'','',''],[t('Coins Types'),'','',''],[t('Exchange Rates'),'','','']]},indicators:{title:t('Indicators'),headers:[t('Period Date'),'','',''],items:[[t('Months'),'','',''],[t('Auditor'),'','',''],[t('Balance Type'),'','',''],[t('Figures Types'),'','',''],[t('Coins Types'),'','',''],[t('Exchange Rates'),'','','']]}},debts:{short:{items:[{bank:'Capital Bank',purpose:'Linea de Crédito',approvedAmount:200,balanceLastYear:200,balanceLast6Months:154,balanceForecast:200,rate:7.0,surety:'Fianza'},{bank:'St Georges',purpose:'Linea de Crédito',approvedAmount:320,balanceLastYear:200,balanceLast6Months:436,balanceForecast:450,rate:7.5,surety:'Fianza'},{bank:'St Georges',purpose:'TDC',approvedAmount:11,balanceLastYear:11,balanceLast6Months:0,balanceForecast:11,rate:null,surety:''}]},long:{items:[{bank:'Banesco',purpose:'Préstamo',approvedAmount:126,balanceLastYear:0,balanceLast6Months:0,balanceForecast:126,rate:6.5,surety:'Bien Inmueble'}]}}});}function loadIdentifications(){return new Promise(function(resolve,reject){backendServices.consultarCatalogoTipoIdentificacion().then(function(data){if(data!==null&&data!==undefined){setIdentificationList(data);}resolve();}).catch(function(error){resolve();console.error('api error: ',error);});});}function handleReturn(){history.push(url.URL_DASHBOARD);}function handleClose(){history.push(url.URL_DASHBOARD);}function handleSaveFacility(newItem){var newFacilities=[].concat(_toConsumableArray(facilityListItems),[newItem]);setFacilityListItems(newFacilities);}function getProspect(){Promise.allSettled([//backServices.consultarUsuarioProspecto(location.data.transactionId),\n//backServices.consultProspectUser(location.data.transactionId),\nbackendServices.consultPrincipalDebtor(location.data.transactionId),loadIdentifications()]).then(function(resp){var _resp=_slicedToArray(resp,1),PrincipalDebtor=_resp[0].value;console.log(resp,location,PrincipalDebtor);setIsActiveLoading(false);var customerNumberT24=PrincipalDebtor.customerNumberT24;setProspect(customerNumberT24);loadFacilitiesList(customerNumberT24);setpersonId(PrincipalDebtor.personId);}).catch(function(err){// console.log(err);\n});// backServices.consultProspectUser(location.data.transactionId).then(async (resp) => {\n//   console.log(resp);\n//   setIsActiveLoading(false)\n//   // customerNumberT24 = resp.customerNumberT24;\n//   setProspect(customerNumberT24);\n//   loadFacilitiesList(customerNumberT24);\n//   fetchProposal();\n// });\n// backServices.consultPrincipalDebtor(location.data.transactionId).then(async (resp) => {\n//   setpersonId(resp.personId);\n// });\n}function loadFacilitiesList(idcliente){return new Promise(function(resolve,reject){coreServices.getFacilities(idcliente).then(function(resp){setFacilityListItems(resp);resolve();}).catch(function(err){resolve();});});}function handleSaveFacility(newItem){var newFacilities=[].concat(_toConsumableArray(facilityListItems),[newItem]);setFacilityListItems(newFacilities);}////////// PARTE ES LA FINAL DEL PROCESO ///////\n//Modal Para mostrar Comentario de Fin de Proceso\nfunction showModalEndProcess(){var show=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;setdisplayModalEndProcess(show);}//salvar comentario de end process\nfunction onSaveEndProcess(values){onSaveProcess(OPTs.PROCESS_CANCELPROCESS);}function onSaveProcess(option){switch(option){case OPTs.PROCESS_CANCELPROCESS:{break;}}saveJBPMProcess(option);}function saveJBPMProcess(_x){return _saveJBPMProcess.apply(this,arguments);}function _saveJBPMProcess(){_saveJBPMProcess=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(option){var _locationData$infoBpm,_locationData$infoBpm2,_locationData$infoBpm3,_locationData$infoBpm4;var maindebtor,infoBpmModel,values;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return backendServices.consultPrincipalDebtor(locationData.transactionId);case 2:maindebtor=_context.sent;infoBpmModel=new InfoBpmModel((_locationData$infoBpm=(_locationData$infoBpm2=locationData.infoBpmModel)===null||_locationData$infoBpm2===void 0?void 0:_locationData$infoBpm2.instanceId)!==null&&_locationData$infoBpm!==void 0?_locationData$infoBpm:locationData.instanceId,(_locationData$infoBpm3=(_locationData$infoBpm4=locationData.infoBpmModel)===null||_locationData$infoBpm4===void 0?void 0:_locationData$infoBpm4.transactId)!==null&&_locationData$infoBpm3!==void 0?_locationData$infoBpm3:locationData.transactionId,0,0,maindebtor===null||maindebtor===void 0?void 0:maindebtor.personId);infoBpmModel.personName=maindebtor!==undefined?maindebtor.name+\" \"+maindebtor.name2+\" \"+maindebtor.lastName+\" \"+maindebtor.lastName2:\"\";_context.t0=option;_context.next=_context.t0===OPTs.PROCESS_CANCELPROCESS?8:_context.t0===OPTs.PROCESS_ANALISISCREDITO?10:_context.t0===OPTs.PROCESS_INFORMEFINANCIERO?15:_context.t0===OPTs.PROCESS_INFORMEGESTION?20:25;break;case 8:bpmServices.abortProcess(infoBpmModel.instanceId).then(function(data){if(data!==undefined){history.push(url.URL_DASHBOARD);}else{showMessage({msg:t(\"ErrorSaveMessage\"),error:true,show:true});}});return _context.abrupt(\"break\",25);case 10:infoBpmModel.processId=OPTs.PROCESS_ANALISISCREDITO;infoBpmModel.activityId=OPTs.ACT_NONE;values={\"info\":JSON.stringify(infoBpmModel),\"processId\":OPTs.PROCESS_ANALISISCREDITO.toString(),\"activityId\":OPTs.ACT_NONE.toString(),\"transactionId\":locationData.transactionId.toString()};bpmServices.updatevariables(locationData.instanceId,values).then(function(data){if(data!==undefined){showMessage({msg:t(\"Datahasbeensavedsuccessfully\"),error:false,show:true});history.push(url.URL_DASHBOARD);}else{showMessage({msg:t(\"ErrorSaveMessage\"),error:true,show:true});}});return _context.abrupt(\"break\",25);case 15:infoBpmModel.processId=OPTs.PROCESS_INFORMEFINANCIERO;infoBpmModel.activityId=OPTs.ACT_NONE;values={\"info\":JSON.stringify(infoBpmModel),\"processId\":OPTs.PROCESS_INFORMEFINANCIERO.toString(),\"activityId\":OPTs.ACT_NONE.toString(),\"transactionId\":locationData.transactionId.toString()};bpmServices.updatevariables(locationData.instanceId,values).then(function(data){if(data!==undefined){history.push({pathname:url.URL_FINANCIALINFO,data:locationData});}else{showMessage({msg:t(\"ErrorSaveMessage\"),error:true,show:true});}});return _context.abrupt(\"break\",25);case 20://requiere ajustes\ninfoBpmModel.processId=OPTs.PROCESS_INFORMEGESTION;infoBpmModel.activityId=OPTs.ACT_NONE;values={\"info\":JSON.stringify(infoBpmModel),\"processId\":OPTs.PROCESS_INFORMEGESTION.toString(),\"activityId\":OPTs.ACT_NONE.toString(),\"transactionId\":locationData.transactionId,\"requestId\":locationData.requestId,\"decision\":\"si\",//requiere ajustes\n\"dcreditoparalelo\":\"sinparalelo\",\"statuscredito\":\"completo\"//el paralelo de Credito esta activo\n};bpmServices.completedStatusTask(locationData.taskId,values).then(function(data){if(data!==undefined){history.push(url.URL_DASHBOARD);}else{//Mensaje ERROR\nshowMessage({msg:t(\"ErrorSaveMessage\"),error:true,show:true});}});return _context.abrupt(\"break\",25);case 25:case\"end\":return _context.stop();}}},_callee);}));return _saveJBPMProcess.apply(this,arguments);}function showMessage(){var data=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(data!==null){setmessageDlg(data);}else{setmessageDlg({msg:\"\",show:false,error:false});}}return/*#__PURE__*/_jsx(React.Fragment,{children:locationData?/*#__PURE__*/_jsxs(\"div\",{className:\"page-content\",children:[/*#__PURE__*/_jsx(Breadcrumbs,{title:t(\"Commercial Credit\"),breadcrumbItem:t(\"Credit Analysis\")}),/*#__PURE__*/_jsx(LoadingOverlay,{active:isActiveLoading,spinner:true,text:t(\"WaitingPlease\"),children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(CardHeader,{children:[/*#__PURE__*/_jsxs(\"h4\",{className:\"card-title\",children:[mainDebtor!=null?mainDebtor.name+\" \"+mainDebtor.name2+\" \"+mainDebtor.lastName+\" \"+mainDebtor.lastName2:\"\",\"    #\",locationData===null||locationData===void 0?void 0:locationData.transactionId]}),/*#__PURE__*/_jsx(\"h4\",{className:\"card-title\",children:t(\"Credit Analysis\")}),/*#__PURE__*/_jsx(\"p\",{className:\"card-title-desc\",children:t(\"This form is official and must be filled out correctly\")})]}),/*#__PURE__*/_jsxs(CardBody,{children:[/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{xl:\"12\",children:/*#__PURE__*/_jsx(GeneralSection,{proposal:proposal,prospect:prospect})})}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{xl:\"12\",children:mainDebtor?/*#__PURE__*/_jsx(CorporateExposure,{title:t(\"CorporateExhibition\"),customerNumberT24:mainDebtor===null||mainDebtor===void 0?void 0:mainDebtor.customerNumberT24}):null})}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{xl:\"12\",children:mainDebtor?/*#__PURE__*/_jsx(CorporateExposureClient,{title:t(\"CorporateExhibitionClient\"),customerNumberT24:mainDebtor===null||mainDebtor===void 0?void 0:mainDebtor.customerNumberT24}):null})}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{xl:\"12\",children:locationData?/*#__PURE__*/_jsx(ChangeSummaryReadOnly,{transactionId:locationData===null||locationData===void 0?void 0:locationData.transactionId}):null})}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{xl:\"12\",children:mainDebtor?/*#__PURE__*/_jsx(FacilityListCore,{customerNumberT24:mainDebtor===null||mainDebtor===void 0?void 0:mainDebtor.customerNumberT24}):null})}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{xl:\"12\",children:locationData?/*#__PURE__*/_jsx(FacilityListBpm,{transactionId:locationData===null||locationData===void 0?void 0:locationData.transactionId}):null})}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{xl:\"12\",children:/*#__PURE__*/_jsxs(CardBody,{children:[/*#__PURE__*/_jsx(HeaderSections,{title:\"Financial Summary\",t:t}),locationData?/*#__PURE__*/_jsx(AttachmentFileCore,{attachmentFileInputModel:new AttachmentFileInputModel(locationData.transactionId,OPTs.PROCESS_ANALISISCREDITO)}):null]})})}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{xl:\"12\",children:/*#__PURE__*/_jsx(CardBody,{children:/*#__PURE__*/_jsx(FinancialSummary,{client:financialSummary.client,financialStatus:financialSummary.financialStatus,balances:financialSummary.balances,debts:financialSummary.debts,debtorId:personId})})})})]}),/*#__PURE__*/_jsx(LogProcess,{}),/*#__PURE__*/_jsx(CardFooter,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsxs(Col,{md:6,style:{textAlign:\"left\",marginTop:\"10px\"},children:[/*#__PURE__*/_jsxs(Button,{color:\"danger\",type:\"button\",style:{margin:'5px'},onClick:function onClick(){showModalEndProcess();},children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-cancel mid-12px\"}),\" \",t(\"Cancel\")]}),/*#__PURE__*/_jsxs(Button,{color:\"primary\",type:\"button\",style:{margin:'5px'},onClick:function onClick(){onSaveProcess(OPTs.PROCESS_INFORMEGESTION);},children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-backspace-outline mid-12px\"}),\" \",t(\"AdjustRequired\")]})]}),/*#__PURE__*/_jsxs(Col,{md:6,style:{textAlign:\"right\",marginTop:\"10px\"},children:[/*#__PURE__*/_jsxs(Button,{color:\"primary\",type:\"button\",style:{margin:'5px'},onClick:function onClick(){onSaveProcess(OPTs.PROCESS_ANALISISCREDITO);},children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-content-save-outline mid-12px\"}),\" \",t(\"Exit\")]}),/*#__PURE__*/_jsxs(Button,{color:\"success\",type:\"button\",style:{margin:'5px'},onClick:function onClick(){onSaveProcess(OPTs.PROCESS_INFORMEFINANCIERO);},children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-arrow-right-bold-circle-outline mid-12px\"}),\" \",t(\"FinantialReport\")]})]})]})})]})}),/*#__PURE__*/_jsx(ModalEndProcess,{onSaveEndProcess:onSaveEndProcess,isOpen:displayModalEndProcess,toggle:function toggle(){showModalEndProcess(false);}}),messageDlg&&messageDlg.show?/*#__PURE__*/_jsx(SweetAlert,{type:messageDlg.error?\"error\":\"success\",title:messageDlg.error?t(\"Error\"):t(\"Message\"),onConfirm:function onConfirm(){showMessage();},children:messageDlg.msg}):null]}):null});};export default CommercialCreditProposalPage;","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/pages/CommercialCredit/6_AnalisisCredito/CommercialCreditProposalPage.js"],"names":["React","useEffect","useState","useLocation","useHistory","url","useTranslation","withTranslation","Row","Col","Button","Card","CardBody","CardFooter","CardHeader","Link","Breadcrumbs","FacilityListBpm","FacilityListCore","ChangeSummaryReadOnly","CorporateExposure","CorporateExposureClient","FacilityList","FinancialSummary","GeneralSection","SweetAlert","AttachmentFileCore","OPTs","AttachmentFileInputModel","HeaderSections","ModalEndProcess","BackendServices","CoreServices","BpmServices","LoadingOverlay","translationHelpers","formatCurrency","success","LogProcess","InfoBpmModel","CommercialCreditProposalPage","props","history","location","t","i18n","locationData","setLocationData","sumaryData","client","name","financialStatus","headers","items","label","data","balances","active","title","passive","application","indicators","debts","short","bank","purpose","approvedAmount","balanceLastYear","balanceLast6Months","balanceForecast","rate","surety","long","days","proposal","setProposal","changeSummaryItems","setChangeSummaryItems","facilityListItems","setFacilityListItems","identificationList","setIdentificationList","financialSummary","setFinancialSummary","prospect","setProspect","isActiveLoading","setIsActiveLoading","personId","setpersonId","mainDebtor","setmainDebtor","displayModalEndProcess","setdisplayModalEndProcess","msg","show","error","messageDlg","setmessageDlg","backendServices","setbackendServices","bpmServices","setbpmServices","coreServices","setcoreServices","undefined","transactionId","length","push","URL_DASHBOARD","sessionStorage","setItem","JSON","stringify","fetchData","result","getItem","parse","console","log","checkAndStartTask","then","iniresult","loadUserProspect","getProspect","consultPrincipalDebtor","fetchProposal","id","revisionType","preapproved","minSib","relatedPart","approvalLevel","flowType","applicationDate","lastApplicationDate","nextRevisionDate","expirationDate","number","economicGroup","business","risk","countryClass","classification","countryRisk","accountExecutive","responsibleUnit","description","loadIdentifications","Promise","resolve","reject","consultarCatalogoTipoIdentificacion","catch","handleReturn","handleClose","handleSaveFacility","newItem","newFacilities","allSettled","resp","PrincipalDebtor","value","customerNumberT24","loadFacilitiesList","err","idcliente","getFacilities","showModalEndProcess","onSaveEndProcess","values","onSaveProcess","PROCESS_CANCELPROCESS","option","saveJBPMProcess","maindebtor","infoBpmModel","instanceId","transactId","personName","name2","lastName","lastName2","PROCESS_ANALISISCREDITO","PROCESS_INFORMEFINANCIERO","PROCESS_INFORMEGESTION","abortProcess","showMessage","processId","activityId","ACT_NONE","toString","updatevariables","pathname","URL_FINANCIALINFO","requestId","completedStatusTask","taskId","textAlign","marginTop","margin"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\"\r\nimport { useLocation, useHistory } from 'react-router-dom'\r\nimport * as url from \"../../../helpers/url_helper\"\r\nimport { useTranslation, withTranslation } from \"react-i18next\"\r\n\r\nimport {\r\n  Row,\r\n  Col,\r\n  Button,\r\n  Card,\r\n  CardBody,\r\n  CardFooter,\r\n  CardHeader,\r\n} from \"reactstrap\"\r\nimport { Link } from \"react-router-dom\"\r\n\r\n// UI Components\r\nimport Breadcrumbs from \"../../../components/Common/Breadcrumb\"\r\nimport {\r\n  FacilityListBpm, FacilityListCore, ChangeSummaryReadOnly, CorporateExposure, CorporateExposureClient,\r\n  FacilityList, FinancialSummary,\r\n  GeneralSection\r\n} from \"../../../components/PropuestaCreditoComercial\"\r\n\r\n\r\nimport SweetAlert from \"react-bootstrap-sweetalert\"\r\nimport AttachmentFileCore from \"../../../components/Common/AttachmentFileCore\";\r\nimport * as OPTs from \"../../../helpers/options_helper\";\r\nimport { AttachmentFileInputModel } from '../../../models/Common/AttachmentFileInputModel';\r\nimport HeaderSections from \"../../../components/Common/HeaderSections\";\r\nimport ModalEndProcess from \"../../../components/EndProcess/ModalEndProcess\"\r\n\r\n// Services\r\nimport { BackendServices, CoreServices, BpmServices, } from \"../../../services\";\r\nimport LoadingOverlay from \"react-loading-overlay\"\r\nimport { translationHelpers, formatCurrency } from '../../../helpers';\r\nimport { success } from \"toastr\"\r\n\r\nimport LogProcess from \"../../../components/LogProcess/index\";\r\nimport { InfoBpmModel } from '../../../models/Common/InfoBpmModel';\r\n\r\nconst CommercialCreditProposalPage = (props) => {\r\n\r\n\r\n  const history = useHistory();\r\n  const location = useLocation();\r\n\r\n  const { t, i18n } = useTranslation();\r\n  const [locationData, setLocationData] = useState(null);\r\n\r\n  const sumaryData = {\r\n    client: {\r\n      name: 'Nombre Deudor'\r\n    },\r\n    financialStatus: {\r\n      headers: ['Auditados Dic-18', 'Auditados Dic-19', 'Auditados Dic-20', 'Proyecciones Dic-21'],\r\n      items: [\r\n        {\r\n          label: 'Clasificación SAFI',\r\n          data: ['-', '-', '5:6 Riesgo', '-']\r\n        },\r\n        {\r\n          label: 'Crecimiento',\r\n          data: ['-', '-3.4%', '-12.5%', '0.0%']\r\n        },\r\n        {\r\n          label: 'Costo de Ventas',\r\n          data: ['(1550)66.2%', '(1510)66.8%', '(1360)68.8%', '(1360)68.8%']\r\n        },\r\n        {\r\n          label: 'Beneficio Mutuo en Operaciones',\r\n          data: ['(790)66.2%', '(751)66.8%', '(618)68.8%', '(618)68.8%']\r\n        },\r\n        {\r\n          label: 'Margen Bruto',\r\n          data: ['', '', '', '']\r\n        }\r\n      ]\r\n    },\r\n    balances: {\r\n      active: {\r\n        title: t('Active Balance'),\r\n        headers: [t('Period Date'), '', '', ''],\r\n        items: [\r\n          [t('Months'), '', '', ''],\r\n          [t('Auditor'), '', '', ''],\r\n          [t('Balance Type'), '', '', ''],\r\n          [t('Figures Types'), '', '', ''],\r\n          [t('Coins Types'), '', '', ''],\r\n          [t('Exchange Rates'), '', '', '']\r\n        ]\r\n      },\r\n      passive: {\r\n        title: t('Passive Balance and Capital'),\r\n        headers: [t('Period Date'), '', '', ''],\r\n        items: [\r\n          [t('Months'), '', '', ''],\r\n          [t('Auditor'), '', '', ''],\r\n          [t('Balance Type'), '', '', ''],\r\n          [t('Figures Types'), '', '', ''],\r\n          [t('Coins Types'), '', '', ''],\r\n          [t('Exchange Rates'), '', '', '']\r\n        ]\r\n      },\r\n      application: {\r\n        title: t('Origin and Application Status'),\r\n        headers: [t('Period Date'), '', '', ''],\r\n        items: [\r\n          [t('Months'), '', '', ''],\r\n          [t('Auditor'), '', '', ''],\r\n          [t('Balance Type'), '', '', ''],\r\n          [t('Figures Types'), '', '', ''],\r\n          [t('Coins Types'), '', '', ''],\r\n          [t('Exchange Rates'), '', '', '']\r\n        ]\r\n      },\r\n      indicators: {\r\n        title: t('Indicators'),\r\n        headers: [t('Period Date'), '', '', ''],\r\n        items: [\r\n          [t('Months'), '', '', ''],\r\n          [t('Auditor'), '', '', ''],\r\n          [t('Balance Type'), '', '', ''],\r\n          [t('Figures Types'), '', '', ''],\r\n          [t('Coins Types'), '', '', ''],\r\n          [t('Exchange Rates'), '', '', '']\r\n        ]\r\n      }\r\n    },\r\n    debts: {\r\n      short: {\r\n        items: [\r\n          {\r\n            bank: 'Capital Bank',\r\n            purpose: 'Linea de Crédito',\r\n            approvedAmount: 200,\r\n            balanceLastYear: 200,\r\n            balanceLast6Months: 154,\r\n            balanceForecast: 200,\r\n            rate: 7.0,\r\n            surety: 'Fianza'\r\n          },\r\n          {\r\n            bank: 'St Georges',\r\n            purpose: 'Linea de Crédito',\r\n            approvedAmount: 320,\r\n            balanceLastYear: 200,\r\n            balanceLast6Months: 436,\r\n            balanceForecast: 450,\r\n            rate: 7.5,\r\n            surety: 'Fianza'\r\n          },\r\n          {\r\n            bank: 'St Georges',\r\n            purpose: 'TDC',\r\n            approvedAmount: 11,\r\n            balanceLastYear: 11,\r\n            balanceLast6Months: 0,\r\n            balanceForecast: 11,\r\n            rate: null,\r\n            surety: ''\r\n          }\r\n        ]\r\n      },\r\n      long: {\r\n        items: [\r\n          {\r\n            bank: 'Banesco',\r\n            purpose: 'Préstamo',\r\n            approvedAmount: 126,\r\n            balanceLastYear: 0,\r\n            balanceLast6Months: 0,\r\n            balanceForecast: 126,\r\n            rate: 6.5,\r\n            surety: 'Bien Inmueble'\r\n          }\r\n        ]\r\n      }\r\n    },\r\n    history: {\r\n      headers: [\r\n        t('# days', { days: 30 }),\r\n        t('# days', { days: 60 }),\r\n        t('# days', { days: 90 }),\r\n        t('# days', { days: 120 }),\r\n        t('# days', { days: 150 }),\r\n        t('# days', { days: 180 }),\r\n        t('# days', { days: 210 }),\r\n        t('# days', { days: 240 }),\r\n        t('# days', { days: 270 }),\r\n        t('# days', { days: 300 }),\r\n        t('# days', { days: 330 }),\r\n        t('+# days', { days: 331 }),\r\n        t('Totals')\r\n      ],\r\n      data: [\r\n        {\r\n          name: 'Banesco',\r\n          data: [100, 80, 80, 80, 100, 80, 80, 80, 100, 80, 80, 200, 0]\r\n        },\r\n        {\r\n          name: 'Banesco',\r\n          data: [100, 80, 80, 80, 100, 80, 80, 80, 100, 80, 80, 200, 0]\r\n        }\r\n      ]\r\n    }\r\n  }\r\n\r\n  const [proposal, setProposal] = useState(null);\r\n  const [changeSummaryItems, setChangeSummaryItems] = useState([]);\r\n  const [facilityListItems, setFacilityListItems] = useState([]);\r\n  const [identificationList, setIdentificationList] = useState([]);\r\n  const [financialSummary, setFinancialSummary] = useState(sumaryData);\r\n  const [prospect, setProspect] = useState({});\r\n  const [isActiveLoading, setIsActiveLoading] = useState(true);\r\n  const [personId, setpersonId] = useState(null);\r\n\r\n  const [mainDebtor, setmainDebtor] = useState(null);\r\n\r\n  //mostrar el modal para la opción de finalizar proceso\r\n  const [displayModalEndProcess, setdisplayModalEndProcess] = useState(false);\r\n  const [messageDlg, setmessageDlg] = useState({ msg: \"\", show: false, error: false });\r\n\r\n\r\n  //Servicios\r\n  const [backendServices, setbackendServices] = useState(new BackendServices());\r\n  const [bpmServices, setbpmServices] = useState(new BpmServices());\r\n  const [coreServices, setcoreServices] = useState(new CoreServices());\r\n\r\n  //On Mounting (componentDidMount)\r\n  useEffect(() => {\r\n    if (location.data !== null && location.data !== undefined) {\r\n      if (location.data.transactionId === undefined || location.data.transactionId.length <= 0) {\r\n        //location.data.transactionId = 0;\r\n        //checkAndCreateProcedure(location.data);\r\n        history.push(url.URL_DASHBOARD);\r\n      }\r\n      else {\r\n        sessionStorage.setItem('locationData', JSON.stringify(location.data));\r\n        setLocationData(location.data);\r\n        fetchData(location.data);\r\n      }\r\n    }\r\n    else {\r\n      //chequeamos si tenemos guardado en session\r\n      var result = sessionStorage.getItem('locationData');\r\n      if (result !== undefined && result !== null) {\r\n        result = JSON.parse(result);\r\n        setLocationData(result);\r\n        fetchData(result);\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  //Caraga Inicial de datos\r\n  function fetchData(locationData) {\r\n\r\n    console.log(\"fetchData\", locationData);\r\n    //chequear si la tarea no ha sido iniciada\r\n    bpmServices.checkAndStartTask(locationData)\r\n      .then((iniresult) => {\r\n        if (iniresult === false) {\r\n          history.push(url.URL_DASHBOARD);\r\n        }\r\n      })\r\n\r\n    loadUserProspect(locationData.transactionId)\r\n    getProspect();\r\n  }\r\n\r\n  function loadUserProspect(transactionId) {\r\n    // consultarDeudorPrincipal\r\n    backendServices.consultPrincipalDebtor(transactionId)\r\n      .then((data) => {\r\n        if (data !== undefined) {\r\n          setmainDebtor(data);\r\n        }\r\n      });\r\n  }\r\n\r\n\r\n  function fetchProposal() {\r\n\r\n    setProposal({\r\n      proposal: {\r\n        id: 1010,\r\n        revisionType: 'Bimensual',\r\n        preapproved: false,\r\n        minSib: 'Provision',\r\n        relatedPart: false,\r\n        approvalLevel: 'Nivel',\r\n        flowType: 'Normal',\r\n        applicationDate: '24-sep-2021',\r\n        lastApplicationDate: '24-sep-2021',\r\n        nextRevisionDate: '24-sep-2021',\r\n        expirationDate: '24-sep-2021'\r\n      },\r\n      client: {\r\n        number: '3223213',\r\n      },\r\n      economicGroup: {\r\n        number: '32132006176',\r\n        name: 'Grupo Tova SA',\r\n        business: 'Actividad seleccionada'\r\n      },\r\n      risk: {\r\n        countryClass: 'Panamá',\r\n        classification: 'Medio',\r\n        countryRisk: 'Nicaragua'\r\n      },\r\n      accountExecutive: {\r\n        name: 'Elibeth'\r\n      },\r\n      responsibleUnit: {\r\n        name: 'Unidad'\r\n      }\r\n    });\r\n\r\n    setChangeSummaryItems([\r\n      { description: 'Incremento / Disminución (Exposición)' },\r\n      { description: 'Plazos: Fac 1' },\r\n      { description: 'Tasa: Fac 1' },\r\n      { description: 'Cuotas' },\r\n      { description: 'Garantías' },\r\n      { description: 'Covenats' },\r\n      { description: 'Fiadores / Codeudores' },\r\n      { description: 'Otras condiciones' },\r\n    ]);\r\n\r\n    setFinancialSummary({\r\n      client: {\r\n        name: 'Nombre Deudor'\r\n      },\r\n      financialStatus: {\r\n        headers: ['Auditados Dic-18', 'Auditados Dic-19', 'Auditados Dic-20', 'Proyecciones Dic-21'],\r\n        items: [\r\n          {\r\n            label: 'Clasificación SAFI',\r\n            data: ['-', '-', '5:6 Riesgo', '-']\r\n          },\r\n          {\r\n            label: 'Crecimiento',\r\n            data: ['-', '-3.4%', '-12.5%', '0.0%']\r\n          },\r\n          {\r\n            label: 'Costo de Ventas',\r\n            data: ['(1550)66.2%', '(1510)66.8%', '(1360)68.8%', '(1360)68.8%']\r\n          },\r\n          {\r\n            label: 'Beneficio Mutuo en Operaciones',\r\n            data: ['(790)66.2%', '(751)66.8%', '(618)68.8%', '(618)68.8%']\r\n          },\r\n          {\r\n            label: 'Margen Bruto',\r\n            data: ['', '', '', '']\r\n          }\r\n        ]\r\n      },\r\n      balances: {\r\n        active: {\r\n          title: t('Active Balance'),\r\n          headers: [t('Period Date'), '', '', ''],\r\n          items: [\r\n            [t('Months'), '', '', ''],\r\n            [t('Auditor'), '', '', ''],\r\n            [t('Balance Type'), '', '', ''],\r\n            [t('Figures Types'), '', '', ''],\r\n            [t('Coins Types'), '', '', ''],\r\n            [t('Exchange Rates'), '', '', '']\r\n          ]\r\n        },\r\n        passive: {\r\n          title: t('Passive Balance and Capital'),\r\n          headers: [t('Period Date'), '', '', ''],\r\n          items: [\r\n            [t('Months'), '', '', ''],\r\n            [t('Auditor'), '', '', ''],\r\n            [t('Balance Type'), '', '', ''],\r\n            [t('Figures Types'), '', '', ''],\r\n            [t('Coins Types'), '', '', ''],\r\n            [t('Exchange Rates'), '', '', '']\r\n          ]\r\n        },\r\n        application: {\r\n          title: t('Origin and Application Status'),\r\n          headers: [t('Period Date'), '', '', ''],\r\n          items: [\r\n            [t('Months'), '', '', ''],\r\n            [t('Auditor'), '', '', ''],\r\n            [t('Balance Type'), '', '', ''],\r\n            [t('Figures Types'), '', '', ''],\r\n            [t('Coins Types'), '', '', ''],\r\n            [t('Exchange Rates'), '', '', '']\r\n          ]\r\n        },\r\n        indicators: {\r\n          title: t('Indicators'),\r\n          headers: [t('Period Date'), '', '', ''],\r\n          items: [\r\n            [t('Months'), '', '', ''],\r\n            [t('Auditor'), '', '', ''],\r\n            [t('Balance Type'), '', '', ''],\r\n            [t('Figures Types'), '', '', ''],\r\n            [t('Coins Types'), '', '', ''],\r\n            [t('Exchange Rates'), '', '', '']\r\n          ]\r\n        }\r\n      },\r\n      debts: {\r\n        short: {\r\n          items: [\r\n            {\r\n              bank: 'Capital Bank',\r\n              purpose: 'Linea de Crédito',\r\n              approvedAmount: 200,\r\n              balanceLastYear: 200,\r\n              balanceLast6Months: 154,\r\n              balanceForecast: 200,\r\n              rate: 7.0,\r\n              surety: 'Fianza'\r\n            },\r\n            {\r\n              bank: 'St Georges',\r\n              purpose: 'Linea de Crédito',\r\n              approvedAmount: 320,\r\n              balanceLastYear: 200,\r\n              balanceLast6Months: 436,\r\n              balanceForecast: 450,\r\n              rate: 7.5,\r\n              surety: 'Fianza'\r\n            },\r\n            {\r\n              bank: 'St Georges',\r\n              purpose: 'TDC',\r\n              approvedAmount: 11,\r\n              balanceLastYear: 11,\r\n              balanceLast6Months: 0,\r\n              balanceForecast: 11,\r\n              rate: null,\r\n              surety: ''\r\n            }\r\n          ]\r\n        },\r\n        long: {\r\n          items: [\r\n            {\r\n              bank: 'Banesco',\r\n              purpose: 'Préstamo',\r\n              approvedAmount: 126,\r\n              balanceLastYear: 0,\r\n              balanceLast6Months: 0,\r\n              balanceForecast: 126,\r\n              rate: 6.5,\r\n              surety: 'Bien Inmueble'\r\n            }\r\n          ]\r\n        }\r\n      }\r\n    });\r\n\r\n  }\r\n\r\n  function loadIdentifications() {\r\n\r\n    return new Promise((resolve, reject) => {\r\n      backendServices.consultarCatalogoTipoIdentificacion()\r\n        .then((data) => {\r\n          if (data !== null && data !== undefined) {\r\n            setIdentificationList(data);\r\n          }\r\n          resolve();\r\n        })\r\n        .catch((error) => {\r\n          resolve();\r\n          console.error('api error: ', error);\r\n        });\r\n    })\r\n  }\r\n\r\n  function handleReturn() {\r\n    history.push(url.URL_DASHBOARD);\r\n  }\r\n\r\n  function handleClose() {\r\n    history.push(url.URL_DASHBOARD);\r\n  }\r\n\r\n  function handleSaveFacility(newItem) {\r\n    const newFacilities = [...facilityListItems, newItem];\r\n    setFacilityListItems(newFacilities);\r\n  }\r\n\r\n  function getProspect() {\r\n    Promise.allSettled([\r\n      //backServices.consultarUsuarioProspecto(location.data.transactionId),\r\n      //backServices.consultProspectUser(location.data.transactionId),\r\n      backendServices.consultPrincipalDebtor(location.data.transactionId),\r\n      loadIdentifications()\r\n    ]).then((resp) => {\r\n      const [{ value: PrincipalDebtor }] = resp;\r\n      console.log(resp, location, PrincipalDebtor);\r\n      setIsActiveLoading(false);\r\n      let customerNumberT24 = PrincipalDebtor.customerNumberT24;\r\n      setProspect(customerNumberT24);\r\n      loadFacilitiesList(customerNumberT24);\r\n      setpersonId(PrincipalDebtor.personId);\r\n    }).catch(err => {\r\n      // console.log(err);\r\n    });\r\n\r\n    // backServices.consultProspectUser(location.data.transactionId).then(async (resp) => {\r\n    //   console.log(resp);\r\n    //   setIsActiveLoading(false)\r\n    //   // customerNumberT24 = resp.customerNumberT24;\r\n    //   setProspect(customerNumberT24);\r\n    //   loadFacilitiesList(customerNumberT24);\r\n    //   fetchProposal();\r\n    // });\r\n\r\n    // backServices.consultPrincipalDebtor(location.data.transactionId).then(async (resp) => {\r\n    //   setpersonId(resp.personId);\r\n    // });\r\n\r\n  }\r\n\r\n\r\n  function loadFacilitiesList(idcliente) {\r\n    return new Promise(function (resolve, reject) {\r\n      coreServices.getFacilities(idcliente)\r\n        .then(resp => {\r\n          setFacilityListItems(resp);\r\n          resolve();\r\n        })\r\n        .catch(err => {\r\n          resolve();\r\n        });\r\n    })\r\n  }\r\n\r\n  function handleSaveFacility(newItem) {\r\n    const newFacilities = [...facilityListItems, newItem];\r\n    setFacilityListItems(newFacilities);\r\n  }\r\n\r\n\r\n  ////////// PARTE ES LA FINAL DEL PROCESO ///////\r\n  //Modal Para mostrar Comentario de Fin de Proceso\r\n  function showModalEndProcess(show = true) {\r\n    setdisplayModalEndProcess(show);\r\n  }\r\n  //salvar comentario de end process\r\n  function onSaveEndProcess(values) {\r\n    onSaveProcess(OPTs.PROCESS_CANCELPROCESS);\r\n  }\r\n  function onSaveProcess(option) {\r\n\r\n    switch (option) {\r\n      case OPTs.PROCESS_CANCELPROCESS: {\r\n        break;\r\n      }\r\n    }\r\n    saveJBPMProcess(option);\r\n  }\r\n  async function saveJBPMProcess(option) {\r\n    var maindebtor = await backendServices.consultPrincipalDebtor(locationData.transactionId)\r\n    var infoBpmModel = new InfoBpmModel(\r\n      locationData.infoBpmModel?.instanceId??locationData.instanceId,\r\n      locationData.infoBpmModel?.transactId??locationData.transactionId,\r\n      0,0,\r\n      maindebtor?.personId\r\n    );\r\n    infoBpmModel.personName=maindebtor!==undefined?(maindebtor.name + \" \" +maindebtor.name2 + \" \" +maindebtor.lastName + \" \" +maindebtor.lastName2 ):\"\";\r\n    \r\n    switch (option) {\r\n      case OPTs.PROCESS_CANCELPROCESS: {\r\n        bpmServices.abortProcess(infoBpmModel.instanceId)\r\n          .then((data) => {\r\n            if (data !== undefined) {\r\n              history.push(url.URL_DASHBOARD);\r\n            }\r\n            else {\r\n              showMessage({msg:t(\"ErrorSaveMessage\"),error:true,show:true});\r\n            }\r\n          });\r\n        break;\r\n      }\r\n      case OPTs.PROCESS_ANALISISCREDITO: {\r\n        infoBpmModel.processId=OPTs.PROCESS_ANALISISCREDITO;\r\n        infoBpmModel.activityId=OPTs.ACT_NONE;\r\n        \r\n        var values = {\r\n          \"info\":JSON.stringify(infoBpmModel),\r\n          \"processId\": OPTs.PROCESS_ANALISISCREDITO.toString(),\r\n          \"activityId\": OPTs.ACT_NONE.toString(),\r\n          \"transactionId\": locationData.transactionId.toString(),\r\n        };\r\n        bpmServices.updatevariables(locationData.instanceId, values)\r\n          .then((data) => {\r\n            if (data !== undefined) {\r\n              showMessage({ msg: t(\"Datahasbeensavedsuccessfully\"), error: false, show: true });\r\n              history.push(url.URL_DASHBOARD);\r\n            }\r\n            else {\r\n              showMessage({ msg: t(\"ErrorSaveMessage\"), error: true, show: true });\r\n            }\r\n          });\r\n        break;\r\n      }\r\n      case OPTs.PROCESS_INFORMEFINANCIERO: {\r\n        infoBpmModel.processId=OPTs.PROCESS_INFORMEFINANCIERO;\r\n        infoBpmModel.activityId=OPTs.ACT_NONE;\r\n        \r\n        var values = {\r\n          \"info\":JSON.stringify(infoBpmModel),\r\n          \"processId\": OPTs.PROCESS_INFORMEFINANCIERO.toString(),\r\n          \"activityId\": OPTs.ACT_NONE.toString(),\r\n          \"transactionId\": locationData.transactionId.toString(),\r\n        };\r\n        bpmServices.updatevariables(locationData.instanceId, values)\r\n          .then((data) => {\r\n            if (data !== undefined) {\r\n              history.push({\r\n                pathname: url.URL_FINANCIALINFO,\r\n                data: locationData,\r\n              });\r\n            }\r\n            else {\r\n              showMessage({ msg: t(\"ErrorSaveMessage\"), error: true, show: true });\r\n            }\r\n          });\r\n        break;\r\n      }\r\n      case OPTs.PROCESS_INFORMEGESTION: { //requiere ajustes\r\n        infoBpmModel.processId=OPTs.PROCESS_INFORMEGESTION;\r\n        infoBpmModel.activityId=OPTs.ACT_NONE;\r\n        \r\n        var values = {\r\n          \"info\":JSON.stringify(infoBpmModel),\r\n          \"processId\": OPTs.PROCESS_INFORMEGESTION.toString(),\r\n          \"activityId\": OPTs.ACT_NONE.toString(),\r\n          \"transactionId\": locationData.transactionId,\r\n          \"requestId\":locationData.requestId,\r\n          \"decision\":\"si\",          //requiere ajustes\r\n          \"dcreditoparalelo\":\"sinparalelo\",\r\n          \"statuscredito\":\"completo\", //el paralelo de Credito esta activo\r\n        };\r\n        bpmServices.completedStatusTask(locationData.taskId, values)\r\n          .then((data) => {\r\n            if (data !== undefined) {\r\n              history.push(url.URL_DASHBOARD);\r\n            }\r\n            else {\r\n              //Mensaje ERROR\r\n              showMessage({msg:t(\"ErrorSaveMessage\"),error:true,show:true});\r\n            }\r\n          });\r\n        \r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  function showMessage(data = null) {\r\n    if (data !== null) {\r\n      setmessageDlg(data)\r\n    }\r\n    else {\r\n      setmessageDlg({ msg: \"\", show: false, error: false })\r\n    }\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      {locationData ?\r\n        <div className=\"page-content\">\r\n\r\n          <Breadcrumbs title={t(\"Commercial Credit\")} breadcrumbItem={t(\"Credit Analysis\")} />\r\n\r\n          <LoadingOverlay active={isActiveLoading} spinner text={t(\"WaitingPlease\")}>\r\n            <Card>\r\n        <CardHeader>\r\n        <h4 className=\"card-title\">{mainDebtor != null ? mainDebtor.name + \" \" + mainDebtor.name2 + \" \" + mainDebtor.lastName + \" \" + mainDebtor.lastName2 : \"\"}    #{locationData?.transactionId}</h4>\r\n                <h4 className=\"card-title\">{t(\"Credit Analysis\")}</h4>\r\n              <p className=\"card-title-desc\">{t(\"This form is official and must be filled out correctly\")}</p>              \r\n        </CardHeader>\r\n            <CardBody>\r\n                <Row>\r\n                  <Col xl=\"12\">\r\n                    <GeneralSection proposal={proposal} prospect={prospect} />\r\n                  </Col>\r\n                </Row>\r\n                <Row>\r\n                  <Col xl=\"12\">\r\n                    {mainDebtor ?\r\n                      <CorporateExposure title={t(\"CorporateExhibition\")} customerNumberT24={mainDebtor?.customerNumberT24} />\r\n                      : null}\r\n                  </Col>\r\n                </Row>\r\n\r\n                <Row>\r\n                  <Col xl=\"12\">\r\n                    {mainDebtor ?\r\n                      <CorporateExposureClient title={t(\"CorporateExhibitionClient\")} customerNumberT24={mainDebtor?.customerNumberT24} />\r\n                      : null}\r\n                  </Col>\r\n                </Row>\r\n\r\n                <Row>\r\n                  <Col xl=\"12\">\r\n                    {locationData ?\r\n                      <ChangeSummaryReadOnly transactionId={locationData?.transactionId} />\r\n                      : null}\r\n                  </Col>\r\n                </Row>\r\n\r\n                <Row>\r\n                  <Col xl=\"12\">\r\n                    {mainDebtor ?\r\n                      <FacilityListCore customerNumberT24={mainDebtor?.customerNumberT24} />\r\n                      : null}\r\n                  </Col>\r\n                </Row>\r\n\r\n                <Row>\r\n                  <Col xl=\"12\">\r\n                    {locationData ?\r\n                      <FacilityListBpm transactionId={locationData?.transactionId} />\r\n                      : null}\r\n                  </Col>\r\n                </Row>\r\n\r\n                <Row>\r\n                  <Col xl=\"12\">\r\n                    <CardBody>\r\n                      <HeaderSections title=\"Financial Summary\" t={t}></HeaderSections>\r\n                      {locationData ?\r\n                        <AttachmentFileCore attachmentFileInputModel={new AttachmentFileInputModel(locationData.transactionId, OPTs.PROCESS_ANALISISCREDITO)} />\r\n                        : null}\r\n                    </CardBody>\r\n                  </Col>\r\n                </Row>\r\n\r\n                <Row>\r\n                  <Col xl=\"12\">\r\n                    <CardBody>\r\n                      <FinancialSummary client={financialSummary.client}\r\n                        financialStatus={financialSummary.financialStatus}\r\n                        balances={financialSummary.balances}\r\n                        debts={financialSummary.debts}\r\n                        debtorId={personId}\r\n                      />\r\n                    </CardBody>\r\n                  </Col>\r\n                </Row>\r\n              </CardBody>\r\n              <LogProcess />\r\n            <CardFooter>                            \r\n                <Row>\r\n              <Col md={6} style={{ textAlign: \"left\", marginTop: \"10px\" }}>\r\n                    <Button color=\"danger\" type=\"button\" style={{ margin: '5px' }} onClick={() => { showModalEndProcess() }}><i className=\"mdi mdi-cancel mid-12px\"></i> {t(\"Cancel\")}</Button>\r\n                <Button color=\"primary\" type=\"button\" style={{ margin: '5px' }} onClick={() => { onSaveProcess(OPTs.PROCESS_INFORMEGESTION) }}><i className=\"mdi mdi-backspace-outline mid-12px\"></i> {t(\"AdjustRequired\")}</Button>\r\n                        \r\n                  </Col>\r\n                      <Col md={6} style={{ textAlign: \"right\", marginTop: \"10px\" }}>\r\n                    <Button color=\"primary\" type=\"button\" style={{ margin: '5px' }} onClick={() => { onSaveProcess(OPTs.PROCESS_ANALISISCREDITO) }}><i className=\"mdi mdi-content-save-outline mid-12px\"></i> {t(\"Exit\")}</Button>\r\n                    <Button color=\"success\" type=\"button\" style={{ margin: '5px' }}\r\n                      onClick={() => { onSaveProcess(OPTs.PROCESS_INFORMEFINANCIERO) }}><i className=\"mdi mdi-arrow-right-bold-circle-outline mid-12px\"></i> {t(\"FinantialReport\")}</Button>\r\n                  </Col>\r\n                    </Row>           \r\n              </CardFooter>\r\n            </Card>\r\n          </LoadingOverlay >\r\n          <ModalEndProcess onSaveEndProcess={onSaveEndProcess} isOpen={displayModalEndProcess} toggle={() => { showModalEndProcess(false) }} />\r\n          {\r\n            messageDlg && messageDlg.show ? (\r\n              <SweetAlert\r\n                type={messageDlg.error ? \"error\" : \"success\"}\r\n                title={messageDlg.error ? t(\"Error\") : t(\"Message\")}\r\n                onConfirm={() => { showMessage(); }}>\r\n                {messageDlg.msg}\r\n              </SweetAlert>\r\n            ) : null\r\n          }\r\n        </div>\r\n        : null}\r\n    </React.Fragment>\r\n  );\r\n\r\n}\r\n\r\n\r\nexport default CommercialCreditProposalPage;\r\n"]},"metadata":{},"sourceType":"module"}