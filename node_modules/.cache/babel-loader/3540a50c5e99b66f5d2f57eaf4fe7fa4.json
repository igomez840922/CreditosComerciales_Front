{"ast":null,"code":"var _jsxFileName = \"D:\\\\_PROJECTS\\\\_SOAINT\\\\JBPM\\\\App\\\\banescocreditoscomerciales\\\\src\\\\pages\\\\CommercialCredit\\\\2_ValidarPresolicitud\\\\BusquedaCoincidencia\\\\index.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from \"react\";\nimport PropTypes from 'prop-types';\nimport { useLocation, useHistory } from 'react-router-dom';\nimport LoadingOverlay from 'react-loading-overlay';\nimport * as OPTs from \"../../../../helpers/options_helper\";\nimport * as url from \"../../../../helpers/url_helper\";\nimport { Row, Col, Card, CardBody, Label, CardFooter, Button } from \"reactstrap\";\nimport { AvForm, AvField } from \"availity-reactstrap-validation\";\nimport { Link } from \"react-router-dom\"; //Import Breadcrumb\n\nimport Breadcrumbs from \"../../../../components/Common/Breadcrumb\"; //i18n\n\nimport { withTranslation } from \"react-i18next\"; //Import SweetAlert\n\nimport SweetAlert from \"react-bootstrap-sweetalert\";\nimport FormBusqueda from \"./FormBusqueda\";\nimport FormResultados from \"./FormResultados\";\nimport FormObservaciones from \"./FormObservaciones\";\nimport FormGoogle from \"./FormGoogle\";\nimport ModalCloseOptions from \"./ModalCloseOptions\";\nimport ModalAdvanceOptions from \"./ModalAdvanceOptions\";\nimport LogProcess from \"../../../../components/LogProcess/index\";\nimport ModalEndProcess from \"../../../../components/EndProcess/ModalEndProcess\";\nimport AttachmentFileCore from \"../../../../components/Common/AttachmentFileCore\";\nimport { BackendServices, CoreServices, BpmServices } from \"../../../../services\";\nimport { BusquedaDescarteModel } from \"../../../../models\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst BandejaEntrada = props => {\n  _s();\n\n  const history = useHistory();\n  const location = useLocation(); //Data que recibimos en el location\n\n  const [locationData, setLocationData] = useState(undefined); //Entidad Busqueda y Descarte\n\n  const [selectedData, setSelectedData] = useState(undefined); //Resultado de Lista Negra\n\n  const [dataList, setDataList] = useState([]);\n  const [displayModalGoogle, setDisplayModalGoogle] = useState(false);\n  const [searchGoogleTerms, setSearchGoogleTerms] = useState([]);\n  const [displayModalCloseOptions, setDisplayModalCloseOptions] = useState(false);\n  const [displayModalAdvanceOptions, setDisplayModalAdvanceOptions] = useState(false);\n  const [displayModalEndProcess, setDisplayModalEndProcess] = useState(false);\n  const [isActiveLoading, setIsActiveLoading] = useState(false);\n  const [successSave_dlg, setsuccessSave_dlg] = useState(false);\n  const [error_dlg, seterror_dlg] = useState(false);\n  const [error_msg, seterror_msg] = useState(\"\");\n  const [info_dlg, setinfo_dlg] = useState(false);\n  const [info_msg, setinfo_msg] = useState(\"\"); //On Mounting (componentDidMount)\n\n  React.useEffect(() => {\n    if (location.data !== null && location.data !== undefined) {\n      console.log(\"BandejaEntrada\", location.data);\n      setLocationData(location.data);\n      initializeData(location.data);\n    }\n  }, []); //Caraga Inicial\n\n  function initializeData(InputData) {\n    if (InputData !== undefined && InputData !== null) {\n      const apiBackendServices = new BackendServices(); // Buscar en BD los datos de esta actividad\n      //var parameters = {processId:InputData.processId,transactId:InputData.transactionId,activityId:InputData.activityId}      \n\n      apiBackendServices.consultarBusquedaDescarte(InputData.transactionId).then(data => {\n        if (data !== null && data !== undefined) {\n          UpdateDataModel(data);\n        } else {\n          //Nuevo Proceso            \n          data = BusquedaDescarteModel.getRequestModel();\n          UpdateDataModel(data);\n        }\n      }).catch(error => {\n        console.error('api error: ', error);\n      });\n    } else {\n      history.push(url.URL_DASHBOARD);\n    }\n  }\n\n  function searchWhatchList(values) {\n    setIsActiveLoading(true);\n    const apiCoreServices = new CoreServices();\n    apiCoreServices.postWhatchList(values).then(data => {\n      if (data.status === 200) {\n        if (data.result.length > 0) {\n          setDataList(data.result);\n        } else {\n          setinfo_msg(props.t('NoResults'));\n          setinfo_dlg(true);\n        }\n      } else {\n        seterror_msg(props.t('ErrorCode') + \": \" + data.error.errorCode + \"  \" + props.t('ErrorMsg') + \": \" + data.error.errorCode);\n        seterror_dlg(true);\n      }\n    }).catch(error => {\n      console.error('Error fetching documents', error);\n    }).finally(() => {\n      setIsActiveLoading(false);\n    });\n  }\n\n  function removeBodyCss() {\n    document.body.classList.add(\"no_padding\");\n  }\n\n  function onGoogleSearch(q) {\n    setSearchGoogleTerms(q);\n    setDisplayModalGoogle(!displayModalGoogle);\n    removeBodyCss();\n  }\n\n  function toggleGoogleModal() {\n    setDisplayModalGoogle(!displayModalGoogle);\n  } //Modal Opciones al Salir\n\n\n  function toggleModalCloseOptions() {\n    setDisplayModalCloseOptions(!displayModalCloseOptions);\n  } //Modal Para mostrar las opciones al Avanzar\n\n\n  function toggleModalAdvanceOptions() {\n    setDisplayModalAdvanceOptions(!displayModalAdvanceOptions);\n  } //Modal Para mostrar Comentario de Fin de Proceso\n\n\n  function toggleModalEndProcess() {\n    setDisplayModalEndProcess(!displayModalEndProcess);\n  } //Salvando el Proceso y le pasamos una opcion: 1-Finalizar Proceso, 2- Salvarlo, 3- A Cumplimmineto, 4- Avanzar a IGR\n\n\n  function onSaveProcess(option) {\n    if (option === OPTs.OPT_PREFINALIZARPROCESO) {\n      toggleModalEndProcess();\n      return;\n    }\n\n    selectedData.instanceId = locationData.instanceId !== null && locationData.instanceId !== undefined ? locationData.instanceId : selectedData.instanceId;\n    selectedData.customerId = locationData.customerId !== null && locationData.customerId !== undefined ? locationData.customerId : selectedData.customerId;\n    selectedData.responsible = \"admin\";\n    console.log(\"onSaveProcess\", selectedData);\n    const apiBackendServices = new BackendServices(); //Guardar el usuario prospecto    \n\n    apiBackendServices.guardarUsuarioProspecto(selectedData).then(userData => {\n      if (userData !== undefined) {\n        selectedData.transactId = userData.transactId !== null && userData.transactId !== undefined ? userData.transactId : selectedData.transactId;\n        selectedData.customerId = userData.customerId !== null && userData.customerId !== undefined ? userData.customerId : selectedData.customerId;\n        selectedData.compliance = option === OPTs.OPT_ENVIARCUMPLIMIENTO ? true : false;\n        UpdateDataModel(selectedData); //Guardar busqueda y descarte\n\n        apiBackendServices.guardarBusquedaDescarte(selectedData).then(descarteData => {\n          if (descarteData !== undefined) {\n            saveJBPMProcess(option);\n          } else {\n            //Mensaje ERROR\n            seterror_msg(props.t(\"ErrorSaveMessage\"));\n            seterror_dlg(true);\n          }\n        }).catch(error => {\n          console.error('api error: ', error);\n        });\n      } else {\n        //Mensaje ERROR\n        seterror_msg(props.t(\"ErrorSaveMessage\"));\n        seterror_dlg(true);\n      }\n    }).catch(error => {\n      console.error('api error: ', error);\n    });\n  }\n\n  function saveJBPMProcess(option) {\n    //console.error('saveJBPMProcess: ', option);\n    const apiBpmServices = new BpmServices();\n\n    switch (option) {\n      case OPTs.OPT_FINALIZARPROCESO:\n        {\n          apiBpmServices.abortProcess(locationData.instanceId).then(data => {\n            if (data !== undefined) {\n              history.push(url.URL_DASHBOARD);\n            } else {\n              //Mensaje ERROR\n              seterror_msg(props.t(\"TheProcessCouldNotFinish\"));\n              seterror_dlg(true);\n            }\n          });\n          break;\n        }\n\n      case OPTs.OPT_SALVAPARCIAL:\n        {\n          var values = {\n            \"processId\": OPTs.PROCESS_BUSQUEDADESCARTE.toString(),\n            \"activityId\": OPTs.ACT_NONE.toString(),\n            \"transactionId\": selectedData.transactId.toString(),\n            \"customerId\": selectedData.customerId.toString(),\n            \"applicationNumber\": \"\",\n            \"procedureNumber\": \"\" //\"decision\":\"no\"          \n\n          };\n          apiBpmServices.updatevariables(locationData.instanceId, values).then(data => {\n            if (data !== undefined) {\n              setsuccessSave_dlg(true);\n            } else {\n              //Mensaje ERROR\n              seterror_msg(props.t(\"ErrorSaveMessage\"));\n              seterror_dlg(true);\n            }\n          });\n          break;\n        }\n\n      case OPTs.OPT_ENVIARCUMPLIMIENTO:\n        {\n          var values = {\n            \"processId\": OPTs.PROCESS_CUMPLIMIENTO.toString(),\n            \"activityId\": OPTs.ACT_NONE.toString(),\n            \"transactionId\": selectedData.transactId.toString(),\n            \"customerId\": selectedData.customerId.toString(),\n            \"applicationNumber\": \"\",\n            \"procedureNumber\": \"\",\n            \"decision\": \"si\"\n          };\n          apiBpmServices.completedStatusTask(locationData.taskId, values).then(data => {\n            if (data !== undefined) {\n              setsuccessSave_dlg(true);\n            } else {\n              //Mensaje ERROR\n              seterror_msg(props.t(\"ErrorSaveMessage\"));\n              seterror_dlg(true);\n            }\n          });\n          break;\n        }\n\n      case OPTs.OPT_LISTAEXCLUSION:\n        {\n          var values = {\n            \"processId\": OPTs.PROCESS_LISTAEXCLUSION.toString(),\n            \"activityId\": OPTs.ACT_NONE.toString(),\n            \"transactionId\": selectedData.transactId.toString(),\n            \"customerId\": selectedData.customerId.toString(),\n            \"applicationNumber\": \"\",\n            \"procedureNumber\": \"\",\n            \"decision\": \"no\"\n          };\n          apiBpmServices.completedStatusTask(locationData.taskId, values).then(data => {\n            if (data !== undefined) {\n              setsuccessSave_dlg(true);\n            } else {\n              //Mensaje ERROR\n              seterror_msg(props.t(\"ErrorSaveMessage\"));\n              seterror_dlg(true);\n            }\n          });\n          break;\n        }\n    }\n  } //salvar comentario de end process\n\n\n  function onSaveEndProcess(values) {\n    //Salvar los comentarios en Bitacora    \n    selectedData.endProcessComment = values.txtComment;\n    UpdateDataModel(selectedData);\n    onSaveProcess(OPTs.OPT_FINALIZARPROCESO);\n  } //Actualizamos El Modelo de Datos segun va cambiando\n\n\n  function UpdateDataModel(data) {\n    setSelectedData(data);\n  }\n\n  return /*#__PURE__*/_jsxDEV(React.Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"page-content\",\n      children: [/*#__PURE__*/_jsxDEV(Breadcrumbs, {\n        title: props.t(\"CommercialCredit\"),\n        breadcrumbItem: props.t(\"SearchDiscard\")\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 335,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(LoadingOverlay, {\n        active: isActiveLoading,\n        spinner: true,\n        text: props.t(\"WaitingPlease\"),\n        children: [/*#__PURE__*/_jsxDEV(Card, {\n          children: [/*#__PURE__*/_jsxDEV(CardBody, {\n            children: [/*#__PURE__*/_jsxDEV(FormBusqueda, {\n              onSubmit: searchWhatchList,\n              onGoogleSearch: onGoogleSearch,\n              selectedData: selectedData,\n              updateDataModel: UpdateDataModel\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 342,\n              columnNumber: 17\n            }, this), dataList.length > 0 && /*#__PURE__*/_jsxDEV(FormResultados, {\n              results: dataList,\n              onScreenOption: props.onScreenOption\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 345,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(FormObservaciones, {\n              selectedData: selectedData,\n              updateDataModel: UpdateDataModel\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 348,\n              columnNumber: 17\n            }, this), locationData !== undefined ? /*#__PURE__*/_jsxDEV(AttachmentFileCore, {\n              locationData: {\n                instanceId: locationData.instanceId,\n                processId: OPTs.PROCESS_BUSQUEDADESCARTE,\n                activityId: OPTs.ACT_NONE\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 352,\n              columnNumber: 14\n            }, this) : null]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 340,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(CardFooter, {\n            style: {\n              textAlign: \"right\"\n            },\n            children: [/*#__PURE__*/_jsxDEV(Button, {\n              color: \"danger\",\n              type: \"button\",\n              style: {\n                margin: '5px'\n              },\n              onClick: () => {\n                toggleModalCloseOptions();\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"mdi mdi-arrow-left-bold-circle-outline mid-12px\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 359,\n                columnNumber: 128\n              }, this), \" \", props.t(\"Exit\")]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 359,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(Button, {\n              color: \"success\",\n              type: \"button\",\n              style: {\n                margin: '5px'\n              },\n              onClick: () => {\n                toggleModalAdvanceOptions();\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"mdi mdi-arrow-right-bold-circle-outline mid-12px\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 360,\n                columnNumber: 131\n              }, this), \" \", props.t(\"Advance\")]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 360,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 358,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 339,\n          columnNumber: 9\n        }, this), locationData !== undefined && locationData.customerId !== null && locationData.customerId !== undefined && locationData.customerId.length > 0 ? /*#__PURE__*/_jsxDEV(LogProcess, {\n          locationData: {\n            instanceId: locationData.instanceId,\n            transactId: locationData.transactionId,\n            clientId: locationData.customerId,\n            customerName: \"admin\",\n            processId: OPTs.PROCESS_BUSQUEDADESCARTE,\n            activityId: OPTs.ACT_NONE\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 366,\n          columnNumber: 10\n        }, this) : null]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 337,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(FormGoogle, {\n        searchGoogleTerms: searchGoogleTerms,\n        isOpen: displayModalGoogle,\n        toggle: () => {\n          toggleGoogleModal();\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 372,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ModalCloseOptions, {\n        onSaveProcess: onSaveProcess,\n        isOpen: displayModalCloseOptions,\n        toggle: () => {\n          toggleModalCloseOptions();\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 374,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ModalAdvanceOptions, {\n        onSaveProcess: onSaveProcess,\n        isOpen: displayModalAdvanceOptions,\n        toggle: () => {\n          toggleModalAdvanceOptions();\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 376,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ModalEndProcess, {\n        onSaveEndProcess: onSaveEndProcess,\n        isOpen: displayModalEndProcess,\n        toggle: () => {\n          toggleModalEndProcess();\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 378,\n        columnNumber: 9\n      }, this), successSave_dlg ? /*#__PURE__*/_jsxDEV(SweetAlert, {\n        success: true,\n        title: props.t(\"SuccessDialog\"),\n        onConfirm: () => {\n          setsuccessSave_dlg(false);\n          history.push(url.URL_DASHBOARD);\n        },\n        children: props.t(\"SuccessSaveMessage\")\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 381,\n        columnNumber: 13\n      }, this) : null, error_dlg ? /*#__PURE__*/_jsxDEV(SweetAlert, {\n        error: true,\n        title: props.t(\"ErrorDialog\"),\n        onConfirm: () => {\n          seterror_dlg(false);\n        },\n        children: error_msg\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 395,\n        columnNumber: 13\n      }, this) : null, info_dlg ? /*#__PURE__*/_jsxDEV(SweetAlert, {\n        info: true,\n        title: props.t(\"SuccessDialog\"),\n        onConfirm: () => {\n          setinfo_dlg(false);\n        },\n        children: info_msg\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 407,\n        columnNumber: 13\n      }, this) : null]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 333,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 332,\n    columnNumber: 5\n  }, this);\n};\n\n_s(BandejaEntrada, \"7EmzPl7/FDpY64XPdA3pgm/WwVg=\", false, function () {\n  return [useHistory, useLocation];\n});\n\n_c = BandejaEntrada;\nexport default withTranslation()(BandejaEntrada);\n\nvar _c;\n\n$RefreshReg$(_c, \"BandejaEntrada\");","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/pages/CommercialCredit/2_ValidarPresolicitud/BusquedaCoincidencia/index.js"],"names":["React","useState","PropTypes","useLocation","useHistory","LoadingOverlay","OPTs","url","Row","Col","Card","CardBody","Label","CardFooter","Button","AvForm","AvField","Link","Breadcrumbs","withTranslation","SweetAlert","FormBusqueda","FormResultados","FormObservaciones","FormGoogle","ModalCloseOptions","ModalAdvanceOptions","LogProcess","ModalEndProcess","AttachmentFileCore","BackendServices","CoreServices","BpmServices","BusquedaDescarteModel","BandejaEntrada","props","history","location","locationData","setLocationData","undefined","selectedData","setSelectedData","dataList","setDataList","displayModalGoogle","setDisplayModalGoogle","searchGoogleTerms","setSearchGoogleTerms","displayModalCloseOptions","setDisplayModalCloseOptions","displayModalAdvanceOptions","setDisplayModalAdvanceOptions","displayModalEndProcess","setDisplayModalEndProcess","isActiveLoading","setIsActiveLoading","successSave_dlg","setsuccessSave_dlg","error_dlg","seterror_dlg","error_msg","seterror_msg","info_dlg","setinfo_dlg","info_msg","setinfo_msg","useEffect","data","console","log","initializeData","InputData","apiBackendServices","consultarBusquedaDescarte","transactionId","then","UpdateDataModel","getRequestModel","catch","error","push","URL_DASHBOARD","searchWhatchList","values","apiCoreServices","postWhatchList","status","result","length","t","errorCode","finally","removeBodyCss","document","body","classList","add","onGoogleSearch","q","toggleGoogleModal","toggleModalCloseOptions","toggleModalAdvanceOptions","toggleModalEndProcess","onSaveProcess","option","OPT_PREFINALIZARPROCESO","instanceId","customerId","responsible","guardarUsuarioProspecto","userData","transactId","compliance","OPT_ENVIARCUMPLIMIENTO","guardarBusquedaDescarte","descarteData","saveJBPMProcess","apiBpmServices","OPT_FINALIZARPROCESO","abortProcess","OPT_SALVAPARCIAL","PROCESS_BUSQUEDADESCARTE","toString","ACT_NONE","updatevariables","PROCESS_CUMPLIMIENTO","completedStatusTask","taskId","OPT_LISTAEXCLUSION","PROCESS_LISTAEXCLUSION","onSaveEndProcess","endProcessComment","txtComment","onScreenOption","processId","activityId","textAlign","margin","clientId","customerName"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\"\r\nimport PropTypes from 'prop-types';\r\nimport { useLocation,useHistory } from 'react-router-dom'\r\nimport LoadingOverlay from 'react-loading-overlay';\r\nimport * as OPTs from \"../../../../helpers/options_helper\"\r\nimport * as url from \"../../../../helpers/url_helper\"\r\n\r\nimport {\r\n  Row,\r\n  Col,\r\n  Card,\r\n  CardBody,\r\n  Label,\r\n  CardFooter,\r\n  Button,\r\n} from \"reactstrap\"\r\n\r\nimport { AvForm, AvField } from \"availity-reactstrap-validation\"\r\nimport { Link } from \"react-router-dom\"\r\n//Import Breadcrumb\r\nimport Breadcrumbs from \"../../../../components/Common/Breadcrumb\"\r\n//i18n\r\nimport { withTranslation } from \"react-i18next\"\r\n//Import SweetAlert\r\nimport SweetAlert from \"react-bootstrap-sweetalert\"\r\n\r\nimport FormBusqueda from \"./FormBusqueda\"\r\nimport FormResultados from \"./FormResultados\"\r\nimport FormObservaciones from \"./FormObservaciones\"\r\nimport FormGoogle from \"./FormGoogle\"\r\nimport ModalCloseOptions from \"./ModalCloseOptions\"\r\nimport ModalAdvanceOptions from \"./ModalAdvanceOptions\"\r\nimport LogProcess from \"../../../../components/LogProcess/index\";\r\nimport ModalEndProcess from \"../../../../components/EndProcess/ModalEndProcess\";\r\nimport AttachmentFileCore from \"../../../../components/Common/AttachmentFileCore\";\r\n\r\n\r\nimport {BackendServices,CoreServices,BpmServices,} from \"../../../../services\";\r\nimport { BusquedaDescarteModel } from \"../../../../models\";\r\n\r\nconst BandejaEntrada = props => {\r\n  \r\n  const history = useHistory();\r\n  const location = useLocation();\r\n\r\n  //Data que recibimos en el location\r\n  const [locationData, setLocationData] = useState(undefined);  \r\n  //Entidad Busqueda y Descarte\r\n  const [selectedData, setSelectedData] = useState(undefined);  \r\n  //Resultado de Lista Negra\r\n  const [dataList, setDataList] = useState([]);\r\n\r\n  const [displayModalGoogle, setDisplayModalGoogle] = useState(false);\r\n  const [searchGoogleTerms, setSearchGoogleTerms] = useState([]);\r\n  const [displayModalCloseOptions, setDisplayModalCloseOptions] = useState(false);\r\n  const [displayModalAdvanceOptions, setDisplayModalAdvanceOptions] = useState(false);\r\n  const [displayModalEndProcess, setDisplayModalEndProcess] = useState(false);\r\n     \r\n  const [isActiveLoading, setIsActiveLoading] = useState(false);\r\n  const [successSave_dlg, setsuccessSave_dlg] = useState(false)\r\n  const [error_dlg, seterror_dlg] = useState(false)\r\n  const [error_msg, seterror_msg] = useState(\"\")\r\n  const [info_dlg, setinfo_dlg] = useState(false)\r\n  const [info_msg, setinfo_msg] = useState(\"\")\r\n  \r\n  //On Mounting (componentDidMount)\r\n  React.useEffect(() => {\r\n    if(location.data!==null && location.data!==undefined){\r\n      console.log(\"BandejaEntrada\",location.data);\r\n      setLocationData(location.data);\r\n      initializeData(location.data);    \r\n    }    \r\n  }, []);\r\n\r\n  //Caraga Inicial\r\n  function initializeData(InputData) {    \r\n        \r\n    if(InputData!==undefined && InputData!== null){\r\n\r\n      const apiBackendServices = new BackendServices();\r\n      \r\n      // Buscar en BD los datos de esta actividad\r\n      //var parameters = {processId:InputData.processId,transactId:InputData.transactionId,activityId:InputData.activityId}      \r\n      apiBackendServices.consultarBusquedaDescarte(InputData.transactionId)\r\n        .then((data) => {\r\n          if(data!== null && data !==undefined){\r\n            UpdateDataModel(data);\r\n          }\r\n          else{\r\n            //Nuevo Proceso            \r\n            data = BusquedaDescarteModel.getRequestModel();\r\n            UpdateDataModel(data);        \r\n          }\r\n      })\r\n      .catch((error) => {    \r\n        console.error('api error: ', error);\r\n      });\r\n    }    \r\n    else{      \r\n      history.push(url.URL_DASHBOARD);      \r\n    }\r\n  }\r\n\r\n  function searchWhatchList(values) {\r\n    \r\n    setIsActiveLoading(true);\r\n    const apiCoreServices = new CoreServices()\r\n    apiCoreServices.postWhatchList(values)\r\n      .then((data) => {\r\n        if(data.status === 200){\r\n\r\n          if(data.result.length > 0){\r\n            setDataList(data.result);            \r\n          }\r\n          else{\r\n            setinfo_msg(props.t('NoResults'));\r\n            setinfo_dlg(true)\r\n          }\r\n        }\r\n        else{\r\n          seterror_msg(props.t('ErrorCode')+\": \" + data.error.errorCode + \"  \" +props.t('ErrorMsg')+\": \" + data.error.errorCode);\r\n          seterror_dlg(true)\r\n        }\r\n\r\n      })\r\n      .catch((error) => {\r\n\r\n        console.error('Error fetching documents', error);\r\n\r\n      }).finally (() => {\r\n\r\n        setIsActiveLoading(false);\r\n\r\n      })\r\n  }\r\n  \r\n  function removeBodyCss() {\r\n    document.body.classList.add(\"no_padding\")\r\n  }\r\n\r\n  function onGoogleSearch(q) {    \r\n    setSearchGoogleTerms(q);\r\n    setDisplayModalGoogle(!displayModalGoogle);\r\n    removeBodyCss();\r\n  }\r\n\r\n  function toggleGoogleModal() {\r\n    setDisplayModalGoogle(!displayModalGoogle);\r\n  }\r\n\r\n  //Modal Opciones al Salir\r\n  function toggleModalCloseOptions() {\r\n    setDisplayModalCloseOptions(!displayModalCloseOptions);\r\n  }\r\n\r\n  //Modal Para mostrar las opciones al Avanzar\r\n  function toggleModalAdvanceOptions() {\r\n    setDisplayModalAdvanceOptions(!displayModalAdvanceOptions);\r\n  }\r\n\r\n  //Modal Para mostrar Comentario de Fin de Proceso\r\n  function toggleModalEndProcess() {\r\n    setDisplayModalEndProcess(!displayModalEndProcess);\r\n  }\r\n\r\n  //Salvando el Proceso y le pasamos una opcion: 1-Finalizar Proceso, 2- Salvarlo, 3- A Cumplimmineto, 4- Avanzar a IGR\r\n  function onSaveProcess(option){\r\n    \r\n    if(option === OPTs.OPT_PREFINALIZARPROCESO){\r\n      toggleModalEndProcess();\r\n      return;\r\n    }\r\n    \r\n    selectedData.instanceId = locationData.instanceId !== null && locationData.instanceId !== undefined? locationData.instanceId:selectedData.instanceId;\r\n    selectedData.customerId = locationData.customerId !== null && locationData.customerId !== undefined? locationData.customerId:selectedData.customerId;\r\n    selectedData.responsible = \"admin\";\r\n\r\n    console.log(\"onSaveProcess\",selectedData);\r\n    const apiBackendServices = new BackendServices();        \r\n    //Guardar el usuario prospecto    \r\n    apiBackendServices.guardarUsuarioProspecto(selectedData)\r\n    .then((userData) => {\r\n      \r\n      if(userData!==undefined){\r\n        selectedData.transactId = userData.transactId !== null && userData.transactId !== undefined? userData.transactId:selectedData.transactId;\r\n        selectedData.customerId = userData.customerId !== null && userData.customerId !== undefined? userData.customerId:selectedData.customerId;\r\n        selectedData.compliance = option === OPTs.OPT_ENVIARCUMPLIMIENTO?true:false;\r\n\r\n        UpdateDataModel(selectedData);\r\n        \r\n        //Guardar busqueda y descarte\r\n        apiBackendServices.guardarBusquedaDescarte(selectedData)\r\n          .then((descarteData) => {\r\n            if(descarteData!==undefined){\r\n              \r\n              saveJBPMProcess(option);\r\n            }\r\n            else{\r\n              //Mensaje ERROR\r\n              seterror_msg(props.t(\"ErrorSaveMessage\"))\r\n              seterror_dlg(true)\r\n            }\r\n        })\r\n        .catch((error) => {    \r\n          console.error('api error: ', error);\r\n        });\r\n      }\r\n      else{\r\n        //Mensaje ERROR\r\n        seterror_msg(props.t(\"ErrorSaveMessage\"))\r\n              seterror_dlg(true)\r\n      }\r\n    })\r\n    .catch((error) => {    \r\n      console.error('api error: ', error);\r\n    }); \r\n  }\r\n\r\n  function saveJBPMProcess(option){    \r\n    \r\n    //console.error('saveJBPMProcess: ', option);\r\n    const apiBpmServices = new BpmServices();\r\n\r\n    switch(option){\r\n      case OPTs.OPT_FINALIZARPROCESO: {\r\n        \r\n        apiBpmServices.abortProcess(locationData.instanceId)\r\n          .then((data) => {\r\n            if(data!==undefined){              \r\n              history.push(url.URL_DASHBOARD);            }\r\n            else{\r\n              //Mensaje ERROR\r\n              seterror_msg(props.t(\"TheProcessCouldNotFinish\"))\r\n              seterror_dlg(true)\r\n            }\r\n        });\r\n        break;\r\n      }\r\n      case OPTs.OPT_SALVAPARCIAL: {\r\n        var values = {\r\n          \"processId\":OPTs.PROCESS_BUSQUEDADESCARTE.toString(),\r\n          \"activityId\":OPTs.ACT_NONE.toString(),                    \r\n          \"transactionId\":selectedData.transactId.toString(),\r\n          \"customerId\":selectedData.customerId.toString(),                      \r\n          \"applicationNumber\":\"\",\r\n          \"procedureNumber\":\"\" ,\r\n          //\"decision\":\"no\"          \r\n      };\r\n        apiBpmServices.updatevariables(locationData.instanceId,values)\r\n          .then((data) => {\r\n            if(data!==undefined){              \r\n              setsuccessSave_dlg(true);    \r\n            }\r\n            else{\r\n              //Mensaje ERROR\r\n              seterror_msg(props.t(\"ErrorSaveMessage\"))\r\n              seterror_dlg(true)\r\n            }\r\n        });\r\n\r\n        break;\r\n      }\r\n      case OPTs.OPT_ENVIARCUMPLIMIENTO: {\r\n\r\n        var values = {\r\n          \"processId\":OPTs.PROCESS_CUMPLIMIENTO.toString(),\r\n          \"activityId\":OPTs.ACT_NONE.toString(),                    \r\n          \"transactionId\":selectedData.transactId.toString(),\r\n          \"customerId\":selectedData.customerId.toString(),                      \r\n          \"applicationNumber\":\"\",\r\n          \"procedureNumber\":\"\" ,\r\n          \"decision\":\"si\"          \r\n      };\r\n        apiBpmServices.completedStatusTask(locationData.taskId,values)\r\n          .then((data) => {\r\n            if(data!==undefined){              \r\n              setsuccessSave_dlg(true);    \r\n            }\r\n            else{\r\n              //Mensaje ERROR\r\n              seterror_msg(props.t(\"ErrorSaveMessage\"))\r\n              seterror_dlg(true)\r\n            }\r\n        });\r\n\r\n        break;\r\n      }\r\n      case OPTs.OPT_LISTAEXCLUSION: {\r\n\r\n        var values = {\r\n          \"processId\":OPTs.PROCESS_LISTAEXCLUSION.toString(),\r\n          \"activityId\":OPTs.ACT_NONE.toString(),                    \r\n          \"transactionId\":selectedData.transactId.toString(),\r\n          \"customerId\":selectedData.customerId.toString(),                      \r\n          \"applicationNumber\":\"\",\r\n          \"procedureNumber\":\"\" ,\r\n          \"decision\":\"no\"          \r\n      };\r\n        apiBpmServices.completedStatusTask(locationData.taskId,values)\r\n          .then((data) => {\r\n            if(data!==undefined){              \r\n              setsuccessSave_dlg(true);    \r\n            }\r\n            else{\r\n              //Mensaje ERROR\r\n              seterror_msg(props.t(\"ErrorSaveMessage\"))\r\n              seterror_dlg(true)\r\n            }\r\n        });\r\n        break;\r\n      }      \r\n    }\r\n  }\r\n\r\n  //salvar comentario de end process\r\n  function onSaveEndProcess(values){\r\n    \r\n    //Salvar los comentarios en Bitacora    \r\n    selectedData.endProcessComment = values.txtComment;\r\n\r\n    UpdateDataModel(selectedData);\r\n\r\n    onSaveProcess(OPTs.OPT_FINALIZARPROCESO);\r\n  }\r\n\r\n  //Actualizamos El Modelo de Datos segun va cambiando\r\n  function UpdateDataModel(data) {\r\n    setSelectedData(data);                  \r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className=\"page-content\">\r\n        \r\n        <Breadcrumbs title={props.t(\"CommercialCredit\")} breadcrumbItem={props.t(\"SearchDiscard\")} />\r\n\r\n        <LoadingOverlay active={isActiveLoading} spinner text={props.t(\"WaitingPlease\")}>\r\n        \r\n        <Card>\r\n            <CardBody>\r\n\r\n                <FormBusqueda onSubmit={ searchWhatchList }  onGoogleSearch={ onGoogleSearch } selectedData={selectedData} updateDataModel={UpdateDataModel}/>\r\n              \r\n                { dataList.length > 0 && (\r\n                  <FormResultados results={ dataList } onScreenOption={props.onScreenOption}/>                  \r\n                )}\r\n\r\n                <FormObservaciones selectedData={selectedData} updateDataModel={UpdateDataModel}/>\r\n\r\n                { \r\n            (locationData!==undefined)?\r\n            (<AttachmentFileCore locationData={{instanceId:locationData.instanceId,processId:OPTs.PROCESS_BUSQUEDADESCARTE,activityId:OPTs.ACT_NONE}} />)\r\n            :null\r\n          }\r\n\r\n            </CardBody>\r\n\r\n            <CardFooter style={{textAlign:\"right\"}}>  \r\n                  <Button color=\"danger\" type=\"button\" style={{ margin: '5px' }} onClick={() => { toggleModalCloseOptions() }}><i className=\"mdi mdi-arrow-left-bold-circle-outline mid-12px\"></i> {props.t(\"Exit\")}</Button>\r\n                  <Button color=\"success\" type=\"button\" style={{ margin: '5px' }} onClick={() => { toggleModalAdvanceOptions() }}><i className=\"mdi mdi-arrow-right-bold-circle-outline mid-12px\"></i> {props.t(\"Advance\")}</Button>\r\n              </CardFooter>\r\n              \r\n        </Card>\r\n\r\n        { (locationData!==undefined && locationData.customerId!==null && locationData.customerId!==undefined && locationData.customerId.length > 0)?\r\n        (<LogProcess locationData={{instanceId:locationData.instanceId,transactId: locationData.transactionId,clientId: locationData.customerId,\r\n          customerName:\"admin\",processId:OPTs.PROCESS_BUSQUEDADESCARTE,activityId:OPTs.ACT_NONE}}/>)\r\n        :null}\r\n        \r\n      </LoadingOverlay>\r\n\r\n        <FormGoogle searchGoogleTerms={ searchGoogleTerms } isOpen={ displayModalGoogle } toggle={ () => { toggleGoogleModal() } } />\r\n\r\n        <ModalCloseOptions onSaveProcess={ onSaveProcess } isOpen={ displayModalCloseOptions } toggle={ () => { toggleModalCloseOptions() } } />\r\n\r\n        <ModalAdvanceOptions onSaveProcess={ onSaveProcess } isOpen={ displayModalAdvanceOptions } toggle={ () => { toggleModalAdvanceOptions() } } />\r\n\r\n        <ModalEndProcess onSaveEndProcess={ onSaveEndProcess } isOpen={ displayModalEndProcess } toggle={ () => { toggleModalEndProcess() } } />        \r\n\r\n        {successSave_dlg ? (\r\n            <SweetAlert\r\n              success\r\n              title={props.t(\"SuccessDialog\")}\r\n              onConfirm={() => {\r\n                setsuccessSave_dlg(false)\r\n                \r\n                history.push(url.URL_DASHBOARD);\r\n              }}\r\n            >\r\n              {props.t(\"SuccessSaveMessage\")}\r\n            </SweetAlert>\r\n          ) : null}\r\n\r\n          {error_dlg ? (\r\n            <SweetAlert\r\n              error\r\n              title={props.t(\"ErrorDialog\")}\r\n              onConfirm={() => {\r\n                seterror_dlg(false)\r\n              }}\r\n            >\r\n              {error_msg}\r\n            </SweetAlert>\r\n          ) : null}\r\n\r\n          {info_dlg ? (\r\n            <SweetAlert\r\n              info\r\n              title={props.t(\"SuccessDialog\")}\r\n              onConfirm={() => {\r\n                setinfo_dlg(false)\r\n              }}\r\n            >\r\n              {info_msg}\r\n            </SweetAlert>\r\n          ) : null}\r\n\r\n      </div>      \r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\n\r\nexport default (withTranslation()(BandejaEntrada))\r\n"]},"metadata":{},"sourceType":"module"}