{"ast":null,"code":"var _jsxFileName = \"D:\\\\_PROJECTS\\\\_SOAINT\\\\JBPM\\\\App\\\\banescocreditoscomerciales\\\\src\\\\pages\\\\CommercialCredit\\\\5_PropuestaCredito\\\\Secciones\\\\PreviewFacility.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport PropTypes from 'prop-types';\nimport { translationHelpers } from '../../../../helpers';\nimport { Link, useHistory, useLocation } from \"react-router-dom\";\nimport SweetAlert from \"react-bootstrap-sweetalert\";\nimport { Row, Col, Table, Button } from \"reactstrap\";\nimport ModalNuevaComision from \"./ModalNuevaComision\";\nimport { BackendServices, CoreServices } from \"../../../../services\";\nimport { useTranslation } from \"react-i18next\";\nimport Currency from \"../../../../helpers/currency\";\nimport { uniq_key } from \"../../../../helpers/unq_key\";\nimport * as url from \"../../../../helpers/url_helper\";\nimport TreasuryCurve from \"./treasuryCurve.model\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst PreviewFacility = props => {\n  _s();\n\n  const {\n    t,\n    i18n\n  } = useTranslation();\n  const api = new BackendServices();\n  const coreServices = new CoreServices();\n  const currencyData = new Currency();\n  const [Facilidades, setFacilidades] = useState(null);\n  const termOptions = [{\n    label: `${t(\"ShortTerm\")}`,\n    value: \"CP\"\n  }, {\n    label: `${t(\"LongTerm\")}`,\n    value: \"LP\"\n  }];\n  const location = useLocation();\n  const history = useHistory();\n  useEffect(() => {\n    var _location$pathname, _location$pathname2;\n\n    let dataSession = {};\n    console.log(location === null || location === void 0 ? void 0 : (_location$pathname = location.pathname) === null || _location$pathname === void 0 ? void 0 : _location$pathname.split(\"previsualizarPropCred/\")[1]);\n\n    if (location === null || location === void 0 ? void 0 : (_location$pathname2 = location.pathname) === null || _location$pathname2 === void 0 ? void 0 : _location$pathname2.split(\"previsualizarPropCred/\")[1]) {\n      var _location$pathname3;\n\n      dataSession = {\n        transactionId: atob(location === null || location === void 0 ? void 0 : (_location$pathname3 = location.pathname) === null || _location$pathname3 === void 0 ? void 0 : _location$pathname3.split(\"previsualizarPropCred/\")[1])\n      };\n      sessionStorage.setItem('locationData', JSON.stringify(dataSession));\n    }\n\n    if (location.data !== null && location.data !== undefined) {\n      if (location.data.transactionId === undefined || location.data.transactionId.length <= 0) {\n        //location.data.transactionId = 0;\n        //checkAndCreateProcedure(location.data);\n        history.push(url.URL_DASHBOARD);\n      } else {\n        sessionStorage.setItem('locationData', JSON.stringify(location.data));\n        dataSession = location.data;\n      }\n    } else {\n      //chequeamos si tenemos guardado en session\n      var result = sessionStorage.getItem('locationData');\n\n      if (result !== undefined && result !== null) {\n        result = JSON.parse(result);\n        dataSession = result;\n      }\n    }\n\n    loadFacilities(dataSession);\n  }, []);\n\n  function loadFacilities(dataSession) {\n    api.consultarDeudores(dataSession.transactionId).then(data2 => {\n      if (data2 !== null && data2 !== undefined) {\n        let jsonDeudores = [];\n\n        for (let i = 0; i < data2.length; i++) {\n          jsonDeudores.push({\n            label: data2[i][\"typePerson\"] == \"2\" ? data2[i][\"name\"] : data2[i][\"name\"] + \" \" + data2[i][\"name2\"] + \" \" + data2[i][\"lastName\"] + \" \" + data2[i][\"lastName2\"],\n            value: data2[i][\"personId\"]\n          });\n        } // retrieveProposalType\n\n\n        api.retrieveProposalType().then(propuesta => {\n          // retrieveFacilityType\n          api.retrieveFacilityType().then(facilidad => {\n            // consultarFacilidades\n            api.retrieveSubproposalType().then(async proposalType => {\n              let debtors = await api.consultarDeudores(dataSession.transactionId); // let typeIdent = await api.consultarCatalogoTipoIdentificacion();\n\n              let environmentalRisk = await api.consultEnvironmentalAspectsIGR(dataSession.transactionId);\n              let guarantees = await coreServices.getTipoGarantiaCatalogo();\n              let sureties = await api.retrieveBailType();\n              let requestId = await api.consultGeneralDataPropCred(dataSession === null || dataSession === void 0 ? void 0 : dataSession.transactionId);\n              requestId = requestId[0].requestId;\n              api.consultarFacilidades(requestId).then(async resp => {\n                var _resp;\n\n                if (((_resp = resp) === null || _resp === void 0 ? void 0 : _resp.filter(data => data.debtor != \"  \").length) > 0) {\n                  resp = currencyData.orderByJSON(resp, 'facilityId', 'asc');\n                  console.log(resp);\n                  let rows = [];\n                  let index = 1;\n                  let treasuryCurve = new TreasuryCurve();\n                  await treasuryCurve.initial(dataSession);\n\n                  for (const data of resp) {\n                    var _paymentProgramRows, _disbursementFormRows, _suretiesRows, _commissionRows, _data$amount, _debtor$name, _debtor$name2, _debtor$lastName, _debtor$lastName2, _data$balance, _propuesta$find, _facilidad$find, _proposalType$find, _data$purpose, _data$sublimits, _data$proposalRate, _data$noSubsidyRate, _data$effectiveRate, _guaranteesFacility$r, _data$finantialCondit, _environmentalRisk$en, _environmentalRisk$en2, _data$legalDocumentat, _data$otherConditions;\n\n                    console.log(debtors, data);\n                    let debtor = debtors.find(debtr => debtr.personId === +data.debtor);\n                    let guaranteesFacility = await api.consultarGarantiaPropCred(data.facilityId);\n                    let guaranteesRows = [];\n\n                    for (const guarantee of guaranteesFacility) {\n                      var _guarantees$Records$f, _guarantee$commercial, _guarantee$fastValue;\n\n                      guaranteesRows.push( /*#__PURE__*/_jsxDEV(_Fragment, {\n                        children: [/*#__PURE__*/_jsxDEV(\"tr\", {\n                          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                            children: t(\"Warrant Type\")\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 112,\n                            columnNumber: 73\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            children: guarantees === null || guarantees === void 0 ? void 0 : (_guarantees$Records$f = guarantees.Records.find(x => x.Code === guarantee.guaranteeTypeName)) === null || _guarantees$Records$f === void 0 ? void 0 : _guarantees$Records$f.Description\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 113,\n                            columnNumber: 73\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            children: guarantee.guaranteeSubtypeDesc\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 116,\n                            columnNumber: 73\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            colSpan: \"12\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 119,\n                            columnNumber: 73\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 111,\n                          columnNumber: 69\n                        }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                            children: t(\"CommercialValue\")\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 123,\n                            columnNumber: 73\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            colSpan: \"14\",\n                            children: [\"$\", currencyData.formatTable((_guarantee$commercial = guarantee.commercialValue) !== null && _guarantee$commercial !== void 0 ? _guarantee$commercial : 0)]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 124,\n                            columnNumber: 73\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 122,\n                          columnNumber: 69\n                        }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                            children: t(\"QuickSaleValue\")\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 129,\n                            columnNumber: 73\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            colSpan: \"14\",\n                            children: [\"$\", currencyData.formatTable((_guarantee$fastValue = guarantee.fastValue) !== null && _guarantee$fastValue !== void 0 ? _guarantee$fastValue : 0)]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 130,\n                            columnNumber: 73\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 128,\n                          columnNumber: 69\n                        }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                            children: \"LTV %\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 135,\n                            columnNumber: 73\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            colSpan: \"14\",\n                            children: [currencyData.formatTable(guarantee.ltv), \"%\"]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 136,\n                            columnNumber: 73\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 134,\n                          columnNumber: 69\n                        }, this)]\n                      }, void 0, true));\n                    }\n\n                    let paymentProgramRows = await api.consultListProgramPagoPropCred(data.facilityId);\n                    paymentProgramRows = ((_paymentProgramRows = paymentProgramRows) === null || _paymentProgramRows === void 0 ? void 0 : _paymentProgramRows.length) > 0 ? paymentProgramRows.map(payments => /*#__PURE__*/_jsxDEV(\"tr\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                        children: t(\"PaymentProgram\")\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 146,\n                        columnNumber: 61\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        children: payments.paymentProgram\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 147,\n                        columnNumber: 61\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        children: payments.observations\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 148,\n                        columnNumber: 61\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        colSpan: \"12\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 149,\n                        columnNumber: 61\n                      }, this)]\n                    }, uniq_key(), true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 145,\n                      columnNumber: 147\n                    }, this)) : /*#__PURE__*/_jsxDEV(\"tr\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                        children: t(\"PaymentProgram\")\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 152,\n                        columnNumber: 61\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        colSpan: \"14\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 153,\n                        columnNumber: 61\n                      }, this)]\n                    }, uniq_key(), true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 151,\n                      columnNumber: 67\n                    }, this);\n                    let disbursementFormRows = await api.consultDisbursementListPropCred(data.facilityId);\n                    disbursementFormRows = ((_disbursementFormRows = disbursementFormRows) === null || _disbursementFormRows === void 0 ? void 0 : _disbursementFormRows.length) > 0 ? disbursementFormRows.map(disbursement => /*#__PURE__*/_jsxDEV(\"tr\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                        children: t(\"DisbursementForm\")\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 158,\n                        columnNumber: 61\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        children: disbursement.disbursementTypeId\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 159,\n                        columnNumber: 61\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        children: disbursement.observations\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 160,\n                        columnNumber: 61\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        colSpan: \"12\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 161,\n                        columnNumber: 61\n                      }, this)]\n                    }, uniq_key(), true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 157,\n                      columnNumber: 157\n                    }, this)) : /*#__PURE__*/_jsxDEV(\"tr\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                        children: t(\"DisbursementForm\")\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 164,\n                        columnNumber: 61\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        colSpan: \"14\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 165,\n                        columnNumber: 61\n                      }, this)]\n                    }, uniq_key(), true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 163,\n                      columnNumber: 67\n                    }, this);\n                    let suretiesRows = await api.consultarFianzaPropCred(data.facilityId);\n                    suretiesRows = ((_suretiesRows = suretiesRows) === null || _suretiesRows === void 0 ? void 0 : _suretiesRows.length) > 0 ? suretiesRows.map(suretie => {\n                      var _sureties$find;\n\n                      return suretie.status && /*#__PURE__*/_jsxDEV(\"tr\", {\n                        children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                          children: t(\"Sureties\")\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 171,\n                          columnNumber: 61\n                        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                          children: (_sureties$find = sureties.find(x => x.id === suretie.typeBail)) === null || _sureties$find === void 0 ? void 0 : _sureties$find.description\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 172,\n                          columnNumber: 61\n                        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                          children: suretie.observations\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 173,\n                          columnNumber: 61\n                        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                          colSpan: \"12\"\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 174,\n                          columnNumber: 61\n                        }, this)]\n                      }, uniq_key(), true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 170,\n                        columnNumber: 146\n                      }, this);\n                    }) : /*#__PURE__*/_jsxDEV(\"tr\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                        children: t(\"Sureties\")\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 177,\n                        columnNumber: 61\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        colSpan: \"14\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 178,\n                        columnNumber: 61\n                      }, this)]\n                    }, uniq_key(), true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 176,\n                      columnNumber: 67\n                    }, this);\n                    let commissionRows = await api.consultCommissionPropCred(data.facilityId);\n                    commissionRows = commissionRows.commissions;\n                    console.log(commissionRows);\n                    commissionRows = ((_commissionRows = commissionRows) === null || _commissionRows === void 0 ? void 0 : _commissionRows.length) > 0 ? commissionRows.map(commission => /*#__PURE__*/_jsxDEV(\"tr\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                        children: t(\"Commission\")\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 186,\n                        columnNumber: 61\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        children: commission.comisionType.code\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 187,\n                        columnNumber: 61\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        children: [\"$\", currencyData.format(commission.amount)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 188,\n                        columnNumber: 61\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        colSpan: \"12\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 189,\n                        columnNumber: 61\n                      }, this)]\n                    }, uniq_key(), true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 185,\n                      columnNumber: 137\n                    }, this)) : /*#__PURE__*/_jsxDEV(\"tr\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                        children: t(\"Commission\")\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 192,\n                        columnNumber: 61\n                      }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                        colSpan: \"14\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 193,\n                        columnNumber: 61\n                      }, this)]\n                    }, uniq_key(), true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 191,\n                      columnNumber: 67\n                    }, this);\n                    rows.push(data.debtor != \"  \" ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                      children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n                        children: /*#__PURE__*/_jsxDEV(\"tr\", {\n                          children: [/*#__PURE__*/_jsxDEV(\"th\", {\n                            children: t(\"Number of facilities\")\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 203,\n                            columnNumber: 77\n                          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                            children: t(\"C.R\")\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 204,\n                            columnNumber: 77\n                          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                            children: t(\"Amount\")\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 205,\n                            columnNumber: 77\n                          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                            children: t(\"Debtor\")\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 206,\n                            columnNumber: 77\n                          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n                            children: t(\"Balance\")\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 207,\n                            columnNumber: 77\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 202,\n                          columnNumber: 73\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 201,\n                        columnNumber: 69\n                      }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n                        children: [/*#__PURE__*/_jsxDEV(\"tr\", {\n                          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                            children: index++\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 212,\n                            columnNumber: 77\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            children: data.cr\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 213,\n                            columnNumber: 77\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            children: [\"$\", currencyData.formatTable((_data$amount = data === null || data === void 0 ? void 0 : data.amount) !== null && _data$amount !== void 0 ? _data$amount : 0)]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 214,\n                            columnNumber: 77\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            children: `${(_debtor$name = debtor === null || debtor === void 0 ? void 0 : debtor.name) !== null && _debtor$name !== void 0 ? _debtor$name : ''} ${(_debtor$name2 = debtor === null || debtor === void 0 ? void 0 : debtor.name2) !== null && _debtor$name2 !== void 0 ? _debtor$name2 : ''} ${(_debtor$lastName = debtor === null || debtor === void 0 ? void 0 : debtor.lastName) !== null && _debtor$lastName !== void 0 ? _debtor$lastName : ''} ${(_debtor$lastName2 = debtor === null || debtor === void 0 ? void 0 : debtor.lastName2) !== null && _debtor$lastName2 !== void 0 ? _debtor$lastName2 : ''}`\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 215,\n                            columnNumber: 77\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            children: [\"$\", currencyData.formatTable((_data$balance = data === null || data === void 0 ? void 0 : data.balance) !== null && _data$balance !== void 0 ? _data$balance : 0)]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 216,\n                            columnNumber: 77\n                          }, this)]\n                        }, uniq_key(), true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 211,\n                          columnNumber: 73\n                        }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                            children: t(\"Proposal\")\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 219,\n                            columnNumber: 77\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            colSpan: \"14\",\n                            children: (_propuesta$find = propuesta.find(x => {\n                              var _data$proposedType;\n\n                              return x.id === ((_data$proposedType = data === null || data === void 0 ? void 0 : data.proposedType) !== null && _data$proposedType !== void 0 ? _data$proposedType : data === null || data === void 0 ? void 0 : data.proposalTypeId);\n                            })) === null || _propuesta$find === void 0 ? void 0 : _propuesta$find.description\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 220,\n                            columnNumber: 77\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 218,\n                          columnNumber: 73\n                        }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                            children: t(\"FacilityType\")\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 223,\n                            columnNumber: 77\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            colSpan: \"14\",\n                            children: (_facilidad$find = facilidad.find(x => {\n                              var _data$facilityType;\n\n                              return x.id === ((_data$facilityType = data === null || data === void 0 ? void 0 : data.facilityType) !== null && _data$facilityType !== void 0 ? _data$facilityType : data === null || data === void 0 ? void 0 : data.facilityTypeId);\n                            })) === null || _facilidad$find === void 0 ? void 0 : _facilidad$find.description\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 224,\n                            columnNumber: 77\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 222,\n                          columnNumber: 73\n                        }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                            children: t(\"ProposalSubType\")\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 227,\n                            columnNumber: 77\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            colSpan: \"14\",\n                            children: (_proposalType$find = proposalType.find(x => x.id === (data === null || data === void 0 ? void 0 : data.proposalTypeName))) === null || _proposalType$find === void 0 ? void 0 : _proposalType$find.description\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 228,\n                            columnNumber: 77\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 226,\n                          columnNumber: 73\n                        }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                            children: t(\"Purpose\")\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 231,\n                            columnNumber: 77\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            colSpan: \"14\",\n                            children: (_data$purpose = data.purpose) !== null && _data$purpose !== void 0 ? _data$purpose : ''\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 232,\n                            columnNumber: 77\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 230,\n                          columnNumber: 73\n                        }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                            children: t(\"Sublimit\")\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 235,\n                            columnNumber: 77\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            colSpan: \"14\",\n                            children: (_data$sublimits = data.sublimits) !== null && _data$sublimits !== void 0 ? _data$sublimits : ''\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 236,\n                            columnNumber: 77\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 234,\n                          columnNumber: 73\n                        }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                            children: t(\"Rate\")\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 239,\n                            columnNumber: 77\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            children: [currencyData.formatTable((_data$proposalRate = data === null || data === void 0 ? void 0 : data.proposalRate) !== null && _data$proposalRate !== void 0 ? _data$proposalRate : 0), \"%\"]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 240,\n                            columnNumber: 77\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            colSpan: \"13\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 241,\n                            columnNumber: 77\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 238,\n                          columnNumber: 73\n                        }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                            children: t(\"RateWithoutSubsidy\")\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 246,\n                            columnNumber: 77\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            colSpan: \"14\",\n                            children: [currencyData.formatTable((_data$noSubsidyRate = data === null || data === void 0 ? void 0 : data.noSubsidyRate) !== null && _data$noSubsidyRate !== void 0 ? _data$noSubsidyRate : 0), \"%\"]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 247,\n                            columnNumber: 77\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 245,\n                          columnNumber: 73\n                        }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                            children: t(\"EffectiveRate\")\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 250,\n                            columnNumber: 77\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            colSpan: \"14\",\n                            children: [currencyData.formatTable((_data$effectiveRate = data === null || data === void 0 ? void 0 : data.effectiveRate) !== null && _data$effectiveRate !== void 0 ? _data$effectiveRate : 0), \"%\"]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 251,\n                            columnNumber: 77\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 249,\n                          columnNumber: 73\n                        }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                            children: \"FECI\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 254,\n                            columnNumber: 77\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            colSpan: \"14\",\n                            children: data.feci ? t(\"Yes\") : t(\"No\")\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 255,\n                            columnNumber: 77\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 253,\n                          columnNumber: 73\n                        }, this), commissionRows, /*#__PURE__*/_jsxDEV(\"tr\", {\n                          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                            children: t(\"Term\")\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 263,\n                            columnNumber: 77\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            children: `${data.termDays} ${data.termType}`\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 264,\n                            columnNumber: 77\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            colSpan: \"14\",\n                            children: data.termDescription\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 265,\n                            columnNumber: 77\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 262,\n                          columnNumber: 73\n                        }, this), paymentProgramRows, disbursementFormRows, /*#__PURE__*/_jsxDEV(\"tr\", {\n                          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                            children: /*#__PURE__*/_jsxDEV(\"b\", {\n                              children: t(\"Guarantee\")\n                            }, void 0, false, {\n                              fileName: _jsxFileName,\n                              lineNumber: 273,\n                              columnNumber: 81\n                            }, this)\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 273,\n                            columnNumber: 77\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            colSpan: \"14\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 274,\n                            columnNumber: 77\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 272,\n                          columnNumber: 73\n                        }, this), guaranteesRows, /*#__PURE__*/_jsxDEV(\"tr\", {\n                          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                            children: \"LTV % TOTAL\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 282,\n                            columnNumber: 77\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            colSpan: \"14\",\n                            children: [currencyData.formatTable((_guaranteesFacility$r = guaranteesFacility.reduce((acu, crr) => acu + crr.ltv, 0)) !== null && _guaranteesFacility$r !== void 0 ? _guaranteesFacility$r : 0), \"%\"]\n                          }, void 0, true, {\n                            fileName: _jsxFileName,\n                            lineNumber: 283,\n                            columnNumber: 77\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 281,\n                          columnNumber: 73\n                        }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                            children: t(\"Escrow\")\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 288,\n                            columnNumber: 77\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            colSpan: \"14\",\n                            children: data.applyEscrow ? t(\"Yes\") : t(\"No\")\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 289,\n                            columnNumber: 77\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 287,\n                          columnNumber: 73\n                        }, this), suretiesRows, /*#__PURE__*/_jsxDEV(\"tr\", {\n                          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                            children: t(\"FinancialConditions\")\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 297,\n                            columnNumber: 77\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            colSpan: \"14\",\n                            children: (_data$finantialCondit = data === null || data === void 0 ? void 0 : data.finantialConditions) !== null && _data$finantialCondit !== void 0 ? _data$finantialCondit : \"\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 298,\n                            columnNumber: 77\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 296,\n                          columnNumber: 73\n                        }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                            children: t(\"Environmental and social risk category\")\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 304,\n                            columnNumber: 77\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            colSpan: \"14\",\n                            children: (_environmentalRisk$en = environmentalRisk === null || environmentalRisk === void 0 ? void 0 : (_environmentalRisk$en2 = environmentalRisk.environmentalAspectsDTO) === null || _environmentalRisk$en2 === void 0 ? void 0 : _environmentalRisk$en2.riskClassificationConfirmation) !== null && _environmentalRisk$en !== void 0 ? _environmentalRisk$en : \"\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 305,\n                            columnNumber: 77\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 303,\n                          columnNumber: 73\n                        }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                            children: t(\"Status of Legal Documentation\")\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 310,\n                            columnNumber: 77\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            colSpan: \"14\",\n                            children: (_data$legalDocumentat = data === null || data === void 0 ? void 0 : data.legalDocumentation) !== null && _data$legalDocumentat !== void 0 ? _data$legalDocumentat : \"\"\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 311,\n                            columnNumber: 77\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 309,\n                          columnNumber: 73\n                        }, this), /*#__PURE__*/_jsxDEV(\"tr\", {\n                          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                            children: t(\"OtherConditions\")\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 316,\n                            columnNumber: 77\n                          }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                            colSpan: \"14\",\n                            children: (_data$otherConditions = data === null || data === void 0 ? void 0 : data.otherConditions) !== null && _data$otherConditions !== void 0 ? _data$otherConditions : ''\n                          }, void 0, false, {\n                            fileName: _jsxFileName,\n                            lineNumber: 317,\n                            columnNumber: 77\n                          }, this)]\n                        }, void 0, true, {\n                          fileName: _jsxFileName,\n                          lineNumber: 315,\n                          columnNumber: 73\n                        }, this)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 210,\n                        columnNumber: 69\n                      }, this)]\n                    }, void 0, true) : null);\n                  }\n\n                  setFacilidades(rows);\n                } else {\n                  setFacilidades( /*#__PURE__*/_jsxDEV(\"tr\", {\n                    children: /*#__PURE__*/_jsxDEV(\"td\", {\n                      colSpan: \"7\",\n                      style: {\n                        textAlign: 'center'\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 330,\n                      columnNumber: 61\n                    }, this)\n                  }, 1, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 329,\n                    columnNumber: 57\n                  }, this));\n                }\n              });\n            });\n          });\n        });\n      }\n    });\n  }\n\n  return /*#__PURE__*/_jsxDEV(React.Fragment, {\n    children: /*#__PURE__*/_jsxDEV(Table, {\n      className: \"table table-striped table-hover styled-table table\",\n      children: Facilidades\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 342,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 341,\n    columnNumber: 9\n  }, this);\n};\n\n_s(PreviewFacility, \"zyMApc8KX8PyR9p9B0r1eM9EwS4=\", false, function () {\n  return [useTranslation, useLocation, useHistory];\n});\n\n_c = PreviewFacility;\nexport default PreviewFacility;\n\nvar _c;\n\n$RefreshReg$(_c, \"PreviewFacility\");","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/pages/CommercialCredit/5_PropuestaCredito/Secciones/PreviewFacility.js"],"names":["React","useEffect","useState","PropTypes","translationHelpers","Link","useHistory","useLocation","SweetAlert","Row","Col","Table","Button","ModalNuevaComision","BackendServices","CoreServices","useTranslation","Currency","uniq_key","url","TreasuryCurve","PreviewFacility","props","t","i18n","api","coreServices","currencyData","Facilidades","setFacilidades","termOptions","label","value","location","history","dataSession","console","log","pathname","split","transactionId","atob","sessionStorage","setItem","JSON","stringify","data","undefined","length","push","URL_DASHBOARD","result","getItem","parse","loadFacilities","consultarDeudores","then","data2","jsonDeudores","i","retrieveProposalType","propuesta","retrieveFacilityType","facilidad","retrieveSubproposalType","proposalType","debtors","environmentalRisk","consultEnvironmentalAspectsIGR","guarantees","getTipoGarantiaCatalogo","sureties","retrieveBailType","requestId","consultGeneralDataPropCred","consultarFacilidades","resp","filter","debtor","orderByJSON","rows","index","treasuryCurve","initial","find","debtr","personId","guaranteesFacility","consultarGarantiaPropCred","facilityId","guaranteesRows","guarantee","Records","x","Code","guaranteeTypeName","Description","guaranteeSubtypeDesc","formatTable","commercialValue","fastValue","ltv","paymentProgramRows","consultListProgramPagoPropCred","map","payments","paymentProgram","observations","disbursementFormRows","consultDisbursementListPropCred","disbursement","disbursementTypeId","suretiesRows","consultarFianzaPropCred","suretie","status","id","typeBail","description","commissionRows","consultCommissionPropCred","commissions","commission","comisionType","code","format","amount","cr","name","name2","lastName","lastName2","balance","proposedType","proposalTypeId","facilityType","facilityTypeId","proposalTypeName","purpose","sublimits","proposalRate","noSubsidyRate","effectiveRate","feci","termDays","termType","termDescription","reduce","acu","crr","applyEscrow","finantialConditions","environmentalAspectsDTO","riskClassificationConfirmation","legalDocumentation","otherConditions","textAlign"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\"\r\nimport PropTypes from 'prop-types';\r\nimport { translationHelpers } from '../../../../helpers';\r\nimport { Link, useHistory, useLocation } from \"react-router-dom\"\r\nimport SweetAlert from \"react-bootstrap-sweetalert\"\r\nimport {\r\n    Row,\r\n    Col,\r\n    Table,\r\n    Button,\r\n} from \"reactstrap\"\r\nimport ModalNuevaComision from \"./ModalNuevaComision\";\r\nimport { BackendServices, CoreServices } from \"../../../../services\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport Currency from \"../../../../helpers/currency\"\r\nimport { uniq_key } from \"../../../../helpers/unq_key\";\r\nimport * as url from \"../../../../helpers/url_helper\"\r\nimport TreasuryCurve from \"./treasuryCurve.model\";\r\n\r\n\r\nconst PreviewFacility = (props) => {\r\n    const { t, i18n } = useTranslation();\r\n\r\n    const api = new BackendServices();\r\n    const coreServices = new CoreServices();\r\n    const currencyData = new Currency();\r\n\r\n    const [Facilidades, setFacilidades] = useState(null);\r\n    const termOptions = [{ label: `${t(\"ShortTerm\")}`, value: \"CP\" }, { label: `${t(\"LongTerm\")}`, value: \"LP\" }];\r\n\r\n\r\n    const location = useLocation()\r\n    const history = useHistory();\r\n\r\n    useEffect(() => {\r\n        let dataSession = {};\r\n        console.log(location?.pathname?.split(\"previsualizarPropCred/\")[1])\r\n        if (location?.pathname?.split(\"previsualizarPropCred/\")[1]) {\r\n            dataSession = { transactionId: atob(location?.pathname?.split(\"previsualizarPropCred/\")[1]) };\r\n            sessionStorage.setItem('locationData', JSON.stringify(dataSession));\r\n        }\r\n\r\n        if (location.data !== null && location.data !== undefined) {\r\n            if (location.data.transactionId === undefined || location.data.transactionId.length <= 0) {\r\n                //location.data.transactionId = 0;\r\n                //checkAndCreateProcedure(location.data);\r\n                history.push(url.URL_DASHBOARD);\r\n            }\r\n            else {\r\n                sessionStorage.setItem('locationData', JSON.stringify(location.data));\r\n                dataSession = location.data;\r\n            }\r\n        }\r\n        else {\r\n            //chequeamos si tenemos guardado en session\r\n            var result = sessionStorage.getItem('locationData');\r\n            if (result !== undefined && result !== null) {\r\n                result = JSON.parse(result);\r\n                dataSession = result;\r\n            }\r\n        }\r\n        loadFacilities(dataSession)\r\n    }, [])\r\n    function loadFacilities(dataSession) {\r\n        api.consultarDeudores(dataSession.transactionId)\r\n            .then((data2) => {\r\n                if (data2 !== null && data2 !== undefined) {\r\n                    let jsonDeudores = [];\r\n                    for (let i = 0; i < data2.length; i++) {\r\n                        jsonDeudores.push({ label: data2[i][\"typePerson\"] == \"2\" ? data2[i][\"name\"] : data2[i][\"name\"] + \" \" + data2[i][\"name2\"] + \" \" + data2[i][\"lastName\"] + \" \" + data2[i][\"lastName2\"], value: data2[i][\"personId\"] })\r\n                    }\r\n                    // retrieveProposalType\r\n                    api.retrieveProposalType()\r\n                        .then((propuesta) => {\r\n                            // retrieveFacilityType\r\n                            api.retrieveFacilityType()\r\n                                .then((facilidad) => {\r\n                                    // consultarFacilidades\r\n                                    api.retrieveSubproposalType()\r\n                                        .then(async (proposalType) => {\r\n                                            let debtors = await api.consultarDeudores(dataSession.transactionId);\r\n                                            // let typeIdent = await api.consultarCatalogoTipoIdentificacion();\r\n                                            let environmentalRisk = await api.consultEnvironmentalAspectsIGR(dataSession.transactionId)\r\n                                            let guarantees = await coreServices.getTipoGarantiaCatalogo();\r\n                                            let sureties = await api.retrieveBailType();\r\n                                            let requestId = await api.consultGeneralDataPropCred(dataSession?.transactionId)\r\n                                            requestId = requestId[0].requestId;\r\n                                            api.consultarFacilidades(requestId).then(async resp => {\r\n                                                if (resp?.filter(data => data.debtor != \"  \").length > 0) {\r\n                                                    resp = currencyData.orderByJSON(resp, 'facilityId', 'asc')\r\n                                                    console.log(resp)\r\n\r\n                                                    let rows = [];\r\n                                                    let index = 1;\r\n\r\n                                                    let treasuryCurve = new TreasuryCurve();\r\n                                                    await treasuryCurve.initial(dataSession)\r\n\r\n                                                    for (const data of resp) {\r\n                                                        console.log(debtors, data)\r\n                                                        let debtor = debtors.find(debtr => debtr.personId === (+data.debtor));\r\n\r\n                                                        let guaranteesFacility = await api.consultarGarantiaPropCred(data.facilityId);\r\n\r\n                                                        let guaranteesRows = [];\r\n\r\n                                                        for (const guarantee of guaranteesFacility) {\r\n\r\n                                                            guaranteesRows.push(\r\n                                                                <>\r\n                                                                    <tr>\r\n                                                                        <td>{t(\"Warrant Type\")}</td>\r\n                                                                        <td>\r\n                                                                            {guarantees?.Records.find(x => x.Code === guarantee.guaranteeTypeName)?.Description}\r\n                                                                        </td>\r\n                                                                        <td>\r\n                                                                            {guarantee.guaranteeSubtypeDesc}\r\n                                                                        </td>\r\n                                                                        <td colSpan=\"12\">\r\n                                                                        </td>\r\n                                                                    </tr>\r\n                                                                    <tr>\r\n                                                                        <td>{t(\"CommercialValue\")}</td>\r\n                                                                        <td colSpan=\"14\">\r\n                                                                            ${currencyData.formatTable(guarantee.commercialValue ?? 0)}\r\n                                                                        </td>\r\n                                                                    </tr>\r\n                                                                    <tr>\r\n                                                                        <td>{t(\"QuickSaleValue\")}</td>\r\n                                                                        <td colSpan=\"14\">\r\n                                                                            ${currencyData.formatTable(guarantee.fastValue ?? 0)}\r\n                                                                        </td>\r\n                                                                    </tr>\r\n                                                                    <tr>\r\n                                                                        <td>LTV %</td>\r\n                                                                        <td colSpan=\"14\">\r\n                                                                            {currencyData.formatTable(guarantee.ltv)}%\r\n                                                                        </td>\r\n                                                                    </tr>\r\n                                                                </>\r\n                                                            )\r\n                                                        }\r\n\r\n                                                        let paymentProgramRows = await api.consultListProgramPagoPropCred(data.facilityId);\r\n                                                        paymentProgramRows = paymentProgramRows?.length > 0 ? paymentProgramRows.map(payments => (<tr key={uniq_key()}>\r\n                                                            <td>{t(\"PaymentProgram\")}</td>\r\n                                                            <td>{payments.paymentProgram}</td>\r\n                                                            <td>{payments.observations}</td>\r\n                                                            <td colSpan=\"12\">\r\n                                                            </td>\r\n                                                        </tr>)) : <tr key={uniq_key()}>\r\n                                                            <td>{t(\"PaymentProgram\")}</td>\r\n                                                            <td colSpan=\"14\">\r\n                                                            </td>\r\n                                                        </tr>;\r\n                                                        let disbursementFormRows = await api.consultDisbursementListPropCred(data.facilityId);\r\n                                                        disbursementFormRows = disbursementFormRows?.length > 0 ? disbursementFormRows.map(disbursement => (<tr key={uniq_key()}>\r\n                                                            <td>{t(\"DisbursementForm\")}</td>\r\n                                                            <td>{disbursement.disbursementTypeId}</td>\r\n                                                            <td>{disbursement.observations}</td>\r\n                                                            <td colSpan=\"12\">\r\n                                                            </td>\r\n                                                        </tr>)) : <tr key={uniq_key()}>\r\n                                                            <td>{t(\"DisbursementForm\")}</td>\r\n                                                            <td colSpan=\"14\">\r\n                                                            </td>\r\n                                                        </tr>;\r\n\r\n                                                        let suretiesRows = await api.consultarFianzaPropCred(data.facilityId);\r\n                                                        suretiesRows = suretiesRows?.length > 0 ? suretiesRows.map(suretie => suretie.status && (<tr key={uniq_key()}>\r\n                                                            <td>{t(\"Sureties\")}</td>\r\n                                                            <td>{sureties.find(x => x.id === suretie.typeBail)?.description}</td>\r\n                                                            <td>{suretie.observations}</td>\r\n                                                            <td colSpan=\"12\">\r\n                                                            </td>\r\n                                                        </tr>)) : <tr key={uniq_key()}>\r\n                                                            <td>{t(\"Sureties\")}</td>\r\n                                                            <td colSpan=\"14\">\r\n                                                            </td>\r\n                                                        </tr>;\r\n\r\n                                                        let commissionRows = await api.consultCommissionPropCred(data.facilityId);\r\n                                                        commissionRows = commissionRows.commissions;\r\n                                                        console.log(commissionRows)\r\n                                                        commissionRows = commissionRows?.length > 0 ? commissionRows.map(commission => (<tr key={uniq_key()}>\r\n                                                            <td>{t(\"Commission\")}</td>\r\n                                                            <td>{commission.comisionType.code}</td>\r\n                                                            <td>${currencyData.format(commission.amount)}</td>\r\n                                                            <td colSpan=\"12\">\r\n                                                            </td>\r\n                                                        </tr>)) : <tr key={uniq_key()}>\r\n                                                            <td>{t(\"Commission\")}</td>\r\n                                                            <td colSpan=\"14\">\r\n                                                            </td>\r\n                                                        </tr>;\r\n\r\n\r\n                                                        rows.push((\r\n                                                            data.debtor != \"  \" ?\r\n                                                                <>\r\n                                                                    <thead >\r\n                                                                        <tr>\r\n                                                                            <th>{t(\"Number of facilities\")}</th>\r\n                                                                            <th>{t(\"C.R\")}</th>\r\n                                                                            <th>{t(\"Amount\")}</th>\r\n                                                                            <th>{t(\"Debtor\")}</th>\r\n                                                                            <th>{t(\"Balance\")}</th>\r\n                                                                        </tr>\r\n                                                                    </thead>\r\n                                                                    <tbody>\r\n                                                                        <tr key={uniq_key()}>\r\n                                                                            <td>{index++}</td>\r\n                                                                            <td>{data.cr}</td>\r\n                                                                            <td>${currencyData.formatTable(data?.amount ?? 0)}</td>\r\n                                                                            <td>{`${debtor?.name ?? ''} ${debtor?.name2 ?? ''} ${debtor?.lastName ?? ''} ${debtor?.lastName2 ?? ''}`}</td>\r\n                                                                            <td>${currencyData.formatTable(data?.balance ?? 0)}</td>\r\n                                                                        </tr>\r\n                                                                        <tr>\r\n                                                                            <td>{t(\"Proposal\")}</td>\r\n                                                                            <td colSpan=\"14\">{propuesta.find(x => x.id === (data?.proposedType ?? data?.proposalTypeId))?.description}</td>\r\n                                                                        </tr>\r\n                                                                        <tr>\r\n                                                                            <td>{t(\"FacilityType\")}</td>\r\n                                                                            <td colSpan=\"14\">{facilidad.find(x => x.id === (data?.facilityType ?? data?.facilityTypeId))?.description}</td>\r\n                                                                        </tr>\r\n                                                                        <tr>\r\n                                                                            <td>{t(\"ProposalSubType\")}</td>\r\n                                                                            <td colSpan=\"14\">{proposalType.find(x => x.id === data?.proposalTypeName)?.description}</td>\r\n                                                                        </tr>\r\n                                                                        <tr>\r\n                                                                            <td>{t(\"Purpose\")}</td>\r\n                                                                            <td colSpan=\"14\">{data.purpose ?? ''}</td>\r\n                                                                        </tr>\r\n                                                                        <tr>\r\n                                                                            <td>{t(\"Sublimit\")}</td>\r\n                                                                            <td colSpan=\"14\">{data.sublimits ?? ''}</td>\r\n                                                                        </tr>\r\n                                                                        <tr>\r\n                                                                            <td>{t(\"Rate\")}</td>\r\n                                                                            <td >{currencyData.formatTable(data?.proposalRate ?? 0)}%</td>\r\n                                                                            <td colSpan=\"13\">\r\n                                                                                {/*+data?.proposalRate < +(treasuryCurve.showTreasuryCurve({ proposalRate: data?.proposalRate, termType: data?.termType })?.Description ?? 0) && <div className=\"text-danger\">{t(\"Lower Proposal Rate than Treasury Curve\")}</div>*/}\r\n                                                                            </td>\r\n                                                                        </tr>\r\n                                                                        <tr>\r\n                                                                            <td>{t(\"RateWithoutSubsidy\")}</td>\r\n                                                                            <td colSpan=\"14\">{currencyData.formatTable(data?.noSubsidyRate ?? 0)}%</td>\r\n                                                                        </tr>\r\n                                                                        <tr>\r\n                                                                            <td>{t(\"EffectiveRate\")}</td>\r\n                                                                            <td colSpan=\"14\">{currencyData.formatTable(data?.effectiveRate ?? 0)}%</td>\r\n                                                                        </tr>\r\n                                                                        <tr>\r\n                                                                            <td>FECI</td>\r\n                                                                            <td colSpan=\"14\">\r\n                                                                                {data.feci ? t(\"Yes\") : t(\"No\")}\r\n                                                                            </td>\r\n                                                                        </tr>\r\n\r\n                                                                        {commissionRows}\r\n\r\n                                                                        <tr>\r\n                                                                            <td>{t(\"Term\")}</td>\r\n                                                                            <td>{`${data.termDays} ${data.termType}`}</td>\r\n                                                                            <td colSpan=\"14\">{data.termDescription}</td>\r\n                                                                        </tr>\r\n\r\n                                                                        {paymentProgramRows}\r\n\r\n                                                                        {disbursementFormRows}\r\n\r\n                                                                        <tr>\r\n                                                                            <td><b>{t(\"Guarantee\")}</b></td>\r\n                                                                            <td colSpan=\"14\">\r\n\r\n                                                                            </td>\r\n                                                                        </tr>\r\n\r\n                                                                        {guaranteesRows}\r\n\r\n                                                                        <tr>\r\n                                                                            <td>LTV % TOTAL</td>\r\n                                                                            <td colSpan=\"14\">\r\n                                                                                {currencyData.formatTable(guaranteesFacility.reduce((acu, crr) => acu + crr.ltv, 0) ?? 0)}%\r\n                                                                            </td>\r\n                                                                        </tr>\r\n                                                                        <tr>\r\n                                                                            <td>{t(\"Escrow\")}</td>\r\n                                                                            <td colSpan=\"14\">\r\n                                                                                {data.applyEscrow ? t(\"Yes\") : t(\"No\")}\r\n                                                                            </td>\r\n                                                                        </tr>\r\n\r\n                                                                        {suretiesRows}\r\n\r\n                                                                        <tr>\r\n                                                                            <td>{t(\"FinancialConditions\")}</td>\r\n                                                                            <td colSpan=\"14\">\r\n                                                                                {data?.finantialConditions ?? \"\"}\r\n                                                                            </td>\r\n                                                                        </tr>\r\n\r\n                                                                        <tr>\r\n                                                                            <td>{t(\"Environmental and social risk category\")}</td>\r\n                                                                            <td colSpan=\"14\">\r\n                                                                                {environmentalRisk?.environmentalAspectsDTO?.riskClassificationConfirmation ?? \"\"}\r\n                                                                            </td>\r\n                                                                        </tr>\r\n                                                                        <tr>\r\n                                                                            <td>{t(\"Status of Legal Documentation\")}</td>\r\n                                                                            <td colSpan=\"14\">\r\n                                                                                {data?.legalDocumentation ?? \"\"}\r\n                                                                            </td>\r\n                                                                        </tr>\r\n                                                                        <tr>\r\n                                                                            <td>{t(\"OtherConditions\")}</td>\r\n                                                                            <td colSpan=\"14\">\r\n                                                                                {data?.otherConditions ?? ''}\r\n                                                                            </td>\r\n                                                                        </tr>\r\n                                                                    </tbody>\r\n                                                                </>\r\n                                                                : null))\r\n                                                    }\r\n                                                    setFacilidades(rows);\r\n\r\n                                                } else {\r\n                                                    setFacilidades(\r\n                                                        <tr key={1}>\r\n                                                            <td colSpan=\"7\" style={{ textAlign: 'center' }}></td>\r\n                                                        </tr>);\r\n                                                }\r\n                                            });\r\n                                        });\r\n                                })\r\n                        })\r\n                }\r\n            })\r\n    }\r\n    return (\r\n        <React.Fragment>\r\n            <Table className=\"table table-striped table-hover styled-table table\" >\r\n                {Facilidades}\r\n            </Table>\r\n        </React.Fragment>\r\n    );\r\n};\r\n\r\nexport default PreviewFacility;\r\n"]},"metadata":{},"sourceType":"module"}