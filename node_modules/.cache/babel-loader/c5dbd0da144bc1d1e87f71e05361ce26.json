{"ast":null,"code":"import _regeneratorRuntime from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _createForOfIteratorHelper from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _asyncToGenerator from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import{translationHelpers}from'../../../../helpers';import{Link,useHistory,useLocation}from\"react-router-dom\";import SweetAlert from\"react-bootstrap-sweetalert\";import{Row,Col,Table,Button}from\"reactstrap\";import ModalNuevaComision from\"./ModalNuevaComision\";import{BackendServices,CoreServices}from\"../../../../services\";import{useTranslation}from\"react-i18next\";import Currency from\"../../../../helpers/currency\";import{uniq_key}from\"../../../../helpers/unq_key\";import*as url from\"../../../../helpers/url_helper\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var PreviewFacility=function PreviewFacility(props){var _useTranslation=useTranslation(),t=_useTranslation.t,i18n=_useTranslation.i18n;var api=new BackendServices();var coreServices=new CoreServices();var currencyData=new Currency();var _useState=useState(null),_useState2=_slicedToArray(_useState,2),Facilidades=_useState2[0],setFacilidades=_useState2[1];var termOptions=[{label:\"\".concat(t(\"ShortTerm\")),value:\"CP\"},{label:\"\".concat(t(\"LongTerm\")),value:\"LP\"}];var location=useLocation();var history=useHistory();useEffect(function(){var _location$pathname,_location$pathname2;var dataSession={};console.log(location===null||location===void 0?void 0:(_location$pathname=location.pathname)===null||_location$pathname===void 0?void 0:_location$pathname.split(\"previsualizarPropCred/\")[1]);if(location===null||location===void 0?void 0:(_location$pathname2=location.pathname)===null||_location$pathname2===void 0?void 0:_location$pathname2.split(\"previsualizarPropCred/\")[1]){var _location$pathname3;dataSession={transactionId:atob(location===null||location===void 0?void 0:(_location$pathname3=location.pathname)===null||_location$pathname3===void 0?void 0:_location$pathname3.split(\"previsualizarPropCred/\")[1])};sessionStorage.setItem('locationData',JSON.stringify(dataSession));}if(location.data!==null&&location.data!==undefined){if(location.data.transactionId===undefined||location.data.transactionId.length<=0){//location.data.transactionId = 0;\n//checkAndCreateProcedure(location.data);\nhistory.push(url.URL_DASHBOARD);}else{sessionStorage.setItem('locationData',JSON.stringify(location.data));dataSession=location.data;}}else{//chequeamos si tenemos guardado en session\nvar result=sessionStorage.getItem('locationData');if(result!==undefined&&result!==null){result=JSON.parse(result);dataSession=result;}}loadFacilities(dataSession);},[]);function loadFacilities(dataSession){api.consultarDeudores(dataSession.transactionId).then(function(data2){if(data2!==null&&data2!==undefined){var jsonDeudores=[];for(var i=0;i<data2.length;i++){jsonDeudores.push({label:data2[i][\"typePerson\"]==\"2\"?data2[i][\"name\"]:data2[i][\"name\"]+\" \"+data2[i][\"name2\"]+\" \"+data2[i][\"lastName\"]+\" \"+data2[i][\"lastName2\"],value:data2[i][\"personId\"]});}// retrieveProposalType\napi.retrieveProposalType().then(function(propuesta){// retrieveFacilityType\napi.retrieveFacilityType().then(function(facilidad){// consultarFacilidades\napi.retrieveSubproposalType().then(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(proposalType){var debtors,typeIdent,environmentalRisk,guarantees,sureties,requestId;return _regeneratorRuntime.wrap(function _callee2$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return api.consultarDeudores(dataSession.transactionId);case 2:debtors=_context3.sent;_context3.next=5;return api.consultarCatalogoTipoIdentificacion();case 5:typeIdent=_context3.sent;_context3.next=8;return api.consultEnvironmentalAspectsIGR(dataSession.transactionId);case 8:environmentalRisk=_context3.sent;_context3.next=11;return coreServices.getTipoGarantiaCatalogo();case 11:guarantees=_context3.sent;_context3.next=14;return api.retrieveBailType();case 14:sureties=_context3.sent;_context3.next=17;return api.consultGeneralDataPropCred(dataSession===null||dataSession===void 0?void 0:dataSession.transactionId);case 17:requestId=_context3.sent;requestId=requestId[0].requestId;console.log(requestId);api.consultarFacilidades(requestId).then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(resp){var _resp;var rows,index,_iterator,_step,_loop;return _regeneratorRuntime.wrap(function _callee$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(((_resp=resp)===null||_resp===void 0?void 0:_resp.filter(function(data){return data.debtor!=\"  \";}).length)>0)){_context2.next=24;break;}resp=currencyData.orderByJSON(resp,'facilityId','asc');console.log(resp);rows=[];index=1;_iterator=_createForOfIteratorHelper(resp);_context2.prev=6;_loop=/*#__PURE__*/_regeneratorRuntime.mark(function _loop(){var _jsonDeudores$find,_typeIdent$find$descr,_typeIdent$find,_paymentProgramRows,_disbursementFormRows,_suretiesRows,_commissionRows,_data$amount,_debtor$name,_debtor$name2,_debtor$lastName,_debtor$lastName2,_data$balance,_propuesta$find,_facilidad$find,_proposalType$find,_data$purpose,_data$sublimits,_data$proposalRate,_data$noSubsidyRate,_data$effectiveRate,_guaranteesFacility$r,_data$finantialCondit,_environmentalRisk$en,_environmentalRisk$en2,_data$legalDocumentat,_data$otherConditions;var data,debtor0,debtor,identification,guaranteesFacility,guaranteesRows,_iterator2,_step2,_loop2,paymentProgramRows,disbursementFormRows,suretiesRows,commissionRows;return _regeneratorRuntime.wrap(function _loop$(_context){while(1){switch(_context.prev=_context.next){case 0:data=_step.value;debtor0=(_jsonDeudores$find=jsonDeudores.find(function(x){return x.value===Number(data.debtor);}))===null||_jsonDeudores$find===void 0?void 0:_jsonDeudores$find.label;debtor=debtors.find(function(debtr){var _debtr$name,_debtr$lastName,_debtr$lastName2;return debtr.name+(((_debtr$name=debtr.name2)===null||_debtr$name===void 0?void 0:_debtr$name.length)>0?' '+debtr.name2:'')+(((_debtr$lastName=debtr.lastName)===null||_debtr$lastName===void 0?void 0:_debtr$lastName.length)>0?' '+debtr.lastName:'')+(((_debtr$lastName2=debtr.lastName2)===null||_debtr$lastName2===void 0?void 0:_debtr$lastName2.length)>0?' '+debtr.lastName2:'')===debtor0;});identification=(_typeIdent$find$descr=(_typeIdent$find=typeIdent.find(function(identification){return identification.id===(debtor===null||debtor===void 0?void 0:debtor.idType);}))===null||_typeIdent$find===void 0?void 0:_typeIdent$find.description)!==null&&_typeIdent$find$descr!==void 0?_typeIdent$find$descr:'';_context.next=6;return api.consultarGarantiaPropCred(data.facilityId);case 6:guaranteesFacility=_context.sent;guaranteesRows=[];_iterator2=_createForOfIteratorHelper(guaranteesFacility);try{_loop2=function _loop2(){var _guarantees$Records$f,_guarantee$commercial,_guarantee$fastValue;var guarantee=_step2.value;guaranteesRows.push(/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:t(\"Warrant Type\")}),/*#__PURE__*/_jsx(\"td\",{children:guarantees===null||guarantees===void 0?void 0:(_guarantees$Records$f=guarantees.Records.find(function(x){return x.Code===guarantee.guaranteeTypeName;}))===null||_guarantees$Records$f===void 0?void 0:_guarantees$Records$f.Description}),/*#__PURE__*/_jsx(\"td\",{children:guarantee.guaranteeSubtypeDesc}),/*#__PURE__*/_jsx(\"td\",{colSpan:\"12\"})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:t(\"CommercialValue\")}),/*#__PURE__*/_jsxs(\"td\",{colSpan:\"14\",children:[\"$\",currencyData.formatTable((_guarantee$commercial=guarantee.commercialValue)!==null&&_guarantee$commercial!==void 0?_guarantee$commercial:0)]})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:t(\"QuickSaleValue\")}),/*#__PURE__*/_jsxs(\"td\",{colSpan:\"14\",children:[\"$\",currencyData.formatTable((_guarantee$fastValue=guarantee.fastValue)!==null&&_guarantee$fastValue!==void 0?_guarantee$fastValue:0)]})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\"LTV %\"}),/*#__PURE__*/_jsxs(\"td\",{colSpan:\"14\",children:[currencyData.formatTable(guarantee.ltv),\"%\"]})]})]}));};for(_iterator2.s();!(_step2=_iterator2.n()).done;){_loop2();}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}_context.next=12;return api.consultListProgramPagoPropCred(data.facilityId);case 12:paymentProgramRows=_context.sent;paymentProgramRows=((_paymentProgramRows=paymentProgramRows)===null||_paymentProgramRows===void 0?void 0:_paymentProgramRows.length)>0?paymentProgramRows.map(function(payments){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:t(\"PaymentProgram\")}),/*#__PURE__*/_jsx(\"td\",{children:payments.paymentProgram}),/*#__PURE__*/_jsx(\"td\",{children:payments.observations}),/*#__PURE__*/_jsx(\"td\",{colSpan:\"12\"})]},uniq_key());}):/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:t(\"PaymentProgram\")}),/*#__PURE__*/_jsx(\"td\",{colSpan:\"14\"})]},uniq_key());_context.next=16;return api.consultDisbursementListPropCred(data.facilityId);case 16:disbursementFormRows=_context.sent;disbursementFormRows=((_disbursementFormRows=disbursementFormRows)===null||_disbursementFormRows===void 0?void 0:_disbursementFormRows.length)>0?disbursementFormRows.map(function(disbursement){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:t(\"DisbursementForm\")}),/*#__PURE__*/_jsx(\"td\",{children:disbursement.disbursementTypeId}),/*#__PURE__*/_jsx(\"td\",{children:disbursement.observations}),/*#__PURE__*/_jsx(\"td\",{colSpan:\"12\"})]},uniq_key());}):/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:t(\"DisbursementForm\")}),/*#__PURE__*/_jsx(\"td\",{colSpan:\"14\"})]},uniq_key());_context.next=20;return api.consultarFianzaPropCred(data.facilityId);case 20:suretiesRows=_context.sent;suretiesRows=((_suretiesRows=suretiesRows)===null||_suretiesRows===void 0?void 0:_suretiesRows.length)>0?suretiesRows.map(function(suretie){var _sureties$find;return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:t(\"Sureties\")}),/*#__PURE__*/_jsx(\"td\",{children:(_sureties$find=sureties.find(function(x){return x.id===suretie.typeBail;}))===null||_sureties$find===void 0?void 0:_sureties$find.description}),/*#__PURE__*/_jsx(\"td\",{colSpan:\"13\"})]},uniq_key());}):/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:t(\"Sureties\")}),/*#__PURE__*/_jsx(\"td\",{colSpan:\"14\"})]},uniq_key());_context.next=24;return api.consultCommissionPropCred(data.facilityId);case 24:commissionRows=_context.sent;commissionRows=commissionRows.commissions;console.log(commissionRows);commissionRows=((_commissionRows=commissionRows)===null||_commissionRows===void 0?void 0:_commissionRows.length)>0?commissionRows.map(function(commission){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:t(\"Commission\")}),/*#__PURE__*/_jsx(\"td\",{children:commission.comisionType.code}),/*#__PURE__*/_jsxs(\"td\",{children:[\"$\",currencyData.format(commission.amount)]}),/*#__PURE__*/_jsx(\"td\",{colSpan:\"12\"})]},uniq_key());}):/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:t(\"Commission\")}),/*#__PURE__*/_jsx(\"td\",{colSpan:\"14\"})]},uniq_key());rows.push(data.debtor!=\"  \"?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:t(\"Number of facilities\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"C.R\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"Amount\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"Debtor\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"Balance\")})]})}),/*#__PURE__*/_jsxs(\"tbody\",{children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:index++}),/*#__PURE__*/_jsx(\"td\",{children:data.cr}),/*#__PURE__*/_jsxs(\"td\",{children:[\"$\",currencyData.formatTable((_data$amount=data===null||data===void 0?void 0:data.amount)!==null&&_data$amount!==void 0?_data$amount:0)]}),/*#__PURE__*/_jsx(\"td\",{children:\"\".concat((_debtor$name=debtor===null||debtor===void 0?void 0:debtor.name)!==null&&_debtor$name!==void 0?_debtor$name:'',\" \").concat((_debtor$name2=debtor===null||debtor===void 0?void 0:debtor.name2)!==null&&_debtor$name2!==void 0?_debtor$name2:'',\" \").concat((_debtor$lastName=debtor===null||debtor===void 0?void 0:debtor.lastName)!==null&&_debtor$lastName!==void 0?_debtor$lastName:'',\" \").concat((_debtor$lastName2=debtor===null||debtor===void 0?void 0:debtor.lastName2)!==null&&_debtor$lastName2!==void 0?_debtor$lastName2:'')}),/*#__PURE__*/_jsxs(\"td\",{children:[\"$\",currencyData.formatTable((_data$balance=data===null||data===void 0?void 0:data.balance)!==null&&_data$balance!==void 0?_data$balance:0)]})]},uniq_key()),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:t(\"Proposal\")}),/*#__PURE__*/_jsx(\"td\",{colSpan:\"14\",children:(_propuesta$find=propuesta.find(function(x){var _data$proposedType;return x.id===((_data$proposedType=data===null||data===void 0?void 0:data.proposedType)!==null&&_data$proposedType!==void 0?_data$proposedType:data===null||data===void 0?void 0:data.proposalTypeId);}))===null||_propuesta$find===void 0?void 0:_propuesta$find.description})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:t(\"FacilityType\")}),/*#__PURE__*/_jsx(\"td\",{colSpan:\"14\",children:(_facilidad$find=facilidad.find(function(x){var _data$facilityType;return x.id===((_data$facilityType=data===null||data===void 0?void 0:data.facilityType)!==null&&_data$facilityType!==void 0?_data$facilityType:data===null||data===void 0?void 0:data.facilityTypeId);}))===null||_facilidad$find===void 0?void 0:_facilidad$find.description})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:t(\"ProposalSubType\")}),/*#__PURE__*/_jsx(\"td\",{colSpan:\"14\",children:(_proposalType$find=proposalType.find(function(x){return x.id===(data===null||data===void 0?void 0:data.proposalTypeName);}))===null||_proposalType$find===void 0?void 0:_proposalType$find.description})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:t(\"Purpose\")}),/*#__PURE__*/_jsx(\"td\",{colSpan:\"14\",children:(_data$purpose=data.purpose)!==null&&_data$purpose!==void 0?_data$purpose:''})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:t(\"Sublimit\")}),/*#__PURE__*/_jsx(\"td\",{colSpan:\"14\",children:(_data$sublimits=data.sublimits)!==null&&_data$sublimits!==void 0?_data$sublimits:''})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:t(\"Rate\")}),/*#__PURE__*/_jsxs(\"td\",{colSpan:\"14\",children:[currencyData.formatTable((_data$proposalRate=data===null||data===void 0?void 0:data.proposalRate)!==null&&_data$proposalRate!==void 0?_data$proposalRate:0),\"%\"]})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:t(\"RateWithoutSubsidy\")}),/*#__PURE__*/_jsxs(\"td\",{colSpan:\"14\",children:[currencyData.formatTable((_data$noSubsidyRate=data===null||data===void 0?void 0:data.noSubsidyRate)!==null&&_data$noSubsidyRate!==void 0?_data$noSubsidyRate:0),\"%\"]})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:t(\"EffectiveRate\")}),/*#__PURE__*/_jsxs(\"td\",{colSpan:\"14\",children:[currencyData.formatTable((_data$effectiveRate=data===null||data===void 0?void 0:data.effectiveRate)!==null&&_data$effectiveRate!==void 0?_data$effectiveRate:0),\"%\"]})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\"FECI\"}),/*#__PURE__*/_jsx(\"td\",{colSpan:\"14\",children:data.feci?t(\"Yes\"):t(\"No\")})]}),commissionRows,/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:t(\"Term\")}),/*#__PURE__*/_jsx(\"td\",{children:\"\".concat(data.termDays,\" \").concat(data.termType)}),/*#__PURE__*/_jsx(\"td\",{colSpan:\"14\",children:data.termDescription})]}),paymentProgramRows,disbursementFormRows,/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"b\",{children:t(\"Guarantee\")})}),/*#__PURE__*/_jsx(\"td\",{colSpan:\"14\"})]}),guaranteesRows,/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\"LTV % TOTAL\"}),/*#__PURE__*/_jsxs(\"td\",{colSpan:\"14\",children:[currencyData.formatTable((_guaranteesFacility$r=guaranteesFacility.reduce(function(acu,crr){return acu+crr.ltv;},0))!==null&&_guaranteesFacility$r!==void 0?_guaranteesFacility$r:0),\"%\"]})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:t(\"Escrow\")}),/*#__PURE__*/_jsx(\"td\",{colSpan:\"14\",children:data.applyEscrow?t(\"Yes\"):t(\"No\")})]}),suretiesRows,/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:t(\"FinancialConditions\")}),/*#__PURE__*/_jsx(\"td\",{colSpan:\"14\",children:(_data$finantialCondit=data===null||data===void 0?void 0:data.finantialConditions)!==null&&_data$finantialCondit!==void 0?_data$finantialCondit:\"\"})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:t(\"Environmental and social risk category\")}),/*#__PURE__*/_jsx(\"td\",{colSpan:\"14\",children:(_environmentalRisk$en=environmentalRisk===null||environmentalRisk===void 0?void 0:(_environmentalRisk$en2=environmentalRisk.environmentalAspectsDTO)===null||_environmentalRisk$en2===void 0?void 0:_environmentalRisk$en2.riskClassificationConfirmation)!==null&&_environmentalRisk$en!==void 0?_environmentalRisk$en:\"\"})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:t(\"Status of Legal Documentation\")}),/*#__PURE__*/_jsx(\"td\",{colSpan:\"14\",children:(_data$legalDocumentat=data===null||data===void 0?void 0:data.legalDocumentation)!==null&&_data$legalDocumentat!==void 0?_data$legalDocumentat:\"\"})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:t(\"OtherConditions\")}),/*#__PURE__*/_jsx(\"td\",{colSpan:\"14\",children:(_data$otherConditions=data===null||data===void 0?void 0:data.otherConditions)!==null&&_data$otherConditions!==void 0?_data$otherConditions:''})]})]})]}):null);case 29:case\"end\":return _context.stop();}}},_loop);});_iterator.s();case 9:if((_step=_iterator.n()).done){_context2.next=13;break;}return _context2.delegateYield(_loop(),\"t0\",11);case 11:_context2.next=9;break;case 13:_context2.next=18;break;case 15:_context2.prev=15;_context2.t1=_context2[\"catch\"](6);_iterator.e(_context2.t1);case 18:_context2.prev=18;_iterator.f();return _context2.finish(18);case 21:setFacilidades(rows);_context2.next=25;break;case 24:setFacilidades(/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"7\",style:{textAlign:'center'}})},1));case 25:case\"end\":return _context2.stop();}}},_callee,null,[[6,15,18,21]]);}));return function(_x2){return _ref2.apply(this,arguments);};}());case 21:case\"end\":return _context3.stop();}}},_callee2);}));return function(_x){return _ref.apply(this,arguments);};}());});});}});}return/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsx(Table,{className:\"table table-striped table-hover styled-table table\",children:Facilidades})});};export default PreviewFacility;","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/pages/CommercialCredit/5_PropuestaCredito/Secciones/PreviewFacility.js"],"names":["React","useEffect","useState","translationHelpers","Link","useHistory","useLocation","SweetAlert","Row","Col","Table","Button","ModalNuevaComision","BackendServices","CoreServices","useTranslation","Currency","uniq_key","url","PreviewFacility","props","t","i18n","api","coreServices","currencyData","Facilidades","setFacilidades","termOptions","label","value","location","history","dataSession","console","log","pathname","split","transactionId","atob","sessionStorage","setItem","JSON","stringify","data","undefined","length","push","URL_DASHBOARD","result","getItem","parse","loadFacilities","consultarDeudores","then","data2","jsonDeudores","i","retrieveProposalType","propuesta","retrieveFacilityType","facilidad","retrieveSubproposalType","proposalType","debtors","consultarCatalogoTipoIdentificacion","typeIdent","consultEnvironmentalAspectsIGR","environmentalRisk","getTipoGarantiaCatalogo","guarantees","retrieveBailType","sureties","consultGeneralDataPropCred","requestId","consultarFacilidades","resp","filter","debtor","orderByJSON","rows","index","debtor0","find","x","Number","debtr","name","name2","lastName","lastName2","identification","id","idType","description","consultarGarantiaPropCred","facilityId","guaranteesFacility","guaranteesRows","guarantee","Records","Code","guaranteeTypeName","Description","guaranteeSubtypeDesc","formatTable","commercialValue","fastValue","ltv","consultListProgramPagoPropCred","paymentProgramRows","map","payments","paymentProgram","observations","consultDisbursementListPropCred","disbursementFormRows","disbursement","disbursementTypeId","consultarFianzaPropCred","suretiesRows","suretie","typeBail","consultCommissionPropCred","commissionRows","commissions","commission","comisionType","code","format","amount","cr","balance","proposedType","proposalTypeId","facilityType","facilityTypeId","proposalTypeName","purpose","sublimits","proposalRate","noSubsidyRate","effectiveRate","feci","termDays","termType","termDescription","reduce","acu","crr","applyEscrow","finantialConditions","environmentalAspectsDTO","riskClassificationConfirmation","legalDocumentation","otherConditions","textAlign"],"mappings":"itBAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CAEA,OAASC,kBAAT,KAAmC,qBAAnC,CACA,OAASC,IAAT,CAAeC,UAAf,CAA2BC,WAA3B,KAA8C,kBAA9C,CACA,MAAOC,CAAAA,UAAP,KAAuB,4BAAvB,CACA,OACIC,GADJ,CAEIC,GAFJ,CAGIC,KAHJ,CAIIC,MAJJ,KAKO,YALP,CAMA,MAAOC,CAAAA,kBAAP,KAA+B,sBAA/B,CACA,OAASC,eAAT,CAA0BC,YAA1B,KAA8C,sBAA9C,CACA,OAASC,cAAT,KAA+B,eAA/B,CACA,MAAOC,CAAAA,QAAP,KAAqB,8BAArB,CACA,OAASC,QAAT,KAAyB,6BAAzB,CACA,MAAO,GAAKC,CAAAA,GAAZ,KAAqB,gCAArB,C,6IAGA,GAAMC,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAACC,KAAD,CAAW,CAC/B,oBAAoBL,cAAc,EAAlC,CAAQM,CAAR,iBAAQA,CAAR,CAAWC,IAAX,iBAAWA,IAAX,CAEA,GAAMC,CAAAA,GAAG,CAAG,GAAIV,CAAAA,eAAJ,EAAZ,CACA,GAAMW,CAAAA,YAAY,CAAG,GAAIV,CAAAA,YAAJ,EAArB,CACA,GAAMW,CAAAA,YAAY,CAAG,GAAIT,CAAAA,QAAJ,EAArB,CAEA,cAAsCd,QAAQ,CAAC,IAAD,CAA9C,wCAAOwB,WAAP,eAAoBC,cAApB,eACA,GAAMC,CAAAA,WAAW,CAAG,CAAC,CAAEC,KAAK,WAAKR,CAAC,CAAC,WAAD,CAAN,CAAP,CAA8BS,KAAK,CAAE,IAArC,CAAD,CAA8C,CAAED,KAAK,WAAKR,CAAC,CAAC,UAAD,CAAN,CAAP,CAA6BS,KAAK,CAAE,IAApC,CAA9C,CAApB,CAGA,GAAMC,CAAAA,QAAQ,CAAGzB,WAAW,EAA5B,CACA,GAAM0B,CAAAA,OAAO,CAAG3B,UAAU,EAA1B,CAEAJ,SAAS,CAAC,UAAM,4CACZ,GAAIgC,CAAAA,WAAW,CAAG,EAAlB,CACAC,OAAO,CAACC,GAAR,CAAYJ,QAAZ,SAAYA,QAAZ,qCAAYA,QAAQ,CAAEK,QAAtB,6CAAY,mBAAoBC,KAApB,CAA0B,wBAA1B,EAAoD,CAApD,CAAZ,EACA,GAAIN,QAAJ,SAAIA,QAAJ,sCAAIA,QAAQ,CAAEK,QAAd,8CAAI,oBAAoBC,KAApB,CAA0B,wBAA1B,EAAoD,CAApD,CAAJ,CAA4D,yBACxDJ,WAAW,CAAG,CAAEK,aAAa,CAAEC,IAAI,CAACR,QAAD,SAACA,QAAD,sCAACA,QAAQ,CAAEK,QAAX,8CAAC,oBAAoBC,KAApB,CAA0B,wBAA1B,EAAoD,CAApD,CAAD,CAArB,CAAd,CACAG,cAAc,CAACC,OAAf,CAAuB,cAAvB,CAAuCC,IAAI,CAACC,SAAL,CAAeV,WAAf,CAAvC,EACH,CAED,GAAIF,QAAQ,CAACa,IAAT,GAAkB,IAAlB,EAA0Bb,QAAQ,CAACa,IAAT,GAAkBC,SAAhD,CAA2D,CACvD,GAAId,QAAQ,CAACa,IAAT,CAAcN,aAAd,GAAgCO,SAAhC,EAA6Cd,QAAQ,CAACa,IAAT,CAAcN,aAAd,CAA4BQ,MAA5B,EAAsC,CAAvF,CAA0F,CACtF;AACA;AACAd,OAAO,CAACe,IAAR,CAAa7B,GAAG,CAAC8B,aAAjB,EACH,CAJD,IAKK,CACDR,cAAc,CAACC,OAAf,CAAuB,cAAvB,CAAuCC,IAAI,CAACC,SAAL,CAAeZ,QAAQ,CAACa,IAAxB,CAAvC,EACAX,WAAW,CAAGF,QAAQ,CAACa,IAAvB,CACH,CACJ,CAVD,IAWK,CACD;AACA,GAAIK,CAAAA,MAAM,CAAGT,cAAc,CAACU,OAAf,CAAuB,cAAvB,CAAb,CACA,GAAID,MAAM,GAAKJ,SAAX,EAAwBI,MAAM,GAAK,IAAvC,CAA6C,CACzCA,MAAM,CAAGP,IAAI,CAACS,KAAL,CAAWF,MAAX,CAAT,CACAhB,WAAW,CAAGgB,MAAd,CACH,CACJ,CACDG,cAAc,CAACnB,WAAD,CAAd,CACH,CA5BQ,CA4BN,EA5BM,CAAT,CA6BA,QAASmB,CAAAA,cAAT,CAAwBnB,WAAxB,CAAqC,CACjCV,GAAG,CAAC8B,iBAAJ,CAAsBpB,WAAW,CAACK,aAAlC,EACKgB,IADL,CACU,SAACC,KAAD,CAAW,CACb,GAAIA,KAAK,GAAK,IAAV,EAAkBA,KAAK,GAAKV,SAAhC,CAA2C,CACvC,GAAIW,CAAAA,YAAY,CAAG,EAAnB,CACA,IAAK,GAAIC,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAGF,KAAK,CAACT,MAA1B,CAAkCW,CAAC,EAAnC,CAAuC,CACnCD,YAAY,CAACT,IAAb,CAAkB,CAAElB,KAAK,CAAE0B,KAAK,CAACE,CAAD,CAAL,CAAS,YAAT,GAA0B,GAA1B,CAAgCF,KAAK,CAACE,CAAD,CAAL,CAAS,MAAT,CAAhC,CAAmDF,KAAK,CAACE,CAAD,CAAL,CAAS,MAAT,EAAmB,GAAnB,CAAyBF,KAAK,CAACE,CAAD,CAAL,CAAS,OAAT,CAAzB,CAA6C,GAA7C,CAAmDF,KAAK,CAACE,CAAD,CAAL,CAAS,UAAT,CAAnD,CAA0E,GAA1E,CAAgFF,KAAK,CAACE,CAAD,CAAL,CAAS,WAAT,CAA5I,CAAmK3B,KAAK,CAAEyB,KAAK,CAACE,CAAD,CAAL,CAAS,UAAT,CAA1K,CAAlB,EACH,CACD;AACAlC,GAAG,CAACmC,oBAAJ,GACKJ,IADL,CACU,SAACK,SAAD,CAAe,CACjB;AACApC,GAAG,CAACqC,oBAAJ,GACKN,IADL,CACU,SAACO,SAAD,CAAe,CACjB;AACAtC,GAAG,CAACuC,uBAAJ,GACKR,IADL,0FACU,kBAAOS,YAAP,mNACkBxC,CAAAA,GAAG,CAAC8B,iBAAJ,CAAsBpB,WAAW,CAACK,aAAlC,CADlB,QACE0B,OADF,uCAEoBzC,CAAAA,GAAG,CAAC0C,mCAAJ,EAFpB,QAEEC,SAFF,uCAG4B3C,CAAAA,GAAG,CAAC4C,8BAAJ,CAAmClC,WAAW,CAACK,aAA/C,CAH5B,QAGE8B,iBAHF,wCAIqB5C,CAAAA,YAAY,CAAC6C,uBAAb,EAJrB,SAIEC,UAJF,wCAKmB/C,CAAAA,GAAG,CAACgD,gBAAJ,EALnB,SAKEC,QALF,wCAMoBjD,CAAAA,GAAG,CAACkD,0BAAJ,CAA+BxC,WAA/B,SAA+BA,WAA/B,iBAA+BA,WAAW,CAAEK,aAA5C,CANpB,SAMEoC,SANF,gBAOFA,SAAS,CAAGA,SAAS,CAAC,CAAD,CAAT,CAAaA,SAAzB,CACAxC,OAAO,CAACC,GAAR,CAAYuC,SAAZ,EACAnD,GAAG,CAACoD,oBAAJ,CAAyBD,SAAzB,EAAoCpB,IAApC,2FAAyC,iBAAMsB,IAAN,yKACjC,QAAAA,IAAI,QAAJ,8BAAMC,MAAN,CAAa,SAAAjC,IAAI,QAAIA,CAAAA,IAAI,CAACkC,MAAL,EAAe,IAAnB,EAAjB,EAA0ChC,MAA1C,EAAmD,CADlB,4BAEjC8B,IAAI,CAAGnD,YAAY,CAACsD,WAAb,CAAyBH,IAAzB,CAA+B,YAA/B,CAA6C,KAA7C,CAAP,CACA1C,OAAO,CAACC,GAAR,CAAYyC,IAAZ,EAEII,IAL6B,CAKtB,EALsB,CAM7BC,KAN6B,CAMrB,CANqB,sCAQdL,IARc,m1BAQtBhC,IARsB,aASzBsC,OATyB,qBASf1B,YAAY,CAAC2B,IAAb,CAAkB,SAAAC,CAAC,QAAIA,CAAAA,CAAC,CAACtD,KAAF,GAAYuD,MAAM,CAACzC,IAAI,CAACkC,MAAN,CAAtB,EAAnB,CATe,6CASf,mBAAyDjD,KAT1C,CAUzBiD,MAVyB,CAUhBd,OAAO,CAACmB,IAAR,CAAa,SAAAG,KAAK,yDAAIA,CAAAA,KAAK,CAACC,IAAN,EAAc,cAAAD,KAAK,CAACE,KAAN,kDAAa1C,MAAb,EAAsB,CAAtB,CAA0B,IAAMwC,KAAK,CAACE,KAAtC,CAA8C,EAA5D,GAAmE,kBAAAF,KAAK,CAACG,QAAN,0DAAgB3C,MAAhB,EAAyB,CAAzB,CAA6B,IAAMwC,KAAK,CAACG,QAAzC,CAAoD,EAAvH,GAA8H,mBAAAH,KAAK,CAACI,SAAN,4DAAiB5C,MAAjB,EAA0B,CAA1B,CAA8B,IAAMwC,KAAK,CAACI,SAA1C,CAAsD,EAApL,IAA4LR,OAAhM,EAAlB,CAVgB,CAWzBS,cAXyB,yCAWRzB,SAAS,CAACiB,IAAV,CAAe,SAAAQ,cAAc,QAAIA,CAAAA,cAAc,CAACC,EAAf,IAAsBd,MAAtB,SAAsBA,MAAtB,iBAAsBA,MAAM,CAAEe,MAA9B,CAAJ,EAA7B,CAXQ,0CAWR,gBAAwEC,WAXhE,+DAW+E,EAX/E,uBAaEvE,CAAAA,GAAG,CAACwE,yBAAJ,CAA8BnD,IAAI,CAACoD,UAAnC,CAbF,QAazBC,kBAbyB,eAezBC,cAfyB,CAeR,EAfQ,uCAiBLD,kBAjBK,uGAiBlBE,CAAAA,SAjBkB,cAmBzBD,cAAc,CAACnD,IAAf,cACI,wCACI,mCACI,oBAAK1B,CAAC,CAAC,cAAD,CAAN,EADJ,cAEI,oBACKiD,UADL,SACKA,UADL,wCACKA,UAAU,CAAE8B,OAAZ,CAAoBjB,IAApB,CAAyB,SAAAC,CAAC,QAAIA,CAAAA,CAAC,CAACiB,IAAF,GAAWF,SAAS,CAACG,iBAAzB,EAA1B,CADL,gDACK,sBAAuEC,WAD5E,EAFJ,cAKI,oBACKJ,SAAS,CAACK,oBADf,EALJ,cAQI,WAAI,OAAO,CAAC,IAAZ,EARJ,GADJ,cAYI,mCACI,oBAAKnF,CAAC,CAAC,iBAAD,CAAN,EADJ,cAEI,YAAI,OAAO,CAAC,IAAZ,eACMI,YAAY,CAACgF,WAAb,wBAAyBN,SAAS,CAACO,eAAnC,+DAAsD,CAAtD,CADN,GAFJ,GAZJ,cAkBI,mCACI,oBAAKrF,CAAC,CAAC,gBAAD,CAAN,EADJ,cAEI,YAAI,OAAO,CAAC,IAAZ,eACMI,YAAY,CAACgF,WAAb,uBAAyBN,SAAS,CAACQ,SAAnC,6DAAgD,CAAhD,CADN,GAFJ,GAlBJ,cAwBI,mCACI,6BADJ,cAEI,YAAI,OAAO,CAAC,IAAZ,WACKlF,YAAY,CAACgF,WAAb,CAAyBN,SAAS,CAACS,GAAnC,CADL,OAFJ,GAxBJ,GADJ,EAnByB,EAiB7B,kDAA4C,UAmC3C,CApD4B,8EAsDErF,CAAAA,GAAG,CAACsF,8BAAJ,CAAmCjE,IAAI,CAACoD,UAAxC,CAtDF,SAsDzBc,kBAtDyB,eAuD7BA,kBAAkB,CAAG,sBAAAA,kBAAkB,QAAlB,0DAAoBhE,MAApB,EAA6B,CAA7B,CAAiCgE,kBAAkB,CAACC,GAAnB,CAAuB,SAAAC,QAAQ,qBAAK,mCACtF,oBAAK3F,CAAC,CAAC,gBAAD,CAAN,EADsF,cAEtF,oBAAK2F,QAAQ,CAACC,cAAd,EAFsF,cAGtF,oBAAKD,QAAQ,CAACE,YAAd,EAHsF,cAItF,WAAI,OAAO,CAAC,IAAZ,EAJsF,GAASjG,QAAQ,EAAjB,CAAL,EAA/B,CAAjC,cAMX,mCACN,oBAAKI,CAAC,CAAC,gBAAD,CAAN,EADM,cAEN,WAAI,OAAO,CAAC,IAAZ,EAFM,GAASJ,QAAQ,EAAjB,CANV,CAvD6B,uBAkEIM,CAAAA,GAAG,CAAC4F,+BAAJ,CAAoCvE,IAAI,CAACoD,UAAzC,CAlEJ,SAkEzBoB,oBAlEyB,eAmE7BA,oBAAoB,CAAG,wBAAAA,oBAAoB,QAApB,8DAAsBtE,MAAtB,EAA+B,CAA/B,CAAmCsE,oBAAoB,CAACL,GAArB,CAAyB,SAAAM,YAAY,qBAAK,mCAChG,oBAAKhG,CAAC,CAAC,kBAAD,CAAN,EADgG,cAEhG,oBAAKgG,YAAY,CAACC,kBAAlB,EAFgG,cAGhG,oBAAKD,YAAY,CAACH,YAAlB,EAHgG,cAIhG,WAAI,OAAO,CAAC,IAAZ,EAJgG,GAASjG,QAAQ,EAAjB,CAAL,EAArC,CAAnC,cAMb,mCACN,oBAAKI,CAAC,CAAC,kBAAD,CAAN,EADM,cAEN,WAAI,OAAO,CAAC,IAAZ,EAFM,GAASJ,QAAQ,EAAjB,CANV,CAnE6B,uBA+EJM,CAAAA,GAAG,CAACgG,uBAAJ,CAA4B3E,IAAI,CAACoD,UAAjC,CA/EI,SA+EzBwB,YA/EyB,eAgF7BA,YAAY,CAAG,gBAAAA,YAAY,QAAZ,8CAAc1E,MAAd,EAAuB,CAAvB,CAA2B0E,YAAY,CAACT,GAAb,CAAiB,SAAAU,OAAO,wCAAK,mCACnE,oBAAKpG,CAAC,CAAC,UAAD,CAAN,EADmE,cAEnE,oCAAKmD,QAAQ,CAACW,IAAT,CAAc,SAAAC,CAAC,QAAIA,CAAAA,CAAC,CAACQ,EAAF,GAAS6B,OAAO,CAACC,QAArB,EAAf,CAAL,yCAAK,eAA+C5B,WAApD,EAFmE,cAGnE,WAAI,OAAO,CAAC,IAAZ,EAHmE,GAAS7E,QAAQ,EAAjB,CAAL,EAAxB,CAA3B,cAKL,mCACN,oBAAKI,CAAC,CAAC,UAAD,CAAN,EADM,cAEN,WAAI,OAAO,CAAC,IAAZ,EAFM,GAASJ,QAAQ,EAAjB,CALV,CAhF6B,uBA2FFM,CAAAA,GAAG,CAACoG,yBAAJ,CAA8B/E,IAAI,CAACoD,UAAnC,CA3FE,SA2FzB4B,cA3FyB,eA4F7BA,cAAc,CAAGA,cAAc,CAACC,WAAhC,CACA3F,OAAO,CAACC,GAAR,CAAYyF,cAAZ,EACAA,cAAc,CAAG,kBAAAA,cAAc,QAAd,kDAAgB9E,MAAhB,EAAyB,CAAzB,CAA6B8E,cAAc,CAACb,GAAf,CAAmB,SAAAe,UAAU,qBAAK,mCAC5E,oBAAKzG,CAAC,CAAC,YAAD,CAAN,EAD4E,cAE5E,oBAAKyG,UAAU,CAACC,YAAX,CAAwBC,IAA7B,EAF4E,cAG5E,0BAAMvG,YAAY,CAACwG,MAAb,CAAoBH,UAAU,CAACI,MAA/B,CAAN,GAH4E,cAI5E,WAAI,OAAO,CAAC,IAAZ,EAJ4E,GAASjH,QAAQ,EAAjB,CAAL,EAA7B,CAA7B,cAMP,mCACN,oBAAKI,CAAC,CAAC,YAAD,CAAN,EADM,cAEN,WAAI,OAAO,CAAC,IAAZ,EAFM,GAASJ,QAAQ,EAAjB,CANV,CAaA+D,IAAI,CAACjC,IAAL,CACIH,IAAI,CAACkC,MAAL,EAAe,IAAf,cACI,wCACI,oCACI,mCACI,oBAAKzD,CAAC,CAAC,sBAAD,CAAN,EADJ,cAEI,oBAAKA,CAAC,CAAC,KAAD,CAAN,EAFJ,cAGI,oBAAKA,CAAC,CAAC,QAAD,CAAN,EAHJ,cAII,oBAAKA,CAAC,CAAC,QAAD,CAAN,EAJJ,cAKI,oBAAKA,CAAC,CAAC,SAAD,CAAN,EALJ,GADJ,EADJ,cAUI,sCACI,mCACI,oBAAK4D,KAAK,EAAV,EADJ,cAEI,oBAAKrC,IAAI,CAACuF,EAAV,EAFJ,cAGI,0BAAM1G,YAAY,CAACgF,WAAb,eAAyB7D,IAAzB,SAAyBA,IAAzB,iBAAyBA,IAAI,CAAEsF,MAA/B,6CAAyC,CAAzC,CAAN,GAHJ,cAII,4CAAQpD,MAAR,SAAQA,MAAR,iBAAQA,MAAM,CAAES,IAAhB,6CAAwB,EAAxB,4BAA8BT,MAA9B,SAA8BA,MAA9B,iBAA8BA,MAAM,CAAEU,KAAtC,+CAA+C,EAA/C,+BAAqDV,MAArD,SAAqDA,MAArD,iBAAqDA,MAAM,CAAEW,QAA7D,qDAAyE,EAAzE,gCAA+EX,MAA/E,SAA+EA,MAA/E,iBAA+EA,MAAM,CAAEY,SAAvF,uDAAoG,EAApG,GAJJ,cAKI,0BAAMjE,YAAY,CAACgF,WAAb,gBAAyB7D,IAAzB,SAAyBA,IAAzB,iBAAyBA,IAAI,CAAEwF,OAA/B,+CAA0C,CAA1C,CAAN,GALJ,GAASnH,QAAQ,EAAjB,CADJ,cAQI,mCACI,oBAAKI,CAAC,CAAC,UAAD,CAAN,EADJ,cAEI,WAAI,OAAO,CAAC,IAAZ,2BAAkBsC,SAAS,CAACwB,IAAV,CAAe,SAAAC,CAAC,+BAAIA,CAAAA,CAAC,CAACQ,EAAF,wBAAUhD,IAAV,SAAUA,IAAV,iBAAUA,IAAI,CAAEyF,YAAhB,yDAAgCzF,IAAhC,SAAgCA,IAAhC,iBAAgCA,IAAI,CAAE0F,cAAtC,CAAJ,EAAhB,CAAlB,0CAAkB,gBAA4ExC,WAA9F,EAFJ,GARJ,cAYI,mCACI,oBAAKzE,CAAC,CAAC,cAAD,CAAN,EADJ,cAEI,WAAI,OAAO,CAAC,IAAZ,2BAAkBwC,SAAS,CAACsB,IAAV,CAAe,SAAAC,CAAC,+BAAIA,CAAAA,CAAC,CAACQ,EAAF,wBAAUhD,IAAV,SAAUA,IAAV,iBAAUA,IAAI,CAAE2F,YAAhB,yDAAgC3F,IAAhC,SAAgCA,IAAhC,iBAAgCA,IAAI,CAAE4F,cAAtC,CAAJ,EAAhB,CAAlB,0CAAkB,gBAA4E1C,WAA9F,EAFJ,GAZJ,cAgBI,mCACI,oBAAKzE,CAAC,CAAC,iBAAD,CAAN,EADJ,cAEI,WAAI,OAAO,CAAC,IAAZ,8BAAkB0C,YAAY,CAACoB,IAAb,CAAkB,SAAAC,CAAC,QAAIA,CAAAA,CAAC,CAACQ,EAAF,IAAShD,IAAT,SAASA,IAAT,iBAASA,IAAI,CAAE6F,gBAAf,CAAJ,EAAnB,CAAlB,6CAAkB,mBAAyD3C,WAA3E,EAFJ,GAhBJ,cAoBI,mCACI,oBAAKzE,CAAC,CAAC,SAAD,CAAN,EADJ,cAEI,WAAI,OAAO,CAAC,IAAZ,yBAAkBuB,IAAI,CAAC8F,OAAvB,+CAAkC,EAAlC,EAFJ,GApBJ,cAwBI,mCACI,oBAAKrH,CAAC,CAAC,UAAD,CAAN,EADJ,cAEI,WAAI,OAAO,CAAC,IAAZ,2BAAkBuB,IAAI,CAAC+F,SAAvB,mDAAoC,EAApC,EAFJ,GAxBJ,cA4BI,mCACI,oBAAKtH,CAAC,CAAC,MAAD,CAAN,EADJ,cAEI,YAAI,OAAO,CAAC,IAAZ,WAAkBI,YAAY,CAACgF,WAAb,qBAAyB7D,IAAzB,SAAyBA,IAAzB,iBAAyBA,IAAI,CAAEgG,YAA/B,yDAA+C,CAA/C,CAAlB,OAFJ,GA5BJ,cAgCI,mCACI,oBAAKvH,CAAC,CAAC,oBAAD,CAAN,EADJ,cAEI,YAAI,OAAO,CAAC,IAAZ,WAAkBI,YAAY,CAACgF,WAAb,sBAAyB7D,IAAzB,SAAyBA,IAAzB,iBAAyBA,IAAI,CAAEiG,aAA/B,2DAAgD,CAAhD,CAAlB,OAFJ,GAhCJ,cAoCI,mCACI,oBAAKxH,CAAC,CAAC,eAAD,CAAN,EADJ,cAEI,YAAI,OAAO,CAAC,IAAZ,WAAkBI,YAAY,CAACgF,WAAb,sBAAyB7D,IAAzB,SAAyBA,IAAzB,iBAAyBA,IAAI,CAAEkG,aAA/B,2DAAgD,CAAhD,CAAlB,OAFJ,GApCJ,cAwCI,mCACI,4BADJ,cAEI,WAAI,OAAO,CAAC,IAAZ,UACKlG,IAAI,CAACmG,IAAL,CAAY1H,CAAC,CAAC,KAAD,CAAb,CAAuBA,CAAC,CAAC,IAAD,CAD7B,EAFJ,GAxCJ,CA+CKuG,cA/CL,cAiDI,mCACI,oBAAKvG,CAAC,CAAC,MAAD,CAAN,EADJ,cAEI,8BAAQuB,IAAI,CAACoG,QAAb,aAAyBpG,IAAI,CAACqG,QAA9B,GAFJ,cAGI,WAAI,OAAO,CAAC,IAAZ,UAAkBrG,IAAI,CAACsG,eAAvB,EAHJ,GAjDJ,CAuDKpC,kBAvDL,CAyDKM,oBAzDL,cA2DI,mCACI,iCAAI,mBAAI/F,CAAC,CAAC,WAAD,CAAL,EAAJ,EADJ,cAEI,WAAI,OAAO,CAAC,IAAZ,EAFJ,GA3DJ,CAkEK6E,cAlEL,cAoEI,mCACI,mCADJ,cAEI,YAAI,OAAO,CAAC,IAAZ,WACKzE,YAAY,CAACgF,WAAb,wBAAyBR,kBAAkB,CAACkD,MAAnB,CAA0B,SAACC,GAAD,CAAMC,GAAN,QAAcD,CAAAA,GAAG,CAAGC,GAAG,CAACzC,GAAxB,EAA1B,CAAuD,CAAvD,CAAzB,+DAAsF,CAAtF,CADL,OAFJ,GApEJ,cA0EI,mCACI,oBAAKvF,CAAC,CAAC,QAAD,CAAN,EADJ,cAEI,WAAI,OAAO,CAAC,IAAZ,UACKuB,IAAI,CAAC0G,WAAL,CAAmBjI,CAAC,CAAC,KAAD,CAApB,CAA8BA,CAAC,CAAC,IAAD,CADpC,EAFJ,GA1EJ,CAiFKmG,YAjFL,cAmFI,mCACI,oBAAKnG,CAAC,CAAC,qBAAD,CAAN,EADJ,cAEI,WAAI,OAAO,CAAC,IAAZ,iCACKuB,IADL,SACKA,IADL,iBACKA,IAAI,CAAE2G,mBADX,+DACkC,EADlC,EAFJ,GAnFJ,cA0FI,mCACI,oBAAKlI,CAAC,CAAC,wCAAD,CAAN,EADJ,cAEI,WAAI,OAAO,CAAC,IAAZ,iCACK+C,iBADL,SACKA,iBADL,yCACKA,iBAAiB,CAAEoF,uBADxB,iDACK,uBAA4CC,8BADjD,+DACmF,EADnF,EAFJ,GA1FJ,cAgGI,mCACI,oBAAKpI,CAAC,CAAC,+BAAD,CAAN,EADJ,cAEI,WAAI,OAAO,CAAC,IAAZ,iCACKuB,IADL,SACKA,IADL,iBACKA,IAAI,CAAE8G,kBADX,+DACiC,EADjC,EAFJ,GAhGJ,cAsGI,mCACI,oBAAKrI,CAAC,CAAC,iBAAD,CAAN,EADJ,cAEI,WAAI,OAAO,CAAC,IAAZ,iCACKuB,IADL,SACKA,IADL,iBACKA,IAAI,CAAE+G,eADX,+DAC8B,EAD9B,EAFJ,GAtGJ,GAVJ,GADJ,CAyHM,IA1HV,EA3G6B,sZAuOjChI,cAAc,CAACqD,IAAD,CAAd,CAvOiC,gCA0OjCrD,cAAc,cACV,iCACI,WAAI,OAAO,CAAC,GAAZ,CAAgB,KAAK,CAAE,CAAEiI,SAAS,CAAE,QAAb,CAAvB,EADJ,EAAS,CAAT,CADU,CAAd,CA1OiC,4EAAzC,kEATE,yDADV,gEA2PH,CA9PL,EA+PH,CAlQL,EAmQH,CACJ,CA5QL,EA6QH,CACD,mBACI,KAAC,KAAD,CAAO,QAAP,wBACI,KAAC,KAAD,EAAO,SAAS,CAAC,oDAAjB,UACKlI,WADL,EADJ,EADJ,CAOH,CAjUD,CAmUA,cAAeP,CAAAA,eAAf","sourcesContent":["import React, { useEffect, useState } from \"react\"\r\nimport PropTypes from 'prop-types';\r\nimport { translationHelpers } from '../../../../helpers';\r\nimport { Link, useHistory, useLocation } from \"react-router-dom\"\r\nimport SweetAlert from \"react-bootstrap-sweetalert\"\r\nimport {\r\n    Row,\r\n    Col,\r\n    Table,\r\n    Button,\r\n} from \"reactstrap\"\r\nimport ModalNuevaComision from \"./ModalNuevaComision\";\r\nimport { BackendServices, CoreServices } from \"../../../../services\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport Currency from \"../../../../helpers/currency\"\r\nimport { uniq_key } from \"../../../../helpers/unq_key\";\r\nimport * as url from \"../../../../helpers/url_helper\"\r\n\r\n\r\nconst PreviewFacility = (props) => {\r\n    const { t, i18n } = useTranslation();\r\n\r\n    const api = new BackendServices();\r\n    const coreServices = new CoreServices();\r\n    const currencyData = new Currency();\r\n\r\n    const [Facilidades, setFacilidades] = useState(null);\r\n    const termOptions = [{ label: `${t(\"ShortTerm\")}`, value: \"CP\" }, { label: `${t(\"LongTerm\")}`, value: \"LP\" }];\r\n\r\n\r\n    const location = useLocation()\r\n    const history = useHistory();\r\n\r\n    useEffect(() => {\r\n        let dataSession = {};\r\n        console.log(location?.pathname?.split(\"previsualizarPropCred/\")[1])\r\n        if (location?.pathname?.split(\"previsualizarPropCred/\")[1]) {\r\n            dataSession = { transactionId: atob(location?.pathname?.split(\"previsualizarPropCred/\")[1]) };\r\n            sessionStorage.setItem('locationData', JSON.stringify(dataSession));\r\n        }\r\n\r\n        if (location.data !== null && location.data !== undefined) {\r\n            if (location.data.transactionId === undefined || location.data.transactionId.length <= 0) {\r\n                //location.data.transactionId = 0;\r\n                //checkAndCreateProcedure(location.data);\r\n                history.push(url.URL_DASHBOARD);\r\n            }\r\n            else {\r\n                sessionStorage.setItem('locationData', JSON.stringify(location.data));\r\n                dataSession = location.data;\r\n            }\r\n        }\r\n        else {\r\n            //chequeamos si tenemos guardado en session\r\n            var result = sessionStorage.getItem('locationData');\r\n            if (result !== undefined && result !== null) {\r\n                result = JSON.parse(result);\r\n                dataSession = result;\r\n            }\r\n        }\r\n        loadFacilities(dataSession)\r\n    }, [])\r\n    function loadFacilities(dataSession) {\r\n        api.consultarDeudores(dataSession.transactionId)\r\n            .then((data2) => {\r\n                if (data2 !== null && data2 !== undefined) {\r\n                    let jsonDeudores = [];\r\n                    for (let i = 0; i < data2.length; i++) {\r\n                        jsonDeudores.push({ label: data2[i][\"typePerson\"] == \"2\" ? data2[i][\"name\"] : data2[i][\"name\"] + \" \" + data2[i][\"name2\"] + \" \" + data2[i][\"lastName\"] + \" \" + data2[i][\"lastName2\"], value: data2[i][\"personId\"] })\r\n                    }\r\n                    // retrieveProposalType\r\n                    api.retrieveProposalType()\r\n                        .then((propuesta) => {\r\n                            // retrieveFacilityType\r\n                            api.retrieveFacilityType()\r\n                                .then((facilidad) => {\r\n                                    // consultarFacilidades\r\n                                    api.retrieveSubproposalType()\r\n                                        .then(async (proposalType) => {\r\n                                            let debtors = await api.consultarDeudores(dataSession.transactionId);\r\n                                            let typeIdent = await api.consultarCatalogoTipoIdentificacion();\r\n                                            let environmentalRisk = await api.consultEnvironmentalAspectsIGR(dataSession.transactionId)\r\n                                            let guarantees = await coreServices.getTipoGarantiaCatalogo();\r\n                                            let sureties = await api.retrieveBailType();\r\n                                            let requestId = await api.consultGeneralDataPropCred(dataSession?.transactionId)\r\n                                            requestId = requestId[0].requestId;\r\n                                            console.log(requestId)\r\n                                            api.consultarFacilidades(requestId).then(async resp => {\r\n                                                if (resp?.filter(data => data.debtor != \"  \").length > 0) {\r\n                                                    resp = currencyData.orderByJSON(resp, 'facilityId', 'asc')\r\n                                                    console.log(resp)\r\n\r\n                                                    let rows = [];\r\n                                                    let index = 1;\r\n\r\n                                                    for (const data of resp) {\r\n                                                        let debtor0 = jsonDeudores.find(x => x.value === Number(data.debtor))?.label;\r\n                                                        let debtor = debtors.find(debtr => debtr.name + (debtr.name2?.length > 0 ? ' ' + debtr.name2 : '') + (debtr.lastName?.length > 0 ? ' ' + debtr.lastName : '') + (debtr.lastName2?.length > 0 ? ' ' + debtr.lastName2 : '') === debtor0);\r\n                                                        let identification = typeIdent.find(identification => identification.id === debtor?.idType)?.description ?? '';\r\n\r\n                                                        let guaranteesFacility = await api.consultarGarantiaPropCred(data.facilityId);\r\n\r\n                                                        let guaranteesRows = [];\r\n\r\n                                                        for (const guarantee of guaranteesFacility) {\r\n\r\n                                                            guaranteesRows.push(\r\n                                                                <>\r\n                                                                    <tr>\r\n                                                                        <td>{t(\"Warrant Type\")}</td>\r\n                                                                        <td>\r\n                                                                            {guarantees?.Records.find(x => x.Code === guarantee.guaranteeTypeName)?.Description}\r\n                                                                        </td>\r\n                                                                        <td>\r\n                                                                            {guarantee.guaranteeSubtypeDesc}\r\n                                                                        </td>\r\n                                                                        <td colSpan=\"12\">\r\n                                                                        </td>\r\n                                                                    </tr>\r\n                                                                    <tr>\r\n                                                                        <td>{t(\"CommercialValue\")}</td>\r\n                                                                        <td colSpan=\"14\">\r\n                                                                            ${currencyData.formatTable(guarantee.commercialValue ?? 0)}\r\n                                                                        </td>\r\n                                                                    </tr>\r\n                                                                    <tr>\r\n                                                                        <td>{t(\"QuickSaleValue\")}</td>\r\n                                                                        <td colSpan=\"14\">\r\n                                                                            ${currencyData.formatTable(guarantee.fastValue ?? 0)}\r\n                                                                        </td>\r\n                                                                    </tr>\r\n                                                                    <tr>\r\n                                                                        <td>LTV %</td>\r\n                                                                        <td colSpan=\"14\">\r\n                                                                            {currencyData.formatTable(guarantee.ltv)}%\r\n                                                                        </td>\r\n                                                                    </tr>\r\n                                                                </>\r\n                                                            )\r\n                                                        }\r\n\r\n                                                        let paymentProgramRows = await api.consultListProgramPagoPropCred(data.facilityId);\r\n                                                        paymentProgramRows = paymentProgramRows?.length > 0 ? paymentProgramRows.map(payments => (<tr key={uniq_key()}>\r\n                                                            <td>{t(\"PaymentProgram\")}</td>\r\n                                                            <td>{payments.paymentProgram}</td>\r\n                                                            <td>{payments.observations}</td>\r\n                                                            <td colSpan=\"12\">\r\n                                                            </td>\r\n                                                        </tr>)) : <tr key={uniq_key()}>\r\n                                                            <td>{t(\"PaymentProgram\")}</td>\r\n                                                            <td colSpan=\"14\">\r\n                                                            </td>\r\n                                                        </tr>;\r\n                                                        let disbursementFormRows = await api.consultDisbursementListPropCred(data.facilityId);\r\n                                                        disbursementFormRows = disbursementFormRows?.length > 0 ? disbursementFormRows.map(disbursement => (<tr key={uniq_key()}>\r\n                                                            <td>{t(\"DisbursementForm\")}</td>\r\n                                                            <td>{disbursement.disbursementTypeId}</td>\r\n                                                            <td>{disbursement.observations}</td>\r\n                                                            <td colSpan=\"12\">\r\n                                                            </td>\r\n                                                        </tr>)) : <tr key={uniq_key()}>\r\n                                                            <td>{t(\"DisbursementForm\")}</td>\r\n                                                            <td colSpan=\"14\">\r\n                                                            </td>\r\n                                                        </tr>;\r\n\r\n                                                        let suretiesRows = await api.consultarFianzaPropCred(data.facilityId);\r\n                                                        suretiesRows = suretiesRows?.length > 0 ? suretiesRows.map(suretie => (<tr key={uniq_key()}>\r\n                                                            <td>{t(\"Sureties\")}</td>\r\n                                                            <td>{sureties.find(x => x.id === suretie.typeBail)?.description}</td>\r\n                                                            <td colSpan=\"13\">\r\n                                                            </td>\r\n                                                        </tr>)) : <tr key={uniq_key()}>\r\n                                                            <td>{t(\"Sureties\")}</td>\r\n                                                            <td colSpan=\"14\">\r\n                                                            </td>\r\n                                                        </tr>;\r\n\r\n                                                        let commissionRows = await api.consultCommissionPropCred(data.facilityId);\r\n                                                        commissionRows = commissionRows.commissions;\r\n                                                        console.log(commissionRows)\r\n                                                        commissionRows = commissionRows?.length > 0 ? commissionRows.map(commission => (<tr key={uniq_key()}>\r\n                                                            <td>{t(\"Commission\")}</td>\r\n                                                            <td>{commission.comisionType.code}</td>\r\n                                                            <td>${currencyData.format(commission.amount)}</td>\r\n                                                            <td colSpan=\"12\">\r\n                                                            </td>\r\n                                                        </tr>)) : <tr key={uniq_key()}>\r\n                                                            <td>{t(\"Commission\")}</td>\r\n                                                            <td colSpan=\"14\">\r\n                                                            </td>\r\n                                                        </tr>;\r\n\r\n\r\n                                                        rows.push((\r\n                                                            data.debtor != \"  \" ?\r\n                                                                <>\r\n                                                                    <thead >\r\n                                                                        <tr>\r\n                                                                            <th>{t(\"Number of facilities\")}</th>\r\n                                                                            <th>{t(\"C.R\")}</th>\r\n                                                                            <th>{t(\"Amount\")}</th>\r\n                                                                            <th>{t(\"Debtor\")}</th>\r\n                                                                            <th>{t(\"Balance\")}</th>\r\n                                                                        </tr>\r\n                                                                    </thead>\r\n                                                                    <tbody>\r\n                                                                        <tr key={uniq_key()}>\r\n                                                                            <td>{index++}</td>\r\n                                                                            <td>{data.cr}</td>\r\n                                                                            <td>${currencyData.formatTable(data?.amount ?? 0)}</td>\r\n                                                                            <td>{`${debtor?.name ?? ''} ${debtor?.name2 ?? ''} ${debtor?.lastName ?? ''} ${debtor?.lastName2 ?? ''}`}</td>\r\n                                                                            <td>${currencyData.formatTable(data?.balance ?? 0)}</td>\r\n                                                                        </tr>\r\n                                                                        <tr>\r\n                                                                            <td>{t(\"Proposal\")}</td>\r\n                                                                            <td colSpan=\"14\">{propuesta.find(x => x.id === (data?.proposedType ?? data?.proposalTypeId))?.description}</td>\r\n                                                                        </tr>\r\n                                                                        <tr>\r\n                                                                            <td>{t(\"FacilityType\")}</td>\r\n                                                                            <td colSpan=\"14\">{facilidad.find(x => x.id === (data?.facilityType ?? data?.facilityTypeId))?.description}</td>\r\n                                                                        </tr>\r\n                                                                        <tr>\r\n                                                                            <td>{t(\"ProposalSubType\")}</td>\r\n                                                                            <td colSpan=\"14\">{proposalType.find(x => x.id === data?.proposalTypeName)?.description}</td>\r\n                                                                        </tr>\r\n                                                                        <tr>\r\n                                                                            <td>{t(\"Purpose\")}</td>\r\n                                                                            <td colSpan=\"14\">{data.purpose ?? ''}</td>\r\n                                                                        </tr>\r\n                                                                        <tr>\r\n                                                                            <td>{t(\"Sublimit\")}</td>\r\n                                                                            <td colSpan=\"14\">{data.sublimits ?? ''}</td>\r\n                                                                        </tr>\r\n                                                                        <tr>\r\n                                                                            <td>{t(\"Rate\")}</td>\r\n                                                                            <td colSpan=\"14\">{currencyData.formatTable(data?.proposalRate ?? 0)}%</td>\r\n                                                                        </tr>\r\n                                                                        <tr>\r\n                                                                            <td>{t(\"RateWithoutSubsidy\")}</td>\r\n                                                                            <td colSpan=\"14\">{currencyData.formatTable(data?.noSubsidyRate ?? 0)}%</td>\r\n                                                                        </tr>\r\n                                                                        <tr>\r\n                                                                            <td>{t(\"EffectiveRate\")}</td>\r\n                                                                            <td colSpan=\"14\">{currencyData.formatTable(data?.effectiveRate ?? 0)}%</td>\r\n                                                                        </tr>\r\n                                                                        <tr>\r\n                                                                            <td>FECI</td>\r\n                                                                            <td colSpan=\"14\">\r\n                                                                                {data.feci ? t(\"Yes\") : t(\"No\")}\r\n                                                                            </td>\r\n                                                                        </tr>\r\n\r\n                                                                        {commissionRows}\r\n\r\n                                                                        <tr>\r\n                                                                            <td>{t(\"Term\")}</td>\r\n                                                                            <td>{`${data.termDays} ${data.termType}`}</td>\r\n                                                                            <td colSpan=\"14\">{data.termDescription}</td>\r\n                                                                        </tr>\r\n\r\n                                                                        {paymentProgramRows}\r\n\r\n                                                                        {disbursementFormRows}\r\n\r\n                                                                        <tr>\r\n                                                                            <td><b>{t(\"Guarantee\")}</b></td>\r\n                                                                            <td colSpan=\"14\">\r\n\r\n                                                                            </td>\r\n                                                                        </tr>\r\n\r\n                                                                        {guaranteesRows}\r\n\r\n                                                                        <tr>\r\n                                                                            <td>LTV % TOTAL</td>\r\n                                                                            <td colSpan=\"14\">\r\n                                                                                {currencyData.formatTable(guaranteesFacility.reduce((acu, crr) => acu + crr.ltv, 0) ?? 0)}%\r\n                                                                            </td>\r\n                                                                        </tr>\r\n                                                                        <tr>\r\n                                                                            <td>{t(\"Escrow\")}</td>\r\n                                                                            <td colSpan=\"14\">\r\n                                                                                {data.applyEscrow ? t(\"Yes\") : t(\"No\")}\r\n                                                                            </td>\r\n                                                                        </tr>\r\n\r\n                                                                        {suretiesRows}\r\n\r\n                                                                        <tr>\r\n                                                                            <td>{t(\"FinancialConditions\")}</td>\r\n                                                                            <td colSpan=\"14\">\r\n                                                                                {data?.finantialConditions ?? \"\"}\r\n                                                                            </td>\r\n                                                                        </tr>\r\n\r\n                                                                        <tr>\r\n                                                                            <td>{t(\"Environmental and social risk category\")}</td>\r\n                                                                            <td colSpan=\"14\">\r\n                                                                                {environmentalRisk?.environmentalAspectsDTO?.riskClassificationConfirmation ?? \"\"}\r\n                                                                            </td>\r\n                                                                        </tr>\r\n                                                                        <tr>\r\n                                                                            <td>{t(\"Status of Legal Documentation\")}</td>\r\n                                                                            <td colSpan=\"14\">\r\n                                                                                {data?.legalDocumentation ?? \"\"}\r\n                                                                            </td>\r\n                                                                        </tr>\r\n                                                                        <tr>\r\n                                                                            <td>{t(\"OtherConditions\")}</td>\r\n                                                                            <td colSpan=\"14\">\r\n                                                                                {data?.otherConditions ?? ''}\r\n                                                                            </td>\r\n                                                                        </tr>\r\n                                                                    </tbody>\r\n                                                                </>\r\n                                                                : null))\r\n                                                    }\r\n                                                    setFacilidades(rows);\r\n\r\n                                                } else {\r\n                                                    setFacilidades(\r\n                                                        <tr key={1}>\r\n                                                            <td colSpan=\"7\" style={{ textAlign: 'center' }}></td>\r\n                                                        </tr>);\r\n                                                }\r\n                                            });\r\n                                        });\r\n                                })\r\n                        })\r\n                }\r\n            })\r\n    }\r\n    return (\r\n        <React.Fragment>\r\n            <Table className=\"table table-striped table-hover styled-table table\" >\r\n                {Facilidades}\r\n            </Table>\r\n        </React.Fragment>\r\n    );\r\n};\r\n\r\nexport default PreviewFacility;\r\n"]},"metadata":{},"sourceType":"module"}