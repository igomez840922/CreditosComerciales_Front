{"ast":null,"code":"import _slicedToArray from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import{Link,useLocation}from\"react-router-dom\";import SweetAlert from\"react-bootstrap-sweetalert\";import{Row,Col,Table,Button}from\"reactstrap\";import ModalNewWarrant from\"./ModalNewWarrant\";import{BackendServices}from\"../../../../services\";import{useTranslation}from\"react-i18next\";import{CoreServices}from'../../../../services';import Currency from\"../../../../helpers/currency\";import moment from\"moment\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var WarrantsList=function WarrantsList(props){var currencyData=new Currency();var _useTranslation=useTranslation(),t=_useTranslation.t,i18n=_useTranslation.i18n;var api=new BackendServices();var location=useLocation();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),successSave_dlg=_useState2[0],setsuccessSave_dlg=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),error_dlg=_useState4[0],seterror_dlg=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),error_msg=_useState6[0],seterror_msg=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),confirm_alert=_useState8[0],setconfirm_alert=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),displayModal=_useState10[0],setDisplayModal=_useState10[1];var _useState11=useState(true),_useState12=_slicedToArray(_useState11,2),botonValidation=_useState12[0],setbotonValidation=_useState12[1];var _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),tipo=_useState14[0],settipo=_useState14[1];var coreServices=new CoreServices();var _useState15=useState(null),_useState16=_slicedToArray(_useState15,2),datacOMISION=_useState16[0],setdatacOMISION=_useState16[1];var _useState17=useState({\"guaranteeId\":1,\"guaranteeTypeName\":\"\",\"commercialValue\":0,\"fastValue\":0,\"observations\":\"\",\"ltv\":0,\"appraisalDate\":\"\",\"signature\":\"\",\"trustNumber\":\"\",\"fiduciary\":\"\",\"status\":true}),_useState18=_slicedToArray(_useState17,2),dataSet=_useState18[0],setdataSet=_useState18[1];React.useEffect(function(){// Read Api Service data\ninitializeData();},[]);function formatDate(date){return date==='0001-01-01'||date===''?'':moment(date).format(\"DD/MM/YYYY\");}function initializeData(){// getTipoGarantiaCatalogo\ncoreServices.getTipoGarantiaCatalogo().then(function(response){api.consultarGarantiaPropCred(props.dataSet.facilityId).then(function(resp){if(resp!=undefined){setdatacOMISION(resp.map(function(data){var _response$Records$fin,_data$commercialValue,_data$fastValue;return data.status?/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:(_response$Records$fin=response.Records.find(function(x){return x.Code===data.guaranteeTypeName;}))===null||_response$Records$fin===void 0?void 0:_response$Records$fin.Description}),/*#__PURE__*/_jsx(\"td\",{children:currencyData.formatTable((_data$commercialValue=data.commercialValue)!==null&&_data$commercialValue!==void 0?_data$commercialValue:0)}),/*#__PURE__*/_jsx(\"td\",{children:currencyData.formatTable((_data$fastValue=data.fastValue)!==null&&_data$fastValue!==void 0?_data$fastValue:0)}),/*#__PURE__*/_jsx(\"td\",{children:data.observations}),/*#__PURE__*/_jsxs(\"td\",{children:[currencyData.formatTable(data.ltv),\"%\"]}),/*#__PURE__*/_jsx(\"td\",{children:formatDate(data.appraisalDate)}),/*#__PURE__*/_jsxs(\"td\",{style:{textAlign:\"right\"},children:[/*#__PURE__*/_jsx(Button,{type:\"button\",color:\"link\",onClick:function onClick(resp){updateData(data,\"ECOMISION\");},className:\"btn btn-link\",children:/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-border-color mdi-24px\"})}),/*#__PURE__*/_jsx(Button,{type:\"button\",color:\"link\",onClick:function onClick(resp){deleteData(data,\"DCOMISION\");},className:\"btn btn-link\",children:/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-trash-can-outline mdi-24px\"})})]})]},data):null;}));}else{setdatacOMISION(/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"10\",style:{textAlign:'center'}})},1));}});});}function updateData(data,tipo2){data.appraisalDate=data.appraisalDate===''?'':data.appraisalDate;setdataSet(data);setbotonValidation(true);settipo(tipo2);setDisplayModal(true);}function deleteData(data,tipo2){setdataSet(data);settipo(tipo2);setconfirm_alert(true);}function toggleModal(){setDisplayModal(!displayModal);}if(!props.items){return null;}function saveData(values,tipo2){values.requestId=props.dataSet.facilityId;values.commercialValue=Number(currencyData.getRealValue(values.commercialValue));values.fastValue=Number(currencyData.getRealValue(values.fastValue));values.ltv=Number(values.ltv);values.signature=\" \";values.trustNumber=\" \";values.fiduciary=\" \";values.appraisalDate=(values===null||values===void 0?void 0:values.appraisalDate)==\"\"||(values===null||values===void 0?void 0:values.appraisalDate)==null||(values===null||values===void 0?void 0:values.appraisalDate)==undefined?\"\":values===null||values===void 0?void 0:values.appraisalDate;if(tipo2==\"COMISION\"){api.nuevoGarantiaPropCred(values).then(function(resp){if(resp!==null&&resp!==undefined){setsuccessSave_dlg(true);toggleModal();}else{toggleModal();seterror_dlg(false);}initializeData();}).catch(function(err){seterror_dlg(false);});}if(tipo2==\"ECOMISION\"){values.guaranteeId=dataSet.guaranteeId;values.appraisalDate=(values===null||values===void 0?void 0:values.appraisalDate)==\"\"||(values===null||values===void 0?void 0:values.appraisalDate)==null||(values===null||values===void 0?void 0:values.appraisalDate)==undefined?\"\":values===null||values===void 0?void 0:values.appraisalDate;values.status=true;api.actualizarGarantiaPropCred(values).then(function(resp){if(resp!==null&&resp!==undefined){setsuccessSave_dlg(true);toggleModal();}else{toggleModal();seterror_dlg(false);}initializeData();}).catch(function(err){seterror_dlg(false);});}}function toggleModal(){setDisplayModal(!displayModal);}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Row,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Col,{md:\"6\",children:/*#__PURE__*/_jsx(\"h5\",{className:\"card-sub-title\",children:t(\"Warrants\")})}),/*#__PURE__*/_jsx(Col,{md:\"6\",style:{textAlign:\"right\"},children:/*#__PURE__*/_jsxs(Button,{className:\"btn\",color:\"success\",type:\"button\",style:{margin:'5px'},onClick:function onClick(){setbotonValidation(true);setdataSet({\"guaranteeId\":1,\"guaranteeTypeName\":\"\",\"commercialValue\":0,\"fastValue\":0,\"observations\":\"\",\"ltv\":0,\"appraisalDate\":\"\",\"signature\":\"\",\"trustNumber\":\"\",\"fiduciary\":\"\",\"status\":true});settipo(\"COMISION\");toggleModal();},title:t(\"Add\"),children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-lg fa-plus-circle\"}),\" \",\" \"]})}),/*#__PURE__*/_jsx(Col,{md:\"12\",className:\"table-responsive styled-table-div\",children:/*#__PURE__*/_jsxs(Table,{className:\"table table-striped table-hover styled-table table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:t(\"Warrant Type\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"Commercial Value\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"Quick V-Value\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"Description\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"LTV%\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"Appraisal Date\")}),/*#__PURE__*/_jsx(\"th\",{className:\"text-end\",children:t(\"Actions\")})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:datacOMISION})]})})]}),/*#__PURE__*/_jsx(ModalNewWarrant,{saveData:saveData,botones:botonValidation,tipo:tipo,dataSet:dataSet,isOpen:displayModal,toggle:toggleModal}),error_dlg?/*#__PURE__*/_jsx(SweetAlert,{error:true,title:t(\"ErrorDialog\"),confirmButtonText:t(\"Confirm\"),cancelButtonText:t(\"Cancel\"),onConfirm:function onConfirm(){seterror_dlg(false);initializeData();},children:error_msg}):null,confirm_alert?/*#__PURE__*/_jsx(SweetAlert,{title:t(\"Areyousure\"),warning:true,showCancel:true,confirmButtonText:t(\"Yesdeleteit\"),cancelButtonText:t(\"Cancel\"),confirmBtnBsStyle:\"success\",cancelBtnBsStyle:\"danger\",onConfirm:function onConfirm(){var apiBack=new BackendServices();// eliminarGarantiaPropCred\napiBack.eliminarGarantiaPropCred(props.dataSet.facilityId,dataSet.guaranteeId).then(function(resp){if(resp.statusCode==\"500\"){setconfirm_alert(false);seterror_dlg(false);}else{setconfirm_alert(false);setsuccessSave_dlg(true);}initializeData();}).catch(function(error){setconfirm_alert(false);seterror_dlg(false);});},onCancel:function onCancel(){return setconfirm_alert(false);},children:t(\"Youwontbeabletorevertthis\")}):null]});};var WarrantsSection=function WarrantsSection(props){return/*#__PURE__*/_jsx(WarrantsList,{dataSet:props.dataSet,items:props.warrants});};export default WarrantsSection;","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/pages/CommercialCredit/5_PropuestaCredito/Secciones/WarrantsSection.js"],"names":["React","useState","Link","useLocation","SweetAlert","Row","Col","Table","Button","ModalNewWarrant","BackendServices","useTranslation","CoreServices","Currency","moment","WarrantsList","props","currencyData","t","i18n","api","location","successSave_dlg","setsuccessSave_dlg","error_dlg","seterror_dlg","error_msg","seterror_msg","confirm_alert","setconfirm_alert","displayModal","setDisplayModal","botonValidation","setbotonValidation","tipo","settipo","coreServices","datacOMISION","setdatacOMISION","dataSet","setdataSet","useEffect","initializeData","formatDate","date","format","getTipoGarantiaCatalogo","then","response","consultarGarantiaPropCred","facilityId","resp","undefined","map","data","status","Records","find","x","Code","guaranteeTypeName","Description","formatTable","commercialValue","fastValue","observations","ltv","appraisalDate","textAlign","updateData","deleteData","tipo2","toggleModal","items","saveData","values","requestId","Number","getRealValue","signature","trustNumber","fiduciary","nuevoGarantiaPropCred","catch","err","guaranteeId","actualizarGarantiaPropCred","margin","apiBack","eliminarGarantiaPropCred","statusCode","error","WarrantsSection","warrants"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\"\r\nimport PropTypes from 'prop-types';\r\nimport { Link, useLocation } from \"react-router-dom\"\r\nimport SweetAlert from \"react-bootstrap-sweetalert\"\r\nimport {\r\n  Row,\r\n  Col,\r\n  Table,\r\n  Button\r\n} from \"reactstrap\"\r\nimport ModalNewWarrant from \"./ModalNewWarrant\";\r\nimport { BackendServices } from \"../../../../services\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { CoreServices } from '../../../../services';\r\nimport Currency from \"../../../../helpers/currency\"\r\nimport moment from \"moment\";\r\nconst WarrantsList = (props) => {\r\n  const currencyData = new Currency();\r\n\r\n  const { t, i18n } = useTranslation();\r\n  const api = new BackendServices();\r\n  const location = useLocation()\r\n  const [successSave_dlg, setsuccessSave_dlg] = useState(false);\r\n  const [error_dlg, seterror_dlg] = useState(false);\r\n  const [error_msg, seterror_msg] = useState(\"\");\r\n  const [confirm_alert, setconfirm_alert] = useState(false)\r\n  const [displayModal, setDisplayModal] = useState(false);\r\n  const [botonValidation, setbotonValidation] = useState(true);\r\n  const [tipo, settipo] = useState(\"\");\r\n  const coreServices = new CoreServices();\r\n  const [datacOMISION, setdatacOMISION] = useState(null);\r\n  const [dataSet, setdataSet] = useState({\r\n    \"guaranteeId\": 1,\r\n    \"guaranteeTypeName\": \"\",\r\n    \"commercialValue\": 0,\r\n    \"fastValue\": 0,\r\n    \"observations\": \"\",\r\n    \"ltv\": 0,\r\n    \"appraisalDate\": \"\",\r\n    \"signature\": \"\",\r\n    \"trustNumber\": \"\",\r\n    \"fiduciary\": \"\",\r\n    \"status\": true\r\n  });\r\n\r\n  React.useEffect(() => {\r\n    // Read Api Service data\r\n    initializeData();\r\n  }, []);\r\n  function formatDate(date) {\r\n    return date === '0001-01-01' || date === '' ? '' : moment(date).format(\"DD/MM/YYYY\");\r\n  }\r\n  function initializeData() {\r\n    // getTipoGarantiaCatalogo\r\n    coreServices.getTipoGarantiaCatalogo().then(response => {\r\n      api.consultarGarantiaPropCred(props.dataSet.facilityId).then(resp => {\r\n        if (resp != undefined) {\r\n          setdatacOMISION(resp.map((data) => (\r\n            data.status ?\r\n              <tr key={data}>\r\n                <td>{response.Records.find(x => x.Code === data.guaranteeTypeName)?.Description}</td>\r\n                <td>{currencyData.formatTable(data.commercialValue ?? 0)}</td>\r\n                <td>{currencyData.formatTable(data.fastValue ?? 0)}</td>\r\n                <td>{data.observations}</td>\r\n                <td>{currencyData.formatTable(data.ltv)}%</td>\r\n                <td>{formatDate(data.appraisalDate)}</td>\r\n                <td style={{ textAlign: \"right\" }}>\r\n                  <Button type=\"button\" color=\"link\" onClick={(resp) => {\r\n                    updateData(data, \"ECOMISION\")\r\n                  }} className=\"btn btn-link\" ><i className=\"mdi mdi-border-color mdi-24px\"></i></Button>\r\n                  <Button type=\"button\" color=\"link\" onClick={(resp) => {\r\n                    deleteData(data, \"DCOMISION\")\r\n                  }} className=\"btn btn-link\" ><i className=\"mdi mdi-trash-can-outline mdi-24px\"></i></Button>\r\n                </td>\r\n              </tr> : null)\r\n          ));\r\n        } else {\r\n          setdatacOMISION(\r\n            <tr key={1}>\r\n              <td colSpan=\"10\" style={{ textAlign: 'center' }}></td>\r\n            </tr>);\r\n        }\r\n      })\r\n    });\r\n\r\n  }\r\n  function updateData(data, tipo2) {\r\n    data.appraisalDate = data.appraisalDate === '' ? '' : data.appraisalDate;\r\n    setdataSet(data)\r\n    setbotonValidation(true);\r\n    settipo(tipo2);\r\n    setDisplayModal(true);\r\n  }\r\n  function deleteData(data, tipo2) {\r\n    setdataSet(data)\r\n    settipo(tipo2);\r\n    setconfirm_alert(true);\r\n  }\r\n  function toggleModal() {\r\n    setDisplayModal(!displayModal);\r\n  }\r\n  if (!props.items) {\r\n    return null;\r\n  }\r\n  function saveData(values, tipo2) {\r\n    values.requestId = props.dataSet.facilityId;\r\n    values.commercialValue = Number(currencyData.getRealValue(values.commercialValue));\r\n    values.fastValue = Number(currencyData.getRealValue(values.fastValue));\r\n    values.ltv = Number(values.ltv);\r\n    values.signature = \" \";\r\n    values.trustNumber = \" \";\r\n    values.fiduciary = \" \";\r\n    values.appraisalDate = values?.appraisalDate == \"\" || values?.appraisalDate == null || values?.appraisalDate == undefined ? \"\" : values?.appraisalDate;\r\n    if (tipo2 == \"COMISION\") {\r\n      api.nuevoGarantiaPropCred(values).then(resp => {\r\n        if (resp !== null && resp !== undefined) {\r\n          setsuccessSave_dlg(true)\r\n          toggleModal();\r\n        } else {\r\n          toggleModal();\r\n          seterror_dlg(false);\r\n        }\r\n        initializeData();\r\n      }).catch(err => {\r\n        seterror_dlg(false);\r\n      })\r\n    }\r\n    if (tipo2 == \"ECOMISION\") {\r\n      values.guaranteeId = dataSet.guaranteeId;\r\n      values.appraisalDate = values?.appraisalDate == \"\" || values?.appraisalDate == null || values?.appraisalDate == undefined ? \"\" : values?.appraisalDate;\r\n      values.status = true;\r\n      api.actualizarGarantiaPropCred(values).then(resp => {\r\n        if (resp !== null && resp !== undefined) {\r\n          setsuccessSave_dlg(true)\r\n          toggleModal();\r\n        } else {\r\n          toggleModal();\r\n          seterror_dlg(false);\r\n        }\r\n        initializeData();\r\n      }).catch(err => {\r\n        seterror_dlg(false);\r\n      })\r\n    }\r\n\r\n  }\r\n  function toggleModal() {\r\n    setDisplayModal(!displayModal);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {/* <h5>{t(\"Warrants\")}</h5> */}\r\n      <Row className=\"mb-3\">\r\n        <Col md=\"6\">\r\n          <h5 className=\"card-sub-title\">{t(\"Warrants\")}</h5>\r\n        </Col>\r\n        <Col md=\"6\" style={{ textAlign: \"right\" }}>\r\n          <Button className=\"btn\" color=\"success\" type=\"button\" style={{ margin: '5px' }} onClick={() => {\r\n            setbotonValidation(true); setdataSet({\r\n              \"guaranteeId\": 1,\r\n              \"guaranteeTypeName\": \"\",\r\n              \"commercialValue\": 0,\r\n              \"fastValue\": 0,\r\n              \"observations\": \"\",\r\n              \"ltv\": 0,\r\n              \"appraisalDate\": \"\",\r\n              \"signature\": \"\",\r\n              \"trustNumber\": \"\",\r\n              \"fiduciary\": \"\",\r\n              \"status\": true\r\n            }); settipo(\"COMISION\"); toggleModal()\r\n          }} title={t(\"Add\")}><i className=\"fas fa-lg fa-plus-circle\"></i> {(\" \")}</Button>\r\n        </Col>\r\n        <Col md=\"12\" className=\"table-responsive styled-table-div\">\r\n          <Table className=\"table table-striped table-hover styled-table table\" >\r\n            <thead  >\r\n              <tr>\r\n                <th>{t(\"Warrant Type\")}</th>\r\n                <th>{t(\"Commercial Value\")}</th>\r\n                <th>{t(\"Quick V-Value\")}</th>\r\n                <th>{t(\"Description\")}</th>\r\n                <th>{t(\"LTV%\")}</th>\r\n                <th>{t(\"Appraisal Date\")}</th>\r\n                <th className=\"text-end\">{t(\"Actions\")}</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {datacOMISION}\r\n            </tbody>\r\n          </Table>\r\n        </Col>\r\n      </Row>\r\n      <ModalNewWarrant saveData={saveData} botones={botonValidation} tipo={tipo} dataSet={dataSet} isOpen={displayModal} toggle={toggleModal} />\r\n      {/* {successSave_dlg ? (\r\n        <SweetAlert\r\n          success\r\n          title={t(\"SuccessDialog\")}\r\n          confirmButtonText= {t(\"Confirm\")}\r\n          cancelButtonText= {t(\"Cancel\")}\r\n          onConfirm={() => {\r\n            setsuccessSave_dlg(false)\r\n            initializeData();\r\n          }}\r\n        >\r\n          {t(\"SuccessSaveMessage\")}\r\n        </SweetAlert>\r\n      ) : null} */}\r\n\r\n      {error_dlg ? (\r\n        <SweetAlert\r\n          error\r\n          title={t(\"ErrorDialog\")}\r\n          confirmButtonText={t(\"Confirm\")}\r\n          cancelButtonText={t(\"Cancel\")}\r\n          onConfirm={() => {\r\n            seterror_dlg(false)\r\n            initializeData();\r\n          }}\r\n        >\r\n          {error_msg}\r\n        </SweetAlert>\r\n      ) : null}\r\n      {confirm_alert ? (\r\n        <SweetAlert\r\n          title={t(\"Areyousure\")}\r\n          warning\r\n          showCancel\r\n          confirmButtonText={t(\"Yesdeleteit\")}\r\n          cancelButtonText={t(\"Cancel\")}\r\n          confirmBtnBsStyle=\"success\"\r\n          cancelBtnBsStyle=\"danger\"\r\n          onConfirm={() => {\r\n            const apiBack = new BackendServices();\r\n            // eliminarGarantiaPropCred\r\n            apiBack.eliminarGarantiaPropCred(props.dataSet.facilityId, dataSet.guaranteeId).then(resp => {\r\n              if (resp.statusCode == \"500\") {\r\n                setconfirm_alert(false)\r\n                seterror_dlg(false)\r\n              } else {\r\n                setconfirm_alert(false)\r\n                setsuccessSave_dlg(true)\r\n              }\r\n              initializeData();\r\n            }).catch(error => {\r\n              setconfirm_alert(false)\r\n              seterror_dlg(false)\r\n            })\r\n          }}\r\n          onCancel={() => setconfirm_alert(false)}\r\n        >\r\n          {t(\"Youwontbeabletorevertthis\")}\r\n        </SweetAlert>\r\n      ) : null}\r\n    </>\r\n  );\r\n};\r\nconst WarrantsSection = (props) => {\r\n  return (\r\n    <WarrantsList dataSet={props.dataSet} items={props.warrants} />\r\n  );\r\n};\r\nWarrantsSection.propTypes = {\r\n  warrants: PropTypes.array.isRequired,\r\n  onSaveItem: PropTypes.func.isRequired,\r\n  onDeleteItem: PropTypes.func.isRequired,\r\n};\r\nexport default WarrantsSection;\r\n"]},"metadata":{},"sourceType":"module"}