{"ast":null,"code":"var _jsxFileName = \"D:\\\\_PROJECTS\\\\_SOAINT\\\\JBPM\\\\App\\\\banescocreditoscomerciales\\\\src\\\\components\\\\InformeFinanciero\\\\background\\\\FacilityDetails.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useContext, useRef, useEffect } from \"react\";\nimport PropTypes from 'prop-types';\nimport { formatCurrency, translationHelper } from '../../../helpers';\nimport { Table } from \"reactstrap\";\nimport HeaderSections from '../../Common/HeaderSections';\nimport { BackendServices } from '../../../services';\nimport { useLocation, useHistory } from 'react-router-dom';\nimport * as url from \"../../../helpers/url_helper\";\nimport Currency from \"../../../helpers/currency\";\nimport { useTranslation } from \"react-i18next\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst FacilityDetails = props => {\n  _s();\n\n  console.log(props); // const t = translationHelper('financial_report');\n\n  const [dataRows, setdataRows] = useState(null);\n  const api = new BackendServices();\n  const location = useLocation();\n  const [locationData, setLocationData] = useState(null);\n  const history = useHistory();\n  const currencyData = new Currency();\n  const {\n    t,\n    i18n\n  } = useTranslation();\n  React.useEffect(() => {\n    let dataSession;\n\n    if (location.data !== null && location.data !== undefined) {\n      if (location.data.transactionId === undefined || location.data.transactionId.length <= 0) {\n        //location.data.transactionId = 0;\n        //checkAndCreateProcedure(location.data);\n        history.push(url.URL_DASHBOARD);\n      } else {\n        sessionStorage.setItem('locationData', JSON.stringify(location.data));\n        setLocationData(location.data);\n        dataSession = location.data;\n      }\n    } else {\n      //chequeamos si tenemos guardado en session\n      var result = sessionStorage.getItem('locationData');\n\n      if (result !== undefined && result !== null) {\n        result = JSON.parse(result);\n        setLocationData(result);\n        dataSession = result;\n      }\n    } // Read Api Service data\n\n\n    cargarFacilidades(dataSession);\n  }, []);\n\n  function cargarFacilidades(dataSession) {\n    api.consultarDeudores(dataSession.transactionId).then(data2 => {\n      if (data2 !== null && data2 !== undefined) {\n        let jsonDeudores = [];\n\n        for (let i = 0; i < data2.length; i++) {\n          jsonDeudores.push({\n            label: data2[i][\"name\"] + \" \" + data2[i][\"name2\"] + \" \" + data2[i][\"lastName\"] + \" \" + data2[i][\"lastName2\"],\n            value: data2[i][\"personId\"]\n          });\n        }\n\n        api.consultGeneralDataPropCred(dataSession.transactionId).then(data => {\n          if (data !== undefined) {\n            var datosgenerales = data.length == 0 ? undefined : data[0].requestId;\n\n            if (datosgenerales === undefined || datosgenerales == null) {\n              datosgenerales = data[data.length - 1];\n              return;\n            }\n\n            api.retrieveProposalType().then(propuesta => {\n              api.retrieveFacilityType().then(facilidad => {\n                api.consultarFacilidades(datosgenerales).then(resp => {\n                  let acu = 0;\n\n                  if ((resp === null || resp === void 0 ? void 0 : resp.filter(data => data.debtor != \"  \").length) > 0) {\n                    // initializeData(dataSession);\n                    setdataRows(resp.map((data, index) => {\n                      var _jsonDeudores$find, _facilidad$find, _propuesta$find, _data$amount, _data$proposalRate;\n\n                      acu++;\n                      return /*#__PURE__*/_jsxDEV(\"tr\", {\n                        children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                          \"data-label\": t(\"Facility\"),\n                          children: acu\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 85,\n                          columnNumber: 29\n                        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                          \"data-label\": t(\"Debtor\"),\n                          children: (_jsonDeudores$find = jsonDeudores.find(x => x.value === Number(data.debtor))) === null || _jsonDeudores$find === void 0 ? void 0 : _jsonDeudores$find.label\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 87,\n                          columnNumber: 29\n                        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                          \"data-label\": t(\"Facility Type\"),\n                          children: (_facilidad$find = facilidad.find(x => x.id === data.facilityTypeId)) === null || _facilidad$find === void 0 ? void 0 : _facilidad$find.description\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 88,\n                          columnNumber: 29\n                        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                          \"data-label\": t(\"Proposal\"),\n                          children: (_propuesta$find = propuesta.find(x => x.id === data.proposalTypeId)) === null || _propuesta$find === void 0 ? void 0 : _propuesta$find.description\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 89,\n                          columnNumber: 29\n                        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                          \"data-label\": t(\"Approved Risk\"),\n                          children: currencyData.format((_data$amount = data.amount) !== null && _data$amount !== void 0 ? _data$amount : 0)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 90,\n                          columnNumber: 29\n                        }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                          \"data-label\": t(\"Amount\") + \" \" + t(\"Rate\"),\n                          children: currencyData.format((_data$proposalRate = data.proposalRate) !== null && _data$proposalRate !== void 0 ? _data$proposalRate : 0)\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 91,\n                          columnNumber: 29\n                        }, this)]\n                      }, acu, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 84,\n                        columnNumber: 27\n                      }, this);\n                    }));\n                  } else {\n                    setdataRows( /*#__PURE__*/_jsxDEV(\"tr\", {\n                      children: /*#__PURE__*/_jsxDEV(\"td\", {\n                        colSpan: \"7\",\n                        style: {\n                          textAlign: 'center'\n                        }\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 98,\n                        columnNumber: 27\n                      }, this)\n                    }, 1, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 97,\n                      columnNumber: 25\n                    }, this));\n                  }\n                });\n              });\n            });\n          } else {}\n        });\n      }\n    }).catch(error => {\n      console.error('api error: ', error);\n    });\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"table-responsive\",\n    children: [/*#__PURE__*/_jsxDEV(HeaderSections, {\n      title: \"Facility details\",\n      t: t\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"table-responsive styled-table-div\",\n      children: /*#__PURE__*/_jsxDEV(Table, {\n        className: \"table table-striped table-hover styled-table table\",\n        children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n          children: /*#__PURE__*/_jsxDEV(\"tr\", {\n            children: [/*#__PURE__*/_jsxDEV(\"th\", {\n              children: t(\"Facility\")\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 126,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: t(\"Debtor\")\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 127,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: t(\"Facility Type\")\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 128,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: t(\"Proposal\")\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 129,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: t(\"Approved Risk\")\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 130,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n              children: t(\"Amount\") + \" \" + t(\"Rate\")\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 131,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: dataRows\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 118,\n    columnNumber: 5\n  }, this);\n};\n\n_s(FacilityDetails, \"IQa3jkd045aqm5NoOBzrwIEnoMk=\", false, function () {\n  return [useLocation, useHistory, useTranslation];\n});\n\n_c = FacilityDetails;\nexport default FacilityDetails;\n\nvar _c;\n\n$RefreshReg$(_c, \"FacilityDetails\");","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/components/InformeFinanciero/background/FacilityDetails.js"],"names":["React","useState","useContext","useRef","useEffect","PropTypes","formatCurrency","translationHelper","Table","HeaderSections","BackendServices","useLocation","useHistory","url","Currency","useTranslation","FacilityDetails","props","console","log","dataRows","setdataRows","api","location","locationData","setLocationData","history","currencyData","t","i18n","dataSession","data","undefined","transactionId","length","push","URL_DASHBOARD","sessionStorage","setItem","JSON","stringify","result","getItem","parse","cargarFacilidades","consultarDeudores","then","data2","jsonDeudores","i","label","value","consultGeneralDataPropCred","datosgenerales","requestId","retrieveProposalType","propuesta","retrieveFacilityType","facilidad","consultarFacilidades","resp","acu","filter","debtor","map","index","find","x","Number","id","facilityTypeId","description","proposalTypeId","format","amount","proposalRate","textAlign","catch","error"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useRef, useEffect } from \"react\"\r\nimport PropTypes from 'prop-types';\r\nimport { formatCurrency, translationHelper } from '../../../helpers';\r\n\r\nimport {\r\n  Table,\r\n} from \"reactstrap\"\r\nimport HeaderSections from '../../Common/HeaderSections';\r\nimport { BackendServices } from '../../../services';\r\nimport { useLocation, useHistory } from 'react-router-dom';\r\nimport * as url from \"../../../helpers/url_helper\"\r\nimport Currency from \"../../../helpers/currency\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\n\r\nconst FacilityDetails = (props) => {\r\n\r\n  console.log(props);\r\n  // const t = translationHelper('financial_report');\r\n\r\n  const [dataRows, setdataRows] = useState(null);\r\n\r\n  const api = new BackendServices();\r\n  const location = useLocation()\r\n  const [locationData, setLocationData] = useState(null);\r\n  const history = useHistory();\r\n  const currencyData = new Currency();\r\n  const { t, i18n } = useTranslation();\r\n\r\n  React.useEffect(() => {\r\n\r\n    let dataSession;\r\n    if (location.data !== null && location.data !== undefined) {\r\n      if (location.data.transactionId === undefined || location.data.transactionId.length <= 0) {\r\n        //location.data.transactionId = 0;\r\n        //checkAndCreateProcedure(location.data);\r\n        history.push(url.URL_DASHBOARD);\r\n      }\r\n      else {\r\n        sessionStorage.setItem('locationData', JSON.stringify(location.data));\r\n        setLocationData(location.data);\r\n        dataSession = location.data;\r\n      }\r\n    }\r\n    else {\r\n      //chequeamos si tenemos guardado en session\r\n      var result = sessionStorage.getItem('locationData');\r\n      if (result !== undefined && result !== null) {\r\n        result = JSON.parse(result);\r\n        setLocationData(result);\r\n        dataSession = result;\r\n      }\r\n    }\r\n\r\n    // Read Api Service data\r\n    cargarFacilidades(dataSession)\r\n  }, []);\r\n\r\n\r\n  function cargarFacilidades(dataSession) {\r\n    api.consultarDeudores(dataSession.transactionId)\r\n      .then((data2) => {\r\n        if (data2 !== null && data2 !== undefined) {\r\n          let jsonDeudores = [];\r\n          for (let i = 0; i < data2.length; i++) {\r\n            jsonDeudores.push({ label: data2[i][\"name\"] + \" \" + data2[i][\"name2\"] + \" \" + data2[i][\"lastName\"] + \" \" + data2[i][\"lastName2\"], value: data2[i][\"personId\"] })\r\n          }\r\n          api.consultGeneralDataPropCred(dataSession.transactionId).then((data) => {\r\n            if (data !== undefined) {\r\n              var datosgenerales = data.length == 0 ? undefined : data[0].requestId;\r\n              if (datosgenerales === undefined || datosgenerales == null) {\r\n                datosgenerales = data[data.length - 1];\r\n                return;\r\n              }\r\n              api.retrieveProposalType().then((propuesta) => {\r\n                api.retrieveFacilityType().then((facilidad) => {\r\n                  api.consultarFacilidades(datosgenerales).then(resp => {\r\n                    let acu = 0;\r\n                    if (resp?.filter(data => data.debtor != \"  \").length > 0) {\r\n                      // initializeData(dataSession);\r\n                      setdataRows(resp.map((data, index) => {\r\n                        acu++;\r\n                        return (\r\n                          <tr key={acu}>\r\n                            <td data-label={t(\"Facility\")}>{acu}</td>\r\n                            {/* <td>{data.debtor}</td> */}\r\n                            <td data-label={t(\"Debtor\")}>{jsonDeudores.find(x => x.value === Number(data.debtor))?.label}</td>\r\n                            <td data-label={t(\"Facility Type\")}>{facilidad.find(x => x.id === data.facilityTypeId)?.description}</td>\r\n                            <td data-label={t(\"Proposal\")}>{propuesta.find(x => x.id === data.proposalTypeId)?.description}</td>\r\n                            <td data-label={t(\"Approved Risk\")}>{currencyData.format(data.amount ?? 0)}</td>\r\n                            <td data-label={t(\"Amount\") + \" \" + t(\"Rate\")}>{currencyData.format(data.proposalRate ?? 0)}</td>\r\n                          </tr>)\r\n                      }\r\n                      ));\r\n                    } else {\r\n                      setdataRows(\r\n                        <tr key={1}>\r\n                          <td colSpan=\"7\" style={{ textAlign: 'center' }}></td>\r\n                        </tr>);\r\n                    }\r\n                  });\r\n                })\r\n              })\r\n            }\r\n            else {\r\n            }\r\n          });\r\n\r\n        }\r\n\r\n      })\r\n      .catch((error) => {\r\n        console.error('api error: ', error);\r\n      });\r\n  }\r\n\r\n  return (\r\n    <div className=\"table-responsive\">\r\n      {/* <h5>{t(\"FacilityDetails.Title\")}</h5> */}\r\n      <HeaderSections title=\"Facility details\" t={t}></HeaderSections>\r\n\r\n      <div className=\"table-responsive styled-table-div\">\r\n        <Table className=\"table table-striped table-hover styled-table table\" >\r\n          <thead>\r\n            <tr>\r\n              <th>{t(\"Facility\")}</th>\r\n              <th>{t(\"Debtor\")}</th>\r\n              <th>{t(\"Facility Type\")}</th>\r\n              <th>{t(\"Proposal\")}</th>\r\n              <th>{t(\"Approved Risk\")}</th>\r\n              <th>{t(\"Amount\") + \" \" + t(\"Rate\")}</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {dataRows}\r\n          </tbody>\r\n        </Table>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n};\r\n\r\n\r\nexport default FacilityDetails;\r\n"]},"metadata":{},"sourceType":"module"}