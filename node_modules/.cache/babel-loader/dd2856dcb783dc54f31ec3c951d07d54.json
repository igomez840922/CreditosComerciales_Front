{"ast":null,"code":"import _regeneratorRuntime from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import{useLocation,useHistory}from'react-router-dom';import*as opt from\"../../../helpers/options_helper\";import*as url from\"../../../helpers/url_helper\";import moment from\"moment\";import{Row,Col,Card,CardBody,Label,CardFooter,Button,Table,CardHeader}from\"reactstrap\";import Alert from'react-bootstrap/Alert';import{Link}from\"react-router-dom\";import Breadcrumbs from\"../../../components/Common/Breadcrumb\";import{setDefaults,useTranslation}from\"react-i18next\";import LoadingOverlay from'react-loading-overlay';import ClientForm from\"./ClientForm\";import ModalEndProcess from\"../../../components/EndProcess/ModalEndProcess\";import{BackendServices,CoreServices,BpmServices}from\"../../../services\";import{PersonModel}from'../../../models/Common/PersonModel';import{InfoBpmModel}from'../../../models/Common/InfoBpmModel';import SearchClientCore from\"../../../components/Common/SearchClientCore\";import SessionHelper from\"../../../helpers/SessionHelper\";import{LogProcessModel}from'../../../models/Common/LogProcessModel';import LogProcess from\"../../../components/LogProcess/index\";import ErrorHandler from\"../../../components/Common/ErrorHandler\";import LocalStorageHelper from\"../../../helpers/LocalStorageHelper\";import ModalSearchClient from\"./ModalSearchClient\";import ModalClientForm from\"./ModalClientForm\";import ModalBitacora from\"../../../components/Common/ModalBitacora\";import AttachmentFileCore from'../../../components/Common/AttachmentFileCore';import{AttachmentFileInputModel}from\"../../../models/Common/AttachmentFileInputModel\";import SweetAlert from\"react-bootstrap-sweetalert\";import{saveLogProcess}from\"../../../helpers/logs_helper\";import HorizontalSteeper from\"../../../components/Common/HorizontalSteeper\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PreRequest=function PreRequest(props){var _useTranslation=useTranslation(),t=_useTranslation.t,i18n=_useTranslation.i18n;var history=useHistory();var location=useLocation();var _useState=useState(undefined),_useState2=_slicedToArray(_useState,2),locationData=_useState2[0],setLocationData=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isActiveLoading=_useState4[0],setIsActiveLoading=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),openNewClient=_useState6[0],setopenNewClient=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),dataClientList=_useState8[0],setdataClientList=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),dataDelete=_useState10[0],setDataDelete=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),confirm_alert=_useState12[0],setconfirm_alert=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),error_dlg=_useState14[0],seterror_dlg=_useState14[1];var _useState15=useState(undefined),_useState16=_slicedToArray(_useState15,2),selectedClient=_useState16[0],setselectedClient=_useState16[1];var _useState17=useState([]),_useState18=_slicedToArray(_useState17,2),identificationTypeList=_useState18[0],setidentificationTypeList=_useState18[1];var _useState19=useState([]),_useState20=_slicedToArray(_useState19,2),personTypeList=_useState20[0],setpersonTypeList=_useState20[1];var _useState21=useState(false),_useState22=_slicedToArray(_useState21,2),displayModalEndProcess=_useState22[0],setdisplayModalEndProcess=_useState22[1];var _useState23=useState({show:false,msg:\"\",isError:false}),_useState24=_slicedToArray(_useState23,2),msgData=_useState24[0],setmsgData=_useState24[1];//Servicios\nvar _useState25=useState(new BackendServices()),_useState26=_slicedToArray(_useState25,2),backendServices=_useState26[0],setbackendServices=_useState26[1];var _useState27=useState(new CoreServices()),_useState28=_slicedToArray(_useState27,2),coreServices=_useState28[0],setcoreServices=_useState28[1];var _useState29=useState(new BpmServices()),_useState30=_slicedToArray(_useState29,2),bpmServices=_useState30[0],setbpmServices=_useState30[1];var _useState31=useState(new SessionHelper()),_useState32=_slicedToArray(_useState31,2),sessionHelper=_useState32[0],setsessionHelper=_useState32[1];var _useState33=useState(new LocalStorageHelper()),_useState34=_slicedToArray(_useState33,2),localStorageHelper=_useState34[0],setlocalStorageHelper=_useState34[1];var _useState35=useState(false),_useState36=_slicedToArray(_useState35,2),showModalSearchClient=_useState36[0],setshowModalSearchClient=_useState36[1];var _useState37=useState(false),_useState38=_slicedToArray(_useState37,2),displayModalBitacora=_useState38[0],setdisplayModalBitacora=_useState38[1];var _useState39=useState(null),_useState40=_slicedToArray(_useState39,2),optionSelected=_useState40[0],setoptionSelected=_useState40[1];var _useState41=useState(false),_useState42=_slicedToArray(_useState41,2),activitySuccess=_useState42[0],setactivitySuccess=_useState42[1];var _useState43=useState(false),_useState44=_slicedToArray(_useState43,2),updatedataLog=_useState44[0],setupdatedataLog=_useState44[1];var _useState45=useState(false),_useState46=_slicedToArray(_useState45,2),staffChecked=_useState46[0],setstaffChecked=_useState46[1];var _useState47=useState(null),_useState48=_slicedToArray(_useState47,2),attachmentFileInputModel=_useState48[0],setattachmentFileInputModel=_useState48[1];//On Mounting (componentDidMount)\nReact.useEffect(function(){var data=location.data!==undefined?location.data:sessionHelper.get(opt.VARNAME_LOCATIONDATA);if(data!==null&&data!==undefined){if(data.transactionId===undefined||data.transactionId.length<=0){data.transactionId=0;checkAndCreateProcedure(data);}else{setLocationData(data);fetchData(data);}}else{history.push(url.URL_DASHBOARD);}},[]);//Caraga Inicial de datos\nfunction fetchData(locationData){setattachmentFileInputModel(new AttachmentFileInputModel(locationData.transactionId,opt.PROCESS_BUSQUEDADESCARTE,opt.ACT_NONE));//chequear si la tarea no ha sido iniciada\n/*bpmServices.checkAndStartTask(locationData)\r\n      .then((iniresult) => {\r\n        if (iniresult === false) {\r\n          history.push(url.URL_DASHBOARD);\r\n        }\r\n      })*/ //checkAndCreateProcedure(locationData);\nloadIdentificationTypes();loadPersonTypes();getProcessClients(locationData.transactionId);}//CHEQUEAMOS Y GENERAMOS EL PROCESO EN BASE DE DATOS\nfunction checkAndCreateProcedure(locationData){var _credentials$usr;var credentials=localStorageHelper.get(opt.VARNAME_USRCREDENTIAL);backendServices.nuevoTramite(locationData.transactionId,locationData.instanceId,opt.PROCESS_BUSQUEDADESCARTE,opt.PROCESS_BUSQUEDADESCARTE,(_credentials$usr=credentials===null||credentials===void 0?void 0:credentials.usr)!==null&&_credentials$usr!==void 0?_credentials$usr:\"admin\",\"0\").then(function(data){if(data!==null&&data!==undefined){locationData.transactionId=data.transactId;sessionHelper.save(opt.VARNAME_LOCATIONDATA,locationData);setLocationData(locationData);fetchData(locationData);}}).catch(function(error){});}//cargar lista de tipo de identificacion\nfunction loadIdentificationTypes(){backendServices.consultarCatalogoTipoIdentificacion().then(function(data){if(data!==null&&data!==undefined){var json=[];for(var i=0;i<data.length;i++){json.push({label:t(data[i][\"description\"]),value:data[i][\"id\"]});}setidentificationTypeList(json);}}).catch(function(error){});}//cargar lista de tipo de personas\nfunction loadPersonTypes(){backendServices.consultarCatalogoTipoPersona().then(function(data){if(data!==null&&data!==undefined){var json=[];for(var i=0;i<data.length;i++){json.push({label:t(data[i][\"label\"]),value:data[i][\"code\"]});}setpersonTypeList(json);}}).catch(function(error){});}//se buscan todos los clientes de este proceso \nfunction getProcessClients(transactionId){backendServices.consultarOrquestadoListaPersonaSolicitud(transactionId).then(function(data){if(data!==null&&data!==undefined){setdataClientList(data);/*if (data.length <= 0) {\r\n            setselectedClient(new PersonModel());\r\n            onOpenNewClient();\r\n          }*/}}).catch(function(error){});}//Abrir formulario Persona\nfunction onOpenNewClient(){var show=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;setopenNewClient(show);}//Editar Persona\nfunction onEditClient(dataClient){dataClient[\"isNew\"]=false;setselectedClient(dataClient);onOpenNewClient();}//Eliminar Persona\nfunction removeRelay(data){setDataDelete(data);setconfirm_alert(true);}function onDeleteClient(dataClient){console.log(dataClient);setDataDelete(dataClient);setconfirm_alert(true);//setconfirm_alert(true);\n//eliminarOrquestadoListaPersonaSolicitud\n{/*backendServices.eliminarOrquestadoListaPersonaSolicitud(dataClient)\r\n      .then((data) => {\r\n        getProcessClients(dataClient.transactId);\r\n      }).catch((error) => { });*/}}//retorna el Tipo de Persona\nfunction getPersnoType(pType){return personTypeList.find(function(x){return x.value===pType;});}//retorna el Tipo de identificacion\nfunction getIdentificationType(idType){if(idType!==undefined&&idType!==null&&idType.length>0){return identificationTypeList.find(function(x){return x.value===idType;});}return\"\";}//Carga de Datos de Cliente de T24 Seleccionado\nfunction loadClientDataT24(dataClientT24){console.log(\"loadClientDataT24\",dataClientT24);var clientPerson=new PersonModel();clientPerson.customerNumberT24=dataClientT24.id;clientPerson.clientDocumentId=dataClientT24.idnumber;clientPerson.name=dataClientT24.firstname!==undefined?dataClientT24.firstname:\"\";clientPerson.secondName=dataClientT24.secondname!==undefined?dataClientT24.secondname:\"\";clientPerson.lastName=dataClientT24.lastname!==undefined?dataClientT24.lastname:\"\";clientPerson.secondSurname=dataClientT24.secondlastname!==undefined?dataClientT24.secondlastname:\"\";clientPerson.phone=dataClientT24.phoneNumber!==undefined?dataClientT24.phoneNumber:\"\";clientPerson.email=dataClientT24.email!==undefined?dataClientT24.email:\"\";clientPerson.personType=personTypeList.find(function(x){return x.value===Number(dataClientT24.partyType);}).value;clientPerson.idType=identificationTypeList.find(function(x){return x.value===dataClientT24.idtype;}).value;clientPerson.isNew=false;clientPerson.birthDate=dataClientT24[\"birthdate\"]!==undefined?moment(dataClientT24[\"birthdate\"]).format(\"YYYY-MM-DD\"):clientPerson.birthDate;clientPerson.nationality=dataClientT24[\"nationality\"];onEditClient(clientPerson);}function showSearchClient(){var show=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;setshowModalSearchClient(show);}//Chequear si el deudor principal tiene accionistas y otros y agregarlos automaticamente\nfunction checkDebtorShareholders(){return _checkDebtorShareholders.apply(this,arguments);}//mostrar mensaje \nfunction _checkDebtorShareholders(){_checkDebtorShareholders=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var lDdebtors,p,maindebtor,data,i,_data$i$Identificatio,_data$i$Identificatio2,_data$i$Phone$0$Phone,_data$i$Phone$,clientPerson,resultPerson,_data$i$Shareholding,_data$i,sharehold;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(staffChecked||locationData.instanceId.length>0)){_context.next=2;break;}return _context.abrupt(\"return\");case 2:setstaffChecked(true);setIsActiveLoading(true);_context.prev=4;_context.next=7;return backendServices.consultarDeudores(locationData.transactionId);case 7:lDdebtors=_context.sent;if(!(lDdebtors===null||lDdebtors===undefined||lDdebtors.length<=0)){_context.next=11;break;}showMessage(t(\"Youmustselectatleastonedebtor\"),true);return _context.abrupt(\"return\");case 11:p=0;case 12:if(!(p<lDdebtors.length)){_context.next=62;break;}maindebtor=lDdebtors[p];//buscamos a los accionistas de este deudor\n_context.next=16;return coreServices.getPartiesStaff(maindebtor.customerNumberT24);case 16:data=_context.sent;if(!(data!==null&&data!==undefined&&data.results.length>0)){_context.next=59;break;}data=data.results;i=0;case 20:if(!(i<data.length)){_context.next=56;break;}_context.prev=21;clientPerson=new PersonModel();clientPerson.transactId=locationData.transactionId;clientPerson.personType=data[i].PartyType;// \"1\"; //tipo de Persona\nclientPerson.idType=data[i].PartyType!==undefined&&data[i].PartyType===\"1\"?\"CED\":\"RUC\";//tipo de Identificacion\nclientPerson.clientDocumentId=data[i].Identification!==undefined?(_data$i$Identificatio=(_data$i$Identificatio2=data[i].Identification[0])===null||_data$i$Identificatio2===void 0?void 0:_data$i$Identificatio2.Ident.IssuedIdentValue)!==null&&_data$i$Identificatio!==void 0?_data$i$Identificatio:\"\":\"\";//No. de identificacion\nclientPerson.customerNumberT24=\"\";//No. de Cliente T24\nclientPerson.name=data[i].PersonName.FirstName!==undefined?data[i].PersonName.FirstName:\"\";//1er Nombre\nclientPerson.secondName=data[i].PersonName.SecondName!==undefined?data[i].PersonName.SecondName:\"\";//2do Apellido//2do Nombre\nclientPerson.lastName=data[i].PersonName.LastName!==undefined?data[i].PersonName.LastName:\"\";//1er Apellido\nclientPerson.secondSurname=data[i].PersonName.SecondLastName!==undefined?data[i].PersonName.SecondLastName:\"\";clientPerson.nationality=data[i].Nationality!==undefined?data[i].Nationality:\"\";//Nacionalidad\nclientPerson.birthDate=data[i].BirthDt!==undefined?moment(data[i].BirthDt).format(\"YYYY-MM-DD\"):moment().format(\"YYYY-MM-DD\");//Fecha nacimiento \"1998-08-17\",\nclientPerson.address=\"\";//direccion\nclientPerson.phone=data[i].Phone!==undefined?(_data$i$Phone$0$Phone=(_data$i$Phone$=data[i].Phone[0])===null||_data$i$Phone$===void 0?void 0:_data$i$Phone$.PhoneNum)!==null&&_data$i$Phone$0$Phone!==void 0?_data$i$Phone$0$Phone:\"\":\"\";//Telefono,\n//clientPerson.email=data[i].Phone[0]?.PhoneNum??\"\";//Email\nclientPerson.countryOfResidence=\"PA\";//pais de residencia\nclientPerson.comments=\"\";clientPerson.roles=[{roleId:data[i].StaffPosition}];clientPerson.blacklist=[/*{\r\n                blackList: false, comment: \"\", date: moment().format(\"YYYY-MM-DD\"),\r\n                personId: 0, roleId: data[i].StaffPosition, status: true, transactId: locationData.transactionId\r\n              }*/];console.log(\"sharehold\",data[i]);_context.next=43;return backendServices.nuevoOrquestadoListaPersonaSolicitud(clientPerson);case 43:resultPerson=_context.sent;if(!(resultPerson!==undefined&&data[i].StaffPosition===\"ACC\")){_context.next=48;break;}sharehold={\"transactId\":clientPerson.transactId,\"personId\":resultPerson.personId,\"participation\":Number((_data$i$Shareholding=(_data$i=data[i])===null||_data$i===void 0?void 0:_data$i.Shareholding)!==null&&_data$i$Shareholding!==void 0?_data$i$Shareholding:0),\"yearsExperience\":0,\"status\":true};_context.next=48;return backendServices.salvarAccionistaBD(sharehold);case 48:_context.next=53;break;case 50:_context.prev=50;_context.t0=_context[\"catch\"](21);console.error(_context.t0);case 53:i++;_context.next=20;break;case 56:getProcessClients(locationData.transactionId);_context.next=59;break;case 59:p++;_context.next=12;break;case 62:_context.next=66;break;case 64:_context.prev=64;_context.t1=_context[\"catch\"](4);case 66:_context.prev=66;setIsActiveLoading(false);return _context.finish(66);case 69:case\"end\":return _context.stop();}}},_callee,null,[[4,64,66,69],[21,50]]);}));return _checkDebtorShareholders.apply(this,arguments);}function showMessage(message){var isError=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;setmsgData({show:true,msg:message,isError:isError});}////////// PARTE ES LA FINAL DEL PROCESO ///////\n//Salvando el Proceso y le pasamos una opcion: 1-Finalizar Proceso, 2- Salvarlo, 3- A Cumplimmineto, 4- Avanzar a IGR\nfunction onSaveProcess(option){switch(option){case opt.PROCESS_LISTAEXCLUSION:case opt.PROCESS_CUMPLIMIENTO:{//check si hay clientes sin evaluar en listas negras\nfor(var i=0;i<dataClientList.length;i++){if(dataClientList[i].blacklist.length<=0){showMessage(t(\"ExistClientWithoutVerification\"),true);return;}}//chequear si existe algun deudor para poder continuar\nbackendServices.consultPrincipalDebtor(locationData.transactionId).then(function(data){if(data!==null&&data!==undefined){saveJBPMProcess(option);}else{//Mensaje ERROR\nshowMessage(t(\"Youmustselectatleastonedebtor\"),true);}}).catch(function(error){});var person=null;//check si existen clientes en listas negras\nfor(var i=0;i<dataClientList.length;i++){if(dataClientList[i].blacklist[dataClientList[i].blacklist.length-1].blackList===true){person=dataClientList[i];break;}}if(person!==null&&option===opt.PROCESS_LISTAEXCLUSION){option=opt.PROCESS_CUMPLIMIENTO;}break;}case opt.PROCESS_BUSQUEDADESCARTE:{if(dataClientList.length>0){saveJBPMProcess(option);break;}else{showMessage(t(\"Youmustenteratleastoneclient\"),true);return;}}default:{saveJBPMProcess(option);break;}}}function saveJBPMProcess(_x){return _saveJBPMProcess.apply(this,arguments);}function _saveJBPMProcess(){_saveJBPMProcess=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(option){var result,values,maindebtor,infoBpmModel;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(locationData.instanceId===undefined||locationData.instanceId.length<=0)){_context2.next=16;break;}_context2.next=3;return bpmServices.createNewInstance();case 3:result=_context2.sent;if(!(result!==undefined)){_context2.next=14;break;}//instanceId:result.instanceId,taskId:result.taskId,taskStatus:result.status\nlocationData.instanceId=result.instanceId;locationData.taskId=result.taskId;locationData.taskStatus=result.status;sessionHelper.save(opt.VARNAME_LOCATIONDATA,locationData);//Actualizamos Variables\nvalues={\"transactionId\":locationData.transactionId};_context2.next=12;return bpmServices.updatevariables(locationData.instanceId,values);case 12:_context2.next=16;break;case 14://Mensaje ERROR\nshowMessage(t(\"TheProcessCouldNotFinish\"),true);return _context2.abrupt(\"return\");case 16:_context2.next=18;return backendServices.consultPrincipalDebtor(locationData.transactionId);case 18:maindebtor=_context2.sent;infoBpmModel=new InfoBpmModel(locationData.instanceId,locationData.transactionId,opt.PROCESS_BUSQUEDADESCARTE,opt.ACT_NONE,maindebtor===null||maindebtor===void 0?void 0:maindebtor.personId);infoBpmModel.personName=maindebtor!==undefined?maindebtor.name+\" \"+maindebtor.name2+\" \"+maindebtor.lastName+\" \"+maindebtor.lastName2:\"\";infoBpmModel.personName=infoBpmModel.personName.trim();console.log(\"infoBpmModel\",infoBpmModel,maindebtor);_context2.t0=option;_context2.next=_context2.t0===opt.PROCESS_CANCELPROCESS?26:_context2.t0===opt.PROCESS_BUSQUEDADESCARTE?28:_context2.t0===opt.PROCESS_CUMPLIMIENTO?33:_context2.t0===opt.PROCESS_LISTAEXCLUSION?38:43;break;case 26:bpmServices.abortProcess(locationData.instanceId).then(function(data){if(data!==undefined){history.push(url.URL_DASHBOARD);}else{//Mensaje ERROR\nshowMessage(t(\"TheProcessCouldNotFinish\"),true);}});return _context2.abrupt(\"break\",44);case 28:infoBpmModel.processId=opt.PROCESS_BUSQUEDADESCARTE;infoBpmModel.activityId=opt.ACT_NONE;values={\"info\":JSON.stringify(infoBpmModel),\"processId\":opt.PROCESS_BUSQUEDADESCARTE.toString(),\"activityId\":opt.ACT_DATOSGENERALES.toString(),\"transactionId\":locationData.transactionId.toString()};bpmServices.updatevariables(locationData.instanceId,values).then(function(data){if(data!==undefined){history.push(url.URL_DASHBOARD);}else{showMessage(t(\"ErrorSaveMessage\"),true);}});return _context2.abrupt(\"break\",44);case 33:infoBpmModel.processId=opt.PROCESS_CUMPLIMIENTO;infoBpmModel.activityId=opt.ACT_NONE;values={\"info\":JSON.stringify(infoBpmModel),\"processId\":opt.PROCESS_CUMPLIMIENTO.toString(),\"activityId\":opt.ACT_NONE.toString(),\"transactionId\":locationData.transactionId,\"customerId\":\"\",\"applicationNumber\":\"\",\"procedureNumber\":\"\",\"decision\":\"si\"};bpmServices.completedStatusTask(locationData.taskId,values).then(function(data){if(data!==undefined){saveAutoLog(opt.APPLICATION_STATUS_NREC);setactivitySuccess(true);//history.push(url.URL_DASHBOARD);\n//showMessage(t(\"TheProcessCouldNotFinish\"));\n}else{//Mensaje ERROR\nshowMessage(t(\"ErrorSaveMessage\"),true);}});return _context2.abrupt(\"break\",44);case 38:infoBpmModel.processId=opt.PROCESS_LISTAEXCLUSION;infoBpmModel.activityId=opt.ACT_NONE;values={\"info\":JSON.stringify(infoBpmModel),\"processId\":opt.PROCESS_LISTAEXCLUSION.toString(),\"activityId\":opt.ACT_NONE.toString(),\"transactionId\":locationData.transactionId,\"customerId\":\"\",\"applicationNumber\":\"\",\"procedureNumber\":\"\",\"decision\":\"no\"};bpmServices.completedStatusTask(locationData.taskId,values).then(function(data){if(data!==undefined){saveAutoLog(null);setactivitySuccess(true);//history.push(url.URL_DASHBOARD);\n//showMessage(t(\"TheProcessCouldNotFinish\"));\n}else{//Mensaje ERROR\nshowMessage(t(\"ErrorSaveMessage\"),true);}});return _context2.abrupt(\"break\",44);case 43:return _context2.abrupt(\"break\",44);case 44:case\"end\":return _context2.stop();}}},_callee2);}));return _saveJBPMProcess.apply(this,arguments);}function setError(){throw new Error(\"erro fatal\");}function showModalBitacora(){var show=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;setdisplayModalBitacora(show);}function saveAutoLog(_x2){return _saveAutoLog.apply(this,arguments);}function _saveAutoLog(){_saveAutoLog=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(APPLICATION_STATUS){var _mainDebtor$personId,_APPLICATION_STATUS$i,_APPLICATION_STATUS$n;var mainDebtor,log;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return backendServices.consultPrincipalDebtor(locationData.transactionId);case 2:mainDebtor=_context3.sent;log=new LogProcessModel(locationData.instanceId,locationData.transactionId,0,\"\",\"\",opt.PROCESS_BUSQUEDADESCARTE,opt.ACT_NONE,opt.BPM_ACTIVITY_01);log.clientId=(_mainDebtor$personId=mainDebtor===null||mainDebtor===void 0?void 0:mainDebtor.personId)!==null&&_mainDebtor$personId!==void 0?_mainDebtor$personId:log.clientId;log.observations=t(\"ActivityHasBeenFinishedSuccessfully\");log.requestId=(_APPLICATION_STATUS$i=APPLICATION_STATUS===null||APPLICATION_STATUS===void 0?void 0:APPLICATION_STATUS.id)!==null&&_APPLICATION_STATUS$i!==void 0?_APPLICATION_STATUS$i:0;log.statusDescription=(_APPLICATION_STATUS$n=APPLICATION_STATUS===null||APPLICATION_STATUS===void 0?void 0:APPLICATION_STATUS.name)!==null&&_APPLICATION_STATUS$n!==void 0?_APPLICATION_STATUS$n:\"\";saveLogProcess(log);case 9:case\"end\":return _context3.stop();}}},_callee3);}));return _saveAutoLog.apply(this,arguments);}function setDeleteLog(_x3){return _setDeleteLog.apply(this,arguments);}function _setDeleteLog(){_setDeleteLog=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(clientDataDeleted){var _mainDebtor$personId2;var mainDebtor,log;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:setupdatedataLog(false);_context4.next=3;return backendServices.consultPrincipalDebtor(locationData.transactionId);case 3:mainDebtor=_context4.sent;log=new LogProcessModel(locationData.instanceId,locationData.transactionId,0,\"\",\"\",opt.PROCESS_BUSQUEDADESCARTE,opt.ACT_NONE,opt.BPM_ACTIVITY_01);log.clientId=(_mainDebtor$personId2=mainDebtor===null||mainDebtor===void 0?void 0:mainDebtor.personId)!==null&&_mainDebtor$personId2!==void 0?_mainDebtor$personId2:log.clientId;log.observations=t(\"ParticipantHasBeenDeleted\")+\": \"+(clientDataDeleted.name+\" \"+clientDataDeleted.secondName+\" \"+clientDataDeleted.lastName+\" \"+clientDataDeleted.secondSurname);console.log(\"setDeleteLog\",log.observations);log.requestId=0;log.statusDescription=\"\";saveLogProcess(log);setupdatedataLog(true);case 12:case\"end\":return _context4.stop();}}},_callee4);}));return _setDeleteLog.apply(this,arguments);}return/*#__PURE__*/_jsxs(\"div\",{className:\"page-content\",children:[/*#__PURE__*/_jsx(Breadcrumbs,{title:t(\"CommercialCredit\"),breadcrumbItem:t(\"PreRequest\")}),/*#__PURE__*/_jsx(HorizontalSteeper,{processNumber:1,activeStep:0}),/*#__PURE__*/_jsxs(LoadingOverlay,{active:isActiveLoading,spinner:true,text:t(\"WaitingPlease\"),children:[/*#__PURE__*/_jsxs(Row,{style:{marginTop:\"0px\",marginBottom:\"15px\"},children:[/*#__PURE__*/_jsx(Col,{md:\"3\",style:{textAlign:\"left\"},children:/*#__PURE__*/_jsxs(Button,{color:\"danger\",style:{margin:'5px 0px'},type:\"button\",onClick:function onClick(){setoptionSelected(opt.PROCESS_CANCELPROCESS);showModalBitacora();},children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-cancel mid-12px\"}),\" \",t(\"CancelProcess\")]})}),/*#__PURE__*/_jsxs(Col,{md:\"9\",style:{textAlign:\"right\"},children:[/*#__PURE__*/_jsxs(Button,{color:\"primary\",type:\"button\",style:{marginRight:\"5px\"},onClick:function onClick(){onSaveProcess(opt.PROCESS_BUSQUEDADESCARTE);},children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-content-save-outline mid-12px\"}),\" \",t(\"Exit\")]}),/*#__PURE__*/_jsxs(Button,{color:\"success\",type:\"button\",style:{},onClick:function onClick(){onSaveProcess(opt.PROCESS_LISTAEXCLUSION);},children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-arrow-right-bold-circle-outline mid-12px\"}),\" \",t(\"Advance\")]})]})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(CardHeader,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsxs(Col,{md:6,children:[/*#__PURE__*/_jsx(\"h4\",{className:\"card-title\",children:t(\"PreRequest\")}),/*#__PURE__*/_jsx(\"p\",{className:\"card-title-desc\",children:t(\"This form is official and must be filled out correctly\")})]}),/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{sm:12,style:{textAlign:\"right\"},children:/*#__PURE__*/_jsxs(\"h5\",{className:\"card-title\",style:{textAlign:\"right\"},children:[t(\"Tramit\"),\":\",\" \",\"#\",locationData===null||locationData===void 0?void 0:locationData.transactionId]})})})})]})}),/*#__PURE__*/_jsxs(CardBody,{children:[/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:\"6\",children:/*#__PURE__*/_jsx(\"h5\",{className:\"card-sub-title\",children:t(\"ParticipantsList\")})}),/*#__PURE__*/_jsx(Col,{md:6,style:{textAlign:\"right\"},children:/*#__PURE__*/_jsxs(Button,{className:\"btn\",color:\"success\",type:\"button\",style:{margin:'5px'},onClick:function onClick(){showSearchClient();},title:t(\"Add\"),children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-lg fa-plus-circle\"}),\" \",\" \"]})})]}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsx(\"div\",{className:\"table-responsive styled-table-div\",children:/*#__PURE__*/_jsxs(Table,{className:\"table table-striped table-hover styled-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:t(\"PersonType\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"FullName\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"IdentificationType\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"IdentificationNumber\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"Roles\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"WatchList\")}),/*#__PURE__*/_jsx(\"th\",{})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:dataClientList!==null&&dataClientList!==undefined&&dataClientList.length>0?dataClientList.map(function(item,index){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:getPersnoType(Number(item.personType)).label}),/*#__PURE__*/_jsx(\"td\",{children:Number(item.personType)>1?item.name:item.name+\" \"+item.secondName+\" \"+item.lastName+\" \"+item.secondSurname}),/*#__PURE__*/_jsx(\"td\",{children:getIdentificationType(item.idType).label}),/*#__PURE__*/_jsx(\"td\",{children:item.clientDocumentId}),/*#__PURE__*/_jsx(\"td\",{children:item.roles!==undefined?item.roles.map(function(rol,index){return rol.roleDescription+\" - \";}):null}),/*#__PURE__*/_jsx(\"td\",{children:item.blacklist!==undefined&&item.blacklist.length>0?item.blacklist[item.blacklist.length-1].blackList===true?\"Aplica\":\"No Aplica\":\"Sin Verificar\"}),/*#__PURE__*/_jsxs(\"td\",{style:{textAlign:\"right\"},children:[/*#__PURE__*/_jsx(Link,{to:\"#\",onClick:function onClick(e){onEditClient(item);},children:/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-border-color mdi-24px\"})}),/*#__PURE__*/_jsx(Link,{to:\"#\",onClick:function onClick(e){onDeleteClient(item);},children:/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-trash-can-outline mdi-24px\"})})]})]},index);}):/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:7,children:/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-info\",style:{textAlign:\"center\"},children:t(\"NoData\")})})})})]})})})})]}),locationData?/*#__PURE__*/_jsx(CardBody,{children:/*#__PURE__*/_jsx(AttachmentFileCore,{attachmentFileInputModel:attachmentFileInputModel})}):null,!openNewClient?/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsx(CardFooter,{children:/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsx(Alert,{show:msgData.show,variant:msgData.isError?\"danger\":\"success\",dismissible:true,onClose:function onClose(){console.log(\"onClose\");setmsgData({show:false,msg:\"\",isError:false});},children:msgData.msg})})})})}):null]})]}),locationData?/*#__PURE__*/_jsx(LogProcess,{updatedata:updatedataLog,logProcessModel:new LogProcessModel(locationData.instanceId,locationData.transactionId,0,\"\",\"\",opt.PROCESS_BUSQUEDADESCARTE,opt.ACT_NONE,opt.BPM_ACTIVITY_01)}):null,/*#__PURE__*/_jsxs(Row,{style:{marginTop:\"0px\",marginBottom:\"15px\"},children:[/*#__PURE__*/_jsx(Col,{md:\"3\",style:{textAlign:\"left\"},children:/*#__PURE__*/_jsxs(Button,{color:\"danger\",style:{margin:'5px 0px'},type:\"button\",onClick:function onClick(){setoptionSelected(opt.PROCESS_CANCELPROCESS);showModalBitacora();},children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-cancel mid-12px\"}),\" \",t(\"CancelProcess\")]})}),/*#__PURE__*/_jsxs(Col,{md:\"9\",style:{textAlign:\"right\"},children:[/*#__PURE__*/_jsxs(Button,{color:\"primary\",type:\"button\",style:{marginRight:\"5px\"},onClick:function onClick(){onSaveProcess(opt.PROCESS_BUSQUEDADESCARTE);},children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-content-save-outline mid-12px\"}),\" \",t(\"Exit\")]}),/*#__PURE__*/_jsxs(Button,{color:\"success\",type:\"button\",style:{},onClick:function onClick(){onSaveProcess(opt.PROCESS_LISTAEXCLUSION);},children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-arrow-right-bold-circle-outline mid-12px\"}),\" \",t(\"Advance\")]})]})]}),showModalSearchClient?/*#__PURE__*/_jsx(ModalSearchClient,{isOpen:showModalSearchClient,toggle:function toggle(){showSearchClient(!showModalSearchClient);},onClientSelect:function onClientSelect(data){loadClientDataT24(data);showSearchClient(false);},onNewClientSelect:function onNewClientSelect(data){var person=new PersonModel();person.clientDocumentId=data!==undefined?data:\"\";console.log(\"selectedperson\",data,person);setselectedClient(data!==undefined?person:undefined);onOpenNewClient();showSearchClient(false);}}):null,locationData?/*#__PURE__*/_jsx(ModalClientForm,{isOpen:openNewClient,toggle:function toggle(){onOpenNewClient(!openNewClient);},transactId:locationData.transactionId,clientSelected:selectedClient,onCancel:function onCancel(){onOpenNewClient(false);getProcessClients(locationData.transactionId);},checkDebtorShareholders:checkDebtorShareholders}):null,locationData&&displayModalBitacora?/*#__PURE__*/_jsx(ModalBitacora,{logProcessModel:new LogProcessModel(locationData.instanceId,locationData.transactionId,0,\"\",\"\",opt.PROCESS_CUMPLIMIENTO,opt.ACT_NONE,opt.BPM_ACTIVITY_02),successSaved:function successSaved(){onSaveProcess(optionSelected);},isOpen:displayModalBitacora,toggle:function toggle(){showModalBitacora(false);}}):null,activitySuccess?/*#__PURE__*/_jsx(SweetAlert,{success:true,title:t(\"SuccessDialog\"),confirmButtonText:t(\"Accept\"),onConfirm:function onConfirm(){history.push(url.URL_DASHBOARD);},children:t(\"ActivityFinishedSuccessfully\")}):null,confirm_alert?/*#__PURE__*/_jsx(SweetAlert,{title:t(\"Areyousure\"),warning:true,showCancel:true,confirmButtonText:t(\"Yesdeleteit\"),cancelButtonText:t(\"Cancel\"),confirmBtnBsStyle:\"success\",cancelBtnBsStyle:\"danger\",onConfirm:function onConfirm(){var apiBack=new BackendServices();apiBack.eliminarOrquestadoListaPersonaSolicitud(dataDelete).then(function(resp){if(resp.statusCode==\"500\"){setconfirm_alert(false);seterror_dlg(false);}else{setconfirm_alert(false);setDeleteLog(dataDelete);getProcessClients(dataDelete.transactId);}}).catch(function(error){});},onCancel:function onCancel(){return setconfirm_alert(false);},children:t(\"Youwontbeabletorevertthis\")}):null]});};export default PreRequest;","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/pages/CommercialCredit/1_Presolicitud/index.js"],"names":["React","useState","useLocation","useHistory","opt","url","moment","Row","Col","Card","CardBody","Label","CardFooter","Button","Table","CardHeader","Alert","Link","Breadcrumbs","setDefaults","useTranslation","LoadingOverlay","ClientForm","ModalEndProcess","BackendServices","CoreServices","BpmServices","PersonModel","InfoBpmModel","SearchClientCore","SessionHelper","LogProcessModel","LogProcess","ErrorHandler","LocalStorageHelper","ModalSearchClient","ModalClientForm","ModalBitacora","AttachmentFileCore","AttachmentFileInputModel","SweetAlert","saveLogProcess","HorizontalSteeper","PreRequest","props","t","i18n","history","location","undefined","locationData","setLocationData","isActiveLoading","setIsActiveLoading","openNewClient","setopenNewClient","dataClientList","setdataClientList","dataDelete","setDataDelete","confirm_alert","setconfirm_alert","error_dlg","seterror_dlg","selectedClient","setselectedClient","identificationTypeList","setidentificationTypeList","personTypeList","setpersonTypeList","displayModalEndProcess","setdisplayModalEndProcess","show","msg","isError","msgData","setmsgData","backendServices","setbackendServices","coreServices","setcoreServices","bpmServices","setbpmServices","sessionHelper","setsessionHelper","localStorageHelper","setlocalStorageHelper","showModalSearchClient","setshowModalSearchClient","displayModalBitacora","setdisplayModalBitacora","optionSelected","setoptionSelected","activitySuccess","setactivitySuccess","updatedataLog","setupdatedataLog","staffChecked","setstaffChecked","attachmentFileInputModel","setattachmentFileInputModel","useEffect","data","get","VARNAME_LOCATIONDATA","transactionId","length","checkAndCreateProcedure","fetchData","push","URL_DASHBOARD","PROCESS_BUSQUEDADESCARTE","ACT_NONE","loadIdentificationTypes","loadPersonTypes","getProcessClients","credentials","VARNAME_USRCREDENTIAL","nuevoTramite","instanceId","usr","then","transactId","save","catch","error","consultarCatalogoTipoIdentificacion","json","i","label","value","consultarCatalogoTipoPersona","consultarOrquestadoListaPersonaSolicitud","onOpenNewClient","onEditClient","dataClient","removeRelay","onDeleteClient","console","log","getPersnoType","pType","find","x","getIdentificationType","idType","loadClientDataT24","dataClientT24","clientPerson","customerNumberT24","id","clientDocumentId","idnumber","name","firstname","secondName","secondname","lastName","lastname","secondSurname","secondlastname","phone","phoneNumber","email","personType","Number","partyType","idtype","isNew","birthDate","format","nationality","showSearchClient","checkDebtorShareholders","consultarDeudores","lDdebtors","showMessage","p","maindebtor","getPartiesStaff","results","PartyType","Identification","Ident","IssuedIdentValue","PersonName","FirstName","SecondName","LastName","SecondLastName","Nationality","BirthDt","address","Phone","PhoneNum","countryOfResidence","comments","roles","roleId","StaffPosition","blacklist","nuevoOrquestadoListaPersonaSolicitud","resultPerson","sharehold","personId","Shareholding","salvarAccionistaBD","message","onSaveProcess","option","PROCESS_LISTAEXCLUSION","PROCESS_CUMPLIMIENTO","consultPrincipalDebtor","saveJBPMProcess","person","blackList","createNewInstance","result","taskId","taskStatus","status","values","updatevariables","infoBpmModel","personName","name2","lastName2","trim","PROCESS_CANCELPROCESS","abortProcess","processId","activityId","JSON","stringify","toString","ACT_DATOSGENERALES","completedStatusTask","saveAutoLog","APPLICATION_STATUS_NREC","setError","Error","showModalBitacora","APPLICATION_STATUS","mainDebtor","BPM_ACTIVITY_01","clientId","observations","requestId","statusDescription","setDeleteLog","clientDataDeleted","marginTop","marginBottom","textAlign","margin","marginRight","map","item","index","rol","roleDescription","e","BPM_ACTIVITY_02","apiBack","eliminarOrquestadoListaPersonaSolicitud","resp","statusCode"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\"\r\nimport PropTypes from 'prop-types';\r\nimport { useLocation, useHistory } from 'react-router-dom'\r\nimport * as opt from \"../../../helpers/options_helper\"\r\nimport * as url from \"../../../helpers/url_helper\"\r\nimport moment from \"moment\";\r\nimport {\r\n  Row,\r\n  Col,\r\n  Card,\r\n  CardBody,\r\n  Label,\r\n  CardFooter,\r\n  Button,\r\n  Table,\r\n  CardHeader,\r\n} from \"reactstrap\"\r\nimport Alert from 'react-bootstrap/Alert'\r\nimport { Link } from \"react-router-dom\"\r\nimport Breadcrumbs from \"../../../components/Common/Breadcrumb\"\r\nimport { setDefaults, useTranslation } from \"react-i18next\";\r\nimport LoadingOverlay from 'react-loading-overlay';\r\nimport ClientForm from \"./ClientForm\";\r\nimport ModalEndProcess from \"../../../components/EndProcess/ModalEndProcess\";\r\nimport { BackendServices, CoreServices, BpmServices } from \"../../../services\";\r\nimport { PersonModel } from '../../../models/Common/PersonModel';\r\nimport { InfoBpmModel } from '../../../models/Common/InfoBpmModel';\r\n\r\nimport SearchClientCore from \"../../../components/Common/SearchClientCore\";\r\nimport SessionHelper from \"../../../helpers/SessionHelper\";\r\n\r\nimport { LogProcessModel } from '../../../models/Common/LogProcessModel';\r\nimport LogProcess from \"../../../components/LogProcess/index\";\r\nimport ErrorHandler from \"../../../components/Common/ErrorHandler\";\r\n\r\nimport LocalStorageHelper from \"../../../helpers/LocalStorageHelper\";\r\nimport ModalSearchClient from \"./ModalSearchClient\";\r\nimport ModalClientForm from \"./ModalClientForm\"\r\nimport ModalBitacora from \"../../../components/Common/ModalBitacora\";\r\n\r\nimport AttachmentFileCore from '../../../components/Common/AttachmentFileCore';\r\nimport { AttachmentFileInputModel } from \"../../../models/Common/AttachmentFileInputModel\"\r\n\r\nimport SweetAlert from \"react-bootstrap-sweetalert\"\r\nimport { saveLogProcess } from \"../../../helpers/logs_helper\";\r\n\r\nimport HorizontalSteeper from \"../../../components/Common/HorizontalSteeper\";\r\n\r\nconst PreRequest = props => {\r\n  const { t, i18n } = useTranslation();\r\n  const history = useHistory();\r\n  const location = useLocation();\r\n  const [locationData, setLocationData] = useState(undefined);\r\n  const [isActiveLoading, setIsActiveLoading] = useState(false);\r\n  const [openNewClient, setopenNewClient] = useState(false);\r\n  const [dataClientList, setdataClientList] = useState([]);\r\n  const [dataDelete, setDataDelete] = useState([]);\r\n  const [confirm_alert, setconfirm_alert] = useState(false);\r\n  const [error_dlg, seterror_dlg] = useState(false);\r\n  const [selectedClient, setselectedClient] = useState(undefined);\r\n  const [identificationTypeList, setidentificationTypeList] = useState([]);\r\n  const [personTypeList, setpersonTypeList] = useState([]);\r\n  const [displayModalEndProcess, setdisplayModalEndProcess] = useState(false);\r\n  const [msgData, setmsgData] = useState({ show: false, msg: \"\", isError: false });\r\n  //Servicios\r\n  const [backendServices, setbackendServices] = useState(new BackendServices());\r\n  const [coreServices, setcoreServices] = useState(new CoreServices());\r\n  const [bpmServices, setbpmServices] = useState(new BpmServices());\r\n  const [sessionHelper, setsessionHelper] = useState(new SessionHelper());\r\n\r\n  const [localStorageHelper, setlocalStorageHelper] = useState(new LocalStorageHelper());\r\n  const [showModalSearchClient, setshowModalSearchClient] = useState(false);\r\n  const [displayModalBitacora, setdisplayModalBitacora] = useState(false);\r\n  const [optionSelected, setoptionSelected] = useState(null);\r\n  const [activitySuccess, setactivitySuccess] = useState(false);\r\n  const [updatedataLog, setupdatedataLog] = useState(false);\r\n\r\n  const [staffChecked, setstaffChecked] = useState(false);\r\n  const [attachmentFileInputModel, setattachmentFileInputModel] = useState(null)\r\n\r\n  //On Mounting (componentDidMount)\r\n  React.useEffect(() => {\r\n    var data = location.data !== undefined ? location.data : sessionHelper.get(opt.VARNAME_LOCATIONDATA);\r\n    if (data !== null && data !== undefined) {\r\n      if (data.transactionId === undefined || data.transactionId.length <= 0) {\r\n        data.transactionId = 0;\r\n        checkAndCreateProcedure(data);\r\n      }\r\n      else {\r\n        setLocationData(data);\r\n        fetchData(data);\r\n      }\r\n    }\r\n    else {\r\n      history.push(url.URL_DASHBOARD);\r\n    }\r\n  }, []);\r\n  //Caraga Inicial de datos\r\n  function fetchData(locationData) {\r\n\r\n    setattachmentFileInputModel(new AttachmentFileInputModel(locationData.transactionId, opt.PROCESS_BUSQUEDADESCARTE, opt.ACT_NONE))\r\n\r\n    //chequear si la tarea no ha sido iniciada\r\n    /*bpmServices.checkAndStartTask(locationData)\r\n      .then((iniresult) => {\r\n        if (iniresult === false) {\r\n          history.push(url.URL_DASHBOARD);\r\n        }\r\n      })*/\r\n    //checkAndCreateProcedure(locationData);\r\n    loadIdentificationTypes();\r\n    loadPersonTypes();\r\n    getProcessClients(locationData.transactionId);\r\n  }\r\n  //CHEQUEAMOS Y GENERAMOS EL PROCESO EN BASE DE DATOS\r\n  function checkAndCreateProcedure(locationData) {\r\n    var credentials = localStorageHelper.get(opt.VARNAME_USRCREDENTIAL);\r\n    backendServices.nuevoTramite(locationData.transactionId, locationData.instanceId, opt.PROCESS_BUSQUEDADESCARTE, opt.PROCESS_BUSQUEDADESCARTE, credentials?.usr ?? \"admin\", \"0\")\r\n      .then((data) => {\r\n        if (data !== null && data !== undefined) {\r\n          locationData.transactionId = data.transactId;\r\n          sessionHelper.save(opt.VARNAME_LOCATIONDATA, locationData);\r\n          setLocationData(locationData);\r\n          fetchData(locationData);\r\n        }\r\n      }).catch((error) => { });\r\n  }\r\n  //cargar lista de tipo de identificacion\r\n  function loadIdentificationTypes() {\r\n    backendServices.consultarCatalogoTipoIdentificacion()\r\n      .then((data) => {\r\n        if (data !== null && data !== undefined) {\r\n          let json = [];\r\n          for (let i = 0; i < data.length; i++) {\r\n            json.push({ label: t(data[i][\"description\"]), value: data[i][\"id\"] })\r\n          }\r\n          setidentificationTypeList(json);\r\n        }\r\n      }).catch((error) => { });\r\n  }\r\n  //cargar lista de tipo de personas\r\n  function loadPersonTypes() {\r\n    backendServices.consultarCatalogoTipoPersona()\r\n      .then((data) => {\r\n        if (data !== null && data !== undefined) {\r\n          let json = [];\r\n          for (let i = 0; i < data.length; i++) {\r\n            json.push({ label: t(data[i][\"label\"]), value: data[i][\"code\"] })\r\n          }\r\n          setpersonTypeList(json);\r\n        }\r\n      }).catch((error) => { });\r\n  }\r\n  //se buscan todos los clientes de este proceso \r\n  function getProcessClients(transactionId) {\r\n    backendServices.consultarOrquestadoListaPersonaSolicitud(transactionId)\r\n      .then((data) => {\r\n        if (data !== null && data !== undefined) {\r\n          setdataClientList(data)\r\n          /*if (data.length <= 0) {\r\n            setselectedClient(new PersonModel());\r\n            onOpenNewClient();\r\n          }*/\r\n        }\r\n      }).catch((error) => { });\r\n  }\r\n  //Abrir formulario Persona\r\n  function onOpenNewClient(show = true) {\r\n    setopenNewClient(show)\r\n  }\r\n  //Editar Persona\r\n  function onEditClient(dataClient) {\r\n    dataClient[\"isNew\"] = false;\r\n    setselectedClient(dataClient)\r\n    onOpenNewClient();\r\n  }\r\n  //Eliminar Persona\r\n\r\n  function removeRelay(data) {\r\n    setDataDelete(data)\r\n    setconfirm_alert(true);\r\n  }\r\n\r\n  function onDeleteClient(dataClient) {\r\n    console.log(dataClient);\r\n    setDataDelete(dataClient)\r\n    setconfirm_alert(true);\r\n    //setconfirm_alert(true);\r\n    //eliminarOrquestadoListaPersonaSolicitud\r\n    {/*backendServices.eliminarOrquestadoListaPersonaSolicitud(dataClient)\r\n      .then((data) => {\r\n        getProcessClients(dataClient.transactId);\r\n      }).catch((error) => { });*/}\r\n  }\r\n  //retorna el Tipo de Persona\r\n  function getPersnoType(pType) {\r\n    return personTypeList.find(x => x.value === pType);\r\n  }\r\n  //retorna el Tipo de identificacion\r\n  function getIdentificationType(idType) {\r\n    if (idType !== undefined && idType !== null && idType.length > 0) {\r\n      return identificationTypeList.find(x => x.value === idType);\r\n    }\r\n    return \"\";\r\n  }\r\n  //Carga de Datos de Cliente de T24 Seleccionado\r\n  function loadClientDataT24(dataClientT24) {\r\n    console.log(\"loadClientDataT24\",dataClientT24);\r\n\r\n    var clientPerson = new PersonModel();\r\n    clientPerson.customerNumberT24 = dataClientT24.id;\r\n    clientPerson.clientDocumentId = dataClientT24.idnumber;\r\n    clientPerson.name = dataClientT24.firstname !== undefined ? dataClientT24.firstname : \"\";\r\n    clientPerson.secondName = dataClientT24.secondname !== undefined ? dataClientT24.secondname : \"\";\r\n    clientPerson.lastName = dataClientT24.lastname !== undefined ? dataClientT24.lastname : \"\";\r\n    clientPerson.secondSurname = dataClientT24.secondlastname !== undefined ? dataClientT24.secondlastname : \"\";\r\n    clientPerson.phone = dataClientT24.phoneNumber !== undefined ? dataClientT24.phoneNumber : \"\";\r\n    clientPerson.email = dataClientT24.email !== undefined ? dataClientT24.email : \"\";\r\n    clientPerson.personType = personTypeList.find(x => x.value === Number(dataClientT24.partyType)).value;\r\n    clientPerson.idType = identificationTypeList.find(x => x.value === dataClientT24.idtype).value;\r\n    clientPerson.isNew = false;\r\n    clientPerson.birthDate = dataClientT24[\"birthdate\"] !== undefined ? moment(dataClientT24[\"birthdate\"]).format(\"YYYY-MM-DD\") : clientPerson.birthDate;\r\n    clientPerson.nationality = dataClientT24[\"nationality\"];\r\n    onEditClient(clientPerson);\r\n  }\r\n\r\n  function showSearchClient(show = true) {\r\n    setshowModalSearchClient(show);\r\n  }\r\n\r\n  //Chequear si el deudor principal tiene accionistas y otros y agregarlos automaticamente\r\n  async function checkDebtorShareholders() {\r\n    \r\n    //console.log(\"checkDebtorShareholders\",locationData);\r\n    //asadsasd;\r\n\r\n    if(staffChecked || locationData.instanceId.length > 0){\r\n      return;\r\n    }\r\n    \r\n    setstaffChecked(true);\r\n    setIsActiveLoading(true)\r\n    \r\n    try {\r\n      var lDdebtors = await backendServices.consultarDeudores(locationData.transactionId)\r\n      if (lDdebtors === null || lDdebtors === undefined || lDdebtors.length <= 0) {\r\n        showMessage(t(\"Youmustselectatleastonedebtor\"), true);\r\n        return;\r\n      }\r\n\r\n      for (let p = 0; p < lDdebtors.length; p++) {\r\n        var maindebtor = lDdebtors[p];\r\n\r\n        //buscamos a los accionistas de este deudor\r\n        var data = await coreServices.getPartiesStaff(maindebtor.customerNumberT24);\r\n        if (data !== null && data !== undefined && data.results.length > 0) {\r\n          data = data.results;\r\n          for (let i = 0; i < data.length; i++) {\r\n            try {\r\n              var clientPerson = new PersonModel();\r\n              clientPerson.transactId = locationData.transactionId;\r\n              clientPerson.personType = data[i].PartyType;// \"1\"; //tipo de Persona\r\n              clientPerson.idType = data[i].PartyType !== undefined && data[i].PartyType === \"1\" ? \"CED\" : \"RUC\"; //tipo de Identificacion\r\n              clientPerson.clientDocumentId = data[i].Identification !== undefined ? data[i].Identification[0]?.Ident.IssuedIdentValue ?? \"\" : \"\";//No. de identificacion\r\n              clientPerson.customerNumberT24 = \"\"; //No. de Cliente T24\r\n              clientPerson.name = data[i].PersonName.FirstName !== undefined ? data[i].PersonName.FirstName : \"\";//1er Nombre\r\n              clientPerson.secondName = data[i].PersonName.SecondName !== undefined ? data[i].PersonName.SecondName : \"\";//2do Apellido//2do Nombre\r\n              clientPerson.lastName = data[i].PersonName.LastName !== undefined ? data[i].PersonName.LastName : \"\";//1er Apellido\r\n              clientPerson.secondSurname = data[i].PersonName.SecondLastName !== undefined ? data[i].PersonName.SecondLastName : \"\";\r\n              clientPerson.nationality = data[i].Nationality !== undefined ? data[i].Nationality : \"\";//Nacionalidad\r\n              clientPerson.birthDate = data[i].BirthDt !== undefined ? moment(data[i].BirthDt).format(\"YYYY-MM-DD\") : moment().format(\"YYYY-MM-DD\");//Fecha nacimiento \"1998-08-17\",\r\n              clientPerson.address = \"\"; //direccion\r\n              clientPerson.phone = data[i].Phone !== undefined ? data[i].Phone[0]?.PhoneNum ?? \"\" : \"\"; //Telefono,\r\n              //clientPerson.email=data[i].Phone[0]?.PhoneNum??\"\";//Email\r\n              clientPerson.countryOfResidence = \"PA\";//pais de residencia\r\n              clientPerson.comments = \"\";\r\n              clientPerson.roles = [{ roleId: data[i].StaffPosition }];\r\n              clientPerson.blacklist = [/*{\r\n                blackList: false, comment: \"\", date: moment().format(\"YYYY-MM-DD\"),\r\n                personId: 0, roleId: data[i].StaffPosition, status: true, transactId: locationData.transactionId\r\n              }*/];\r\n              console.log(\"sharehold\", data[i]);\r\n              var resultPerson = await backendServices.nuevoOrquestadoListaPersonaSolicitud(clientPerson);\r\n              if (resultPerson !== undefined && data[i].StaffPosition === \"ACC\") {\r\n                var sharehold = {\r\n                  \"transactId\": clientPerson.transactId,\r\n                  \"personId\": resultPerson.personId,\r\n                  \"participation\": Number(data[i]?.Shareholding ?? 0),\r\n                  \"yearsExperience\": 0,\r\n                  \"status\": true\r\n                }\r\n                await backendServices.salvarAccionistaBD(sharehold);\r\n              }\r\n            }\r\n            catch (err) { console.error(err) }\r\n          }\r\n          getProcessClients(locationData.transactionId)\r\n        }\r\n        else {\r\n          //showMessage(t(\"NoResults\"), true);\r\n          //return;\r\n        }\r\n      }\r\n\r\n    }\r\n    catch (err) { }\r\n    finally {\r\n      setIsActiveLoading(false)\r\n    }\r\n  }\r\n\r\n  //mostrar mensaje \r\n  function showMessage(message, isError = false) {\r\n\r\n    setmsgData({ show: true, msg: message, isError: isError })\r\n  }\r\n  ////////// PARTE ES LA FINAL DEL PROCESO ///////\r\n  //Salvando el Proceso y le pasamos una opcion: 1-Finalizar Proceso, 2- Salvarlo, 3- A Cumplimmineto, 4- Avanzar a IGR\r\n  function onSaveProcess(option) {\r\n\r\n    switch (option) {\r\n      case opt.PROCESS_LISTAEXCLUSION:\r\n      case opt.PROCESS_CUMPLIMIENTO: {\r\n        //check si hay clientes sin evaluar en listas negras\r\n        for (var i = 0; i < dataClientList.length; i++) {\r\n          if (dataClientList[i].blacklist.length <= 0) {\r\n            showMessage(t(\"ExistClientWithoutVerification\"), true);\r\n            return;\r\n          }\r\n        }\r\n\r\n        //chequear si existe algun deudor para poder continuar\r\n        backendServices.consultPrincipalDebtor(locationData.transactionId)\r\n          .then((data) => {\r\n            if (data !== null && data !== undefined) {\r\n              saveJBPMProcess(option);\r\n            }\r\n            else {\r\n              //Mensaje ERROR\r\n              showMessage(t(\"Youmustselectatleastonedebtor\"), true);\r\n            }\r\n          }).catch((error) => { });\r\n\r\n        var person = null;\r\n        //check si existen clientes en listas negras\r\n        for (var i = 0; i < dataClientList.length; i++) {\r\n          if (dataClientList[i].blacklist[dataClientList[i].blacklist.length - 1].blackList === true) {\r\n            person = dataClientList[i];\r\n            break;\r\n          }\r\n        }\r\n        if (person !== null && option === opt.PROCESS_LISTAEXCLUSION) {\r\n          option = opt.PROCESS_CUMPLIMIENTO;\r\n        }\r\n\r\n        break;\r\n      }\r\n      case opt.PROCESS_BUSQUEDADESCARTE: {\r\n        if (dataClientList.length > 0) {\r\n          saveJBPMProcess(option);\r\n          break;\r\n        }\r\n        else {\r\n          showMessage(t(\"Youmustenteratleastoneclient\"), true);\r\n          return;\r\n        }\r\n      }\r\n      default: {\r\n        saveJBPMProcess(option);\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  async function saveJBPMProcess(option) {\r\n\r\n    if (locationData.instanceId === undefined || locationData.instanceId.length <= 0) {\r\n      var result = await bpmServices.createNewInstance();\r\n      if (result !== undefined) {\r\n\r\n        //instanceId:result.instanceId,taskId:result.taskId,taskStatus:result.status\r\n        locationData.instanceId = result.instanceId;\r\n        locationData.taskId = result.taskId;\r\n        locationData.taskStatus = result.status;\r\n\r\n        sessionHelper.save(opt.VARNAME_LOCATIONDATA, locationData);\r\n\r\n        //Actualizamos Variables\r\n        var values = { \"transactionId\": locationData.transactionId };\r\n        await bpmServices.updatevariables(locationData.instanceId, values);\r\n      }\r\n      else {\r\n        //Mensaje ERROR\r\n        showMessage(t(\"TheProcessCouldNotFinish\"), true);\r\n        return;\r\n      }\r\n    }\r\n\r\n    var maindebtor = await backendServices.consultPrincipalDebtor(locationData.transactionId)\r\n    var infoBpmModel = new InfoBpmModel(locationData.instanceId, locationData.transactionId,\r\n      opt.PROCESS_BUSQUEDADESCARTE, opt.ACT_NONE, maindebtor?.personId);\r\n    infoBpmModel.personName = maindebtor !== undefined ? (maindebtor.name + \" \" + maindebtor.name2 + \" \" + maindebtor.lastName + \" \" + maindebtor.lastName2) : \"\";\r\n    infoBpmModel.personName = infoBpmModel.personName.trim();\r\n\r\n    console.log(\"infoBpmModel\", infoBpmModel, maindebtor);\r\n\r\n    switch (option) {\r\n      case opt.PROCESS_CANCELPROCESS: {\r\n        bpmServices.abortProcess(locationData.instanceId)\r\n          .then((data) => {\r\n            if (data !== undefined) {\r\n              history.push(url.URL_DASHBOARD);\r\n            }\r\n            else {\r\n              //Mensaje ERROR\r\n              showMessage(t(\"TheProcessCouldNotFinish\"), true);\r\n            }\r\n          });\r\n        break;\r\n      }\r\n      case opt.PROCESS_BUSQUEDADESCARTE: {\r\n        infoBpmModel.processId = opt.PROCESS_BUSQUEDADESCARTE;\r\n        infoBpmModel.activityId = opt.ACT_NONE;\r\n\r\n        var values = {\r\n          \"info\": JSON.stringify(infoBpmModel),\r\n          \"processId\": opt.PROCESS_BUSQUEDADESCARTE.toString(),\r\n          \"activityId\": opt.ACT_DATOSGENERALES.toString(),\r\n          \"transactionId\": locationData.transactionId.toString()\r\n        };\r\n        bpmServices.updatevariables(locationData.instanceId, values)\r\n          .then((data) => {\r\n            if (data !== undefined) {\r\n              history.push(url.URL_DASHBOARD);\r\n            }\r\n            else {\r\n              showMessage(t(\"ErrorSaveMessage\"), true);\r\n            }\r\n          });\r\n        break;\r\n      }\r\n      case opt.PROCESS_CUMPLIMIENTO: {\r\n\r\n        infoBpmModel.processId = opt.PROCESS_CUMPLIMIENTO;\r\n        infoBpmModel.activityId = opt.ACT_NONE;\r\n\r\n        var values = {\r\n          \"info\": JSON.stringify(infoBpmModel),\r\n          \"processId\": opt.PROCESS_CUMPLIMIENTO.toString(),\r\n          \"activityId\": opt.ACT_NONE.toString(),\r\n          \"transactionId\": locationData.transactionId,\r\n          \"customerId\": \"\",\r\n          \"applicationNumber\": \"\",\r\n          \"procedureNumber\": \"\",\r\n          \"decision\": \"si\"\r\n        };\r\n        bpmServices.completedStatusTask(locationData.taskId, values)\r\n          .then((data) => {\r\n            if (data !== undefined) {\r\n              saveAutoLog(opt.APPLICATION_STATUS_NREC);\r\n              setactivitySuccess(true);\r\n              //history.push(url.URL_DASHBOARD);\r\n              //showMessage(t(\"TheProcessCouldNotFinish\"));\r\n            }\r\n            else {\r\n              //Mensaje ERROR\r\n              showMessage(t(\"ErrorSaveMessage\"), true);\r\n            }\r\n          });\r\n        break;\r\n      }\r\n      case opt.PROCESS_LISTAEXCLUSION: {\r\n\r\n        infoBpmModel.processId = opt.PROCESS_LISTAEXCLUSION;\r\n        infoBpmModel.activityId = opt.ACT_NONE;\r\n\r\n        var values = {\r\n          \"info\": JSON.stringify(infoBpmModel),\r\n          \"processId\": opt.PROCESS_LISTAEXCLUSION.toString(),\r\n          \"activityId\": opt.ACT_NONE.toString(),\r\n          \"transactionId\": locationData.transactionId,\r\n          \"customerId\": \"\",\r\n          \"applicationNumber\": \"\",\r\n          \"procedureNumber\": \"\",\r\n          \"decision\": \"no\"\r\n        };\r\n        bpmServices.completedStatusTask(locationData.taskId, values)\r\n          .then((data) => {\r\n            if (data !== undefined) {\r\n              saveAutoLog(null);\r\n              setactivitySuccess(true);\r\n              //history.push(url.URL_DASHBOARD);\r\n              //showMessage(t(\"TheProcessCouldNotFinish\"));\r\n            }\r\n            else {\r\n              //Mensaje ERROR\r\n              showMessage(t(\"ErrorSaveMessage\"), true);\r\n            }\r\n          });\r\n        break;\r\n      }\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n\r\n  function setError() {\r\n    throw new Error(\"erro fatal\");\r\n  }\r\n\r\n  function showModalBitacora(show = true) {\r\n    setdisplayModalBitacora(show);\r\n  }\r\n\r\n  async function saveAutoLog(APPLICATION_STATUS) {\r\n    var mainDebtor = await backendServices.consultPrincipalDebtor(locationData.transactionId);\r\n    var log = new LogProcessModel(locationData.instanceId, locationData.transactionId, 0, \"\", \"\", opt.PROCESS_BUSQUEDADESCARTE, opt.ACT_NONE, opt.BPM_ACTIVITY_01)\r\n    log.clientId = mainDebtor?.personId ?? log.clientId;\r\n    log.observations = t(\"ActivityHasBeenFinishedSuccessfully\");\r\n    log.requestId = APPLICATION_STATUS?.id ?? 0;\r\n    log.statusDescription = APPLICATION_STATUS?.name ?? \"\";\r\n    saveLogProcess(log);\r\n  }\r\n\r\n  async function setDeleteLog(clientDataDeleted) {\r\n    setupdatedataLog(false)\r\n    var mainDebtor = await backendServices.consultPrincipalDebtor(locationData.transactionId);\r\n    var log = new LogProcessModel(locationData.instanceId, locationData.transactionId, 0, \"\", \"\", opt.PROCESS_BUSQUEDADESCARTE, opt.ACT_NONE, opt.BPM_ACTIVITY_01)\r\n    log.clientId = mainDebtor?.personId ?? log.clientId;\r\n    log.observations = t(\"ParticipantHasBeenDeleted\") + \": \" + (clientDataDeleted.name + \" \" + clientDataDeleted.secondName + \" \" + clientDataDeleted.lastName + \" \" + clientDataDeleted.secondSurname);\r\n    console.log(\"setDeleteLog\", log.observations)\r\n    log.requestId = 0;\r\n    log.statusDescription = \"\";\r\n    saveLogProcess(log);\r\n    setupdatedataLog(true)\r\n  }\r\n\r\n  return (\r\n    <div className=\"page-content\">\r\n      <Breadcrumbs title={t(\"CommercialCredit\")} breadcrumbItem={t(\"PreRequest\")} />\r\n\r\n      <HorizontalSteeper processNumber={1} activeStep={0}></HorizontalSteeper>\r\n\r\n      <LoadingOverlay active={isActiveLoading} spinner text={t(\"WaitingPlease\")}>\r\n\r\n        <Row style={{ marginTop: \"0px\", marginBottom: \"15px\" }}>\r\n          <Col md=\"3\" style={{ textAlign: \"left\" }}>\r\n            <Button color=\"danger\" style={{ margin: '5px 0px' }} type=\"button\" onClick={() => { setoptionSelected(opt.PROCESS_CANCELPROCESS); showModalBitacora() }}><i className=\"mdi mdi-cancel mid-12px\"></i> {t(\"CancelProcess\")}</Button>\r\n          </Col>\r\n          <Col md=\"9\" style={{ textAlign: \"right\" }}>\r\n            <Button color=\"primary\" type=\"button\" style={{ marginRight: \"5px\" }} onClick={() => { onSaveProcess(opt.PROCESS_BUSQUEDADESCARTE) }}><i className=\"mdi mdi-content-save-outline mid-12px\"></i> {t(\"Exit\")}</Button>\r\n            <Button color=\"success\" type=\"button\" style={{}} onClick={() => { onSaveProcess(opt.PROCESS_LISTAEXCLUSION) }}><i className=\"mdi mdi-arrow-right-bold-circle-outline mid-12px\"></i> {t(\"Advance\")}</Button>\r\n          </Col>\r\n        </Row>\r\n\r\n        <Card>\r\n          <CardHeader>\r\n            <Row>\r\n              <Col md={6}>\r\n                <h4 className=\"card-title\">{t(\"PreRequest\")}</h4>\r\n                <p className=\"card-title-desc\">{t(\"This form is official and must be filled out correctly\")}</p>\r\n              </Col>\r\n              <Col md={6}>\r\n                <Row>\r\n                  <Col sm={12} style={{ textAlign: \"right\" }}>\r\n                    <h5 className=\"card-title\" style={{ textAlign: \"right\" }}>{t(\"Tramit\")}:{\" \"}#{locationData?.transactionId}</h5>\r\n                  </Col>\r\n                </Row>\r\n              </Col>\r\n            </Row>\r\n          </CardHeader>\r\n\r\n          <CardBody>\r\n            <Row>\r\n              <Col md=\"6\">\r\n                <h5 className=\"card-sub-title\">{t(\"ParticipantsList\")}</h5>\r\n              </Col>\r\n              <Col md={6} style={{ textAlign: \"right\", }}>\r\n                <Button className=\"btn\" color=\"success\" type=\"button\" style={{ margin: '5px' }} onClick={() => { showSearchClient() }} title={t(\"Add\")}><i className=\"fas fa-lg fa-plus-circle\"></i> {(\" \")}</Button>\r\n              </Col>\r\n            </Row>\r\n\r\n            <Row>\r\n              <Col md=\"12\">\r\n\r\n\r\n\r\n                <div className=\"table-responsive styled-table-div\">\r\n                  <Table className=\"table table-striped table-hover styled-table\">\r\n                    <thead>\r\n                      <tr>\r\n                        <th>{t(\"PersonType\")}</th>\r\n                        <th>{t(\"FullName\")}</th>\r\n                        <th>{t(\"IdentificationType\")}</th>\r\n                        <th>{t(\"IdentificationNumber\")}</th>\r\n                        <th>{t(\"Roles\")}</th>\r\n                        <th>{t(\"WatchList\")}</th>\r\n                        <th></th>\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                      {dataClientList !== null && dataClientList !== undefined && dataClientList.length > 0 ?\r\n                        dataClientList.map((item, index) => (\r\n                          <tr key={index}>\r\n                            <td>{getPersnoType(Number(item.personType)).label}</td>\r\n                            <td>{Number(item.personType) > 1 ? (item.name) : (item.name + \" \" + item.secondName + \" \" + item.lastName + \" \" + item.secondSurname)}</td>\r\n                            <td>{getIdentificationType(item.idType).label}</td>\r\n                            <td>{item.clientDocumentId}</td>\r\n                            <td>\r\n                              {item.roles !== undefined ?\r\n                                item.roles.map((rol, index) => (\r\n                                  rol.roleDescription + \" - \"\r\n                                )) : null}\r\n                            </td>\r\n                            <td>\r\n                              {item.blacklist !== undefined && item.blacklist.length > 0 ?\r\n                                (item.blacklist[item.blacklist.length - 1].blackList === true ? \"Aplica\" : \"No Aplica\") : \"Sin Verificar\"}\r\n                            </td>\r\n                            <td style={{ textAlign: \"right\" }}>\r\n                              <Link to=\"#\" onClick={(e) => { onEditClient(item) }}><i className=\"mdi mdi-border-color mdi-24px\"></i></Link>\r\n                              <Link to=\"#\" onClick={(e) => { onDeleteClient(item) }}><i className=\"mdi mdi-trash-can-outline mdi-24px\"></i></Link>\r\n                            </td>\r\n                          </tr>\r\n                        )) :\r\n                        <tr>\r\n                          <td colSpan={7}>\r\n                            <div className=\"alert alert-info\" style={{ textAlign: \"center\" }}>{t(\"NoData\")}</div>\r\n                          </td>\r\n                        </tr>\r\n                      }\r\n                    </tbody>\r\n                  </Table>\r\n                </div>\r\n              </Col>\r\n\r\n            </Row>\r\n          </CardBody>\r\n\r\n          {locationData ?\r\n            <CardBody>\r\n              <AttachmentFileCore attachmentFileInputModel={attachmentFileInputModel} />\r\n            </CardBody>\r\n            : null}\r\n\r\n          {!openNewClient ?\r\n            <React.Fragment>\r\n\r\n              <CardFooter>\r\n                <Row>\r\n                  <Col md=\"12\">\r\n                    <Alert show={msgData.show} variant={msgData.isError ? \"danger\" : \"success\"} dismissible onClose={() => { console.log(\"onClose\"); setmsgData({ show: false, msg: \"\", isError: false }) }}>\r\n                      {msgData.msg}\r\n                    </Alert>\r\n                  </Col>\r\n                </Row>\r\n              </CardFooter>\r\n            </React.Fragment>\r\n            : null\r\n          }\r\n        </Card>\r\n      </LoadingOverlay>\r\n\r\n      {locationData ?\r\n        <LogProcess updatedata={updatedataLog} logProcessModel={new LogProcessModel(locationData.instanceId, locationData.transactionId, 0, \"\", \"\", opt.PROCESS_BUSQUEDADESCARTE, opt.ACT_NONE, opt.BPM_ACTIVITY_01)} />\r\n        : null}\r\n\r\n\r\n      <Row style={{ marginTop: \"0px\", marginBottom: \"15px\" }}>\r\n        <Col md=\"3\" style={{ textAlign: \"left\" }}>\r\n          <Button color=\"danger\" style={{ margin: '5px 0px' }} type=\"button\" onClick={() => { setoptionSelected(opt.PROCESS_CANCELPROCESS); showModalBitacora() }}><i className=\"mdi mdi-cancel mid-12px\"></i> {t(\"CancelProcess\")}</Button>\r\n        </Col>\r\n        <Col md=\"9\" style={{ textAlign: \"right\" }}>\r\n          <Button color=\"primary\" type=\"button\" style={{ marginRight: \"5px\" }} onClick={() => { onSaveProcess(opt.PROCESS_BUSQUEDADESCARTE) }}><i className=\"mdi mdi-content-save-outline mid-12px\"></i> {t(\"Exit\")}</Button>\r\n          <Button color=\"success\" type=\"button\" style={{}} onClick={() => { onSaveProcess(opt.PROCESS_LISTAEXCLUSION) }}><i className=\"mdi mdi-arrow-right-bold-circle-outline mid-12px\"></i> {t(\"Advance\")}</Button>\r\n        </Col>\r\n      </Row>\r\n\r\n      {showModalSearchClient ?\r\n        <ModalSearchClient isOpen={showModalSearchClient} toggle={() => { showSearchClient(!showModalSearchClient) }} onClientSelect={(data) => { loadClientDataT24(data); showSearchClient(false); }} onNewClientSelect={(data) => { var person = new PersonModel(); person.clientDocumentId = data !== undefined ? data : \"\"; console.log(\"selectedperson\", data, person); setselectedClient(data !== undefined ? person : undefined); onOpenNewClient(); showSearchClient(false) }} />\r\n        : null}\r\n\r\n      {locationData ?\r\n        <ModalClientForm isOpen={openNewClient} toggle={() => { onOpenNewClient(!openNewClient) }} transactId={locationData.transactionId} clientSelected={selectedClient} onCancel={() => { onOpenNewClient(false); getProcessClients(locationData.transactionId) }} checkDebtorShareholders={checkDebtorShareholders} />\r\n        : null}\r\n\r\n      {locationData && displayModalBitacora ?\r\n        <ModalBitacora logProcessModel={new LogProcessModel(locationData.instanceId, locationData.transactionId, 0, \"\", \"\", opt.PROCESS_CUMPLIMIENTO, opt.ACT_NONE, opt.BPM_ACTIVITY_02)}\r\n          successSaved={() => { onSaveProcess(optionSelected); }}\r\n          isOpen={displayModalBitacora} toggle={() => { showModalBitacora(false) }} />\r\n        : null}\r\n\r\n\r\n      {activitySuccess ? (\r\n        <SweetAlert\r\n          success\r\n          title={t(\"SuccessDialog\")}\r\n          confirmButtonText={t(\"Accept\")}\r\n          onConfirm={() => {\r\n            history.push(url.URL_DASHBOARD);\r\n          }}\r\n        >\r\n          {t(\"ActivityFinishedSuccessfully\")}\r\n        </SweetAlert>\r\n      ) : null}\r\n\r\n      {confirm_alert ? (\r\n        <SweetAlert\r\n          title={t(\"Areyousure\")}\r\n          warning\r\n          showCancel\r\n          confirmButtonText={t(\"Yesdeleteit\")}\r\n          cancelButtonText={t(\"Cancel\")}\r\n          confirmBtnBsStyle=\"success\"\r\n          cancelBtnBsStyle=\"danger\"\r\n          onConfirm={() => {\r\n            const apiBack = new BackendServices();\r\n            apiBack.eliminarOrquestadoListaPersonaSolicitud(dataDelete)\r\n              .then((resp) => {\r\n                if (resp.statusCode == \"500\") {\r\n                  setconfirm_alert(false)\r\n                  seterror_dlg(false)\r\n                } else {\r\n                  setconfirm_alert(false)\r\n                  setDeleteLog(dataDelete);\r\n                  getProcessClients(dataDelete.transactId);\r\n                }\r\n\r\n              }).catch((error) => { });\r\n          }}\r\n          onCancel={() => setconfirm_alert(false)}\r\n        >\r\n          {t(\"Youwontbeabletorevertthis\")}\r\n        </SweetAlert>\r\n      ) : null}\r\n\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default PreRequest\r\n"]},"metadata":{},"sourceType":"module"}