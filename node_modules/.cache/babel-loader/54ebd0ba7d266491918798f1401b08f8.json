{"ast":null,"code":"import _regeneratorRuntime from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useRef,useState}from\"react\";import IdleTimer from\"react-idle-timer\";import SessionTimeoutDialog from\"./SessionTimeoutDialog\";import{useLocation,useHistory}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var countdownInterval;var timeout;var SessionTimeout=function SessionTimeout(_ref){var isAuthenticated=_ref.isAuthenticated,logOut=_ref.logOut;var history=useHistory();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),timeoutModalOpen=_useState2[0],setTimeoutModalOpen=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),timeoutCountdown=_useState4[0],setTimeoutCountdown=_useState4[1];var idleTimer=useRef(null);var clearSessionTimeout=function clearSessionTimeout(){clearTimeout(timeout);};var clearSessionInterval=function clearSessionInterval(){clearInterval(countdownInterval);};var handleLogout=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var isTimedOut,_args=arguments;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:isTimedOut=_args.length>0&&_args[0]!==undefined?_args[0]:false;try{setTimeoutModalOpen(false);clearSessionInterval();clearSessionTimeout();//logOut();\nhistory.push(\"/logout\");}catch(err){console.error(err);}case 2:case\"end\":return _context.stop();}}},_callee);}));return function handleLogout(){return _ref2.apply(this,arguments);};}();var handleContinue=function handleContinue(){setTimeoutModalOpen(false);clearSessionInterval();clearSessionTimeout();};var onActive=function onActive(){if(!timeoutModalOpen){clearSessionInterval();clearSessionTimeout();}};var onIdle=function onIdle(){var delay=1000*1;if(isAuthenticated&&!timeoutModalOpen){timeout=setTimeout(function(){var countDown=60;setTimeoutModalOpen(true);setTimeoutCountdown(countDown);countdownInterval=setInterval(function(){if(countDown>0){setTimeoutCountdown(--countDown);}else{handleLogout(true);}},1000);},delay);}};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(IdleTimer,{ref:idleTimer,onActive:onActive,onIdle:onIdle,debounce:250,timeout:1000*60*15}),/*#__PURE__*/_jsx(SessionTimeoutDialog,{countdown:timeoutCountdown,onContinue:handleContinue,onLogout:function onLogout(){return handleLogout(false);},open:timeoutModalOpen})]});};export default SessionTimeout;","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/components/Session/SessionTimeout.js"],"names":["React","useRef","useState","IdleTimer","SessionTimeoutDialog","useLocation","useHistory","countdownInterval","timeout","SessionTimeout","isAuthenticated","logOut","history","timeoutModalOpen","setTimeoutModalOpen","timeoutCountdown","setTimeoutCountdown","idleTimer","clearSessionTimeout","clearTimeout","clearSessionInterval","clearInterval","handleLogout","isTimedOut","push","err","console","error","handleContinue","onActive","onIdle","delay","setTimeout","countDown","setInterval"],"mappings":"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","sourcesContent":["import React, { useRef, useState } from \"react\";\r\nimport IdleTimer from \"react-idle-timer\";\r\nimport SessionTimeoutDialog from \"./SessionTimeoutDialog\";\r\nimport { useLocation, useHistory } from 'react-router-dom'\r\n\r\nlet countdownInterval;\r\nlet timeout;\r\n\r\nconst SessionTimeout = ({isAuthenticated, logOut}) => {\r\n  const history = useHistory();\r\n  const [timeoutModalOpen, setTimeoutModalOpen] = useState(false);\r\n  const [timeoutCountdown, setTimeoutCountdown] = useState(0);\r\n  const idleTimer = useRef(null);\r\n\r\n  const clearSessionTimeout = () => {\r\n    clearTimeout(timeout);\r\n  };\r\n\r\n  const clearSessionInterval = () => {\r\n    clearInterval(countdownInterval);\r\n  };\r\n\r\n  const handleLogout = async (isTimedOut = false) => {\r\n    try {\r\n        setTimeoutModalOpen(false);\r\n        clearSessionInterval();\r\n        clearSessionTimeout();\r\n        //logOut();\r\n        history.push(\"/logout\");\r\n     } catch (err) {\r\n        console.error(err);\r\n      }\r\n  };\r\n\r\n  const handleContinue = () => {\r\n    setTimeoutModalOpen(false);\r\n    clearSessionInterval();\r\n    clearSessionTimeout();\r\n  };\r\n\r\n  const onActive = () => {\r\n    if (!timeoutModalOpen) {\r\n      clearSessionInterval();\r\n      clearSessionTimeout();\r\n    }\r\n  };\r\n\r\n  const onIdle = () => {\r\n    const delay = 1000 * 1;\r\n    if (isAuthenticated && !timeoutModalOpen) {\r\n      timeout = setTimeout(() => {\r\n        let countDown = 60;\r\n        setTimeoutModalOpen(true);\r\n        setTimeoutCountdown(countDown);\r\n        countdownInterval = setInterval(() => {\r\n          if (countDown > 0) {\r\n            setTimeoutCountdown(--countDown);\r\n          } else {\r\n            handleLogout(true);\r\n          }\r\n        }, 1000);\r\n      }, delay);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <IdleTimer\r\n        ref={idleTimer}\r\n        onActive={onActive}\r\n        onIdle={onIdle}\r\n        debounce={250}\r\n        timeout={1000*60*15}\r\n      />\r\n      <SessionTimeoutDialog\r\n        countdown={timeoutCountdown}\r\n        onContinue={handleContinue}\r\n        onLogout={() => handleLogout(false)}\r\n        open={timeoutModalOpen}\r\n      />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default SessionTimeout;"]},"metadata":{},"sourceType":"module"}