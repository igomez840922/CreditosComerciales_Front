{"ast":null,"code":"import _regeneratorRuntime from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";/*ExclusionList = Lista de Exclusion*/import React,{useState}from\"react\";import{useLocation,useHistory}from'react-router-dom';import LoadingOverlay from'react-loading-overlay';import ModalEndProcess from\"../../../components/EndProcess/ModalEndProcess\";import*as OPTs from\"../../../helpers/options_helper\";import*as url from\"../../../helpers/url_helper\";import{Row,Col,Card,CardBody,Label,CardFooter,CardHeader,Button}from\"reactstrap\";import{AvForm,AvField}from\"availity-reactstrap-validation\";import{Link}from\"react-router-dom\";//Import Breadcrumb\nimport Breadcrumbs from\"../../../components/Common/Breadcrumb\";//i18n\nimport{withTranslation}from\"react-i18next\";import FormResult from\"./FormResultados\";import ModalAdvanceOptions from\"./ModalAdvanceOptions\";import ModalCloseOptions from\"./ModalCloseOptions\";import{BackendServices,CoreServices,BpmServices}from\"../../../services\";import SweetAlert from\"react-bootstrap-sweetalert\";import{useTranslation}from\"react-i18next\";import{InfoBpmModel}from'../../../models/Common/InfoBpmModel';import{LogProcessModel}from'../../../models/Common/LogProcessModel';import LogProcess from\"../../../components/LogProcess/index\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ListaExclusion=function ListaExclusion(props){var history=useHistory();var location=useLocation();//Data que recibimos en el location\nvar _useState=useState(undefined),_useState2=_slicedToArray(_useState,2),locationData=_useState2[0],setLocationData=_useState2[1];var _useTranslation=useTranslation(),t=_useTranslation.t,i18n=_useTranslation.i18n;var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),dataList=_useState4[0],setDataList=_useState4[1];//items de la lista de exclusion\nvar _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),dataListSelected=_useState6[0],setDataListSelected=_useState6[1];//items selected de la lista de exclusion       \nvar _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isActiveLoading=_useState8[0],setIsActiveLoading=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),successSave_dlg=_useState10[0],setsuccessSave_dlg=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),error_dlg=_useState12[0],seterror_dlg=_useState12[1];var _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),error_msg=_useState14[0],seterror_msg=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),displayModalAdvanceOptions=_useState16[0],setDisplayModalAdvanceOptions=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),displayModalCloseOptions=_useState18[0],setDisplayModalCloseOptions=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),displayModalEndProcess=_useState20[0],setdisplayModalEndProcess=_useState20[1];var _useState21=useState(null),_useState22=_slicedToArray(_useState21,2),mainDebtor=_useState22[0],setmainDebtor=_useState22[1];//Servicios\nvar _useState23=useState(new BackendServices()),_useState24=_slicedToArray(_useState23,2),backendServices=_useState24[0],setbackendServices=_useState24[1];var _useState25=useState(new BpmServices()),_useState26=_slicedToArray(_useState25,2),bpmServices=_useState26[0],setbpmServices=_useState26[1];var _useState27=useState(false),_useState28=_slicedToArray(_useState27,2),checked=_useState28[0],setchecked=_useState28[1];//On Mounting (componentDid Mount)\nReact.useEffect(function(){if(location.data!==null&&location.data!==undefined){if(location.data.transactionId===undefined||location.data.transactionId.length<=0){//location.data.transactionId = 0;\n//checkAndCreateProcedure(location.data);\nhistory.push(url.URL_DASHBOARD);}else{sessionStorage.setItem('locationData',JSON.stringify(location.data));setLocationData(location.data);fetchData(location.data);}}else{//chequeamos si tenemos guardado en session\nvar result=sessionStorage.getItem('locationData');if(result!==undefined&&result!==null){result=JSON.parse(result);setLocationData(result);fetchData(result);}}},[]);React.useEffect(function(){var lista=document.getElementsByClassName(\"listaExclusion\");for(var i=0;i<lista.length;i++){for(var j=0;j<dataListSelected.length;j++){if(dataListSelected[j].exclusionCatListId==dataList[i].exclusionId){document.getElementById(dataList[i].exclusionId).checked=true;setchecked(true);}}}},[props,dataListSelected]);//Caraga Inicial de datos\nfunction fetchData(locationData){//chequear si la tarea no ha sido iniciada\nbpmServices.checkAndStartTask(locationData).then(function(iniresult){if(iniresult===false){history.push(url.URL_DASHBOARD);}});loadMainDebtor(locationData);setLocationData(locationData);initializeData(locationData);}//Caraga Inicial\nfunction initializeData(locdata){var processNumber=locdata?locdata.transactionId:null;/* ---------------------------------------------------------------------------------------------- */ /*                     Buscar en Servicio el ExclisionList de este proceso...                     */ /* ---------------------------------------------------------------------------------------------- */backendServices.queryListExclusion().then(function(data){setDataList(data.exclusionCatListDTOList);}).catch(function(error){console.error('api error: ',error);});//{ transactId: location.data.transactionId, processId: location.data.processId, activityId: location.data.activityId }\n/* ---------------------------------------------------------------------------------------------- */ /*                       Obtenemos los datos de la lista de exclusion record                      */ /* ---------------------------------------------------------------------------------------------- */if(processNumber!=null){backendServices.consultListExclusionChecked({transactId:processNumber}).then(function(data){var datos=data.getExclusionApplicationListDTOList;setDataListSelected(datos);}).catch(function(error){console.error('api error: ',error);});}}function startProcess(status,taskId){if(status===\"Ready\"){bpmServices.startedStatusTask(taskId).then(function(resp){if(resp===undefined){history.push(url.URL_DASHBOARD);}});}}function removeBodyCss(){document.body.classList.add(\"no_padding\");}function loadMainDebtor(InputData){backendServices.consultPrincipalDebtor(InputData.transactionId).then(function(resp){//resp.personType\n//resp.identificationType\n//resp.customerNumberT24\n//resp.firstName\n//resp.secondName\n//resp.firstLastName\n//resp.secondLastName\n//resp.customerDocumentId\n// dataReturn.nuevoDato = \"\"\nsetmainDebtor(resp);});}//Modal Opciones para avanzar\nfunction toggleModalAdvanceOptions(){setDisplayModalAdvanceOptions(!displayModalAdvanceOptions);}//Modal Opciones al Salir\nfunction toggleModalCloseOptions(){setDisplayModalCloseOptions(!displayModalCloseOptions);}function onSelectOption(e){if(document.getElementById(e.exclusionId).checked){setchecked(true);backendServices.saveListExclusion(locationData.transactionId,e.exclusionId).then(function(resp){if(resp===undefined){//Mensaje ERROR\nseterror_msg(t(\"ErrorSaveMessage\"));seterror_dlg(true);return;}});}else{setchecked(false);backendServices.removeCheckedExclusionList(locationData.transactionId,e.exclusionId).then(function(resp){if(resp===undefined){//Mensaje ERROR\nseterror_msg(t(\"ErrorSaveMessage\"));seterror_dlg(true);return;}});}}//Chequear si existen opciones seleccionadas en la lista\nfunction checkSelectedOptions(){/* ---------------------------------------------------------------------------------------------- */ /*              chequear si tiene seleccionada alguna opcion de la lista de exclusion             */ /*              mostrar mensaje para confirmacion y finalizar proceso                             */ /* ---------------------------------------------------------------------------------------------- */var checkboxes=document.getElementsByClassName(\"listaExclusion\");var check=0;for(var i=0;i<checkboxes.length;i++){if(checkboxes[i].checked){check++;}}if(check>0){setDisplayModalAdvanceOptions(true);}else{//Avanzamos el Proceso\nonSaveProcess(OPTs.PROCESS_INFORMEGESTION);}}//Salvando el Proceso y le pasamos una opcion: 1-Finalizar Proceso, 2- Salvarlo, 3- A Cumplimmineto, 4- Avanzar a IGR\nfunction onSaveProcess(option){//Guardamos la seleccion\nvar checkboxes=document.getElementsByClassName(\"listaExclusion\");for(var i=0;i<checkboxes.length;i++){if(checkboxes[i].checked){option=OPTs.PROCESS_CANCELPROCESS;}}saveJBPMProcess(option);}function saveJBPMProcess(_x){return _saveJBPMProcess.apply(this,arguments);}////////// PARTE ES LA FINAL DEL PROCESO ///////\n//Modal Para mostrar Comentario de Fin de Proceso\nfunction _saveJBPMProcess(){_saveJBPMProcess=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(option){var _locationData$infoBpm,_locationData$infoBpm2,_locationData$infoBpm3,_locationData$infoBpm4;var maindebtor,infoBpmModel,values;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return backendServices.consultPrincipalDebtor(locationData.transactionId);case 2:maindebtor=_context.sent;infoBpmModel=new InfoBpmModel((_locationData$infoBpm=(_locationData$infoBpm2=locationData.infoBpmModel)===null||_locationData$infoBpm2===void 0?void 0:_locationData$infoBpm2.instanceId)!==null&&_locationData$infoBpm!==void 0?_locationData$infoBpm:locationData.instanceId,(_locationData$infoBpm3=(_locationData$infoBpm4=locationData.infoBpmModel)===null||_locationData$infoBpm4===void 0?void 0:_locationData$infoBpm4.transactId)!==null&&_locationData$infoBpm3!==void 0?_locationData$infoBpm3:locationData.transactionId,0,0,maindebtor===null||maindebtor===void 0?void 0:maindebtor.personId);infoBpmModel.personName=maindebtor!==undefined?maindebtor.name+\" \"+maindebtor.name2+\" \"+maindebtor.lastName+\" \"+maindebtor.lastName2:\"\";_context.t0=option;_context.next=_context.t0===OPTs.PROCESS_CANCELPROCESS?8:_context.t0===OPTs.PROCESS_LISTAEXCLUSION?10:_context.t0===OPTs.PROCESS_INFORMEGESTION?15:20;break;case 8:bpmServices.abortProcess(infoBpmModel.instanceId).then(function(data){if(data!==undefined){history.push(url.URL_DASHBOARD);}else{//Mensaje ERROR\nseterror_msg(t(\"ErrorSaveMessage\"));seterror_dlg(true);}});return _context.abrupt(\"break\",20);case 10:infoBpmModel.processId=OPTs.PROCESS_LISTAEXCLUSION;infoBpmModel.activityId=OPTs.ACT_NONE;values={\"info\":JSON.stringify(infoBpmModel),\"processId\":OPTs.PROCESS_LISTAEXCLUSION.toString(),\"activityId\":OPTs.ACT_NONE.toString(),\"transactionId\":locationData.transactionId.toString(),\"customerId\":locationData.customerId.toString(),\"applicationNumber\":\"\",\"procedureNumber\":\"\"//\"decision\":\"no\"          \n};bpmServices.updatevariables(locationData.instanceId,values).then(function(data){if(data!==undefined){history.push(url.URL_DASHBOARD);}else{//Mensaje ERROR\nseterror_msg(t(\"ErrorSaveMessage\"));seterror_dlg(true);}});return _context.abrupt(\"break\",20);case 15:infoBpmModel.processId=OPTs.PROCESS_INFORMEGESTION;infoBpmModel.activityId=OPTs.ACT_NONE;values={\"info\":JSON.stringify(infoBpmModel),\"processId\":OPTs.PROCESS_INFORMEGESTION.toString(),\"activityId\":OPTs.ACT_DATOSGENERALES.toString(),\"transactionId\":locationData.transactionId.toString(),\"customerId\":locationData.customerId.toString(),\"applicationNumber\":\"\",\"procedureNumber\":\"\"//\"decision\":\"no\"          \n};bpmServices.updatevariables(locationData.instanceId,values).then(function(data){if(data!==undefined){history.push({pathname:url.URL_MANAGEMENTREPORT,data:locationData});}else{//Mensaje ERROR\nseterror_msg(t(\"ErrorSaveMessage\"));seterror_dlg(true);}});return _context.abrupt(\"break\",20);case 20:case\"end\":return _context.stop();}}},_callee);}));return _saveJBPMProcess.apply(this,arguments);}function showModalEndProcess(){var show=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;setdisplayModalEndProcess(show);}//salvar comentario de end process\nfunction onSaveEndProcess(values){//Salvar los comentarios en Bitacora    \nlocationData[\"endProcessComment\"]=values.txtComment;UpdateDataModel(locationData);onSaveProcess(OPTs.PROCESS_CANCELPROCESS);}//Actualizamos El Modelo de Datos segun va cambiando\nfunction UpdateDataModel(data){setLocationData(data);}return/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"page-content\",children:[/*#__PURE__*/_jsx(Breadcrumbs,{title:t(\"CommercialCredit\"),breadcrumbItem:t(\"ExclusionList\")}),/*#__PURE__*/_jsxs(LoadingOverlay,{active:isActiveLoading,spinner:true,text:t(\"WaitingPlease\"),children:[/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(CardHeader,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsxs(Col,{md:6,children:[/*#__PURE__*/_jsx(\"h4\",{className:\"card-title\",children:t(\"ExclusionList\")}),/*#__PURE__*/_jsx(\"p\",{className:\"card-title-desc\",children:t(\"Selectifyoumeetanyofthefollowingpoints\")})]}),/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{sm:12,style:{textAlign:\"right\"},children:/*#__PURE__*/_jsxs(\"h5\",{className:\"card-title\",children:[mainDebtor!=null?mainDebtor.typePerson===\"1\"?mainDebtor.name+\" \"+mainDebtor.name2+\" \"+mainDebtor.lastName+\" \"+mainDebtor.lastName2:mainDebtor.name:\"\",\" \"]})}),/*#__PURE__*/_jsx(Col,{sm:12,style:{textAlign:\"right\"},children:/*#__PURE__*/_jsxs(\"h5\",{className:\"card-title\",style:{textAlign:\"right\"},children:[t(\"Tramit\"),\":\",\" \",\"#\",locationData===null||locationData===void 0?void 0:locationData.transactionId]})})]})})]})}),/*#__PURE__*/_jsx(CardBody,{children:dataList.length>0&&/*#__PURE__*/_jsx(FormResult,{results:dataList,dataCheck:dataListSelected,setDataListSelected:setDataListSelected,onSelectOption:onSelectOption})}),/*#__PURE__*/_jsx(CardFooter,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:3,style:{textAlign:\"left\",marginTop:\"10px\"},children:/*#__PURE__*/_jsxs(Button,{color:\"danger\",type:\"button\",style:{margin:'5px'},onClick:function onClick(){showModalEndProcess();},children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-cancel mid-12px\"}),\" \",t(\"Cancel\")]})}),/*#__PURE__*/_jsxs(Col,{md:9,style:{textAlign:\"right\",marginTop:\"10px\"},children:[/*#__PURE__*/_jsxs(Button,{color:\"primary\",type:\"button\",style:{margin:'5px'},onClick:function onClick(){onSaveProcess(OPTs.PROCESS_LISTAEXCLUSION);},children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-content-save-outline mid-12px\"}),\" \",t(\"Exit\")]}),/*#__PURE__*/_jsxs(Button,{color:\"success\",type:\"button\",style:{margin:'5px'},onClick:function onClick(){checkSelectedOptions();},children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-arrow-right-bold-circle-outline mid-12px\"}),\" \",t(\"ManagementReport\")]})]})]})})]}),locationData!==undefined&&locationData.customerId!==null&&locationData.customerId!==undefined&&locationData.customerId.length>0?/*#__PURE__*/_jsx(LogProcess,{locationData:locationData}):null]}),locationData?/*#__PURE__*/_jsx(LogProcess,{logProcessModel:new LogProcessModel(locationData.instanceId,locationData.transactionId,0,\"\",\"\",OPTs.PROCESS_LISTAEXCLUSION,OPTs.ACT_NONE,OPTs.BPM_ACTIVITY_03)}):null,/*#__PURE__*/_jsx(ModalCloseOptions,{onSaveProcess:onSaveProcess,isOpen:displayModalCloseOptions,toggle:function toggle(){toggleModalCloseOptions();}}),/*#__PURE__*/_jsx(ModalAdvanceOptions,{onSaveProcess:onSaveProcess,isOpen:displayModalAdvanceOptions,toggle:function toggle(){toggleModalAdvanceOptions();}}),/*#__PURE__*/_jsx(ModalEndProcess,{onSaveEndProcess:onSaveEndProcess,isOpen:displayModalEndProcess,toggle:function toggle(){showModalEndProcess(false);}}),successSave_dlg?/*#__PURE__*/_jsx(SweetAlert,{success:true,title:t(\"SuccessDialog\"),confirmButtonText:t(\"Confirm\"),cancelButtonText:t(\"Cancel\"),onConfirm:function onConfirm(){setsuccessSave_dlg(false);history.push(url.URL_DASHBOARD);},children:t(\"SuccessSaveMessage\")}):null,error_dlg?/*#__PURE__*/_jsx(SweetAlert,{error:true,title:t(\"ErrorDialog\"),confirmButtonText:t(\"Confirm\"),cancelButtonText:t(\"Cancel\"),onConfirm:function onConfirm(){seterror_dlg(false);},children:error_msg}):null]})});};export default withTranslation()(ListaExclusion);","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/pages/CommercialCredit/18_ListaExclusion/index.js"],"names":["React","useState","useLocation","useHistory","LoadingOverlay","ModalEndProcess","OPTs","url","Row","Col","Card","CardBody","Label","CardFooter","CardHeader","Button","AvForm","AvField","Link","Breadcrumbs","withTranslation","FormResult","ModalAdvanceOptions","ModalCloseOptions","BackendServices","CoreServices","BpmServices","SweetAlert","useTranslation","InfoBpmModel","LogProcessModel","LogProcess","ListaExclusion","props","history","location","undefined","locationData","setLocationData","t","i18n","dataList","setDataList","dataListSelected","setDataListSelected","isActiveLoading","setIsActiveLoading","successSave_dlg","setsuccessSave_dlg","error_dlg","seterror_dlg","error_msg","seterror_msg","displayModalAdvanceOptions","setDisplayModalAdvanceOptions","displayModalCloseOptions","setDisplayModalCloseOptions","displayModalEndProcess","setdisplayModalEndProcess","mainDebtor","setmainDebtor","backendServices","setbackendServices","bpmServices","setbpmServices","checked","setchecked","useEffect","data","transactionId","length","push","URL_DASHBOARD","sessionStorage","setItem","JSON","stringify","fetchData","result","getItem","parse","lista","document","getElementsByClassName","i","j","exclusionCatListId","exclusionId","getElementById","checkAndStartTask","then","iniresult","loadMainDebtor","initializeData","locdata","processNumber","queryListExclusion","exclusionCatListDTOList","catch","error","console","consultListExclusionChecked","transactId","datos","getExclusionApplicationListDTOList","startProcess","status","taskId","startedStatusTask","resp","removeBodyCss","body","classList","add","InputData","consultPrincipalDebtor","toggleModalAdvanceOptions","toggleModalCloseOptions","onSelectOption","e","saveListExclusion","removeCheckedExclusionList","checkSelectedOptions","checkboxes","check","onSaveProcess","PROCESS_INFORMEGESTION","option","PROCESS_CANCELPROCESS","saveJBPMProcess","maindebtor","infoBpmModel","instanceId","personId","personName","name","name2","lastName","lastName2","PROCESS_LISTAEXCLUSION","abortProcess","processId","activityId","ACT_NONE","values","toString","customerId","updatevariables","ACT_DATOSGENERALES","pathname","URL_MANAGEMENTREPORT","showModalEndProcess","show","onSaveEndProcess","txtComment","UpdateDataModel","textAlign","typePerson","marginTop","margin","BPM_ACTIVITY_03"],"mappings":"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","sourcesContent":["/*ExclusionList = Lista de Exclusion*/\r\nimport React, { useState } from \"react\"\r\nimport PropTypes from 'prop-types';\r\nimport { useLocation, useHistory } from 'react-router-dom'\r\nimport LoadingOverlay from 'react-loading-overlay';\r\nimport ModalEndProcess from \"../../../components/EndProcess/ModalEndProcess\"\r\nimport * as OPTs from \"../../../helpers/options_helper\"\r\nimport * as url from \"../../../helpers/url_helper\"\r\n\r\nimport {\r\n  Row,\r\n  Col,\r\n  Card,\r\n  CardBody,\r\n  Label,\r\n  CardFooter,\r\n  CardHeader,\r\n  Button\r\n} from \"reactstrap\"\r\n\r\nimport { AvForm, AvField } from \"availity-reactstrap-validation\"\r\nimport { Link } from \"react-router-dom\"\r\n//Import Breadcrumb\r\nimport Breadcrumbs from \"../../../components/Common/Breadcrumb\"\r\n\r\n//i18n\r\nimport { withTranslation } from \"react-i18next\"\r\n\r\nimport FormResult from \"./FormResultados\"\r\nimport ModalAdvanceOptions from \"./ModalAdvanceOptions\"\r\nimport ModalCloseOptions from \"./ModalCloseOptions\"\r\nimport { BackendServices, CoreServices, BpmServices, } from \"../../../services\";\r\nimport SweetAlert from \"react-bootstrap-sweetalert\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { InfoBpmModel } from '../../../models/Common/InfoBpmModel';\r\n\r\nimport { LogProcessModel } from '../../../models/Common/LogProcessModel';\r\nimport LogProcess from \"../../../components/LogProcess/index\";\r\n\r\n\r\nconst ListaExclusion = props => {\r\n\r\n\r\n  const history = useHistory();\r\n  const location = useLocation()\r\n  //Data que recibimos en el location\r\n  const [locationData, setLocationData] = useState(undefined);\r\n\r\n  const { t, i18n } = useTranslation();\r\n\r\n  const [dataList, setDataList] = useState([]); //items de la lista de exclusion\r\n  const [dataListSelected, setDataListSelected] = useState([]); //items selected de la lista de exclusion       \r\n  const [isActiveLoading, setIsActiveLoading] = useState(false);\r\n  const [successSave_dlg, setsuccessSave_dlg] = useState(false);\r\n  const [error_dlg, seterror_dlg] = useState(false);\r\n  const [error_msg, seterror_msg] = useState(\"\");\r\n  const [displayModalAdvanceOptions, setDisplayModalAdvanceOptions] = useState(false);\r\n  const [displayModalCloseOptions, setDisplayModalCloseOptions] = useState(false);\r\n  const [displayModalEndProcess, setdisplayModalEndProcess] = useState(false);\r\n\r\n  const [mainDebtor, setmainDebtor] = useState(null);\r\n  //Servicios\r\n  const [backendServices, setbackendServices] = useState(new BackendServices());\r\n  const [bpmServices, setbpmServices] = useState(new BpmServices());\r\n\r\n  const [checked, setchecked] = useState(false);\r\n  //On Mounting (componentDid Mount)\r\n  React.useEffect(() => {\r\n    if (location.data !== null && location.data !== undefined) {\r\n      if (location.data.transactionId === undefined || location.data.transactionId.length <= 0) {\r\n        //location.data.transactionId = 0;\r\n        //checkAndCreateProcedure(location.data);\r\n        history.push(url.URL_DASHBOARD);\r\n      }\r\n      else {\r\n        sessionStorage.setItem('locationData', JSON.stringify(location.data));\r\n        setLocationData(location.data);\r\n        fetchData(location.data);\r\n      }\r\n    }\r\n    else {\r\n      //chequeamos si tenemos guardado en session\r\n      var result = sessionStorage.getItem('locationData');\r\n      if (result !== undefined && result !== null) {\r\n        result = JSON.parse(result);\r\n        setLocationData(result);\r\n        fetchData(result);\r\n      }\r\n    }\r\n  }, []);\r\n  React.useEffect(() => {\r\n    let lista = document.getElementsByClassName(\"listaExclusion\");\r\n    for (var i = 0; i < lista.length; i++) {\r\n      for (let j = 0; j < dataListSelected.length; j++) {\r\n        if (dataListSelected[j].exclusionCatListId == dataList[i].exclusionId) {\r\n          document.getElementById(dataList[i].exclusionId).checked = true;\r\n          setchecked(true);\r\n        }\r\n      }\r\n    }\r\n  }, [props, dataListSelected]);\r\n\r\n  //Caraga Inicial de datos\r\n  function fetchData(locationData) {\r\n    //chequear si la tarea no ha sido iniciada\r\n    bpmServices.checkAndStartTask(locationData)\r\n      .then((iniresult) => {\r\n        if (iniresult === false) {\r\n          history.push(url.URL_DASHBOARD);\r\n        }\r\n      })\r\n    loadMainDebtor(locationData);\r\n    setLocationData(locationData);\r\n    initializeData(locationData);\r\n  }\r\n\r\n  //Caraga Inicial\r\n  function initializeData(locdata) {\r\n    var processNumber = locdata ? locdata.transactionId : null;\r\n    /* ---------------------------------------------------------------------------------------------- */\r\n    /*                     Buscar en Servicio el ExclisionList de este proceso...                     */\r\n    /* ---------------------------------------------------------------------------------------------- */\r\n    backendServices.queryListExclusion().then((data) => {\r\n      setDataList(data.exclusionCatListDTOList);\r\n    }).catch((error) => {\r\n      console.error('api error: ', error);\r\n    });\r\n    //{ transactId: location.data.transactionId, processId: location.data.processId, activityId: location.data.activityId }\r\n\r\n    /* ---------------------------------------------------------------------------------------------- */\r\n    /*                       Obtenemos los datos de la lista de exclusion record                      */\r\n    /* ---------------------------------------------------------------------------------------------- */\r\n    if (processNumber != null) {\r\n      backendServices.consultListExclusionChecked({ transactId: processNumber }).then((data) => {\r\n        let datos = data.getExclusionApplicationListDTOList;\r\n        setDataListSelected(datos);\r\n\r\n      }).catch((error) => {\r\n        console.error('api error: ', error);\r\n      });\r\n    }\r\n  }\r\n  function startProcess(status, taskId) {\r\n    if (status === \"Ready\") {\r\n      bpmServices.startedStatusTask(taskId).then(resp => {\r\n        if (resp === undefined) {\r\n          history.push(url.URL_DASHBOARD);\r\n        }\r\n      });\r\n    }\r\n  }\r\n  function removeBodyCss() {\r\n    document.body.classList.add(\"no_padding\")\r\n  }\r\n  function loadMainDebtor(InputData) {\r\n    backendServices.consultPrincipalDebtor(InputData.transactionId).then(resp => {\r\n      //resp.personType\r\n      //resp.identificationType\r\n      //resp.customerNumberT24\r\n      //resp.firstName\r\n      //resp.secondName\r\n      //resp.firstLastName\r\n      //resp.secondLastName\r\n      //resp.customerDocumentId\r\n      // dataReturn.nuevoDato = \"\"\r\n      setmainDebtor(resp)\r\n    })\r\n  }\r\n\r\n  //Modal Opciones para avanzar\r\n  function toggleModalAdvanceOptions() {\r\n    setDisplayModalAdvanceOptions(!displayModalAdvanceOptions);\r\n  }\r\n  //Modal Opciones al Salir\r\n  function toggleModalCloseOptions() {\r\n    setDisplayModalCloseOptions(!displayModalCloseOptions);\r\n  }\r\n\r\n  function onSelectOption(e) {\r\n    if (document.getElementById(e.exclusionId).checked) {\r\n      setchecked(true);\r\n      backendServices.saveListExclusion(locationData.transactionId, e.exclusionId).then(resp => {\r\n        if (resp === undefined) {\r\n          //Mensaje ERROR\r\n          seterror_msg(t(\"ErrorSaveMessage\"))\r\n          seterror_dlg(true)\r\n          return;\r\n        }\r\n      });\r\n    } else {\r\n      setchecked(false);\r\n      backendServices.removeCheckedExclusionList(locationData.transactionId, e.exclusionId).then(resp => {\r\n        if (resp === undefined) {\r\n          //Mensaje ERROR\r\n          seterror_msg(t(\"ErrorSaveMessage\"))\r\n          seterror_dlg(true)\r\n          return;\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  //Chequear si existen opciones seleccionadas en la lista\r\n  function checkSelectedOptions() {\r\n    /* ---------------------------------------------------------------------------------------------- */\r\n    /*              chequear si tiene seleccionada alguna opcion de la lista de exclusion             */\r\n    /*              mostrar mensaje para confirmacion y finalizar proceso                             */\r\n    /* ---------------------------------------------------------------------------------------------- */\r\n    var checkboxes = document.getElementsByClassName(\"listaExclusion\");\r\n    let check = 0;\r\n    for (var i = 0; i < checkboxes.length; i++) {\r\n      if (checkboxes[i].checked) {\r\n        check++;\r\n      }\r\n    }\r\n\r\n    if (check > 0) {\r\n      setDisplayModalAdvanceOptions(true);\r\n    } else {\r\n      //Avanzamos el Proceso\r\n      onSaveProcess(OPTs.PROCESS_INFORMEGESTION);\r\n    }\r\n  }\r\n\r\n  //Salvando el Proceso y le pasamos una opcion: 1-Finalizar Proceso, 2- Salvarlo, 3- A Cumplimmineto, 4- Avanzar a IGR\r\n  function onSaveProcess(option) {\r\n\r\n    //Guardamos la seleccion\r\n    var checkboxes = document.getElementsByClassName(\"listaExclusion\");\r\n    for (var i = 0; i < checkboxes.length; i++) {\r\n      if (checkboxes[i].checked) {\r\n        option=OPTs.PROCESS_CANCELPROCESS;\r\n      }\r\n    }\r\n\r\n    saveJBPMProcess(option);\r\n\r\n  }\r\n\r\n  async function saveJBPMProcess(option) {\r\n\r\n    var maindebtor = await backendServices.consultPrincipalDebtor(locationData.transactionId)\r\n\r\n    var infoBpmModel = new InfoBpmModel(\r\n      locationData.infoBpmModel?.instanceId ?? locationData.instanceId,\r\n      locationData.infoBpmModel?.transactId ?? locationData.transactionId,\r\n      0, 0,\r\n      maindebtor?.personId\r\n    );\r\n    infoBpmModel.personName = maindebtor !== undefined ? (maindebtor.name + \" \" + maindebtor.name2 + \" \" + maindebtor.lastName + \" \" + maindebtor.lastName2) : \"\";\r\n\r\n    switch (option) {\r\n      case OPTs.PROCESS_CANCELPROCESS: {\r\n        bpmServices.abortProcess(infoBpmModel.instanceId)\r\n          .then((data) => {\r\n            if (data !== undefined) {\r\n              history.push(url.URL_DASHBOARD);\r\n            }\r\n            else {\r\n              //Mensaje ERROR\r\n              seterror_msg(t(\"ErrorSaveMessage\"))\r\n              seterror_dlg(true)\r\n            }\r\n          });\r\n        break;\r\n      }\r\n      case OPTs.PROCESS_LISTAEXCLUSION: {\r\n        infoBpmModel.processId = OPTs.PROCESS_LISTAEXCLUSION;\r\n        infoBpmModel.activityId = OPTs.ACT_NONE;\r\n\r\n        var values = {\r\n          \"info\": JSON.stringify(infoBpmModel),\r\n          \"processId\": OPTs.PROCESS_LISTAEXCLUSION.toString(),\r\n          \"activityId\": OPTs.ACT_NONE.toString(),\r\n          \"transactionId\": locationData.transactionId.toString(),\r\n          \"customerId\": locationData.customerId.toString(),\r\n          \"applicationNumber\": \"\",\r\n          \"procedureNumber\": \"\",\r\n          //\"decision\":\"no\"          \r\n        };\r\n        bpmServices.updatevariables(locationData.instanceId, values)\r\n          .then((data) => {\r\n            if (data !== undefined) {\r\n              history.push(url.URL_DASHBOARD);\r\n            }\r\n            else {\r\n              //Mensaje ERROR\r\n              seterror_msg(t(\"ErrorSaveMessage\"))\r\n              seterror_dlg(true)\r\n            }\r\n          });\r\n\r\n        break;\r\n      }\r\n      case OPTs.PROCESS_INFORMEGESTION: {\r\n        infoBpmModel.processId = OPTs.PROCESS_INFORMEGESTION;\r\n        infoBpmModel.activityId = OPTs.ACT_NONE;\r\n\r\n        var values = {\r\n          \"info\": JSON.stringify(infoBpmModel),\r\n          \"processId\": OPTs.PROCESS_INFORMEGESTION.toString(),\r\n          \"activityId\": OPTs.ACT_DATOSGENERALES.toString(),\r\n          \"transactionId\": locationData.transactionId.toString(),\r\n          \"customerId\": locationData.customerId.toString(),\r\n          \"applicationNumber\": \"\",\r\n          \"procedureNumber\": \"\",\r\n          //\"decision\":\"no\"          \r\n        };\r\n        bpmServices.updatevariables(locationData.instanceId, values)\r\n          .then((data) => {\r\n            if (data !== undefined) {\r\n              history.push({\r\n                pathname: url.URL_MANAGEMENTREPORT,\r\n                data: locationData,\r\n              });\r\n            }\r\n            else {\r\n              //Mensaje ERROR\r\n              seterror_msg(t(\"ErrorSaveMessage\"))\r\n              seterror_dlg(true)\r\n            }\r\n          });\r\n\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  ////////// PARTE ES LA FINAL DEL PROCESO ///////\r\n  //Modal Para mostrar Comentario de Fin de Proceso\r\n  function showModalEndProcess(show = true) {\r\n    setdisplayModalEndProcess(show);\r\n  }\r\n\r\n  //salvar comentario de end process\r\n  function onSaveEndProcess(values) {\r\n\r\n    //Salvar los comentarios en Bitacora    \r\n    locationData[\"endProcessComment\"] = values.txtComment;\r\n\r\n    UpdateDataModel(locationData);\r\n\r\n    onSaveProcess(OPTs.PROCESS_CANCELPROCESS);\r\n  }\r\n\r\n  //Actualizamos El Modelo de Datos segun va cambiando\r\n  function UpdateDataModel(data) {\r\n    setLocationData(data);\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className=\"page-content\">\r\n        <Breadcrumbs title={t(\"CommercialCredit\")} breadcrumbItem={t(\"ExclusionList\")} />\r\n        <LoadingOverlay active={isActiveLoading} spinner text={t(\"WaitingPlease\")}>\r\n          <Card>\r\n            <CardHeader>\r\n              <Row>\r\n                <Col md={6}>\r\n                  <h4 className=\"card-title\">{t(\"ExclusionList\")}</h4>\r\n                  <p className=\"card-title-desc\">{t(\"Selectifyoumeetanyofthefollowingpoints\")}</p>\r\n                </Col>\r\n                <Col md={6}>\r\n                  <Row>\r\n                    <Col sm={12} style={{ textAlign: \"right\" }}>\r\n                      <h5 className=\"card-title\">{mainDebtor != null ? (mainDebtor.typePerson === \"1\" ? (mainDebtor.name + \" \" + mainDebtor.name2 + \" \" + mainDebtor.lastName + \" \" + mainDebtor.lastName2) : (mainDebtor.name)) : \"\"} </h5>\r\n                    </Col>\r\n                    <Col sm={12} style={{ textAlign: \"right\" }}>\r\n                      <h5 className=\"card-title\" style={{ textAlign: \"right\" }}>{t(\"Tramit\")}:{\" \"}#{locationData?.transactionId}</h5>\r\n                    </Col>\r\n                  </Row>\r\n                </Col>\r\n              </Row>\r\n            </CardHeader>\r\n            <CardBody>\r\n              {dataList.length > 0 && (\r\n                <FormResult results={dataList} dataCheck={dataListSelected} setDataListSelected={setDataListSelected} onSelectOption={onSelectOption} />\r\n              )}\r\n            </CardBody>\r\n            <CardFooter>\r\n\r\n              <Row>\r\n                <Col md={3} style={{ textAlign: \"left\", marginTop: \"10px\" }}>\r\n                  <Button color=\"danger\" type=\"button\" style={{ margin: '5px' }} onClick={() => { showModalEndProcess() }}><i className=\"mdi mdi-cancel mid-12px\"></i> {t(\"Cancel\")}</Button>\r\n                </Col>\r\n                <Col md={9} style={{ textAlign: \"right\", marginTop: \"10px\" }}>\r\n                  <Button color=\"primary\" type=\"button\" style={{ margin: '5px' }} onClick={() => { onSaveProcess(OPTs.PROCESS_LISTAEXCLUSION) }}><i className=\"mdi mdi-content-save-outline mid-12px\"></i> {t(\"Exit\")}</Button>\r\n                  <Button color=\"success\" type=\"button\" style={{ margin: '5px' }}\r\n                    onClick={() => { checkSelectedOptions(); }}><i className=\"mdi mdi-arrow-right-bold-circle-outline mid-12px\"></i> {t(\"ManagementReport\")}</Button>\r\n                </Col>\r\n              </Row>\r\n\r\n            </CardFooter>\r\n          </Card>\r\n\r\n          {(locationData !== undefined && locationData.customerId !== null && locationData.customerId !== undefined && locationData.customerId.length > 0) ? (<LogProcess locationData={locationData} />) : null}\r\n        </LoadingOverlay>\r\n\r\n        {locationData ?\r\n          <LogProcess logProcessModel={new LogProcessModel(locationData.instanceId, locationData.transactionId, 0, \"\", \"\", OPTs.PROCESS_LISTAEXCLUSION, OPTs.ACT_NONE,OPTs.BPM_ACTIVITY_03)} />\r\n          : null}\r\n\r\n        <ModalCloseOptions onSaveProcess={onSaveProcess} isOpen={displayModalCloseOptions} toggle={() => { toggleModalCloseOptions() }} />\r\n        <ModalAdvanceOptions onSaveProcess={onSaveProcess} isOpen={displayModalAdvanceOptions} toggle={() => { toggleModalAdvanceOptions() }} />\r\n        <ModalEndProcess onSaveEndProcess={onSaveEndProcess} isOpen={displayModalEndProcess} toggle={() => { showModalEndProcess(false) }} />\r\n\r\n        {successSave_dlg ? (\r\n          <SweetAlert\r\n            success\r\n            title={t(\"SuccessDialog\")}\r\n            confirmButtonText= {t(\"Confirm\")}\r\n            cancelButtonText= {t(\"Cancel\")}          \r\n            onConfirm={() => {\r\n              setsuccessSave_dlg(false)\r\n\r\n              history.push(url.URL_DASHBOARD);\r\n            }}\r\n          >\r\n            {t(\"SuccessSaveMessage\")}\r\n          </SweetAlert>\r\n        ) : null}\r\n\r\n        {error_dlg ? (\r\n          <SweetAlert\r\n            error\r\n            title={t(\"ErrorDialog\")}\r\n            confirmButtonText= {t(\"Confirm\")}\r\n            cancelButtonText= {t(\"Cancel\")}          \r\n            onConfirm={() => {\r\n              seterror_dlg(false)\r\n            }}\r\n          >\r\n            {error_msg}\r\n          </SweetAlert>\r\n        ) : null}\r\n      </div>\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\nexport default (withTranslation()(ListaExclusion))\r\n"]},"metadata":{},"sourceType":"module"}