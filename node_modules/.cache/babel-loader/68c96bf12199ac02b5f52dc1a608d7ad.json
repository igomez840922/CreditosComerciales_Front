{"ast":null,"code":"import _slicedToArray from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import{withTranslation}from\"react-i18next\";import{Row,Col,Button,Label,Input,Modal,Card,CardBody,CardFooter}from\"reactstrap\";import{AvForm,AvField}from\"availity-reactstrap-validation\";import Services from\"../../services/BackendServices/Services\";import{useLocation,useHistory}from'react-router-dom';import{useTranslation}from'react-i18next';import toastr from\"toastr\";import\"toastr/build/toastr.min.css\";import Alert from'react-bootstrap/Alert';import LocalStorageHelper from\"../../helpers/LocalStorageHelper\";import*as opt from\"../../helpers/options_helper\";import{BackendServices}from\"../../services/index\";/* ---------------------------------------------------------------------------------------------- */ /*                  Funcion para mostrar el modal para guardar la bitacora manual                 */ /* ---------------------------------------------------------------------------------------------- */import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ModalBitacora=function ModalBitacora(props){var _useTranslation=useTranslation(),t=_useTranslation.t,i18n=_useTranslation.i18n;var _useState=useState(props.logProcessModel),_useState2=_slicedToArray(_useState,2),logProcessModel=_useState2[0],setlogProcessModel=_useState2[1];var _useState3=useState(new LocalStorageHelper()),_useState4=_slicedToArray(_useState3,2),localStorageHelper=_useState4[0],setlocalStorageHelper=_useState4[1];var _useState5=useState(new BackendServices()),_useState6=_slicedToArray(_useState5,2),backendServices=_useState6[0],setbackendServices=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),mainDebtor=_useState8[0],setmainDebtor=_useState8[1];var _useState9=useState({show:false,msg:\"\",isError:false}),_useState10=_slicedToArray(_useState9,2),msgData=_useState10[0],setmsgData=_useState10[1];useEffect(function(){if(logProcessModel!==undefined&&logProcessModel!==null){loadMainDebtor(logProcessModel.transactId);}},[]);function loadMainDebtor(transactionId){// consultarDeudorPrincipal\nbackendServices.consultPrincipalDebtor(transactionId).then(function(data){if(data!==undefined){setmainDebtor(data);}});}//mostrar mensaje \nfunction showMessage(message){var isError=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;setmsgData({show:true,msg:message,isError:isError});}function handleSubmit(event,errors,values){event.preventDefault();if(errors.length>0){return;}onSaveLogProcess(values.txtComment);}function onSaveLogProcess(observations){var _credentials$usr,_mainDebtor$personId;var credentials=localStorageHelper.get(opt.VARNAME_USRCREDENTIAL);logProcessModel.responsible=(_credentials$usr=credentials===null||credentials===void 0?void 0:credentials.usr)!==null&&_credentials$usr!==void 0?_credentials$usr:\"admin\";logProcessModel.clientId=(_mainDebtor$personId=mainDebtor===null||mainDebtor===void 0?void 0:mainDebtor.personId)!==null&&_mainDebtor$personId!==void 0?_mainDebtor$personId:logProcessModel.clientId;logProcessModel.observations=observations;backendServices.saveHistorical(logProcessModel).then(function(resp){//console.log(\"saveHistorical\",resp);\nif(resp!==undefined){props.successSaved();props.toggle();}else{//Mensaje ERROR\nshowMessage(t(\"ErrorSaveMessage\"),true);}props.successSaved();props.toggle();}).catch(function(err){showMessage(err.message,true);});}return/*#__PURE__*/_jsxs(Modal,{size:\"xl\",isOpen:props.isOpen,toggle:props.toggle,centered:true,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"modal-title mt-0\",children:props.t(\"NewLog\")}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:props.toggle,className:\"close\",\"data-dismiss\":\"modal\",\"aria-label\":\"Close\",children:/*#__PURE__*/_jsx(\"span\",{\"aria-hidden\":\"true\",children:\"\\xD7\"})})]}),/*#__PURE__*/_jsxs(AvForm,{id:\"frmNewLog\",className:\"needs-validation\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-body\",children:[/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"txtComment\",children:t(\"Comment\")}),/*#__PURE__*/_jsx(AvField,{className:\"form-control\",name:\"txtComment\",type:\"textarea\",rows:7,validate:{required:{value:true,errorMessage:t(\"Required Field\")}}})]})})}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsx(Alert,{show:msgData.show,variant:msgData.isError?\"danger\":\"success\",dismissible:true,onClose:function onClose(){setmsgData({show:false,msg:\"\",isError:false});},children:msgData.msg})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-footer\",children:[/*#__PURE__*/_jsxs(Button,{color:\"danger\",type:\"button\",style:{margin:'5px'},onClick:function onClick(){props.toggle();},children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-cancel mid-12px\"}),\" \",props.t(\"Cancel\")]}),/*#__PURE__*/_jsxs(Button,{color:\"success\",type:\"submit\",style:{margin:'5px'},children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-content-save  mid-12px\"}),\" \",props.t(\"Save\")]})]})]})]});};export default withTranslation()(ModalBitacora);","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/components/Common/ModalBitacora.js"],"names":["React","useEffect","useState","withTranslation","Row","Col","Button","Label","Input","Modal","Card","CardBody","CardFooter","AvForm","AvField","Services","useLocation","useHistory","useTranslation","toastr","Alert","LocalStorageHelper","opt","BackendServices","ModalBitacora","props","t","i18n","logProcessModel","setlogProcessModel","localStorageHelper","setlocalStorageHelper","backendServices","setbackendServices","mainDebtor","setmainDebtor","show","msg","isError","msgData","setmsgData","undefined","loadMainDebtor","transactId","transactionId","consultPrincipalDebtor","then","data","showMessage","message","handleSubmit","event","errors","values","preventDefault","length","onSaveLogProcess","txtComment","observations","credentials","get","VARNAME_USRCREDENTIAL","responsible","usr","clientId","personId","saveHistorical","resp","successSaved","toggle","catch","err","isOpen","required","value","errorMessage","margin"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\"\r\nimport { withTranslation } from \"react-i18next\"\r\nimport PropTypes from 'prop-types';\r\nimport {Row,Col,Button,Label,Input,Modal,Card,CardBody,CardFooter} from \"reactstrap\"\r\nimport { AvForm, AvField } from \"availity-reactstrap-validation\"\r\nimport Services from \"../../services/BackendServices/Services\";\r\nimport { useLocation, useHistory } from 'react-router-dom'\r\nimport { useTranslation } from 'react-i18next'\r\nimport toastr from \"toastr\";\r\nimport \"toastr/build/toastr.min.css\";\r\n\r\nimport Alert from 'react-bootstrap/Alert'\r\n\r\nimport LocalStorageHelper from \"../../helpers/LocalStorageHelper\";\r\nimport * as opt from \"../../helpers/options_helper\";\r\nimport { BackendServices } from \"../../services/index\";\r\n\r\n/* ---------------------------------------------------------------------------------------------- */\r\n/*                  Funcion para mostrar el modal para guardar la bitacora manual                 */\r\n/* ---------------------------------------------------------------------------------------------- */\r\nconst ModalBitacora = (props) => {\r\n\r\n    \r\n    const { t, i18n } = useTranslation();\r\n    const [logProcessModel, setlogProcessModel] = useState(props.logProcessModel);\r\n    const [localStorageHelper, setlocalStorageHelper] = useState(new LocalStorageHelper());\r\n    const [backendServices, setbackendServices] = useState(new BackendServices());\r\n\r\n    const [mainDebtor, setmainDebtor] = useState(null);\r\n    const [msgData, setmsgData] = useState({ show: false, msg: \"\", isError: false });\r\n  \r\n    useEffect(() => {\r\n        if (logProcessModel !== undefined && logProcessModel !== null) {\r\n          loadMainDebtor(logProcessModel.transactId);\r\n        } \r\n      }, []);\r\n    \r\n      function loadMainDebtor(transactionId) {\r\n        // consultarDeudorPrincipal\r\n        backendServices.consultPrincipalDebtor(transactionId)\r\n          .then((data) => {\r\n            if (data !== undefined) {\r\n              setmainDebtor(data);\r\n            }\r\n          });\r\n      }\r\n     \r\n      //mostrar mensaje \r\n  function showMessage(message, isError = false) {\r\n    setmsgData({ show: true, msg: message, isError: isError })\r\n  }\r\n  \r\n  \r\n    function handleSubmit(event, errors, values) {\r\n    event.preventDefault();\r\n    if (errors.length > 0) {\r\n      return;\r\n    }\r\n    onSaveLogProcess(values.txtComment);\r\n  }\r\n\r\n  function onSaveLogProcess(observations) {\r\n    \r\n    var credentials = localStorageHelper.get(opt.VARNAME_USRCREDENTIAL);\r\n    \r\n    logProcessModel.responsible = credentials?.usr??\"admin\"\r\n    logProcessModel.clientId = mainDebtor?.personId??logProcessModel.clientId;\r\n    logProcessModel.observations= observations;    \r\n    backendServices.saveHistorical(logProcessModel)\r\n        .then(resp => {\r\n            //console.log(\"saveHistorical\",resp);\r\n          if (resp !== undefined) {\r\n            props.successSaved()\r\n            props.toggle()\r\n          }\r\n          else {\r\n            //Mensaje ERROR\r\n            showMessage(t(\"ErrorSaveMessage\"), true);\r\n          }\r\n\r\n          props.successSaved()\r\n            props.toggle()\r\n            \r\n        }).catch(err => {\r\n            showMessage(err.message, true);\r\n        });\r\n  }\r\n\r\n\r\n  return (\r\n    <Modal\r\n      size=\"xl\"\r\n      isOpen={props.isOpen}\r\n      toggle={props.toggle}\r\n      centered={true}>\r\n      <div className=\"modal-header\">\r\n        <h5 className=\"modal-title mt-0\">{props.t(\"NewLog\")}</h5>\r\n        <button\r\n          type=\"button\"\r\n          onClick={props.toggle}\r\n          className=\"close\"\r\n          data-dismiss=\"modal\"\r\n          aria-label=\"Close\">\r\n          <span aria-hidden=\"true\">&times;</span>\r\n        </button>\r\n      </div>\r\n\r\n      <AvForm id=\"frmNewLog\" className=\"needs-validation\" onSubmit={handleSubmit}>\r\n        <div className=\"modal-body\">\r\n          <Row>\r\n            <Col md=\"12\">\r\n              <div className=\"mb-3\">\r\n                <Label htmlFor=\"txtComment\">{t(\"Comment\")}</Label>\r\n                <AvField\r\n                  className=\"form-control\"\r\n                  name=\"txtComment\"\r\n                  type=\"textarea\"\r\n                  rows={7}\r\n                  validate={{\r\n                    required: { value: true, errorMessage: t(\"Required Field\") }\r\n                  }}\r\n                />\r\n              </div>\r\n            </Col>\r\n          </Row>\r\n\r\n                <Row>\r\n                  <Col md=\"12\">\r\n                    <Alert show={msgData.show} variant={msgData.isError ? \"danger\" : \"success\"} dismissible onClose={() => { setmsgData({ show: false, msg: \"\", isError: false }) }}>\r\n                      {msgData.msg}\r\n                    </Alert>\r\n                  </Col>\r\n                </Row>\r\n\r\n        </div>\r\n        <div className=\"modal-footer\">\r\n          <Button color=\"danger\" type=\"button\" style={{ margin: '5px' }} onClick={() => { props.toggle() }}>\r\n            <i className=\"mdi mdi-cancel mid-12px\"></i> {props.t(\"Cancel\")}\r\n          </Button>\r\n          <Button color=\"success\" type=\"submit\" style={{ margin: '5px' }} >\r\n            <i className=\"mdi mdi-content-save  mid-12px\"></i> {props.t(\"Save\")}\r\n          </Button>\r\n        </div>\r\n      </AvForm>\r\n\r\n    </Modal>\r\n  );\r\n};\r\n\r\nModalBitacora.propTypes = {\r\n  isOpen: PropTypes.bool,\r\n  toggle: PropTypes.func,  \r\n  successSaved: PropTypes.func,\r\n  logProcessModel: PropTypes.any, //LogProcessModel\r\n};\r\n\r\nexport default (withTranslation()(ModalBitacora));\r\n"]},"metadata":{},"sourceType":"module"}