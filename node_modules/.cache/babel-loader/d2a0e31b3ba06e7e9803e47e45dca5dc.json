{"ast":null,"code":"import _slicedToArray from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import{Row,Col,Card,CardBody,CardHeader,Button,Label,Table}from\"reactstrap\";import{AvForm,AvField}from\"availity-reactstrap-validation\";//i18n\nimport{withTranslation}from\"react-i18next\";import{useLocation,useHistory}from\"react-router-dom\";import{BackendServices}from\"../../../../services\";import*as url from\"../../../../helpers/url_helper\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Fideicomiso=function Fideicomiso(props){var location=useLocation();var apiBack=new BackendServices();var _useState=useState(location.data),_useState2=_slicedToArray(_useState,2),dataLocation=_useState2[0],setData=_useState2[1];var _useState3=useState({name:\"\",number:0}),_useState4=_slicedToArray(_useState3,2),dataTrust=_useState4[0],setdataTrust=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),locationData=_useState6[0],setLocationData=_useState6[1];var history=useHistory();React.useEffect(function(){var dataSession;if(location.data!==null&&location.data!==undefined){if(location.data.transactionId===undefined||location.data.transactionId.length<=0){//location.data.transactionId = 0;\n//checkAndCreateProcedure(location.data);\nhistory.push(url.URL_DASHBOARD);}else{sessionStorage.setItem('locationData',JSON.stringify(location.data));setLocationData(location.data);dataSession=location.data;}}else{//chequeamos si tenemos guardado en session\nvar result=sessionStorage.getItem('locationData');if(result!==undefined&&result!==null){result=JSON.parse(result);setLocationData(result);dataSession=result;}}// Read Api Service data\ninitializeData(dataSession);},[props.facilityId]);function initializeData(dataLocation){apiBack.consultarNumeroFideicomiso(dataLocation.transactionId).then(function(resp){var _resp$filter;if(resp===undefined||(resp===null||resp===void 0?void 0:(_resp$filter=resp.filter(function(trustInfo){return trustInfo.facilityId===props.facilityId;}))===null||_resp$filter===void 0?void 0:_resp$filter.length)===0){apiBack.guardarNumeroFideicomiso({\"transactId\":Number(dataLocation.transactionId),facilityId:props.facilityId,\"conclusions\":\" \"}).then(function(response){var trustName=response.trustName.split(' ');trustName.splice(trustName.length-1,1);trustName=trustName.join(' ');setdataTrust({name:trustName,number:response.trustNumber});});}else{var trustInfo=resp.find(function(trustInfo){return trustInfo.facilityId===props.facilityId;});var trustName=trustInfo.trustName.split(' ');trustName.splice(trustName.length-1,1);trustName=trustName.join(' ');setdataTrust({name:trustName,number:trustInfo.trustNumber});}});}function handleSubmit(event,errors,values){event.preventDefaulprops.t();if(errors.length>0){return;}}function check(e){var tecla=document.all?e.keyCode:e.which;//Tecla de retroceso para borrar, siempre la permite\nif(tecla===45){e.preventDefault();return true;}return false;}return/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsxs(Col,{lg:\"12\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"card-title\",children:props.t(\"Escrow\")}),/*#__PURE__*/_jsx(\"p\",{className:\"card-title-desc\"}),/*#__PURE__*/_jsx(AvForm,{id:\"frmSearch\",className:\"needs-validation\",onSubmit:handleSubmit,children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:\"6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"fideicomisoName\",children:props.t(\"Escrowname\")}),/*#__PURE__*/_jsx(AvField,{className:\"form-control\",name:\"fideicomisoName\",type:\"text\",readOnly:true,id:\"fideicomisoName\",value:dataTrust.name})]})}),/*#__PURE__*/_jsx(Col,{md:\"3\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"fideicomisoNumber\",children:props.t(\"Escrownumber\")}),/*#__PURE__*/_jsx(AvField,{className:\"form-control\",name:\"fideicomisoNumber\",min:0,type:\"number\",onKeyPress:function onKeyPress(e){return check(e);},readOnly:true,id:\"fideicomisoNumber\",value:dataTrust.number})]})})]})})]})})});};export default withTranslation()(Fideicomiso);","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/pages/CommercialCredit/10_Fideicomiso/AsignarNumeroFideicomiso/Fideicomiso.js"],"names":["React","useState","Row","Col","Card","CardBody","CardHeader","Button","Label","Table","AvForm","AvField","withTranslation","useLocation","useHistory","BackendServices","url","Fideicomiso","props","location","apiBack","data","dataLocation","setData","name","number","dataTrust","setdataTrust","locationData","setLocationData","history","useEffect","dataSession","undefined","transactionId","length","push","URL_DASHBOARD","sessionStorage","setItem","JSON","stringify","result","getItem","parse","initializeData","facilityId","consultarNumeroFideicomiso","then","resp","filter","trustInfo","guardarNumeroFideicomiso","Number","response","trustName","split","splice","join","trustNumber","find","handleSubmit","event","errors","values","preventDefaulprops","t","check","e","tecla","document","all","keyCode","which","preventDefault"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\"\r\nimport PropTypes from 'prop-types';\r\nimport {\r\n  Row,\r\n  Col,\r\n  Card,\r\n  CardBody,\r\n  CardHeader,\r\n  Button,\r\n  Label,\r\n  Table\r\n} from \"reactstrap\"\r\nimport { AvForm, AvField } from \"availity-reactstrap-validation\"\r\n//i18n\r\nimport { withTranslation } from \"react-i18next\"\r\nimport { useLocation, useHistory } from \"react-router-dom\";\r\nimport { BackendServices } from \"../../../../services\";\r\nimport * as url from \"../../../../helpers/url_helper\"\r\n\r\nconst Fideicomiso = (props) => {\r\n  const location = useLocation()\r\n  const apiBack = new BackendServices();\r\n  const [dataLocation, setData] = useState(location.data);\r\n  const [dataTrust, setdataTrust] = useState({ name: \"\", number: 0 });\r\n  const [locationData, setLocationData] = useState(null);\r\n  const history = useHistory();\r\n\r\n  React.useEffect(() => {\r\n\r\n    let dataSession;\r\n\r\n    if (location.data !== null && location.data !== undefined) {\r\n      if (location.data.transactionId === undefined || location.data.transactionId.length <= 0) {\r\n        //location.data.transactionId = 0;\r\n        //checkAndCreateProcedure(location.data);\r\n        history.push(url.URL_DASHBOARD);\r\n      }\r\n      else {\r\n        sessionStorage.setItem('locationData', JSON.stringify(location.data));\r\n        setLocationData(location.data);\r\n        dataSession = location.data;\r\n      }\r\n    }\r\n    else {\r\n      //chequeamos si tenemos guardado en session\r\n      var result = sessionStorage.getItem('locationData');\r\n      if (result !== undefined && result !== null) {\r\n        result = JSON.parse(result);\r\n        setLocationData(result);\r\n        dataSession = result;\r\n      }\r\n    }\r\n\r\n\r\n    // Read Api Service data\r\n    initializeData(dataSession);\r\n  }, [props.facilityId]);\r\n  function initializeData(dataLocation) {\r\n    apiBack.consultarNumeroFideicomiso(dataLocation.transactionId).then(resp => {\r\n      if (resp === undefined || resp?.filter(trustInfo => trustInfo.facilityId === props.facilityId)?.length === 0) {\r\n        apiBack.guardarNumeroFideicomiso({\r\n          \"transactId\": Number(dataLocation.transactionId),\r\n          facilityId: props.facilityId,\r\n          \"conclusions\": \" \"\r\n        }).then(response => {\r\n          let trustName = response.trustName.split(' ');\r\n          trustName.splice(trustName.length - 1, 1);\r\n          trustName = trustName.join(' ');\r\n          setdataTrust({ name: trustName, number: response.trustNumber })\r\n        })\r\n      } else {\r\n        let trustInfo = resp.find(trustInfo => trustInfo.facilityId === props.facilityId)\r\n        let trustName = trustInfo.trustName.split(' ');\r\n        trustName.splice(trustName.length - 1, 1);\r\n        trustName = trustName.join(' ');\r\n        setdataTrust({ name: trustName, number: trustInfo.trustNumber })\r\n\r\n      }\r\n    })\r\n  }\r\n  function handleSubmit(event, errors, values) {\r\n    event.preventDefaulprops.t();\r\n    if (errors.length > 0) {\r\n      return;\r\n    }\r\n  }\r\n\r\n  function check(e) {\r\n    let tecla = (document.all) ? e.keyCode : e.which;\r\n    //Tecla de retroceso para borrar, siempre la permite\r\n    if (tecla === 45) {\r\n      e.preventDefault();\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <Row>\r\n        <Col lg=\"12\">\r\n          <h4 className=\"card-title\">{props.t(\"Escrow\")}</h4>\r\n          <p className=\"card-title-desc\"></p>\r\n          <AvForm id=\"frmSearch\" className=\"needs-validation\" onSubmit={handleSubmit}>\r\n            <Row>\r\n              <Col md=\"6\">\r\n                <div className=\"mb-3\">\r\n                  <Label htmlFor=\"fideicomisoName\">{props.t(\"Escrowname\")}</Label>\r\n                  <AvField\r\n                    className=\"form-control\"\r\n                    name=\"fideicomisoName\"\r\n                    type=\"text\"\r\n                    readOnly={true}\r\n                    id=\"fideicomisoName\" value={dataTrust.name} />\r\n                </div>\r\n              </Col>\r\n              <Col md=\"3\">\r\n                <div className=\"mb-3\">\r\n                  <Label htmlFor=\"fideicomisoNumber\">{props.t(\"Escrownumber\")}</Label>\r\n                  <AvField\r\n                    className=\"form-control\"\r\n                    name=\"fideicomisoNumber\"\r\n                    min={0}\r\n                    type=\"number\"\r\n                    onKeyPress={(e) => { return check(e) }}\r\n                    readOnly={true}\r\n                    id=\"fideicomisoNumber\" value={dataTrust.number} />\r\n                </div>\r\n              </Col>\r\n            </Row>\r\n          </AvForm>\r\n        </Col>\r\n      </Row>\r\n    </React.Fragment>\r\n  );\r\n}\r\nexport default (withTranslation()(Fideicomiso))\r\n"]},"metadata":{},"sourceType":"module"}