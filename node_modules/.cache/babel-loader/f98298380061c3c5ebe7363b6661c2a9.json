{"ast":null,"code":"import _objectSpread from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _createForOfIteratorHelper from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _slicedToArray from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import packageJson from\"../package.json\";import moment from\"moment\";import{jsx as _jsx}from\"react/jsx-runtime\";var buildDateGreaterThan=function buildDateGreaterThan(latestDate,currentDate){var momLatestDateTime=moment(latestDate);var momCurrentDateTime=moment(currentDate);if(momLatestDateTime.isAfter(momCurrentDateTime)){return true;}else{return false;}};function withClearCache(Component){function ClearCacheComponent(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLatestBuildDate=_useState2[0],setIsLatestBuildDate=_useState2[1];useEffect(function(){fetch(\"/meta.json\").then(function(response){return response.json();}).then(function(meta){var latestVersionDate=meta.buildDate;var currentVersionDate=packageJson.buildDate;var shouldForceRefresh=buildDateGreaterThan(latestVersionDate,currentVersionDate);if(shouldForceRefresh){setIsLatestBuildDate(false);refreshCacheAndReload();}else{setIsLatestBuildDate(true);}});},[]);var refreshCacheAndReload=function refreshCacheAndReload(){if(caches){// Service worker cache should be cleared with caches.delete()\ncaches.keys().then(function(names){var _iterator=_createForOfIteratorHelper(names),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var name=_step.value;caches.delete(name);}}catch(err){_iterator.e(err);}finally{_iterator.f();}});}// delete browser cache and hard reload\nwindow.location.reload(true);};return/*#__PURE__*/_jsx(React.Fragment,{children:isLatestBuildDate?/*#__PURE__*/_jsx(Component,_objectSpread({},props)):null});}return ClearCacheComponent;}export default withClearCache;","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/ClearCache.js"],"names":["React","useState","useEffect","packageJson","moment","buildDateGreaterThan","latestDate","currentDate","momLatestDateTime","momCurrentDateTime","isAfter","withClearCache","Component","ClearCacheComponent","props","isLatestBuildDate","setIsLatestBuildDate","fetch","then","response","json","meta","latestVersionDate","buildDate","currentVersionDate","shouldForceRefresh","refreshCacheAndReload","caches","keys","names","name","delete","window","location","reload"],"mappings":"oiBAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,MAAOC,CAAAA,WAAP,KAAwB,iBAAxB,CACA,MAAOC,CAAAA,MAAP,KAAmB,QAAnB,C,2CAEA,GAAMC,CAAAA,oBAAoB,CAAG,QAAvBA,CAAAA,oBAAuB,CAACC,UAAD,CAAaC,WAAb,CAA6B,CACxD,GAAMC,CAAAA,iBAAiB,CAAGJ,MAAM,CAACE,UAAD,CAAhC,CACA,GAAMG,CAAAA,kBAAkB,CAAGL,MAAM,CAACG,WAAD,CAAjC,CAEA,GAAIC,iBAAiB,CAACE,OAAlB,CAA0BD,kBAA1B,CAAJ,CAAmD,CACjD,MAAO,KAAP,CACD,CAFD,IAEO,CACL,MAAO,MAAP,CACD,CACF,CATD,CAWA,QAASE,CAAAA,cAAT,CAAwBC,SAAxB,CAAmC,CACjC,QAASC,CAAAA,mBAAT,CAA6BC,KAA7B,CAAoC,CAClC,cAAkDb,QAAQ,CAAC,KAAD,CAA1D,wCAAOc,iBAAP,eAA0BC,oBAA1B,eAEAd,SAAS,CAAC,UAAM,CACde,KAAK,CAAC,YAAD,CAAL,CACGC,IADH,CACQ,SAACC,QAAD,QAAcA,CAAAA,QAAQ,CAACC,IAAT,EAAd,EADR,EAEGF,IAFH,CAEQ,SAACG,IAAD,CAAU,CACd,GAAMC,CAAAA,iBAAiB,CAAGD,IAAI,CAACE,SAA/B,CACA,GAAMC,CAAAA,kBAAkB,CAAGrB,WAAW,CAACoB,SAAvC,CAEA,GAAME,CAAAA,kBAAkB,CAAGpB,oBAAoB,CAC7CiB,iBAD6C,CAE7CE,kBAF6C,CAA/C,CAIA,GAAIC,kBAAJ,CAAwB,CACtBT,oBAAoB,CAAC,KAAD,CAApB,CACAU,qBAAqB,GACtB,CAHD,IAGO,CACLV,oBAAoB,CAAC,IAAD,CAApB,CACD,CACF,CAhBH,EAiBD,CAlBQ,CAkBN,EAlBM,CAAT,CAoBA,GAAMU,CAAAA,qBAAqB,CAAG,QAAxBA,CAAAA,qBAAwB,EAAM,CAClC,GAAIC,MAAJ,CAAY,CACV;AACAA,MAAM,CAACC,IAAP,GAAcV,IAAd,CAAmB,SAACW,KAAD,CAAW,0CACTA,KADS,YAC5B,+CAA0B,IAAfC,CAAAA,IAAe,aACxBH,MAAM,CAACI,MAAP,CAAcD,IAAd,EACD,CAH2B,qDAI7B,CAJD,EAKD,CACD;AACAE,MAAM,CAACC,QAAP,CAAgBC,MAAhB,CAAuB,IAAvB,EACD,CAXD,CAaA,mBACE,KAAC,KAAD,CAAO,QAAP,WACGnB,iBAAiB,cAAG,KAAC,SAAD,kBAAeD,KAAf,EAAH,CAA8B,IADlD,EADF,CAKD,CAED,MAAOD,CAAAA,mBAAP,CACD,CAED,cAAeF,CAAAA,cAAf","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport packageJson from \"../package.json\";\r\nimport moment from \"moment\";\r\n\r\nconst buildDateGreaterThan = (latestDate, currentDate) => {\r\n  const momLatestDateTime = moment(latestDate);\r\n  const momCurrentDateTime = moment(currentDate);\r\n\r\n  if (momLatestDateTime.isAfter(momCurrentDateTime)) {\r\n    return true;\r\n  } else {\r\n    return false;\r\n  }\r\n};\r\n\r\nfunction withClearCache(Component) {\r\n  function ClearCacheComponent(props) {\r\n    const [isLatestBuildDate, setIsLatestBuildDate] = useState(false);\r\n\r\n    useEffect(() => {\r\n      fetch(\"/meta.json\")\r\n        .then((response) => response.json())\r\n        .then((meta) => {\r\n          const latestVersionDate = meta.buildDate;\r\n          const currentVersionDate = packageJson.buildDate;\r\n\r\n          const shouldForceRefresh = buildDateGreaterThan(\r\n            latestVersionDate,\r\n            currentVersionDate\r\n          );\r\n          if (shouldForceRefresh) {\r\n            setIsLatestBuildDate(false);\r\n            refreshCacheAndReload();\r\n          } else {\r\n            setIsLatestBuildDate(true);\r\n          }\r\n        });\r\n    }, []);\r\n\r\n    const refreshCacheAndReload = () => {\r\n      if (caches) {\r\n        // Service worker cache should be cleared with caches.delete()\r\n        caches.keys().then((names) => {\r\n          for (const name of names) {\r\n            caches.delete(name);\r\n          }\r\n        });\r\n      }\r\n      // delete browser cache and hard reload\r\n      window.location.reload(true);\r\n    };\r\n\r\n    return (\r\n      <React.Fragment>\r\n        {isLatestBuildDate ? <Component {...props} /> : null}\r\n      </React.Fragment>\r\n    );\r\n  }\r\n\r\n  return ClearCacheComponent;\r\n}\r\n\r\nexport default withClearCache;"]},"metadata":{},"sourceType":"module"}