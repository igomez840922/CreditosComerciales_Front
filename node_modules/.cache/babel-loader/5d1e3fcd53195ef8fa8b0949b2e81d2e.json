{"ast":null,"code":"import _createForOfIteratorHelper from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _regeneratorRuntime from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import{BackendServices,CoreServices}from\"../services\";var backendServices=new BackendServices();var coreServices=new CoreServices();var AutoSaveData=/*#__PURE__*/function(){function AutoSaveData(){_classCallCheck(this,AutoSaveData);}_createClass(AutoSaveData,[{key:\"saveInitialData\",value://salvamos deudas de un tramite\nfunction(){var _saveInitialData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(transactionId){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:this.saveDebts(transactionId);this.saveAccountMovements(transactionId);this.saveCorporateExhibition(transactionId);this.saveFacilities(transactionId);case 4:case\"end\":return _context.stop();}}},_callee,this);}));function saveInitialData(_x){return _saveInitialData.apply(this,arguments);}return saveInitialData;}()//salvamos exposicion por tramite\n},{key:\"saveCorporateExhibition\",value:function(){var _saveCorporateExhibition=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(transactionId){var dataResult,i,datoSent;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return backendServices.getExposicionCorporativaBD(transactionId);case 3:dataResult=_context2.sent;if(!(dataResult!==undefined&&dataResult!==null&&dataResult.length>0)){_context2.next=6;break;}return _context2.abrupt(\"return\");case 6:_context2.next=8;return coreServices.getCorporateExhibition(transactionId);case 8:dataResult=_context2.sent;i=0;case 10:if(!(i<dataResult.length)){_context2.next=17;break;}datoSent={\"transactId\":Number(transactionId),//\"accountNumber\": data.name,\n//\"t24ClientId\": data.customerNumberT24,\n\"description\":dataResult[i].name,\"approved\":dataResult[i].approved,\"currentBalance\":dataResult[i].balance,\"proposed\":dataResult[i].proposal,\"ltv\":0,\"difference\":dataResult[i].variation};_context2.next=14;return backendServices.saveExposicionCorporativaBD(datoSent);case 14:i++;_context2.next=10;break;case 17:_context2.next=21;break;case 19:_context2.prev=19;_context2.t0=_context2[\"catch\"](0);case 21:case\"end\":return _context2.stop();}}},_callee2,null,[[0,19]]);}));function saveCorporateExhibition(_x2){return _saveCorporateExhibition.apply(this,arguments);}return saveCorporateExhibition;}()//salvamos facilidades por tramite\n},{key:\"saveFacilities\",value:function(){var _saveFacilities=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(transactionId){var request,dataResult,i,_dataResult$i$facilit,_request$0$requestId,datoSent;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return backendServices.consultGeneralDataPropCred(transactionId);case 3:request=_context3.sent;console.log(request);_context3.next=7;return backendServices.consultarFacilidadesT24(request[0].requestId);case 7:dataResult=_context3.sent;if(!(dataResult!==undefined&&dataResult!==null&&dataResult.length>0)){_context3.next=10;break;}return _context3.abrupt(\"return\");case 10:_context3.next=12;return coreServices.getFacilitiesByTransaction(transactionId);case 12:dataResult=_context3.sent;i=0;case 14:if(!(i<dataResult.length)){_context3.next=21;break;}datoSent={\"facilityNumber\":dataResult[i].AcctId,\"cr\":dataResult[i].AcctId,\"amount\":dataResult[i].approvedAmount,\"debtor\":dataResult[i].debtorName,\"clientTypeId\":dataResult[i].debtorId,\"balance\":dataResult[i].actualBalance,\"purpose\":\"\",\"sublimits\":\"\",\"proposalRate\":0,\"noSubsidyRate\":0,\"effectiveRate\":0,\"feci\":false,\"termDays\":0,\"termDescription\":\"\",\"ltv\":0,\"finantialConditions\":\" \",\"environmentRiskCategory\":0,\"covenant\":\" \",\"environmentRiskOpinion\":\" \",\"finantialCovenant\":\" \",\"legalDocumentation\":\"  \",\"otherConditions\":\" \",\"creditRiskOpinion\":\" \",\"provision\":\" \",\"proposalTypeId\":\"\",\"proposalTypeName\":\"\",\"facilityTypeId\":(_dataResult$i$facilit=dataResult[i].facilityType)!==null&&_dataResult$i$facilit!==void 0?_dataResult$i$facilit:\"\",\"termType\":\"\",\"origin\":\"CORE\",\"applyEscrow\":false,\"facilityId\":0,\"requestId\":(_request$0$requestId=request[0].requestId)!==null&&_request$0$requestId!==void 0?_request$0$requestId:\"\",\"startingAmount\":0,\"term\":\"\"};_context3.next=18;return backendServices.newFacilityPropCred(datoSent);case 18:i++;_context3.next=14;break;case 21:_context3.next=25;break;case 23:_context3.prev=23;_context3.t0=_context3[\"catch\"](0);case 25:case\"end\":return _context3.stop();}}},_callee3,null,[[0,23]]);}));function saveFacilities(_x3){return _saveFacilities.apply(this,arguments);}return saveFacilities;}()//salvamos deudas a Corto y largo Plazo\n},{key:\"saveDebts\",value:function(){var _saveDebts=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(transactionId){var checkCP,checkLP,dataResult,_iterator,_step,short,dat,_iterator2,_step2,long,dat1;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;checkCP=false;checkLP=false;_context4.next=5;return backendServices.consultBankingRelationsDebtsCP(transactionId);case 5:dataResult=_context4.sent;if(dataResult!==undefined&&dataResult!==null&&dataResult.getBankingRelationCPDTOList.length>0){}else{checkCP=true;}_context4.next=9;return backendServices.consultBankRelationsDebtsLP(transactionId);case 9:dataResult=_context4.sent;if(dataResult!==undefined&&dataResult!==null&&dataResult.bankingRelationLPDTOList.length>0){}else{checkLP=true;}if(!(!checkCP&&!checkLP)){_context4.next=13;break;}return _context4.abrupt(\"return\");case 13:_context4.next=15;return coreServices.getAllTermDebtsByTransaction(transactionId);case 15:dataResult=_context4.sent;if(!checkCP){_context4.next=36;break;}_iterator=_createForOfIteratorHelper(dataResult.shortTermresult);_context4.prev=18;_iterator.s();case 20:if((_step=_iterator.n()).done){_context4.next=28;break;}short=_step.value;console.log(\"shortTermresult\",short);dat={\"facilityType\":short.facilityType,\"amount\":Number(short.approvedAmount.toFixed(2)),\"date\":short.startDate,\"expirationDate\":short.endDate,\"debitBalance1\":Number(short.balance.toFixed(2)),\"debitBalance2\":0,\"debitBalance3\":0,\"paymentHistory\":short.paymentHistory,\"rate\":0,\"fee\":0,\"bail\":0,\"fundDestiny\":\"\",status:true,\"bank\":short.bank,\"transactId\":Number(transactionId)};_context4.next=26;return backendServices.newBankingRelationsDebtsCP(dat);case 26:_context4.next=20;break;case 28:_context4.next=33;break;case 30:_context4.prev=30;_context4.t0=_context4[\"catch\"](18);_iterator.e(_context4.t0);case 33:_context4.prev=33;_iterator.f();return _context4.finish(33);case 36:if(!checkLP){_context4.next=55;break;}_iterator2=_createForOfIteratorHelper(dataResult.longTermresult);_context4.prev=38;_iterator2.s();case 40:if((_step2=_iterator2.n()).done){_context4.next=47;break;}long=_step2.value;dat1={\"transactId\":Number(transactionId),\"bank\":long.bank,\"facilityType\":long.facilityType,\"amount\":Number(long.approvedAmount.toFixed(2)),\"date\":long.startDate,\"expirationDate\":long.endDate,\"debitBalance1\":Number(long.balance.toFixed(2)),\"debitBalance2\":0,\"debitBalance3\":0,\"paymentHistory\":long.paymentHistory,\"rate\":0,\"fee\":0,\"bail\":\" \",\"fundDestiny\":\" \",status:true};_context4.next=45;return backendServices.newBankingRelationsDebtsLP(dat1);case 45:_context4.next=40;break;case 47:_context4.next=52;break;case 49:_context4.prev=49;_context4.t1=_context4[\"catch\"](38);_iterator2.e(_context4.t1);case 52:_context4.prev=52;_iterator2.f();return _context4.finish(52);case 55:_context4.next=60;break;case 57:_context4.prev=57;_context4.t2=_context4[\"catch\"](0);console.error(\"newBankingRelationsDebts\",_context4.t2);case 60:case\"end\":return _context4.stop();}}},_callee4,null,[[0,57],[18,30,33,36],[38,49,52,55]]);}));function saveDebts(_x4){return _saveDebts.apply(this,arguments);}return saveDebts;}()//salvamos facilidades por tramite\n},{key:\"saveAccountMovements\",value:function(){var _saveAccountMovements=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(transactionId){var dataResult,i,cuenta,j,k,jsonSet;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;_context5.next=3;return backendServices.consultMovementsBank(transactionId);case 3:dataResult=_context5.sent;if(!(dataResult!==undefined&&dataResult!==null&&(dataResult.bankBanesco.length>0||dataResult.bankOthersBank.length>0))){_context5.next=6;break;}return _context5.abrupt(\"return\");case 6:_context5.next=8;return coreServices.getAccountMovementsByTransaction(transactionId);case 8:dataResult=_context5.sent;i=0;case 10:if(!(i<dataResult.length)){_context5.next=29;break;}//aqui cargamos por cuentas\ncuenta=dataResult[i].AcctId;j=0;case 13:if(!(j<dataResult[i].dataByYear.length)){_context5.next=26;break;}console.log(\"data[i].dataByYear\",dataResult[i].dataByYear);k=0;case 16:if(!(k<dataResult[i].dataByYear[j].dataresult.length)){_context5.next=23;break;}jsonSet={\"trasactId\":Number(transactionId),\"year\":dataResult[i].dataByYear[j].dataresult[k].year,\"month\":dataResult[i].dataByYear[j].dataresult[k].month,\"deposits\":dataResult[i].dataByYear[j].dataresult[k].deposits,\"averageBalance\":dataResult[i].dataByYear[j].dataresult[k].amount,\"observations\":\"\",\"accountNumber\":cuenta,\"t24\":true};_context5.next=20;return backendServices.newMovementsAccountsIGR(jsonSet);case 20:k++;_context5.next=16;break;case 23:j++;_context5.next=13;break;case 26:i++;_context5.next=10;break;case 29:_context5.next=33;break;case 31:_context5.prev=31;_context5.t0=_context5[\"catch\"](0);case 33:case\"end\":return _context5.stop();}}},_callee5,null,[[0,31]]);}));function saveAccountMovements(_x5){return _saveAccountMovements.apply(this,arguments);}return saveAccountMovements;}()}]);return AutoSaveData;}();export{AutoSaveData as default};","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/helpers/AutoSaveData.js"],"names":["BackendServices","CoreServices","backendServices","coreServices","AutoSaveData","transactionId","saveDebts","saveAccountMovements","saveCorporateExhibition","saveFacilities","getExposicionCorporativaBD","dataResult","undefined","length","getCorporateExhibition","i","datoSent","Number","name","approved","balance","proposal","variation","saveExposicionCorporativaBD","consultGeneralDataPropCred","request","console","log","consultarFacilidadesT24","requestId","getFacilitiesByTransaction","AcctId","approvedAmount","debtorName","debtorId","actualBalance","facilityType","newFacilityPropCred","checkCP","checkLP","consultBankingRelationsDebtsCP","getBankingRelationCPDTOList","consultBankRelationsDebtsLP","bankingRelationLPDTOList","getAllTermDebtsByTransaction","shortTermresult","short","dat","toFixed","startDate","endDate","paymentHistory","status","bank","newBankingRelationsDebtsCP","longTermresult","long","dat1","newBankingRelationsDebtsLP","error","consultMovementsBank","bankBanesco","bankOthersBank","getAccountMovementsByTransaction","cuenta","j","dataByYear","k","dataresult","jsonSet","year","month","deposits","amount","newMovementsAccountsIGR"],"mappings":"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","sourcesContent":["\r\nimport { BackendServices, CoreServices } from \"../services\";\r\n\r\nconst backendServices = new BackendServices();\r\nconst coreServices = new CoreServices();\r\n\r\nexport default class AutoSaveData {\r\n\r\n\r\n  //salvamos deudas de un tramite\r\n  async saveInitialData(transactionId) {\r\n    this.saveDebts(transactionId);\r\n    this.saveAccountMovements(transactionId);\r\n    this.saveCorporateExhibition(transactionId);\r\n    this.saveFacilities(transactionId);\r\n  }\r\n\r\n  //salvamos exposicion por tramite\r\n  async saveCorporateExhibition(transactionId) {\r\n    try {\r\n\r\n      var dataResult = await backendServices.getExposicionCorporativaBD(transactionId);\r\n      if (dataResult !== undefined && dataResult !== null && dataResult.length > 0) {\r\n        return;\r\n      }\r\n\r\n      dataResult = await coreServices.getCorporateExhibition(transactionId)\r\n      for (let i = 0; i < dataResult.length; i++) {\r\n        let datoSent = {\r\n          \"transactId\": Number(transactionId),\r\n          //\"accountNumber\": data.name,\r\n          //\"t24ClientId\": data.customerNumberT24,\r\n          \"description\": dataResult[i].name,\r\n          \"approved\": dataResult[i].approved,\r\n          \"currentBalance\": dataResult[i].balance,\r\n          \"proposed\": dataResult[i].proposal,\r\n          \"ltv\": 0,\r\n          \"difference\": dataResult[i].variation,\r\n        }\r\n        await backendServices.saveExposicionCorporativaBD(datoSent)\r\n      }\r\n    }\r\n    catch (err) { }\r\n  }\r\n\r\n  //salvamos facilidades por tramite\r\n  async saveFacilities(transactionId) {\r\n    try {\r\n\r\n      var request = await backendServices.consultGeneralDataPropCred(transactionId);\r\n      console.log(request);\r\n      var dataResult = await backendServices.consultarFacilidadesT24(request[0].requestId);\r\n      if (dataResult !== undefined && dataResult !== null && dataResult.length > 0) {\r\n        return;\r\n      }\r\n\r\n      dataResult = await coreServices.getFacilitiesByTransaction(transactionId)\r\n      for (let i = 0; i < dataResult.length; i++) {\r\n        let datoSent = {\r\n          \"facilityNumber\": dataResult[i].AcctId,\r\n          \"cr\": dataResult[i].AcctId,\r\n          \"amount\": dataResult[i].approvedAmount,\r\n          \"debtor\": dataResult[i].debtorName,\r\n          \"clientTypeId\": dataResult[i].debtorId,\r\n          \"balance\": dataResult[i].actualBalance,\r\n          \"purpose\": \"\",\r\n          \"sublimits\": \"\",\r\n          \"proposalRate\": 0,\r\n          \"noSubsidyRate\": 0,\r\n          \"effectiveRate\": 0,\r\n          \"feci\": false,\r\n          \"termDays\": 0,\r\n          \"termDescription\": \"\",\r\n          \"ltv\": 0,\r\n          \"finantialConditions\": \" \",\r\n          \"environmentRiskCategory\": 0,\r\n          \"covenant\": \" \",\r\n          \"environmentRiskOpinion\": \" \",\r\n          \"finantialCovenant\": \" \",\r\n          \"legalDocumentation\": \"  \",\r\n          \"otherConditions\": \" \",\r\n          \"creditRiskOpinion\": \" \",\r\n          \"provision\": \" \",\r\n          \"proposalTypeId\": \"\",\r\n          \"proposalTypeName\": \"\",\r\n          \"facilityTypeId\": dataResult[i].facilityType ?? \"\",\r\n          \"termType\": \"\",\r\n          \"origin\": \"CORE\",\r\n          \"applyEscrow\": false,\r\n          \"facilityId\": 0,\r\n          \"requestId\": request[0].requestId ?? \"\",\r\n          \"startingAmount\": 0,\r\n          \"term\": \"\"\r\n        }\r\n        await backendServices.newFacilityPropCred(datoSent)\r\n      }\r\n    }\r\n    catch (err) { }\r\n  }\r\n\r\n  //salvamos deudas a Corto y largo Plazo\r\n  async saveDebts(transactionId) {\r\n    try {\r\n\r\n      var checkCP = false;\r\n      var checkLP = false;\r\n\r\n      var dataResult = await backendServices.consultBankingRelationsDebtsCP(transactionId);\r\n      if (dataResult !== undefined && dataResult !== null && dataResult.getBankingRelationCPDTOList.length > 0) { }\r\n      else {\r\n        checkCP = true;\r\n      }\r\n      dataResult = await backendServices.consultBankRelationsDebtsLP(transactionId);\r\n      if (dataResult !== undefined && dataResult !== null && dataResult.bankingRelationLPDTOList.length > 0) { }\r\n      else {\r\n        checkLP = true;\r\n      }\r\n\r\n      if (!checkCP && !checkLP) {\r\n        return;\r\n      }\r\n\r\n      dataResult = await coreServices.getAllTermDebtsByTransaction(transactionId);\r\n      \r\n      if (checkCP) {\r\n        for (var short of dataResult.shortTermresult) {\r\n          console.log(\"shortTermresult\",short);\r\n          var dat = {\r\n            \"facilityType\": short.facilityType,\r\n            \"amount\": Number(short.approvedAmount.toFixed(2)),\r\n            \"date\": short.startDate,\r\n            \"expirationDate\": short.endDate,\r\n            \"debitBalance1\": Number(short.balance.toFixed(2)),\r\n            \"debitBalance2\": 0,\r\n            \"debitBalance3\": 0,\r\n            \"paymentHistory\": short.paymentHistory,\r\n            \"rate\": 0,\r\n            \"fee\": 0,\r\n            \"bail\": 0,\r\n            \"fundDestiny\": \"\",\r\n            status: true,\r\n            \"bank\": short.bank,\r\n            \"transactId\": Number(transactionId)\r\n          }\r\n          await backendServices.newBankingRelationsDebtsCP(dat)\r\n        }\r\n      }\r\n\r\n      if (checkLP) {\r\n        for (var long of dataResult.longTermresult) {\r\n          var dat1 = {\r\n            \"transactId\": Number(transactionId),\r\n            \"bank\": long.bank,\r\n            \"facilityType\": long.facilityType,\r\n            \"amount\": Number(long.approvedAmount.toFixed(2)),\r\n            \"date\": long.startDate,\r\n            \"expirationDate\": long.endDate,\r\n            \"debitBalance1\": Number(long.balance.toFixed(2)),\r\n            \"debitBalance2\": 0,\r\n            \"debitBalance3\": 0,\r\n            \"paymentHistory\": long.paymentHistory,\r\n            \"rate\": 0,\r\n            \"fee\": 0,\r\n            \"bail\": \" \",\r\n            \"fundDestiny\": \" \",\r\n            status: true,\r\n          }\r\n          await backendServices.newBankingRelationsDebtsLP(dat1)\r\n        }\r\n      }\r\n\r\n    }\r\n    catch (err) { console.error(\"newBankingRelationsDebts\",err)}\r\n  }\r\n\r\n  //salvamos facilidades por tramite\r\n  async saveAccountMovements(transactionId) {\r\n    try {\r\n\r\n      var dataResult = await backendServices.consultMovementsBank(transactionId);\r\n      \r\n      if (dataResult !== undefined && dataResult !== null && (dataResult.bankBanesco.length > 0 || dataResult.bankOthersBank.length > 0)) {\r\n        return;\r\n      }\r\n\r\n      dataResult = await coreServices.getAccountMovementsByTransaction(transactionId)\r\n      for (let i = 0; i < dataResult.length; i++) {\r\n        //aqui cargamos por cuentas\r\n        let cuenta = dataResult[i].AcctId;\r\n        for (let j = 0; j < dataResult[i].dataByYear.length; j++) {\r\n          console.log(\"data[i].dataByYear\", dataResult[i].dataByYear);\r\n          for (let k = 0; k < dataResult[i].dataByYear[j].dataresult.length; k++) {\r\n            let jsonSet = {\r\n              \"trasactId\": Number(transactionId),\r\n              \"year\": dataResult[i].dataByYear[j].dataresult[k].year,\r\n              \"month\": dataResult[i].dataByYear[j].dataresult[k].month,\r\n              \"deposits\": dataResult[i].dataByYear[j].dataresult[k].deposits,\r\n              \"averageBalance\": dataResult[i].dataByYear[j].dataresult[k].amount,\r\n              \"observations\": \"\",\r\n              \"accountNumber\": cuenta,\r\n              \"t24\": true\r\n            }\r\n            await backendServices.newMovementsAccountsIGR(jsonSet);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    catch (err) { }\r\n  }\r\n\r\n}"]},"metadata":{},"sourceType":"module"}