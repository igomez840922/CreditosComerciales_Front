{"ast":null,"code":"import _slicedToArray from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useContext,useRef,useEffect}from\"react\";import{formatCurrency,translationHelper}from'../../../helpers';import{Table}from\"reactstrap\";import HeaderSections from'../../Common/HeaderSections';import{BackendServices}from'../../../services';import{useLocation,useHistory}from'react-router-dom';import*as url from\"../../../helpers/url_helper\";import Currency from\"../../../helpers/currency\";import{useTranslation}from\"react-i18next\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var FacilityDetails=function FacilityDetails(props){console.log(props);// const t = translationHelper('financial_report');\nvar _useState=useState(null),_useState2=_slicedToArray(_useState,2),dataRows=_useState2[0],setdataRows=_useState2[1];var api=new BackendServices();var location=useLocation();var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),locationData=_useState4[0],setLocationData=_useState4[1];var history=useHistory();var currencyData=new Currency();var _useTranslation=useTranslation(),t=_useTranslation.t,i18n=_useTranslation.i18n;React.useEffect(function(){var dataSession;if(location.data!==null&&location.data!==undefined){if(location.data.transactionId===undefined||location.data.transactionId.length<=0){//location.data.transactionId = 0;\n//checkAndCreateProcedure(location.data);\nhistory.push(url.URL_DASHBOARD);}else{sessionStorage.setItem('locationData',JSON.stringify(location.data));setLocationData(location.data);dataSession=location.data;}}else{//chequeamos si tenemos guardado en session\nvar result=sessionStorage.getItem('locationData');if(result!==undefined&&result!==null){result=JSON.parse(result);setLocationData(result);dataSession=result;}}// Read Api Service data\ncargarFacilidades(dataSession);},[]);function cargarFacilidades(dataSession){api.consultarDeudores(dataSession.transactionId).then(function(data2){if(data2!==null&&data2!==undefined){var jsonDeudores=[];for(var i=0;i<data2.length;i++){jsonDeudores.push({label:data2[i][\"name\"]+\" \"+data2[i][\"name2\"]+\" \"+data2[i][\"lastName\"]+\" \"+data2[i][\"lastName2\"],value:data2[i][\"personId\"]});}api.consultGeneralDataPropCred(dataSession.transactionId).then(function(data){if(data!==undefined){var datosgenerales=data.length==0?undefined:data[0].requestId;if(datosgenerales===undefined||datosgenerales==null){datosgenerales=data[data.length-1];return;}api.retrieveProposalType().then(function(propuesta){api.retrieveFacilityType().then(function(facilidad){api.consultarFacilidades(datosgenerales).then(function(resp){var acu=0;if((resp===null||resp===void 0?void 0:resp.filter(function(data){return data.debtor!=\"  \";}).length)>0){// initializeData(dataSession);\nsetdataRows(resp.map(function(data,index){var _jsonDeudores$find,_facilidad$find,_propuesta$find,_data$amount,_data$proposalRate;acu++;return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{\"data-label\":t(\"Facility\"),children:acu}),/*#__PURE__*/_jsx(\"td\",{\"data-label\":t(\"Debtor\"),children:(_jsonDeudores$find=jsonDeudores.find(function(x){return x.value===Number(data.debtor);}))===null||_jsonDeudores$find===void 0?void 0:_jsonDeudores$find.label}),/*#__PURE__*/_jsx(\"td\",{\"data-label\":t(\"Facility Type\"),children:(_facilidad$find=facilidad.find(function(x){return x.id===data.facilityTypeId;}))===null||_facilidad$find===void 0?void 0:_facilidad$find.description}),/*#__PURE__*/_jsx(\"td\",{\"data-label\":t(\"Proposal\"),children:(_propuesta$find=propuesta.find(function(x){return x.id===data.proposalTypeId;}))===null||_propuesta$find===void 0?void 0:_propuesta$find.description}),/*#__PURE__*/_jsx(\"td\",{\"data-label\":t(\"Approved Risk\"),children:currencyData.format((_data$amount=data.amount)!==null&&_data$amount!==void 0?_data$amount:0)}),/*#__PURE__*/_jsx(\"td\",{\"data-label\":t(\"Amount\")+\" \"+t(\"Rate\"),children:currencyData.format((_data$proposalRate=data.proposalRate)!==null&&_data$proposalRate!==void 0?_data$proposalRate:0)})]},acu);}));}else{setdataRows(/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"7\",style:{textAlign:'center'}})},1));}});});});}else{}});}}).catch(function(error){console.error('api error: ',error);});}return/*#__PURE__*/_jsxs(\"div\",{className:\"table-responsive\",children:[/*#__PURE__*/_jsx(HeaderSections,{title:\"Facility details\",t:t}),/*#__PURE__*/_jsx(\"div\",{className:\"table-responsive styled-table-div\",children:/*#__PURE__*/_jsxs(Table,{className:\"table table-striped table-hover styled-table table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:t(\"Facility\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"Debtor\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"Facility Type\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"Proposal\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"Approved Risk\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"Amount\")+\" \"+t(\"Rate\")})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:dataRows})]})})]});};export default FacilityDetails;","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/components/InformeFinanciero/background/FacilityDetails.js"],"names":["React","useState","useContext","useRef","useEffect","formatCurrency","translationHelper","Table","HeaderSections","BackendServices","useLocation","useHistory","url","Currency","useTranslation","FacilityDetails","props","console","log","dataRows","setdataRows","api","location","locationData","setLocationData","history","currencyData","t","i18n","dataSession","data","undefined","transactionId","length","push","URL_DASHBOARD","sessionStorage","setItem","JSON","stringify","result","getItem","parse","cargarFacilidades","consultarDeudores","then","data2","jsonDeudores","i","label","value","consultGeneralDataPropCred","datosgenerales","requestId","retrieveProposalType","propuesta","retrieveFacilityType","facilidad","consultarFacilidades","resp","acu","filter","debtor","map","index","find","x","Number","id","facilityTypeId","description","proposalTypeId","format","amount","proposalRate","textAlign","catch","error"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useRef, useEffect } from \"react\"\r\nimport PropTypes from 'prop-types';\r\nimport { formatCurrency, translationHelper } from '../../../helpers';\r\n\r\nimport {\r\n  Table,\r\n} from \"reactstrap\"\r\nimport HeaderSections from '../../Common/HeaderSections';\r\nimport { BackendServices } from '../../../services';\r\nimport { useLocation, useHistory } from 'react-router-dom';\r\nimport * as url from \"../../../helpers/url_helper\"\r\nimport Currency from \"../../../helpers/currency\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\n\r\nconst FacilityDetails = (props) => {\r\n\r\n  console.log(props);\r\n  // const t = translationHelper('financial_report');\r\n\r\n  const [dataRows, setdataRows] = useState(null);\r\n\r\n  const api = new BackendServices();\r\n  const location = useLocation()\r\n  const [locationData, setLocationData] = useState(null);\r\n  const history = useHistory();\r\n  const currencyData = new Currency();\r\n  const { t, i18n } = useTranslation();\r\n\r\n  React.useEffect(() => {\r\n\r\n    let dataSession;\r\n    if (location.data !== null && location.data !== undefined) {\r\n      if (location.data.transactionId === undefined || location.data.transactionId.length <= 0) {\r\n        //location.data.transactionId = 0;\r\n        //checkAndCreateProcedure(location.data);\r\n        history.push(url.URL_DASHBOARD);\r\n      }\r\n      else {\r\n        sessionStorage.setItem('locationData', JSON.stringify(location.data));\r\n        setLocationData(location.data);\r\n        dataSession = location.data;\r\n      }\r\n    }\r\n    else {\r\n      //chequeamos si tenemos guardado en session\r\n      var result = sessionStorage.getItem('locationData');\r\n      if (result !== undefined && result !== null) {\r\n        result = JSON.parse(result);\r\n        setLocationData(result);\r\n        dataSession = result;\r\n      }\r\n    }\r\n\r\n    // Read Api Service data\r\n    cargarFacilidades(dataSession)\r\n  }, []);\r\n\r\n\r\n  function cargarFacilidades(dataSession) {\r\n    api.consultarDeudores(dataSession.transactionId)\r\n      .then((data2) => {\r\n        if (data2 !== null && data2 !== undefined) {\r\n          let jsonDeudores = [];\r\n          for (let i = 0; i < data2.length; i++) {\r\n            jsonDeudores.push({ label: data2[i][\"name\"] + \" \" + data2[i][\"name2\"] + \" \" + data2[i][\"lastName\"] + \" \" + data2[i][\"lastName2\"], value: data2[i][\"personId\"] })\r\n          }\r\n          api.consultGeneralDataPropCred(dataSession.transactionId).then((data) => {\r\n            if (data !== undefined) {\r\n              var datosgenerales = data.length == 0 ? undefined : data[0].requestId;\r\n              if (datosgenerales === undefined || datosgenerales == null) {\r\n                datosgenerales = data[data.length - 1];\r\n                return;\r\n              }\r\n              api.retrieveProposalType().then((propuesta) => {\r\n                api.retrieveFacilityType().then((facilidad) => {\r\n                  api.consultarFacilidades(datosgenerales).then(resp => {\r\n                    let acu = 0;\r\n                    if (resp?.filter(data => data.debtor != \"  \").length > 0) {\r\n                      // initializeData(dataSession);\r\n                      setdataRows(resp.map((data, index) => {\r\n                        acu++;\r\n                        return (\r\n                          <tr key={acu}>\r\n                            <td data-label={t(\"Facility\")}>{acu}</td>\r\n                            {/* <td>{data.debtor}</td> */}\r\n                            <td data-label={t(\"Debtor\")}>{jsonDeudores.find(x => x.value === Number(data.debtor))?.label}</td>\r\n                            <td data-label={t(\"Facility Type\")}>{facilidad.find(x => x.id === data.facilityTypeId)?.description}</td>\r\n                            <td data-label={t(\"Proposal\")}>{propuesta.find(x => x.id === data.proposalTypeId)?.description}</td>\r\n                            <td data-label={t(\"Approved Risk\")}>{currencyData.format(data.amount ?? 0)}</td>\r\n                            <td data-label={t(\"Amount\") + \" \" + t(\"Rate\")}>{currencyData.format(data.proposalRate ?? 0)}</td>\r\n                          </tr>)\r\n                      }\r\n                      ));\r\n                    } else {\r\n                      setdataRows(\r\n                        <tr key={1}>\r\n                          <td colSpan=\"7\" style={{ textAlign: 'center' }}></td>\r\n                        </tr>);\r\n                    }\r\n                  });\r\n                })\r\n              })\r\n            }\r\n            else {\r\n            }\r\n          });\r\n\r\n        }\r\n\r\n      })\r\n      .catch((error) => {\r\n        console.error('api error: ', error);\r\n      });\r\n  }\r\n\r\n  return (\r\n    <div className=\"table-responsive\">\r\n      {/* <h5>{t(\"FacilityDetails.Title\")}</h5> */}\r\n      <HeaderSections title=\"Facility details\" t={t}></HeaderSections>\r\n\r\n      <div className=\"table-responsive styled-table-div\">\r\n        <Table className=\"table table-striped table-hover styled-table table\" >\r\n          <thead>\r\n            <tr>\r\n              <th>{t(\"Facility\")}</th>\r\n              <th>{t(\"Debtor\")}</th>\r\n              <th>{t(\"Facility Type\")}</th>\r\n              <th>{t(\"Proposal\")}</th>\r\n              <th>{t(\"Approved Risk\")}</th>\r\n              <th>{t(\"Amount\") + \" \" + t(\"Rate\")}</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {dataRows}\r\n          </tbody>\r\n        </Table>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n};\r\n\r\n\r\nexport default FacilityDetails;\r\n"]},"metadata":{},"sourceType":"module"}