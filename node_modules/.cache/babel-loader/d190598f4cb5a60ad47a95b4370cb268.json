{"ast":null,"code":"import _objectSpread from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import{translationHelpers}from'../../helpers/translation-helper';import{Row,Col,Card,CardBody,Button,Label,Input,CardHeader,CardTitle,InputGroup,Table,CardFooter}from\"reactstrap\";import AvField from'availity-reactstrap-validation/lib/AvField';import AvForm from'availity-reactstrap-validation/lib/AvForm';import{Link}from\"react-router-dom\";import ModalPolicy from\"../Attachments/ModalPolicy\";import SweetAlert from\"react-bootstrap-sweetalert\";import{BackendServices,CoreServices,BpmServices}from\"../../services\";import{useLocation,useHistory}from'react-router-dom';import LoadingOverlay from\"react-loading-overlay\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var CreditPolicyReview=function CreditPolicyReview(props){React.useEffect(function(){// Read Api Service data\nLoadData();},[]);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),displayModal=_useState2[0],setDisplayModal=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),actions=_useState4[0],setActions=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),SusscessDialog=_useState6[0],setSusscessDialog=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),dataRows=_useState8[0],setdataRows=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),DataSend=_useState10[0],setDataSend=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),confirm_alert=_useState12[0],setconfirm_alert=_useState12[1];var _useState13=useState(props.data),_useState14=_slicedToArray(_useState13,2),dataLocation=_useState14[0],setData=_useState14[1];var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),dataDelete=_useState16[0],setDataDelete=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),error_dlg=_useState18[0],seterror_dlg=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),isActiveLoading=_useState20[0],setIsActiveLoading=_useState20[1];var _translationHelpers=translationHelpers('commercial_credit','common'),_translationHelpers2=_slicedToArray(_translationHelpers,2),t=_translationHelpers2[0],c=_translationHelpers2[1];var location=useLocation();if(!props.policies){return null;}function LoadData(){var backendServices=new BackendServices();backendServices.consultarPoliticaCredito(dataLocation.transactionId).then(function(resp){setdataRows(resp.map(function(policy,index){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:policy.parameter}),/*#__PURE__*/_jsx(\"td\",{children:policy.condition}),/*#__PURE__*/_jsx(\"td\",{children:policy.comply?'Si':'No'}),/*#__PURE__*/_jsx(\"td\",{children:policy.observations}),/*#__PURE__*/_jsxs(\"td\",{style:{textAlign:\"right\"},children:[/*#__PURE__*/_jsx(Button,{type:\"button\",color:\"link\",onClick:function onClick(resp){editarSowActual(policy);},className:\"btn btn-link\",children:/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-border-color mdi-24px\"})}),/*#__PURE__*/_jsx(Button,{type:\"button\",color:\"link\",onClick:function onClick(resp){eliminarSowActual(policy);},className:\"btn btn-link\",children:/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-trash-can-outline mdi-24px\"})})]})]},'row-'+policy.id+'-'+index);}));});}// setdataRows(props.policies.map((policy) => {\n//   return policy.conditions.map((condition, index) => (\n//     <tr key={'row-' + policy.id + '-' + index}>\n//       <th>{index === 0 ? policy.parameter : ''}</th>\n//       <td>{condition.title}</td>\n//       <td>\n//         <AvField\n//           className=\"form-control\"\n//           name={\"comply[\" + index + \"]\"}\n//           type=\"select\"\n//           id={\"comply-\" + index}\n//           value=\"N/A\">\n//           <option>{c(\"Yes\")}</option>\n//           <option>{c(\"No\")}</option>\n//           <option>{c(\"N/A\")}</option>\n//         </AvField>\n//       </td>\n//       <td>{condition.observations[0]}</td>\n//     </tr>\n//   )\n//   )\n// }\n// ));\nfunction toggleModal(){setDisplayModal(!displayModal);}function handleSubmit(event,errors,values){event.preventDefault();if(errors.length>0){return;}// props.onSubmit(values);\n}function DataUpdate(values){setIsActiveLoading(true);var datos=_objectSpread(_objectSpread({},values),{},{transactId:dataLocation.transactionId});var backendServices=new BackendServices();backendServices.actualizarPoliticaCredito(datos).then(function(resp){if(resp.statusCode==\"200\"){setSusscessDialog(true);LoadData();}setIsActiveLoading(false);});}function DataInsert(values){setIsActiveLoading(true);var datos=_objectSpread(_objectSpread({},values),{},{transactId:+dataLocation.transactionId,debtorId:props.debtorId});var backendServices=new BackendServices();backendServices.nuevoPoliticaCredito(datos).then(function(resp){if(resp.statusCode==\"200\"){setSusscessDialog(true);LoadData();}setIsActiveLoading(false);});}function editarSowActual(data){toggleModal();setActions('edit');setDataSend(data);}function eliminarSowActual(data){setDataDelete(data);setconfirm_alert(true);}function InsertShowCurrent(){setActions('new');setDataSend(null);}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex flex-row justify-content-between\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"card-title\",children:t(\"Credit Policy Review\")}),/*#__PURE__*/_jsxs(Link,{to:\"#\",className:\"float-end\",onClick:function onClick(){toggleModal();InsertShowCurrent();},children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-plus-box-multiple-outline mdi-24px\"}),t(\"\")]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"card-title-desc\"}),/*#__PURE__*/_jsx(AvForm,{id:\"frmSearch\",className:\"needs-validation\",onSubmit:handleSubmit,children:/*#__PURE__*/_jsx(LoadingOverlay,{active:isActiveLoading,spinner:true,text:t(\"WaitingPlease\"),children:/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{lg:\"12\",children:/*#__PURE__*/_jsx(\"div\",{className:\"table-responsive\",children:/*#__PURE__*/_jsxs(Table,{className:\"table mb-0\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"table-light\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:t(\"Parameters\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"Conditions\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"Comply\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"Observations\")}),/*#__PURE__*/_jsx(\"th\",{})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:dataRows})]})})})})})}),displayModal&&/*#__PURE__*/_jsx(ModalPolicy,{isOpen:displayModal,toggle:toggleModal,DataUpdate:DataUpdate,DataInsert:DataInsert,actions:actions,DataSend:DataSend}),SusscessDialog?/*#__PURE__*/_jsx(SweetAlert,{success:true,title:t(\"SuccessDialog\"),onConfirm:function onConfirm(){setSusscessDialog(false);LoadData();},children:t(\"SuccessSaveMessage\")}):null,confirm_alert?/*#__PURE__*/_jsx(SweetAlert,{title:t(\"Areyousure\"),warning:true,showCancel:true,confirmButtonText:t(\"Yesdeleteit\"),confirmBtnBsStyle:\"success\",cancelBtnBsStyle:\"danger\",onConfirm:function onConfirm(){setIsActiveLoading(true);var backendServices=new BackendServices();backendServices.eliminarPoliticaCredit(dataLocation.transactionId,dataDelete.debtorId,dataDelete.itemId).then(function(resp){setIsActiveLoading(false);if(resp.statusCode==\"500\"){setconfirm_alert(false);seterror_dlg(true);}else{setconfirm_alert(false);setSusscessDialog(true);}}).catch(function(error){setconfirm_alert(false);seterror_dlg(true);});},onCancel:function onCancel(){return setconfirm_alert(false);},children:t(\"Youwontbeabletorevertthis\")}):null]});};export default CreditPolicyReview;","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/components/InformeFinanciero/CreditPolicyReview.js"],"names":["React","useEffect","useState","translationHelpers","Row","Col","Card","CardBody","Button","Label","Input","CardHeader","CardTitle","InputGroup","Table","CardFooter","AvField","AvForm","Link","ModalPolicy","SweetAlert","BackendServices","CoreServices","BpmServices","useLocation","useHistory","LoadingOverlay","CreditPolicyReview","props","LoadData","displayModal","setDisplayModal","actions","setActions","SusscessDialog","setSusscessDialog","dataRows","setdataRows","DataSend","setDataSend","confirm_alert","setconfirm_alert","data","dataLocation","setData","dataDelete","setDataDelete","error_dlg","seterror_dlg","isActiveLoading","setIsActiveLoading","t","c","location","policies","backendServices","consultarPoliticaCredito","transactionId","then","resp","map","policy","index","parameter","condition","comply","observations","textAlign","editarSowActual","eliminarSowActual","id","toggleModal","handleSubmit","event","errors","values","preventDefault","length","DataUpdate","datos","transactId","actualizarPoliticaCredito","statusCode","DataInsert","debtorId","nuevoPoliticaCredito","InsertShowCurrent","eliminarPoliticaCredit","itemId","catch","error"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\"\r\n\r\nimport PropTypes from 'prop-types';\r\nimport { translationHelpers } from '../../helpers/translation-helper';\r\n\r\nimport {\r\n  Row,\r\n  Col,\r\n  Card,\r\n  CardBody,\r\n  Button,\r\n  Label,\r\n  Input,\r\n  CardHeader,\r\n  CardTitle,\r\n  InputGroup,\r\n  Table,\r\n  CardFooter\r\n} from \"reactstrap\"\r\n\r\nimport AvField from 'availity-reactstrap-validation/lib/AvField';\r\nimport AvForm from 'availity-reactstrap-validation/lib/AvForm';\r\nimport { Link } from \"react-router-dom\";\r\nimport ModalPolicy from \"../Attachments/ModalPolicy\";\r\nimport SweetAlert from \"react-bootstrap-sweetalert\"\r\nimport { BackendServices, CoreServices, BpmServices, } from \"../../services\";\r\nimport { useLocation, useHistory } from 'react-router-dom'\r\nimport LoadingOverlay from \"react-loading-overlay\";\r\n\r\n\r\nconst CreditPolicyReview = (props) => {\r\n\r\n  React.useEffect(() => {\r\n    // Read Api Service data\r\n    LoadData();\r\n  }, []);\r\n\r\n\r\n  const [displayModal, setDisplayModal] = useState(false);\r\n  const [actions, setActions] = useState('');\r\n  const [SusscessDialog, setSusscessDialog] = useState(false);\r\n  const [dataRows, setdataRows] = useState(null);\r\n  const [DataSend, setDataSend] = useState(null);\r\n  const [confirm_alert, setconfirm_alert] = useState(false)\r\n  const [dataLocation, setData] = useState(props.data);\r\n  const [dataDelete, setDataDelete] = useState([]);\r\n  const [error_dlg, seterror_dlg] = useState(false);\r\n  const [isActiveLoading, setIsActiveLoading] = useState(false);\r\n\r\n  const [t, c] = translationHelpers('commercial_credit', 'common');\r\n  const location = useLocation()\r\n\r\n  if (!props.policies) {\r\n    return null;\r\n  }\r\n\r\n  function LoadData() {\r\n    const backendServices = new BackendServices();\r\n    backendServices.consultarPoliticaCredito(dataLocation.transactionId).then(resp => {\r\n      setdataRows(resp.map((policy, index) => {\r\n        return (\r\n          <tr key={'row-' + policy.id + '-' + index}>\r\n            <th>{policy.parameter}</th>\r\n            <td>{policy.condition}</td>\r\n            <td>\r\n              {policy.comply ? 'Si' : 'No'}\r\n            </td>\r\n            <td>{policy.observations}</td>\r\n            <td style={{ textAlign: \"right\" }}>\r\n              <Button type=\"button\" color=\"link\" onClick={(resp) => { editarSowActual(policy) }} className=\"btn btn-link\" ><i className=\"mdi mdi-border-color mdi-24px\"></i></Button>\r\n              <Button type=\"button\" color=\"link\" onClick={(resp) => { eliminarSowActual(policy) }} className=\"btn btn-link\" ><i className=\"mdi mdi-trash-can-outline mdi-24px\"></i></Button>\r\n            </td>\r\n          </tr>\r\n\r\n        )\r\n      }\r\n      ));\r\n    });\r\n\r\n  }\r\n\r\n  // setdataRows(props.policies.map((policy) => {\r\n  //   return policy.conditions.map((condition, index) => (\r\n  //     <tr key={'row-' + policy.id + '-' + index}>\r\n  //       <th>{index === 0 ? policy.parameter : ''}</th>\r\n  //       <td>{condition.title}</td>\r\n  //       <td>\r\n  //         <AvField\r\n  //           className=\"form-control\"\r\n  //           name={\"comply[\" + index + \"]\"}\r\n  //           type=\"select\"\r\n  //           id={\"comply-\" + index}\r\n  //           value=\"N/A\">\r\n  //           <option>{c(\"Yes\")}</option>\r\n  //           <option>{c(\"No\")}</option>\r\n  //           <option>{c(\"N/A\")}</option>\r\n  //         </AvField>\r\n  //       </td>\r\n  //       <td>{condition.observations[0]}</td>\r\n  //     </tr>\r\n  //   )\r\n  //   )\r\n  // }\r\n  // ));\r\n\r\n  function toggleModal() {\r\n    setDisplayModal(!displayModal);\r\n  }\r\n\r\n  function handleSubmit(event, errors, values) {\r\n    event.preventDefault();\r\n    if (errors.length > 0) {\r\n      return;\r\n    }\r\n    // props.onSubmit(values);\r\n  }\r\n\r\n  function DataUpdate(values) {\r\n    setIsActiveLoading(true);\r\n    let datos = { ...values, transactId: dataLocation.transactionId };\r\n    const backendServices = new BackendServices();\r\n\r\n    backendServices.actualizarPoliticaCredito(datos).then(resp => {\r\n      if (resp.statusCode == \"200\") {\r\n        setSusscessDialog(true);\r\n        LoadData();\r\n      }\r\n      setIsActiveLoading(false);\r\n    });\r\n  }\r\n\r\n  function DataInsert(values) {\r\n    setIsActiveLoading(true);\r\n    let datos = { ...values, transactId: +dataLocation.transactionId, debtorId: props.debtorId };\r\n    const backendServices = new BackendServices();\r\n\r\n    backendServices.nuevoPoliticaCredito(datos).then(resp => {\r\n      if (resp.statusCode == \"200\") {\r\n        setSusscessDialog(true);\r\n        LoadData();\r\n      }\r\n      setIsActiveLoading(false);\r\n    });\r\n  }\r\n\r\n  function editarSowActual(data) {\r\n    toggleModal();\r\n    setActions('edit');\r\n    setDataSend(data);\r\n  }\r\n\r\n  function eliminarSowActual(data) {\r\n    setDataDelete(data)\r\n    setconfirm_alert(true);\r\n  }\r\n\r\n  function InsertShowCurrent() {\r\n    setActions('new');\r\n    setDataSend(null);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {/* <Card> */}\r\n      {/* <CardBody> */}\r\n      <div className=\"d-flex flex-row justify-content-between\">\r\n        <h4 className=\"card-title\">{t(\"Credit Policy Review\")}</h4>\r\n        <Link to=\"#\" className=\"float-end\" onClick={() => { toggleModal(); InsertShowCurrent() }}>\r\n          <i className=\"mdi mdi-plus-box-multiple-outline mdi-24px\"></i>{t(\"\")}\r\n        </Link>\r\n      </div>\r\n      <p className=\"card-title-desc\"></p>\r\n      <AvForm id=\"frmSearch\" className=\"needs-validation\" onSubmit={handleSubmit}>\r\n        <LoadingOverlay active={isActiveLoading} spinner text={t(\"WaitingPlease\")}>\r\n          <Row>\r\n            <Col lg=\"12\">\r\n              <div className=\"table-responsive\">\r\n                <Table className=\"table mb-0\">\r\n                  <thead className=\"table-light\">\r\n                    <tr>\r\n                      <th>{t(\"Parameters\")}</th>\r\n                      <th>{t(\"Conditions\")}</th>\r\n                      <th>{t(\"Comply\")}</th>\r\n                      <th>{t(\"Observations\")}</th>\r\n                      <th></th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    {dataRows}\r\n                  </tbody>\r\n                </Table>\r\n              </div>\r\n            </Col>\r\n          </Row>\r\n        </LoadingOverlay>\r\n      </AvForm>\r\n      {/* </CardBody> */}\r\n      {displayModal &&\r\n        <ModalPolicy\r\n          isOpen={displayModal}\r\n          toggle={toggleModal}\r\n          DataUpdate={DataUpdate}\r\n          DataInsert={DataInsert}\r\n          actions={actions}\r\n          DataSend={DataSend}\r\n        />}\r\n\r\n      {\r\n        SusscessDialog ? (\r\n          <SweetAlert\r\n            success\r\n            title={t(\"SuccessDialog\")}\r\n            onConfirm={() => {\r\n              setSusscessDialog(false)\r\n              LoadData();\r\n            }}\r\n          >\r\n            {t(\"SuccessSaveMessage\")}\r\n          </SweetAlert>\r\n        ) : null\r\n      }\r\n\r\n      {\r\n        confirm_alert ? (\r\n          <SweetAlert\r\n            title={t(\"Areyousure\")}\r\n            warning\r\n            showCancel\r\n            confirmButtonText={t(\"Yesdeleteit\")}\r\n            confirmBtnBsStyle=\"success\"\r\n            cancelBtnBsStyle=\"danger\"\r\n            onConfirm={() => {\r\n              setIsActiveLoading(true);\r\n              const backendServices = new BackendServices();\r\n              backendServices.eliminarPoliticaCredit(dataLocation.transactionId, dataDelete.debtorId, dataDelete.itemId).then(resp => {\r\n                setIsActiveLoading(false);\r\n                if (resp.statusCode == \"500\") {\r\n                  setconfirm_alert(false)\r\n                  seterror_dlg(true)\r\n                } else {\r\n                  setconfirm_alert(false)\r\n                  setSusscessDialog(true)\r\n                }\r\n              }).catch(error => {\r\n                setconfirm_alert(false)\r\n                seterror_dlg(true)\r\n              })\r\n            }}\r\n            onCancel={() => setconfirm_alert(false)}\r\n          >\r\n            {t(\"Youwontbeabletorevertthis\")}\r\n          </SweetAlert>\r\n        ) : null\r\n      }\r\n      {/* </Card> */}\r\n    </>\r\n  );\r\n};\r\n\r\nCreditPolicyReview.propTypes = {\r\n  policies: PropTypes.array\r\n};\r\n\r\nexport default CreditPolicyReview;\r\n"]},"metadata":{},"sourceType":"module"}