{"ast":null,"code":"import _regeneratorRuntime from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useRef}from'react';import{useTranslation}from'react-i18next';import{useLocation,useHistory}from'react-router-dom';import moment from\"moment\";import{Row,Col,Card,CardBody,Button,Label,Table,Pagination,PaginationItem,PaginationLink,CardFooter,Modal}from\"reactstrap\";import{AvForm,AvField}from\"availity-reactstrap-validation\";import{Link}from\"react-router-dom\";import DocumentModel from\"../../models/Core/DocumentModel\";import DocumentoAnexoModel from\"../../models/Backend/DocumentoAnexoModel\";import functionshelper from\"../../helpers/functions_helper\";import LoadingOverlay from'react-loading-overlay';import{CoreServices,BackendServices}from'../../services';import Alert from'react-bootstrap/Alert';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var AttachmentFileCore=function AttachmentFileCore(props){var _useTranslation=useTranslation(),t=_useTranslation.t,i18n=_useTranslation.i18n;var attachmentFileInputModel=props.attachmentFileInputModel;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showModelAttachment=_useState2[0],setShowModelAttachment=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),attachments=_useState4[0],setAttachments=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isActiveLoading=_useState6[0],setIsActiveLoading=_useState6[1];var _useState7=useState({}),_useState8=_slicedToArray(_useState7,2),fileData=_useState8[0],setfileData=_useState8[1];var _useState9=useState(undefined),_useState10=_slicedToArray(_useState9,2),mainPerson=_useState10[0],setmainPerson=_useState10[1];//Servicios\nvar _useState11=useState(new BackendServices()),_useState12=_slicedToArray(_useState11,2),backendServices=_useState12[0],setbackendServices=_useState12[1];var _useState13=useState(new CoreServices()),_useState14=_slicedToArray(_useState13,2),coreServices=_useState14[0],setcoreServices=_useState14[1];var _useState15=useState({show:false,msg:\"\",isError:false}),_useState16=_slicedToArray(_useState15,2),msgData=_useState16[0],setmsgData=_useState16[1];var _useState17=useState({show:false,msg:\"\",isError:false}),_useState18=_slicedToArray(_useState17,2),msgModal=_useState18[0],setmsgModal=_useState18[1];//On Mounting (componentDidMount) if selectedData has changes\nReact.useEffect(function(){if(attachmentFileInputModel!==undefined&&attachmentFileInputModel!==null){getPerson();updateAttachments();}},[attachmentFileInputModel]);function getPerson(){return _getPerson.apply(this,arguments);}//abrimos modal para adjunar archivos\nfunction _getPerson(){_getPerson=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var result,person;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(attachmentFileInputModel.personId>0)){_context.next=5;break;}_context.next=3;return backendServices.consultarListaPersonaSolicitud(attachmentFileInputModel.transactId);case 3:result=_context.sent;if(result!==null){person=result.find(function(x){return x.personId===attachmentFileInputModel.personId;});if(person!==undefined){setmainPerson(person);}}case 5:case\"end\":return _context.stop();}}},_callee);}));return _getPerson.apply(this,arguments);}function toggleShowModelAttachment(){setShowModelAttachment(!showModelAttachment);removeBodyCss();}function removeBodyCss(){document.body.classList.add(\"no_padding\");}//GUARDAR ADJUNTO\nfunction addAttachment(filedata){setIsActiveLoading(true);try{console.log(\"filedata\",filedata);//GUARDAR EN GESTOR DOCUMENTAL ONBASE\n//filedata.name, filedata.description, filedata.fileName, filedata.fileExtension, filedata.fileBase64 \nvar clientName=mainPerson!==undefined?mainPerson.name+mainPerson.secondName+mainPerson.lastName+mainPerson.secondSurname:\"Attachment\";var clientNumber=mainPerson!==undefined?mainPerson.customerNumberT24:attachmentFileInputModel.transactId;var clientType=mainPerson!==undefined&&mainPerson.personType!==\"1\"?\"J\":\"N\";var identification=mainPerson!==undefined&&mainPerson.clientDocumentId.length>0?mainPerson.clientDocumentId:attachmentFileInputModel.transactId;var data={ApplicationNumber:attachmentFileInputModel.transactId,ClientName:clientName.trim(),ClientNumber:clientNumber.trim(),//\"98765432\",\nClientType:clientType,//\"N\",\nDocumentTypeId:\"1067\",ExpirationDate:moment().format(\"DD/MM/YYYY\"),FileExtension:filedata.fileExtension,Identification:identification.trim(),//\"9-728-1643\",\nImageBase64:filedata.fileBase64,ProcessCode:attachmentFileInputModel.processId,//\"7\",\nToken:attachmentFileInputModel.transactId+attachmentFileInputModel.processId+attachmentFileInputModel.activityId,//\"34543\",\nUploadDate:moment().format(\"DD/MM/YYYY\")//ProductNumber:\"456\"\n};console.log(\"senddata\",data);coreServices.postDocument(data).then(function(resultCore){console.log(\"postDocument\",resultCore);filedata['transactId']=attachmentFileInputModel.transactId;filedata['processId']=attachmentFileInputModel.processId;filedata['activityId']=attachmentFileInputModel.activityId;filedata['personId']=attachmentFileInputModel.personId;filedata['documentId']=resultCore.documentId;filedata['docName']=resultCore.docName;////GUARDAR EN BD ////\ndata=DocumentoAnexoModel.getSaveModel(filedata);console.log(\"data\",data);backendServices.saveAttachmentDocument(data).then(function(resultBackend){if(resultBackend){// SI TODO OK ACTUALIZAR LA LISTA DE ADJUNTOS\nupdateAttachments();}}).catch(function(error){showMessage(t(\"Error\")+\" \"+error.message,true);}).finally(function(){setIsActiveLoading(false);});}).catch(function(error){showMessage(t(\"Error\")+\" \"+error.message,true);}).finally(function(){setIsActiveLoading(false);});}catch(error){setIsActiveLoading(false);}}//BORRAR ADJUNTO\nfunction removeAttachment(data){//BORRAR EN GESTOR DOCUMENTAL ONBASE\n////BORRAR EN BD \n// data = { transactId: data.transactId, onBaseIdentification: data.onBaseIdentification };\nbackendServices.deleteAttachmentDocument(data.transactId,data.onBaseIdentification).then(function(resultBackend){if(resultBackend){// SI TODO OK ACTUALIZAR LA LISTA DE ADJUNTOS\nupdateAttachments();}}).catch(function(error){showMessage(t(\"Error\")+\" \"+error.message,true);}).finally(function(){});//})\n//.catch((error) => {console.error('api error', error);})\n//.finally (() => {  });        \n}//VER ADJUNTO\nfunction viewAttachment(docId){coreServices.postViewDocument(docId).then(function(resultCore){if(resultCore!==null){window.open(resultCore,\"_blank\");}}).catch(function(error){console.error('api error',error);}).finally(function(){setIsActiveLoading(false);});}//ACTUALIZAR LISTA DE ADJUNTOS\nfunction updateAttachments(){fileData[\"name\"]=\"\";fileData[\"description\"]=\"\";backendServices.getAttachmentDocumentByPerson(attachmentFileInputModel).then(function(data){setAttachments(data);}).catch(function(error){console.error('api error',error);}).finally(function(){});}function saveAttachment(){var form=document.getElementById('frmAttachment');form.requestSubmit();}// Submitimos formulario para busqueda de clientes\nfunction handleSubmitfrmAttachment(event,errors,values){event.preventDefault();if(errors.length>0){return;}if(fileData['fileName']===undefined){return;}addAttachment(fileData);toggleShowModelAttachment();}//On change Inputs\nfunction handleChangeInputfrm(_x){return _handleChangeInputfrm.apply(this,arguments);}//mostrar mensaje \nfunction _handleChangeInputfrm(){_handleChangeInputfrm=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var file,base64;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:fileData[e.target.name]=e.target.value;_context2.t0=e.target.name;_context2.next=_context2.t0===\"attachment\"?4:17;break;case 4:fileData['fileName']=undefined;if(!(e.target.files[0].size>1024*1024*5)){_context2.next=8;break;}//1024*1024*5 => 5MB\nshowMessageModal(t(\"FileToBigOnlyAcceptFilesUntil\")+\" 5MB\",true);return _context2.abrupt(\"return\");case 8:;file=e.target.files[0];fileData['fileName']=file.name;fileData['fileExtension']=\".\"+file.name.split('.').pop();_context2.next=14;return functionshelper.convertBase64(file);case 14:base64=_context2.sent;//console.log(\"base64\",base64.split(','))\nfileData['fileBase64']=base64.split(',')[1];return _context2.abrupt(\"break\",17);case 17:console.log(\"fileData\",fileData);setfileData(fileData);case 19:case\"end\":return _context2.stop();}}},_callee2);}));return _handleChangeInputfrm.apply(this,arguments);}function showMessage(message){var isError=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;setmsgData({show:true,msg:message,isError:isError});}function showMessageModal(message){var isError=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;setmsgModal({show:true,msg:message,isError:isError});}return/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsxs(LoadingOverlay,{active:isActiveLoading,spinner:true,text:t(\"WaitingPlease\"),children:[/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:\"6\",children:/*#__PURE__*/_jsx(\"h5\",{className:\"card-sub-title\",children:t(\"Attach File\")})}),/*#__PURE__*/_jsx(Col,{md:\"6\",children:/*#__PURE__*/_jsx(\"h5\",{className:\"card-sub-title\",children:/*#__PURE__*/_jsxs(Link,{to:\"#\",className:\"float-end\",onClick:function onClick(){toggleShowModelAttachment();},title:t(\"Add\"),children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-plus-box-multiple-outline mdi-24px\"}),\" \"]})})})]}),/*#__PURE__*/_jsx(CardBody,{children:/*#__PURE__*/_jsx(\"div\",{className:\"table-responseive\",children:attachments!==null&&attachments!==undefined&&attachments.length>0?/*#__PURE__*/_jsxs(Table,{className:\"table m-0\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"table-light\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:t(\"Name\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"Description\")}),/*#__PURE__*/_jsx(\"th\",{})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:attachments.map(function(data){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-0\",children:data.fileName}),/*#__PURE__*/_jsx(\"td\",{className:\"px-0\",children:data.fileDescription}),/*#__PURE__*/_jsxs(\"td\",{style:{textAlign:\"right\"},children:[/*#__PURE__*/_jsx(Link,{to:\"#\",title:t(\"View\"),onClick:function onClick(){return viewAttachment(data.onBaseIdentification);},children:/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-file-search-outline mdi-24px\"})}),/*#__PURE__*/_jsx(Link,{to:\"#\",title:t(\"Delete\"),onClick:function onClick(){return removeAttachment(data);},children:/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-file-remove-outline mdi-24px\"})})]})]},data.documentIdentification);})})]}):/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-info m-0\",children:t(\"NoAttachments\")})})})})}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsx(Alert,{className:\"text-center\",show:msgData.show,variant:msgData.isError?\"danger\":\"success\",dismissible:true,onClose:function onClose(){setmsgData({show:false,msg:\"\",isError:false});},children:msgData.msg})})})]}),/*#__PURE__*/_jsxs(Modal,{size:\"md\",isOpen:showModelAttachment,toggle:toggleShowModelAttachment,centered:true,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"modal-title mt-0\",children:t(\"Attach File\")}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:toggleShowModelAttachment,className:\"close\",\"data-dismiss\":\"modal\",\"aria-label\":\"Close\",children:/*#__PURE__*/_jsx(\"span\",{\"aria-hidden\":\"true\",children:\"\\xD7\"})})]}),/*#__PURE__*/_jsxs(AvForm,{id:\"frmAttachment\",className:\"needs-validation\",onSubmit:handleSubmitfrmAttachment,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-body\",children:[/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"name\",children:t(\"Name\")}),/*#__PURE__*/_jsx(AvField,{className:\"form-control\",type:\"text\",name:\"name\",onChange:handleChangeInputfrm,errorMessage:t(\"Required Field\"),validate:{required:{value:true}}})]})}),/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"attachment\",children:t(\"File\")}),/*#__PURE__*/_jsx(AvField,{className:\"form-control\",type:\"file\",name:\"attachment\",onChange:handleChangeInputfrm,errorMessage:t(\"Required Field\"),validate:{required:{value:true}},accept:\".jpg,.jpeg,.png,.doc,.docx,.xls,.xlsx,.pdf\"})]})})]}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"description\",children:t(\"Description\")}),/*#__PURE__*/_jsx(AvField,{className:\"form-control\",type:\"textarea\",name:\"description\",maxLength:\"1000\",rows:\"7\",onChange:handleChangeInputfrm})]})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-footer\",children:[/*#__PURE__*/_jsxs(Button,{color:\"danger\",type:\"button\",style:{margin:'5px'},onClick:toggleShowModelAttachment,\"data-dismiss\":\"modal\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi mdi-cancel mid-12px\"}),\" \",t(\"Cancel\")]}),/*#__PURE__*/_jsxs(Button,{color:\"success\",type:\"submit\",style:{margin:'5px'},children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-content-save mid-12px\"}),\" \",t(\"Save\")]})]})]}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsx(Alert,{className:\"text-center\",show:msgModal.show,variant:msgModal.isError?\"danger\":\"success\",dismissible:true,onClose:function onClose(){setmsgModal({show:false,msg:\"\",isError:false});},children:msgModal.msg})})})]})]})});};//export default (withTranslation()(DatosGenerales));\nexport default AttachmentFileCore;","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/components/Common/AttachmentFileCore.js"],"names":["React","useState","useRef","useTranslation","useLocation","useHistory","moment","Row","Col","Card","CardBody","Button","Label","Table","Pagination","PaginationItem","PaginationLink","CardFooter","Modal","AvForm","AvField","Link","DocumentModel","DocumentoAnexoModel","functionshelper","LoadingOverlay","CoreServices","BackendServices","Alert","AttachmentFileCore","props","t","i18n","attachmentFileInputModel","showModelAttachment","setShowModelAttachment","attachments","setAttachments","isActiveLoading","setIsActiveLoading","fileData","setfileData","undefined","mainPerson","setmainPerson","backendServices","setbackendServices","coreServices","setcoreServices","show","msg","isError","msgData","setmsgData","msgModal","setmsgModal","useEffect","getPerson","updateAttachments","personId","consultarListaPersonaSolicitud","transactId","result","person","find","x","toggleShowModelAttachment","removeBodyCss","document","body","classList","add","addAttachment","filedata","console","log","clientName","name","secondName","lastName","secondSurname","clientNumber","customerNumberT24","clientType","personType","identification","clientDocumentId","length","data","ApplicationNumber","ClientName","trim","ClientNumber","ClientType","DocumentTypeId","ExpirationDate","format","FileExtension","fileExtension","Identification","ImageBase64","fileBase64","ProcessCode","processId","Token","activityId","UploadDate","postDocument","then","resultCore","documentId","docName","getSaveModel","saveAttachmentDocument","resultBackend","catch","error","showMessage","message","finally","removeAttachment","deleteAttachmentDocument","onBaseIdentification","viewAttachment","docId","postViewDocument","window","open","getAttachmentDocumentByPerson","saveAttachment","form","getElementById","requestSubmit","handleSubmitfrmAttachment","event","errors","values","preventDefault","handleChangeInputfrm","e","target","value","files","size","showMessageModal","file","split","pop","convertBase64","base64","map","fileName","fileDescription","textAlign","documentIdentification","required","margin"],"mappings":"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","sourcesContent":["import React, { useState ,useRef} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { useTranslation } from 'react-i18next'\r\nimport { useLocation, useHistory } from 'react-router-dom'\r\n\r\nimport moment from \"moment\";\r\n\r\nimport {\r\n  Row,\r\n  Col,\r\n  Card,\r\n  CardBody,\r\n  Button,\r\n  Label,\r\n  Table,\r\n  Pagination,\r\n  PaginationItem,\r\n  PaginationLink,\r\n  CardFooter,\r\n  Modal,\r\n} from \"reactstrap\"\r\n\r\nimport { AvForm, AvField } from \"availity-reactstrap-validation\"\r\nimport { Link } from \"react-router-dom\"\r\nimport DocumentModel from \"../../models/Core/DocumentModel\";\r\nimport DocumentoAnexoModel from \"../../models/Backend/DocumentoAnexoModel\";\r\nimport functionshelper from \"../../helpers/functions_helper\"\r\nimport LoadingOverlay from 'react-loading-overlay';\r\n\r\nimport { CoreServices, BackendServices } from '../../services';\r\nimport Alert from 'react-bootstrap/Alert'\r\n\r\nconst AttachmentFileCore = (props) => {\r\n\r\n  const { t, i18n } = useTranslation();\r\n\r\n  const { attachmentFileInputModel } = props;\r\n\r\n  const [showModelAttachment, setShowModelAttachment] = useState(false);\r\n  const [attachments, setAttachments] = useState([]);\r\n  const [isActiveLoading, setIsActiveLoading] = useState(false);\r\n  const [fileData, setfileData] = useState({});\r\n  const [mainPerson, setmainPerson] = useState(undefined);\r\n\r\n  //Servicios\r\n  const [backendServices, setbackendServices] = useState(new BackendServices());\r\n  const [coreServices, setcoreServices] = useState(new CoreServices());\r\n  \r\n  const [msgData, setmsgData] = useState({ show: false, msg: \"\", isError: false });\r\n\r\n  const [msgModal, setmsgModal] = useState({ show: false, msg: \"\", isError: false });\r\n\r\n  //On Mounting (componentDidMount) if selectedData has changes\r\n  React.useEffect(() => {\r\n    if (attachmentFileInputModel !== undefined && attachmentFileInputModel !== null) {\r\n      getPerson();\r\n      updateAttachments();\r\n    }\r\n  }, [attachmentFileInputModel]);\r\n\r\n\r\n  async function getPerson() {\r\n    if (attachmentFileInputModel.personId > 0) {\r\n      var result = await backendServices.consultarListaPersonaSolicitud(attachmentFileInputModel.transactId);\r\n      if (result !== null) {\r\n        var person = result.find(x => x.personId === attachmentFileInputModel.personId);\r\n        if (person !== undefined) {\r\n          setmainPerson(person);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  //abrimos modal para adjunar archivos\r\n  function toggleShowModelAttachment() {\r\n    setShowModelAttachment(!showModelAttachment);\r\n    removeBodyCss()\r\n  }\r\n\r\n  function removeBodyCss() {\r\n    document.body.classList.add(\"no_padding\")\r\n  }\r\n\r\n  //GUARDAR ADJUNTO\r\n  function addAttachment(filedata) {\r\n\r\n    setIsActiveLoading(true);\r\n\r\n    try {\r\n      console.log(\"filedata\", filedata);\r\n      //GUARDAR EN GESTOR DOCUMENTAL ONBASE\r\n      //filedata.name, filedata.description, filedata.fileName, filedata.fileExtension, filedata.fileBase64 \r\n      var clientName = mainPerson !== undefined ? (mainPerson.name + mainPerson.secondName + mainPerson.lastName + mainPerson.secondSurname) : \"Attachment\";\r\n      var clientNumber = mainPerson !== undefined ? (mainPerson.customerNumberT24) : attachmentFileInputModel.transactId;\r\n      var clientType = mainPerson !== undefined && mainPerson.personType !== \"1\" ? \"J\" : \"N\";\r\n      var identification = mainPerson !== undefined && mainPerson.clientDocumentId.length > 0 ? mainPerson.clientDocumentId : attachmentFileInputModel.transactId;\r\n      var data = {\r\n        ApplicationNumber: attachmentFileInputModel.transactId,\r\n        ClientName: clientName.trim(),\r\n        ClientNumber: clientNumber.trim(),//\"98765432\",\r\n        ClientType: clientType,//\"N\",\r\n        DocumentTypeId: \"1067\",\r\n        ExpirationDate: moment().format(\"DD/MM/YYYY\"),\r\n        FileExtension: filedata.fileExtension,\r\n        Identification: identification.trim(),//\"9-728-1643\",\r\n        ImageBase64: filedata.fileBase64,\r\n        ProcessCode: attachmentFileInputModel.processId,//\"7\",\r\n        Token: attachmentFileInputModel.transactId + attachmentFileInputModel.processId + attachmentFileInputModel.activityId,//\"34543\",\r\n        UploadDate: moment().format(\"DD/MM/YYYY\"),\r\n        //ProductNumber:\"456\"\r\n      };\r\n      console.log(\"senddata\", data);\r\n      coreServices.postDocument(data).then((resultCore) => {\r\n\r\n        console.log(\"postDocument\", resultCore);\r\n\r\n        filedata['transactId'] = attachmentFileInputModel.transactId;\r\n        filedata['processId'] = attachmentFileInputModel.processId;\r\n        filedata['activityId'] = attachmentFileInputModel.activityId;\r\n        filedata['personId'] = attachmentFileInputModel.personId;\r\n        filedata['documentId'] = resultCore.documentId;\r\n        filedata['docName'] = resultCore.docName;\r\n\r\n        ////GUARDAR EN BD ////\r\n        data = DocumentoAnexoModel.getSaveModel(filedata);\r\n        console.log(\"data\", data);\r\n\r\n        backendServices.saveAttachmentDocument(data).then((resultBackend) => {\r\n\r\n          if (resultBackend) {\r\n            // SI TODO OK ACTUALIZAR LA LISTA DE ADJUNTOS\r\n            updateAttachments();\r\n          }\r\n        })\r\n          .catch((error) => {            \r\n            showMessage(t(\"Error\") + \" \" + error.message, true);\r\n           })\r\n          .finally(() => { setIsActiveLoading(false); });\r\n      })\r\n        .catch((error) => {\r\n            showMessage(t(\"Error\") + \" \" + error.message, true); \r\n          })\r\n        .finally(() => { setIsActiveLoading(false); });\r\n\r\n    }\r\n    catch (error) { setIsActiveLoading(false); }\r\n  }\r\n\r\n  //BORRAR ADJUNTO\r\n  function removeAttachment(data) {\r\n\r\n    //BORRAR EN GESTOR DOCUMENTAL ONBASE\r\n\r\n    ////BORRAR EN BD \r\n    // data = { transactId: data.transactId, onBaseIdentification: data.onBaseIdentification };\r\n    backendServices.deleteAttachmentDocument(data.transactId, data.onBaseIdentification).then((resultBackend) => {\r\n\r\n      if (resultBackend) {\r\n        // SI TODO OK ACTUALIZAR LA LISTA DE ADJUNTOS\r\n        updateAttachments();\r\n      }\r\n\r\n    }).catch((error) => {\r\n      showMessage(t(\"Error\") + \" \" + error.message, true);\r\n     })\r\n      .finally(() => { });\r\n    //})\r\n    //.catch((error) => {console.error('api error', error);})\r\n    //.finally (() => {  });        \r\n  }\r\n\r\n  //VER ADJUNTO\r\n  function viewAttachment(docId) {\r\n\r\n    coreServices.postViewDocument(docId).then((resultCore) => {\r\n      if (resultCore !== null) {\r\n        window.open(resultCore, \"_blank\")\r\n      }\r\n    }).catch((error) => { console.error('api error', error); })\r\n      .finally(() => { setIsActiveLoading(false); });\r\n  }\r\n\r\n  //ACTUALIZAR LISTA DE ADJUNTOS\r\n  function updateAttachments() {\r\n    fileData[\"name\"]=\"\";\r\n    fileData[\"description\"]=\"\";\r\n    \r\n    backendServices.getAttachmentDocumentByPerson(attachmentFileInputModel).then((data) => {\r\n      setAttachments(data);\r\n    })\r\n      .catch((error) => { console.error('api error', error); })\r\n      .finally(() => { });\r\n  }\r\n\r\n  function saveAttachment() {\r\n    let form = document.getElementById('frmAttachment');\r\n    form.requestSubmit();\r\n  }\r\n\r\n  // Submitimos formulario para busqueda de clientes\r\n  function handleSubmitfrmAttachment(event, errors, values) {\r\n    event.preventDefault();\r\n    if (errors.length > 0) {\r\n      return;\r\n    }\r\n\r\n    if(fileData['fileName'] === undefined){\r\n      return;\r\n    }\r\n\r\n    addAttachment(fileData);\r\n    toggleShowModelAttachment();\r\n  }\r\n  //On change Inputs\r\n  async function handleChangeInputfrm(e) {\r\n    fileData[e.target.name] = e.target.value;\r\n    switch (e.target.name) {\r\n      case \"attachment\": {\r\n        fileData['fileName'] = undefined;\r\n          \r\n        if(e.target.files[0].size > (1024*1024*5)){  //1024*1024*5 => 5MB\r\n          showMessageModal(t(\"FileToBigOnlyAcceptFilesUntil\") + \" 5MB\", true);\r\n          return;\r\n       };\r\n\r\n        const file = e.target.files[0]\r\n        fileData['fileName'] = file.name;\r\n        fileData['fileExtension'] = \".\" + file.name.split('.').pop();\r\n        var base64 = await functionshelper.convertBase64(file);\r\n        //console.log(\"base64\",base64.split(','))\r\n        fileData['fileBase64'] = base64.split(',')[1];\r\n        break;\r\n      }\r\n    }\r\n    console.log(\"fileData\", fileData)\r\n    setfileData(fileData);\r\n  }\r\n\r\n//mostrar mensaje \r\nfunction showMessage(message, isError = false) {\r\n  setmsgData({ show: true, msg: message, isError: isError })\r\n}\r\nfunction showMessageModal(message, isError = false) {\r\n  setmsgModal({ show: true, msg: message, isError: isError })\r\n}\r\n  return (\r\n\r\n    <React.Fragment>\r\n      <LoadingOverlay active={isActiveLoading} spinner text={t(\"WaitingPlease\")}>\r\n\r\n          <Card>          \r\n                  <Row>\r\n                    <Col md=\"6\">\r\n                      <h5 className=\"card-sub-title\">{t(\"Attach File\")}</h5>\r\n                    </Col> \r\n                    <Col md=\"6\">\r\n                      <h5 className=\"card-sub-title\">\r\n                        <Link to=\"#\" className=\"float-end\" onClick={() => { toggleShowModelAttachment() }} title={t(\"Add\")}><i className=\"mdi mdi-plus-box-multiple-outline mdi-24px\"></i>{\" \"}</Link>\r\n                      </h5>\r\n                    </Col>                    \r\n                  </Row> \r\n                  \r\n          <CardBody>\r\n              <div className='table-responseive'>\r\n              \r\n                {attachments !== null && attachments !== undefined && attachments.length > 0 ?\r\n              <Table className=\"table m-0\">                \r\n                <thead className=\"table-light\">\r\n                <tr>\r\n                  <th>{t(\"Name\")}</th>                  \r\n                  <th>{t(\"Description\")}</th>\r\n                  <th></th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                  {(attachments.map((data) => (\r\n                    <tr key={data.documentIdentification}>\r\n                      <td className=\"px-0\">{data.fileName}</td>\r\n                      <td className=\"px-0\">{data.fileDescription}</td>\r\n                      <td style={{textAlign:\"right\"}}>\r\n                        <Link to=\"#\" title={t(\"View\")} onClick={() => viewAttachment(data.onBaseIdentification)}><i className=\"mdi mdi-file-search-outline mdi-24px\"></i></Link>\r\n                        <Link to=\"#\" title={t(\"Delete\")} onClick={() => removeAttachment(data)}><i className=\"mdi mdi-file-remove-outline mdi-24px\"></i></Link>\r\n                      </td>\r\n                    </tr>\r\n                    )))}\r\n                    </tbody>\r\n            </Table>\r\n                  : (\r\n                    <Row>\r\n                      <Col>\r\n                      <div className=\"alert alert-info m-0\">{t(\"NoAttachments\")}</div>                      \r\n                      </Col>\r\n                    </Row>                    \r\n                  )}\r\n\r\n              </div>\r\n          </CardBody>\r\n\r\n          <Row>\r\n                  <Col md=\"12\">\r\n                    <Alert className='text-center' show={msgData.show} variant={msgData.isError ? \"danger\" : \"success\"} dismissible onClose={() => { setmsgData({ show: false, msg: \"\", isError: false }) }}>\r\n                      {msgData.msg}\r\n                    </Alert>\r\n                  </Col>\r\n                </Row>    \r\n          </Card>\r\n        \r\n        <Modal size=\"md\" isOpen={showModelAttachment} toggle={toggleShowModelAttachment} centered={true}>\r\n          <div className=\"modal-header\">\r\n            <h5 className=\"modal-title mt-0\">{t(\"Attach File\")}</h5>\r\n            <button\r\n              type=\"button\"\r\n              onClick={toggleShowModelAttachment}\r\n              className=\"close\"\r\n              data-dismiss=\"modal\"\r\n              aria-label=\"Close\">\r\n              <span aria-hidden=\"true\">&times;</span>\r\n            </button>\r\n          </div>\r\n\r\n          <AvForm id=\"frmAttachment\" className=\"needs-validation\" onSubmit={handleSubmitfrmAttachment}>\r\n            <div className=\"modal-body\">\r\n              <Row>\r\n                <Col md=\"12\">\r\n                  <div className=\"mb-3\">\r\n                    <Label htmlFor=\"name\">{t(\"Name\")}</Label>\r\n                    <AvField\r\n                      className=\"form-control\"\r\n                      type=\"text\"\r\n                      name=\"name\" onChange={handleChangeInputfrm}\r\n                      errorMessage={t(\"Required Field\")}\r\n                      validate={{ required: { value: true } }}\r\n                    />\r\n                  </div>\r\n                </Col>\r\n                <Col md=\"12\">\r\n                  <div className=\"mb-3\">\r\n                    <Label htmlFor=\"attachment\">{t(\"File\")}</Label>\r\n                    <AvField\r\n                      className=\"form-control\"\r\n                      type=\"file\"\r\n                      name=\"attachment\" onChange={handleChangeInputfrm}\r\n                      errorMessage={t(\"Required Field\")}\r\n                      validate={{ required: { value: true } }}\r\n                      accept=\".jpg,.jpeg,.png,.doc,.docx,.xls,.xlsx,.pdf\"\r\n                    />\r\n\r\n                  </div>\r\n                </Col>\r\n              </Row>\r\n              <Row>\r\n                <Col md=\"12\">\r\n                  <div className=\"mb-3\">\r\n                    <Label htmlFor=\"description\">{t(\"Description\")}</Label>\r\n                    <AvField\r\n                      className=\"form-control\"\r\n                      type=\"textarea\"\r\n                      name=\"description\"\r\n                      maxLength=\"1000\"\r\n                      rows=\"7\"\r\n                      onChange={handleChangeInputfrm}\r\n                    />\r\n                  </div>\r\n                </Col>\r\n              </Row>\r\n            </div>\r\n            <div className=\"modal-footer\">\r\n              <Button color=\"danger\" type=\"button\" style={{ margin: '5px' }} onClick={toggleShowModelAttachment} data-dismiss=\"modal\">\r\n                <i className=\"mdi mdi mdi-cancel mid-12px\"></i> {t(\"Cancel\")}\r\n              </Button>\r\n\r\n              <Button color=\"success\" type=\"submit\" style={{ margin: '5px' }}>\r\n                <i className=\"mdi mdi-content-save mid-12px\"></i> {t(\"Save\")}\r\n              </Button>\r\n            </div>\r\n          </AvForm>\r\n\r\n          <Row>\r\n                  <Col md=\"12\">\r\n                    <Alert className='text-center' show={msgModal.show} variant={msgModal.isError ? \"danger\" : \"success\"} dismissible onClose={() => { setmsgModal({ show: false, msg: \"\", isError: false }) }}>\r\n                      {msgModal.msg}\r\n                    </Alert>\r\n                  </Col>\r\n                </Row>    \r\n\r\n        </Modal>\r\n      </LoadingOverlay>\r\n    </React.Fragment>\r\n\r\n  )\r\n}\r\n\r\nAttachmentFileCore.propTypes = {\r\n  attachmentFileInputModel: PropTypes.any,\r\n}\r\n\r\n//export default (withTranslation()(DatosGenerales));\r\nexport default AttachmentFileCore;\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}