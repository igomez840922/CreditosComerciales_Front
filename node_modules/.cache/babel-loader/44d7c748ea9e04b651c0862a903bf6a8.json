{"ast":null,"code":"import _createForOfIteratorHelper from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _regeneratorRuntime from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import{BackendServices,CoreServices}from\"../services\";var backendServices=new BackendServices();var coreServices=new CoreServices();var AutoSaveData=/*#__PURE__*/function(){function AutoSaveData(){_classCallCheck(this,AutoSaveData);}_createClass(AutoSaveData,[{key:\"saveInitialData\",value://salvamos deudas de un tramite\nfunction(){var _saveInitialData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(transactionId){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:this.saveDebts(transactionId);this.saveAccountMovements(transactionId);this.saveFacilities(transactionId);this.saveCorporateExhibition(transactionId);case 4:case\"end\":return _context.stop();}}},_callee,this);}));function saveInitialData(_x){return _saveInitialData.apply(this,arguments);}return saveInitialData;}()//salvamos exposicion por tramite\n},{key:\"saveCorporateExhibition\",value:function(){var _saveCorporateExhibition=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(transactionId){var dataResult,i,datoSent;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return backendServices.getExposicionCorporativaBD(transactionId);case 3:dataResult=_context2.sent;if(!(dataResult!==undefined&&dataResult!==null&&dataResult.length>0)){_context2.next=6;break;}return _context2.abrupt(\"return\");case 6:_context2.next=8;return coreServices.getCorporateExhibition(transactionId);case 8:dataResult=_context2.sent;i=0;case 10:if(!(i<dataResult.length)){_context2.next=17;break;}datoSent={\"transactId\":Number(transactionId),//\"accountNumber\": data.name,\n//\"t24ClientId\": data.customerNumberT24,\n\"description\":dataResult[i].name,\"approved\":dataResult[i].approved,\"currentBalance\":dataResult[i].balance,\"proposed\":dataResult[i].proposal,\"ltv\":0,\"difference\":dataResult[i].variation};_context2.next=14;return backendServices.saveExposicionCorporativaBD(datoSent);case 14:i++;_context2.next=10;break;case 17:_context2.next=21;break;case 19:_context2.prev=19;_context2.t0=_context2[\"catch\"](0);case 21:case\"end\":return _context2.stop();}}},_callee2,null,[[0,19]]);}));function saveCorporateExhibition(_x2){return _saveCorporateExhibition.apply(this,arguments);}return saveCorporateExhibition;}()//salvamos facilidades por tramite\n},{key:\"saveFacilities\",value:function(){var _saveFacilities=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(transactionId){var request,dataResult,i,_dataResult$i$facilit,_request$0$requestId,datoSent;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return backendServices.consultGeneralDataPropCred(transactionId);case 3:request=_context3.sent;console.log(request);_context3.next=7;return backendServices.consultarFacilidadesT24(request[0].requestId);case 7:dataResult=_context3.sent;if(!(dataResult!==undefined&&dataResult!==null&&dataResult.length>0)){_context3.next=10;break;}return _context3.abrupt(\"return\");case 10:_context3.next=12;return coreServices.getFacilitiesByTransaction(transactionId);case 12:dataResult=_context3.sent;i=0;case 14:if(!(i<dataResult.length)){_context3.next=21;break;}datoSent={\"facilityNumber\":dataResult[i].AcctId,\"cr\":\"\",\"amount\":dataResult[i].approvedAmount,\"debtor\":dataResult[i].debtorName,\"clientTypeId\":dataResult[i].debtorId,\"balance\":dataResult[i].actualBalance,\"purpose\":\"\",\"sublimits\":\"\",\"proposalRate\":0,\"noSubsidyRate\":0,\"effectiveRate\":0,\"feci\":false,\"termDays\":0,\"termDescription\":\"\",\"ltv\":0,\"finantialConditions\":\" \",\"environmentRiskCategory\":0,\"covenant\":\" \",\"environmentRiskOpinion\":\" \",\"finantialCovenant\":\" \",\"legalDocumentation\":\"  \",\"otherConditions\":\" \",\"creditRiskOpinion\":\" \",\"provision\":\" \",\"proposalTypeId\":\"\",\"proposalTypeName\":\"\",\"facilityTypeId\":(_dataResult$i$facilit=dataResult[i].facilityType)!==null&&_dataResult$i$facilit!==void 0?_dataResult$i$facilit:\"\",\"termType\":\"\",\"origin\":\"CORE\",\"applyEscrow\":false,\"facilityId\":0,\"requestId\":(_request$0$requestId=request[0].requestId)!==null&&_request$0$requestId!==void 0?_request$0$requestId:\"\",\"startingAmount\":0,\"term\":\"\"};_context3.next=18;return backendServices.newFacilityPropCred(datoSent);case 18:i++;_context3.next=14;break;case 21:_context3.next=25;break;case 23:_context3.prev=23;_context3.t0=_context3[\"catch\"](0);case 25:case\"end\":return _context3.stop();}}},_callee3,null,[[0,23]]);}));function saveFacilities(_x3){return _saveFacilities.apply(this,arguments);}return saveFacilities;}()//salvamos deudas a Corto y largo Plazo\n},{key:\"saveDebts\",value:function(){var _saveDebts=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(transactionId){var checkCP,checkLP,dataResult,_iterator,_step,short,dat,_iterator2,_step2,long,dat1;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;checkCP=false;checkLP=false;_context4.next=5;return backendServices.consultBankingRelationsDebtsCP(transactionId);case 5:dataResult=_context4.sent;if(dataResult!==undefined&&dataResult!==null&&dataResult.getBankingRelationCPDTOList.length>0){}else{checkCP=true;}_context4.next=9;return backendServices.consultBankRelationsDebtsLP(transactionId);case 9:dataResult=_context4.sent;if(dataResult!==undefined&&dataResult!==null&&dataResult.bankingRelationLPDTOList.length>0){}else{checkLP=true;}if(!(!checkCP&&!checkLP)){_context4.next=13;break;}return _context4.abrupt(\"return\");case 13:_context4.next=15;return coreServices.getAllTermDebtsByTransaction(transactionId);case 15:dataResult=_context4.sent;if(!checkCP){_context4.next=35;break;}_iterator=_createForOfIteratorHelper(dataResult.shortTermresult);_context4.prev=18;_iterator.s();case 20:if((_step=_iterator.n()).done){_context4.next=27;break;}short=_step.value;dat={\"facilityType\":short.facilityType,\"amount\":Number(short.approvedAmount.toFixed(2)),\"date\":short.startDate,\"expirationDate\":short.endDate,\"debitBalance1\":Number(short.balance.toFixed(2)),\"debitBalance2\":0,\"debitBalance3\":0,\"rate\":0,\"fee\":0,\"bail\":0,\"fundDestiny\":\"\",status:true,\"bank\":short.bank,\"transactId\":Number(transactionId)};_context4.next=25;return backendServices.newBankingRelationsDebtsCP(dat);case 25:_context4.next=20;break;case 27:_context4.next=32;break;case 29:_context4.prev=29;_context4.t0=_context4[\"catch\"](18);_iterator.e(_context4.t0);case 32:_context4.prev=32;_iterator.f();return _context4.finish(32);case 35:if(!checkLP){_context4.next=54;break;}_iterator2=_createForOfIteratorHelper(dataResult.longTermresult);_context4.prev=37;_iterator2.s();case 39:if((_step2=_iterator2.n()).done){_context4.next=46;break;}long=_step2.value;dat1={\"transactId\":Number(transactionId),\"bank\":long.bank,\"facilityType\":long.facilityType,\"amount\":Number(long.approvedAmount.toFixed(2)),\"date\":long.startDate,\"expirationDate\":long.endDate,\"debitBalance1\":Number(long.balance.toFixed(2)),\"debitBalance2\":0,\"debitBalance3\":0,\"rate\":0,\"fee\":0,\"bail\":\" \",\"fundDestiny\":\" \",status:true};_context4.next=44;return backendServices.newBankingRelationsDebtsLP(dat1);case 44:_context4.next=39;break;case 46:_context4.next=51;break;case 48:_context4.prev=48;_context4.t1=_context4[\"catch\"](37);_iterator2.e(_context4.t1);case 51:_context4.prev=51;_iterator2.f();return _context4.finish(51);case 54:_context4.next=58;break;case 56:_context4.prev=56;_context4.t2=_context4[\"catch\"](0);case 58:case\"end\":return _context4.stop();}}},_callee4,null,[[0,56],[18,29,32,35],[37,48,51,54]]);}));function saveDebts(_x4){return _saveDebts.apply(this,arguments);}return saveDebts;}()//salvamos facilidades por tramite\n},{key:\"saveAccountMovements\",value:function(){var _saveAccountMovements=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(transactionId){var dataResult,i,cuenta,j,k,jsonSet;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;_context5.next=3;return backendServices.consultMovementsBank(transactionId);case 3:dataResult=_context5.sent;console.log(\"getAccountMovements\",dataResult);if(!(dataResult!==undefined&&dataResult!==null&&(dataResult.bankBanesco.length>0||dataResult.bankOthersBank.length>0))){_context5.next=7;break;}return _context5.abrupt(\"return\");case 7:_context5.next=9;return coreServices.getAccountMovementsByTransaction(transactionId);case 9:dataResult=_context5.sent;i=0;case 11:if(!(i<dataResult.length)){_context5.next=30;break;}//aqui cargamos por cuentas\ncuenta=dataResult[i].AcctId;j=0;case 14:if(!(j<dataResult[i].dataByYear.length)){_context5.next=27;break;}console.log(\"data[i].dataByYear\",dataResult[i].dataByYear);k=0;case 17:if(!(k<dataResult[i].dataByYear[j].dataresult.length)){_context5.next=24;break;}jsonSet={\"trasactId\":Number(transactionId),\"year\":dataResult[i].dataByYear[j].dataresult[k].year,\"month\":dataResult[i].dataByYear[j].dataresult[k].month,\"deposits\":dataResult[i].dataByYear[j].dataresult[k].deposits,\"averageBalance\":dataResult[i].dataByYear[j].dataresult[k].amount,\"observations\":\"\",\"accountNumber\":cuenta,\"t24\":true};_context5.next=21;return backendServices.newMovementsAccountsIGR(jsonSet);case 21:k++;_context5.next=17;break;case 24:j++;_context5.next=14;break;case 27:i++;_context5.next=11;break;case 30:_context5.next=34;break;case 32:_context5.prev=32;_context5.t0=_context5[\"catch\"](0);case 34:case\"end\":return _context5.stop();}}},_callee5,null,[[0,32]]);}));function saveAccountMovements(_x5){return _saveAccountMovements.apply(this,arguments);}return saveAccountMovements;}()}]);return AutoSaveData;}();export{AutoSaveData as default};","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/helpers/AutoSaveData.js"],"names":["BackendServices","CoreServices","backendServices","coreServices","AutoSaveData","transactionId","saveDebts","saveAccountMovements","saveFacilities","saveCorporateExhibition","getExposicionCorporativaBD","dataResult","undefined","length","getCorporateExhibition","i","datoSent","Number","name","approved","balance","proposal","variation","saveExposicionCorporativaBD","consultGeneralDataPropCred","request","console","log","consultarFacilidadesT24","requestId","getFacilitiesByTransaction","AcctId","approvedAmount","debtorName","debtorId","actualBalance","facilityType","newFacilityPropCred","checkCP","checkLP","consultBankingRelationsDebtsCP","getBankingRelationCPDTOList","consultBankRelationsDebtsLP","bankingRelationLPDTOList","getAllTermDebtsByTransaction","shortTermresult","short","dat","toFixed","startDate","endDate","status","bank","newBankingRelationsDebtsCP","longTermresult","long","dat1","newBankingRelationsDebtsLP","consultMovementsBank","bankBanesco","bankOthersBank","getAccountMovementsByTransaction","cuenta","j","dataByYear","k","dataresult","jsonSet","year","month","deposits","amount","newMovementsAccountsIGR"],"mappings":"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","sourcesContent":["\r\nimport { BackendServices, CoreServices } from \"../services\";\r\n\r\nconst backendServices = new BackendServices();\r\nconst coreServices = new CoreServices();\r\n\r\nexport default class AutoSaveData{\r\n    \r\n\r\n    //salvamos deudas de un tramite\r\n    async saveInitialData(transactionId) {\r\n        this.saveDebts(transactionId);\r\n        this.saveAccountMovements(transactionId);\r\n        this.saveFacilities(transactionId);\r\n        this.saveCorporateExhibition(transactionId);\r\n    }\r\n\r\n    //salvamos exposicion por tramite\r\n    async saveCorporateExhibition(transactionId) {\r\n        try{\r\n\r\n            var dataResult =  await  backendServices.getExposicionCorporativaBD(transactionId);\r\n            if(dataResult!==undefined && dataResult!==null && dataResult.length > 0){\r\n                return;\r\n            }\r\n    \r\n            dataResult =  await coreServices.getCorporateExhibition(transactionId)\r\n           for (let i = 0; i < dataResult.length; i++) {\r\n            let datoSent = {\r\n              \"transactId\": Number(transactionId),\r\n              //\"accountNumber\": data.name,\r\n              //\"t24ClientId\": data.customerNumberT24,\r\n              \"description\": dataResult[i].name,\r\n              \"approved\": dataResult[i].approved,\r\n              \"currentBalance\": dataResult[i].balance,\r\n              \"proposed\": dataResult[i].proposal,\r\n              \"ltv\": 0,\r\n              \"difference\": dataResult[i].variation,\r\n            }\r\n            await backendServices.saveExposicionCorporativaBD(datoSent)\r\n          }         \r\n        }\r\n        catch(err){}\r\n    }\r\n   \r\n    //salvamos facilidades por tramite\r\n    async saveFacilities(transactionId) {\r\n        try{\r\n           \r\n           var request = await backendServices.consultGeneralDataPropCred(transactionId);\r\n          console.log(request);\r\n           var dataResult =  await backendServices.consultarFacilidadesT24(request[0].requestId);\r\n            if(dataResult!==undefined && dataResult!==null && dataResult.length > 0){\r\n                return;\r\n            }\r\n\r\n           dataResult =  await coreServices.getFacilitiesByTransaction(transactionId)\r\n           for (let i = 0; i < dataResult.length; i++) {\r\n            let datoSent = {\r\n                \"facilityNumber\": dataResult[i].AcctId,\r\n                \"cr\": \"\",\r\n                \"amount\": dataResult[i].approvedAmount,\r\n                \"debtor\": dataResult[i].debtorName,\r\n                \"clientTypeId\": dataResult[i].debtorId,\r\n                \"balance\": dataResult[i].actualBalance,\r\n                \"purpose\": \"\",\r\n                \"sublimits\": \"\",\r\n                \"proposalRate\": 0,\r\n                \"noSubsidyRate\": 0,\r\n                \"effectiveRate\": 0,\r\n                \"feci\": false,\r\n                \"termDays\": 0,\r\n                \"termDescription\": \"\",\r\n                \"ltv\": 0,\r\n                \"finantialConditions\": \" \",\r\n                \"environmentRiskCategory\": 0,\r\n                \"covenant\": \" \",\r\n                \"environmentRiskOpinion\": \" \",\r\n                \"finantialCovenant\": \" \",\r\n                \"legalDocumentation\": \"  \",\r\n                \"otherConditions\": \" \",\r\n                \"creditRiskOpinion\": \" \",\r\n                \"provision\": \" \",\r\n                \"proposalTypeId\": \"\",\r\n                \"proposalTypeName\": \"\",\r\n                \"facilityTypeId\": dataResult[i].facilityType ?? \"\",\r\n                \"termType\": \"\",\r\n                \"origin\": \"CORE\",\r\n                \"applyEscrow\": false,\r\n                \"facilityId\": 0,\r\n                \"requestId\": request[0].requestId ?? \"\",\r\n                \"startingAmount\": 0,\r\n                \"term\": \"\"\r\n              }\r\n            await backendServices.newFacilityPropCred(datoSent)\r\n          }         \r\n        }\r\n        catch(err){}\r\n    }\r\n\r\n    //salvamos deudas a Corto y largo Plazo\r\n    async saveDebts(transactionId) {\r\n        try{\r\n           \r\n            var checkCP =false;\r\n            var checkLP =false;\r\n\r\n            var dataResult = await backendServices.consultBankingRelationsDebtsCP(transactionId);\r\n            if(dataResult!==undefined && dataResult!==null && dataResult.getBankingRelationCPDTOList.length > 0){}\r\n            else{\r\n                checkCP=true;\r\n            }\r\n            dataResult = await backendServices.consultBankRelationsDebtsLP(transactionId);\r\n            if(dataResult!==undefined && dataResult!==null && dataResult.bankingRelationLPDTOList.length > 0){}\r\n            else{\r\n                checkLP=true;\r\n            }\r\n\r\n            if(!checkCP && !checkLP){\r\n                return;\r\n            }\r\n\r\n            dataResult = await coreServices.getAllTermDebtsByTransaction(transactionId);\r\n    \r\n            if(checkCP){\r\n                for (var short of dataResult.shortTermresult) {\r\n                    var dat = {\r\n                      \"facilityType\": short.facilityType,\r\n                      \"amount\": Number(short.approvedAmount.toFixed(2)),\r\n                      \"date\": short.startDate,\r\n                      \"expirationDate\": short.endDate,\r\n                      \"debitBalance1\": Number(short.balance.toFixed(2)),\r\n                      \"debitBalance2\": 0,\r\n                      \"debitBalance3\": 0,\r\n                      \"rate\": 0,\r\n                      \"fee\": 0,\r\n                      \"bail\": 0,\r\n                      \"fundDestiny\": \"\",\r\n                      status: true,\r\n                      \"bank\": short.bank,\r\n                      \"transactId\": Number(transactionId)\r\n                    }\r\n                    await backendServices.newBankingRelationsDebtsCP(dat)\r\n                  }\r\n            }\r\n\r\n            if(checkLP){\r\n                for (var long of dataResult.longTermresult) {\r\n                    var dat1 = {\r\n                      \"transactId\": Number(transactionId),\r\n                      \"bank\": long.bank,\r\n                      \"facilityType\": long.facilityType,\r\n                      \"amount\": Number(long.approvedAmount.toFixed(2)),\r\n                      \"date\": long.startDate,\r\n                      \"expirationDate\": long.endDate,\r\n                      \"debitBalance1\": Number(long.balance.toFixed(2)),\r\n                      \"debitBalance2\": 0,\r\n                      \"debitBalance3\": 0,\r\n                      \"rate\": 0,\r\n                      \"fee\": 0,\r\n                      \"bail\": \" \",\r\n                      \"fundDestiny\": \" \",\r\n                      status: true,\r\n                    }\r\n                    await backendServices.newBankingRelationsDebtsLP(dat1)\r\n                  }\r\n            }\r\n               \r\n        }\r\n        catch(err){}\r\n    }\r\n\r\n    //salvamos facilidades por tramite\r\n    async saveAccountMovements(transactionId) {\r\n        try{\r\n           \r\n           \r\n           var dataResult =  await backendServices.consultMovementsBank(transactionId);\r\n            console.log(\"getAccountMovements\",dataResult);\r\n                     \r\n            if(dataResult!==undefined && dataResult!==null && (dataResult.bankBanesco.length > 0 || dataResult.bankOthersBank.length > 0) ){\r\n                return;\r\n            }            \r\n\r\n           dataResult =  await coreServices.getAccountMovementsByTransaction(transactionId)\r\n           for (let i = 0; i < dataResult.length; i++) {\r\n            //aqui cargamos por cuentas\r\n            let cuenta = dataResult[i].AcctId;\r\n            for (let j = 0; j < dataResult[i].dataByYear.length; j++) {\r\n              console.log(\"data[i].dataByYear\", dataResult[i].dataByYear);\r\n              for (let k = 0; k < dataResult[i].dataByYear[j].dataresult.length; k++) {\r\n                let jsonSet = {\r\n                  \"trasactId\": Number(transactionId),\r\n                  \"year\": dataResult[i].dataByYear[j].dataresult[k].year,\r\n                  \"month\": dataResult[i].dataByYear[j].dataresult[k].month,\r\n                  \"deposits\": dataResult[i].dataByYear[j].dataresult[k].deposits,\r\n                  \"averageBalance\": dataResult[i].dataByYear[j].dataresult[k].amount,\r\n                  \"observations\": \"\",\r\n                  \"accountNumber\": cuenta,\r\n                  \"t24\": true\r\n                }\r\n                await backendServices.newMovementsAccountsIGR(jsonSet);\r\n              }\r\n            }\r\n          }        \r\n        }\r\n        catch(err){}\r\n    }\r\n\r\n}"]},"metadata":{},"sourceType":"module"}