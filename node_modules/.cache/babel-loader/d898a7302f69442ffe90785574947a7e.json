{"ast":null,"code":"import _slicedToArray from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState,useRef}from\"react\";import{translationHelpers}from\"../../../helpers\";import{useLocation,useHistory}from'react-router-dom';import*as url from\"../../../helpers/url_helper\";import{withTranslation}from\"react-i18next\";import{Row,Col,Button}from\"reactstrap\";//Import Breadcrumb\nimport Breadcrumbs from\"../../../components/Common/Breadcrumb\";import{GeneralSection}from\"../../../components/PropuestaCreditoComercial\";import Analisis from\"./riesgoCredito/Analisis\";import FormConclusiones from\"./riesgoCredito/Conclusiones\";import{BpmServices}from\"../../../services\";import SweetAlert from\"react-bootstrap-sweetalert\";import RiesgoCreditoContext from\"./RiesgoCreditoContext\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var RiesgoCreditoDetalle=function RiesgoCreditoDetalle(props){var history=useHistory();var location=useLocation();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),successSave_dlg=_useState2[0],setsuccessSave_dlg=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),error_dlg=_useState4[0],seterror_dlg=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),error_msg=_useState6[0],seterror_msg=_useState6[1];var _useState7=useState({}),_useState8=_slicedToArray(_useState7,2),context=_useState8[0],setContext=_useState8[1];var _translationHelpers=translationHelpers('navigation','commercial_credit','common'),_translationHelpers2=_slicedToArray(_translationHelpers,3),n=_translationHelpers2[0],t=_translationHelpers2[1],c=_translationHelpers2[2];// Component Refs\nvar formConclusionesRef=useRef();useEffect(function(){if(!location.data){location.data={\"requestId\":\"XYZ892022\",\"facilityId\":\"\",\"customerId\":\"68\",\"transactionId\":\"110\",\"processId\":\"6\",\"activityId\":\"0\",\"instanceId\":9104,\"taskId\":456,\"taskStatus\":\"InProgress\"};}// update context\nconsole.log('context',location.data);setContext({transactionId:location.data.transactionId,customerId:location.data.customerId,instanceId:location.data.instanceId,requestId:location.data.requestId});},[]);function handleSubmit(){formConclusionesRef.current.submit();}function handleSave(){handleReturn();}function handleReturn(){/* ---------------------------------------------------------------------------------------------- */ /*                                      Avanzamos el proceso                                      */ /* ---------------------------------------------------------------------------------------------- */var api=new BpmServices();var taskId=\"\";api.completedStatusTask(taskId).then(function(resp){if(resp!==undefined){setsuccessSave_dlg(true);}else{//Mensaje ERROR\nseterror_msg(props.t(\"ErrorSaveMessage\"));seterror_dlg(true);}}).catch(function(err){console.log(err);});}function handleClose(){/* ---------------------------------------------------------------------------------------------- */ /*                    Cerramos el proceso y retornamos a la bandeja de entrada                    */ /* ---------------------------------------------------------------------------------------------- */var api=new BpmServices();// let instanceId = location.data.instanceId\nvar instanceId=0;api.abortProcess(instanceId).then(function(data){if(data!==undefined){history.push(url.URL_DASHBOARD);}else{//Mensaje ERROR\nseterror_msg(props.t(\"TheProcessCouldNotFinish\"));seterror_dlg(true);}});}return/*#__PURE__*/_jsxs(\"div\",{className:\"page-content\",children:[/*#__PURE__*/_jsx(Breadcrumbs,{title:n(\"Commercial Credit\"),breadcrumbItem:n(\"Credit Risk\")}),/*#__PURE__*/_jsxs(RiesgoCreditoContext.Provider,{value:context,children:[/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{xl:\"12\",children:/*#__PURE__*/_jsx(Analisis,{})})}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{xl:\"12\",children:/*#__PURE__*/_jsx(FormConclusiones,{ref:formConclusionesRef,onSaveSuccess:handleSave})})}),/*#__PURE__*/_jsx(Row,{className:\"my-2\",children:/*#__PURE__*/_jsxs(Col,{xl:\"12 text-end\",children:[/*#__PURE__*/_jsxs(Button,{id:\"btnReturn\",color:\"dark\",type:\"button\",style:{margin:'5px'},onClick:handleClose,children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-arrow-left-bold-circle-outline mid-12px\"}),\" \",\" \",c(\"Close\")]}),/*#__PURE__*/_jsxs(Button,{id:\"btnSave\",color:\"success\",type:\"button\",style:{margin:'5px'},onClick:handleSubmit,children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-content-save mdi-12px\"}),\" \",\" \",c(\"Save\")]})]})}),successSave_dlg?/*#__PURE__*/_jsx(SweetAlert,{success:true,title:props.t(\"SuccessDialog\"),onConfirm:function onConfirm(){setsuccessSave_dlg(false);history.push(url.URL_DASHBOARD);},children:props.t(\"SuccessSaveMessage\")}):null,error_dlg?/*#__PURE__*/_jsx(SweetAlert,{error:true,title:props.t(\"ErrorDialog\"),onConfirm:function onConfirm(){seterror_dlg(false);},children:error_msg}):null]})]});};export default withTranslation()(RiesgoCreditoDetalle);","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/pages/CommercialCredit/17_RiesgoCredito/RiesgoCreditoDetalle.js"],"names":["React","useEffect","useState","useRef","translationHelpers","useLocation","useHistory","url","withTranslation","Row","Col","Button","Breadcrumbs","GeneralSection","Analisis","FormConclusiones","BpmServices","SweetAlert","RiesgoCreditoContext","RiesgoCreditoDetalle","props","history","location","successSave_dlg","setsuccessSave_dlg","error_dlg","seterror_dlg","error_msg","seterror_msg","context","setContext","n","t","c","formConclusionesRef","data","console","log","transactionId","customerId","instanceId","requestId","handleSubmit","current","submit","handleSave","handleReturn","api","taskId","completedStatusTask","then","resp","undefined","catch","err","handleClose","abortProcess","push","URL_DASHBOARD","margin"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useRef } from \"react\"\r\nimport { translationHelpers } from \"../../../helpers\"\r\nimport { useLocation, useHistory } from 'react-router-dom'\r\nimport * as url from \"../../../helpers/url_helper\"\r\nimport { withTranslation } from \"react-i18next\"\r\nimport {\r\n  Row,\r\n  Col,\r\n  Button\r\n} from \"reactstrap\"\r\n\r\n\r\n//Import Breadcrumb\r\nimport Breadcrumbs from \"../../../components/Common/Breadcrumb\"\r\nimport { GeneralSection } from \"../../../components/PropuestaCreditoComercial\"\r\nimport Analisis from \"./riesgoCredito/Analisis\"\r\nimport FormConclusiones from \"./riesgoCredito/Conclusiones\"\r\nimport { BpmServices } from \"../../../services\"\r\nimport SweetAlert from \"react-bootstrap-sweetalert\"\r\nimport RiesgoCreditoContext from \"./RiesgoCreditoContext\"\r\n\r\n\r\n\r\nconst RiesgoCreditoDetalle = (props) => {\r\n\r\n  const history = useHistory();\r\n  const location = useLocation()\r\n  const [successSave_dlg, setsuccessSave_dlg] = useState(false);\r\n  const [error_dlg, seterror_dlg] = useState(false);\r\n  const [error_msg, seterror_msg] = useState(\"\");\r\n  const [context, setContext] = useState({});\r\n\r\n  const [n, t, c] = translationHelpers('navigation', 'commercial_credit', 'common');\r\n\r\n  // Component Refs\r\n  const formConclusionesRef = useRef();\r\n\r\n  useEffect(() => {\r\n\r\n    if (!location.data) {\r\n      location.data = {\r\n        \"requestId\": \"XYZ892022\",\r\n        \"facilityId\": \"\",\r\n        \"customerId\": \"68\",\r\n        \"transactionId\": \"110\",\r\n        \"processId\": \"6\",\r\n        \"activityId\": \"0\",\r\n        \"instanceId\": 9104,\r\n        \"taskId\": 456,\r\n        \"taskStatus\": \"InProgress\"\r\n      }\r\n    }\r\n\r\n    // update context\r\n    console.log('context', location.data);\r\n    setContext({\r\n      transactionId: location.data.transactionId,\r\n      customerId: location.data.customerId,\r\n      instanceId: location.data.instanceId,\r\n      requestId: location.data.requestId,\r\n    });\r\n\r\n  }, []);\r\n\r\n\r\n  function handleSubmit() {\r\n    formConclusionesRef.current.submit();\r\n  }\r\n\r\n  function handleSave() {\r\n    handleReturn();\r\n  }\r\n\r\n  function handleReturn() {\r\n    /* ---------------------------------------------------------------------------------------------- */\r\n    /*                                      Avanzamos el proceso                                      */\r\n    /* ---------------------------------------------------------------------------------------------- */\r\n    const api = new BpmServices();\r\n    let taskId = \"\";\r\n    api.completedStatusTask(taskId).then(resp => {\r\n      if (resp !== undefined) {\r\n        setsuccessSave_dlg(true);\r\n      }\r\n      else {\r\n        //Mensaje ERROR\r\n        seterror_msg(props.t(\"ErrorSaveMessage\"))\r\n        seterror_dlg(true)\r\n      }\r\n    }).catch(err => {\r\n      console.log(err);\r\n    })\r\n  }\r\n\r\n  function handleClose() {\r\n    /* ---------------------------------------------------------------------------------------------- */\r\n    /*                    Cerramos el proceso y retornamos a la bandeja de entrada                    */\r\n    /* ---------------------------------------------------------------------------------------------- */\r\n    const api = new BpmServices();\r\n    // let instanceId = location.data.instanceId\r\n    let instanceId = 0\r\n    api.abortProcess(instanceId).then((data) => {\r\n      if (data !== undefined) {\r\n        history.push(url.URL_DASHBOARD);\r\n      }\r\n      else {\r\n        //Mensaje ERROR\r\n        seterror_msg(props.t(\"TheProcessCouldNotFinish\"))\r\n        seterror_dlg(true)\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n  return (\r\n\r\n    <div className=\"page-content\">\r\n\r\n      <Breadcrumbs title={n(\"Commercial Credit\")} breadcrumbItem={n(\"Credit Risk\")} />\r\n\r\n      <RiesgoCreditoContext.Provider value={context}>\r\n\r\n        <Row>\r\n          <Col xl=\"12\">\r\n            <Analisis />\r\n          </Col>\r\n        </Row>\r\n\r\n        <Row>\r\n          <Col xl=\"12\">\r\n            <FormConclusiones ref={formConclusionesRef} onSaveSuccess={handleSave} />\r\n          </Col>\r\n        </Row>\r\n\r\n        <Row className=\"my-2\">\r\n          <Col xl=\"12 text-end\">\r\n            <Button id=\"btnReturn\" color=\"dark\" type=\"button\" style={{ margin: '5px' }} onClick={handleClose}>\r\n              <i className=\"mdi mdi-arrow-left-bold-circle-outline mid-12px\"></i>\r\n              {\" \"} {c(\"Close\")}\r\n            </Button>\r\n            <Button id=\"btnSave\" color=\"success\" type=\"button\" style={{ margin: '5px' }} onClick={handleSubmit}>\r\n              <i className=\"mdi mdi-content-save mdi-12px\"></i>\r\n              {\" \"} {c(\"Save\")}\r\n            </Button>\r\n          </Col>\r\n        </Row>\r\n\r\n      {successSave_dlg ? (\r\n        <SweetAlert\r\n          success\r\n          title={props.t(\"SuccessDialog\")}\r\n          onConfirm={() => {\r\n            setsuccessSave_dlg(false)\r\n\r\n            history.push(url.URL_DASHBOARD);\r\n          }}\r\n        >\r\n          {props.t(\"SuccessSaveMessage\")}\r\n        </SweetAlert>\r\n      ) : null}\r\n\r\n      {error_dlg ? (\r\n        <SweetAlert\r\n          error\r\n          title={props.t(\"ErrorDialog\")}\r\n          onConfirm={() => {\r\n            seterror_dlg(false)\r\n          }}\r\n        >\r\n          {error_msg}\r\n        </SweetAlert>\r\n      ) : null}\r\n\r\n      </RiesgoCreditoContext.Provider>\r\n\r\n    </div>\r\n  );\r\n\r\n}\r\n\r\n\r\nexport default (withTranslation()(RiesgoCreditoDetalle));\r\n"]},"metadata":{},"sourceType":"module"}