{"ast":null,"code":"import _slicedToArray from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import{useLocation,useHistory}from'react-router-dom';import LoadingOverlay from'react-loading-overlay';import*as OPTs from\"../../../../helpers/options_helper\";import*as url from\"../../../../helpers/url_helper\";import{Row,Col,Card,CardBody,Label,CardFooter,Button}from\"reactstrap\";import{AvForm,AvField}from\"availity-reactstrap-validation\";import{Link}from\"react-router-dom\";//Import Breadcrumb\nimport Breadcrumbs from\"../../../../components/Common/Breadcrumb\";//i18n\nimport{withTranslation}from\"react-i18next\";//Import SweetAlert\nimport SweetAlert from\"react-bootstrap-sweetalert\";import FormBusqueda from\"./FormBusqueda\";import FormResultados from\"./FormResultados\";import FormObservaciones from\"./FormObservaciones\";import FormGoogle from\"./FormGoogle\";import ModalCloseOptions from\"./ModalCloseOptions\";import ModalAdvanceOptions from\"./ModalAdvanceOptions\";import LogProcess from\"../../../../components/LogProcess/index\";import ModalEndProcess from\"../../../../components/EndProcess/ModalEndProcess\";import AttachmentFileCore from\"../../../../components/Common/AttachmentFileCore\";import{BackendServices,CoreServices,BpmServices}from\"../../../../services\";import{BusquedaDescarteModel}from\"../../../../models\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var BandejaEntrada=function BandejaEntrada(props){var history=useHistory();var location=useLocation();//Data que recibimos en el location\nvar _useState=useState(location.data),_useState2=_slicedToArray(_useState,2),locationData=_useState2[0],setLocationData=_useState2[1];//Entidad Busqueda y Descarte\nvar _useState3=useState(undefined),_useState4=_slicedToArray(_useState3,2),selectedData=_useState4[0],setSelectedData=_useState4[1];//Resultado de Lista Negra\nvar _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),dataList=_useState6[0],setDataList=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),displayModalGoogle=_useState8[0],setDisplayModalGoogle=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),searchGoogleTerms=_useState10[0],setSearchGoogleTerms=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),displayModalCloseOptions=_useState12[0],setDisplayModalCloseOptions=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),displayModalAdvanceOptions=_useState14[0],setDisplayModalAdvanceOptions=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),displayModalEndProcess=_useState16[0],setDisplayModalEndProcess=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),isActiveLoading=_useState18[0],setIsActiveLoading=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),successSave_dlg=_useState20[0],setsuccessSave_dlg=_useState20[1];var _useState21=useState(false),_useState22=_slicedToArray(_useState21,2),error_dlg=_useState22[0],seterror_dlg=_useState22[1];var _useState23=useState(\"\"),_useState24=_slicedToArray(_useState23,2),error_msg=_useState24[0],seterror_msg=_useState24[1];var _useState25=useState(false),_useState26=_slicedToArray(_useState25,2),info_dlg=_useState26[0],setinfo_dlg=_useState26[1];var _useState27=useState(\"\"),_useState28=_slicedToArray(_useState27,2),info_msg=_useState28[0],setinfo_msg=_useState28[1];//On Mounting (componentDidMount)\nReact.useEffect(function(){setLocationData(location.data);initializeData(location.data);},[]);//Caraga Inicial\nfunction initializeData(InputData){if(InputData!==undefined&&InputData!==null){//chequear si la tarea no ha sido iniciada\nif(InputData.taskStatus===\"Ready\"){var apiBpmServices=new BpmServices();//Iniciamos la nueva tarea en BPM   \napiBpmServices.startedStatusTask(InputData.taskId).then(function(iniresult){if(iniresult===undefined){history.push(url.URL_DASHBOARD);}});}var apiBackendServices=new BackendServices();// Buscar en BD los datos de esta actividad\n//var parameters = {processId:InputData.instanceId,transactId:InputData.transactionId,activityId:InputData.activityId}   \napiBackendServices.consultarBusquedaDescarte(InputData.transactionId).then(function(data){if(data!==null&&data!==undefined){UpdateDataModel(data);}else{//Nuevo Proceso            \ndata=BusquedaDescarteModel.getRequestModel();UpdateDataModel(data);}}).catch(function(error){console.error('api error: ',error);});}else{history.push(url.URL_DASHBOARD);}}function searchWhatchList(values){setIsActiveLoading(true);var apiCoreServices=new CoreServices();apiCoreServices.postWhatchList(values).then(function(data){if(data.status===200){if(data.result.length>0){setDataList(data.result);}else{setinfo_msg(props.t('NoResults'));setinfo_dlg(true);}}else{seterror_msg(props.t('ErrorCode')+\": \"+data.error.errorCode+\"  \"+props.t('ErrorMsg')+\": \"+data.error.errorCode);seterror_dlg(true);}}).catch(function(error){console.error('Error fetching documents',error);}).finally(function(){setIsActiveLoading(false);});}function removeBodyCss(){document.body.classList.add(\"no_padding\");}function onGoogleSearch(q){setSearchGoogleTerms(q);setDisplayModalGoogle(!displayModalGoogle);removeBodyCss();}function toggleGoogleModal(){setDisplayModalGoogle(!displayModalGoogle);}//Modal Opciones al Salir\nfunction toggleModalCloseOptions(){setDisplayModalCloseOptions(!displayModalCloseOptions);}//Modal Para mostrar las opciones al Avanzar\nfunction toggleModalAdvanceOptions(){/* ---------------------------------------------------------------------------------------------- */ /*                             Aqui avanzamos al modal de descripcion                             */ /* ---------------------------------------------------------------------------------------------- */setDisplayModalAdvanceOptions(!displayModalAdvanceOptions);}//Modal Para mostrar Comentario de Fin de Proceso\nfunction toggleModalEndProcess(){setDisplayModalEndProcess(true);}//////////////////////////////////////////////////////////////\n//////////////////////////////////////////////////////////////\n//Salvando el Proceso y le pasamos una opcion: 1-Finalizar Proceso, 2- Salvarlo, 3- A Cumplimmineto, 4- Avanzar a IGR\nfunction onSaveProcess(option){if(option===OPTs.OPT_PREFINALIZARPROCESO){toggleModalEndProcess();return;}selectedData.instanceId=locationData.instanceId!==null&&locationData.instanceId!==undefined?locationData.instanceId:selectedData.instanceId;selectedData.customerId=locationData.customerId!==null&&locationData.customerId!==undefined?locationData.customerId:selectedData.customerId;selectedData.responsible=\"admin\";var apiBackendServices=new BackendServices();//Guardar el usuario prospecto    \napiBackendServices.guardarUsuarioProspecto(selectedData).then(function(userData){if(userData!==undefined){selectedData.transactId=userData.transactId!==null&&userData.transactId!==undefined?userData.transactId:selectedData.transactId;selectedData.customerId=userData.customerId!==null&&userData.customerId!==undefined?userData.customerId:selectedData.customerId;selectedData.compliance=option===OPTs.OPT_ENVIARCUMPLIMIENTO?true:false;UpdateDataModel(selectedData);//Guardar busqueda y descarte\napiBackendServices.guardarBusquedaDescarte(selectedData).then(function(descarteData){if(descarteData!==undefined){if(option===OPTs.OPT_LISTAEXCLUSION){//Guardar Cumplimiento\napiBackendServices.guardarCumplimiento(selectedData).then(function(descarteData){if(descarteData!==undefined){saveJBPMProcess(option);}else{//Mensaje ERROR\nseterror_msg(props.t(\"ErrorSaveMessage\"));seterror_dlg(true);}});}else{saveJBPMProcess(option);}}else{//Mensaje ERROR\nseterror_msg(props.t(\"ErrorSaveMessage\"));seterror_dlg(true);}});}else{//Mensaje ERROR\nseterror_msg(props.t(\"ErrorSaveMessage\"));seterror_dlg(true);}}).catch(function(error){console.error('api error: ',error);});}function saveJBPMProcess(option){var apiBpmServices=new BpmServices();switch(option){case OPTs.OPT_FINALIZARPROCESO:{apiBpmServices.abortProcess(locationData.instanceId).then(function(data){if(data!==undefined){history.push(url.URL_DASHBOARD);}else{//Mensaje ERROR\nseterror_msg(props.t(\"TheProcessCouldNotFinish\"));seterror_dlg(true);}});break;}case OPTs.OPT_SALVAPARCIAL:{var values={\"processId\":OPTs.PROCESS_CUMPLIMIENTO.toString(),\"activityId\":OPTs.ACT_NONE.toString(),\"transactionId\":selectedData.transactId.toString(),\"customerId\":selectedData.customerId.toString(),\"applicationNumber\":\"\",\"procedureNumber\":\"\"//\"decision\":\"no\"          \n};apiBpmServices.updatevariables(locationData.instanceId,values).then(function(data){if(data!==undefined){setsuccessSave_dlg(true);}else{//Mensaje ERROR\nseterror_msg(props.t(\"ErrorSaveMessage\"));seterror_dlg(true);}});break;}case OPTs.OPT_LISTAEXCLUSION:{var values={\"processId\":OPTs.PROCESS_LISTAEXCLUSION.toString(),\"activityId\":OPTs.ACT_NONE.toString(),\"transactionId\":selectedData.transactId.toString(),\"customerId\":selectedData.customerId.toString(),\"applicationNumber\":\"\",\"procedureNumber\":\"\",\"decision\":\"si\"};console.log(\"saveJBPMProcess value\",values,locationData.taskId);apiBpmServices.completedStatusTask(locationData.taskId,values).then(function(data){if(data!==undefined){setsuccessSave_dlg(true);}else{//Mensaje ERROR\nseterror_msg(props.t(\"ErrorSaveMessage\"));seterror_dlg(true);}});break;}}}//salvar comentario de end process\nfunction onSaveEndProcess(values){//Salvar los comentarios en Bitacora    \nselectedData.endProcessComment=values.txtComment;UpdateDataModel(selectedData);onSaveProcess(OPTs.OPT_FINALIZARPROCESO);}//salvar comentario de end process\nfunction onSaveAdvanceProcess(values){//Salvar los comentarios en Bitacora    \nselectedData.observationsComp=values.txtComment;UpdateDataModel(selectedData);onSaveProcess(OPTs.OPT_LISTAEXCLUSION);}//Actualizamos El Modelo de Datos segun va cambiando\nfunction UpdateDataModel(data){setSelectedData(data);}return/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"page-content\",children:[/*#__PURE__*/_jsx(Breadcrumbs,{title:props.t(\"CommercialCredit\"),breadcrumbItem:props.t(\"Compliance\")}),/*#__PURE__*/_jsxs(LoadingOverlay,{active:isActiveLoading,spinner:true,text:props.t(\"WaitingPlease\"),children:[/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(CardBody,{children:[/*#__PURE__*/_jsx(FormBusqueda,{onSubmit:searchWhatchList,onGoogleSearch:onGoogleSearch,selectedData:selectedData,updateDataModel:UpdateDataModel}),dataList.length>0&&/*#__PURE__*/_jsx(FormResultados,{results:dataList,onScreenOption:props.onScreenOption}),/*#__PURE__*/_jsx(FormObservaciones,{selectedData:selectedData,updateDataModel:UpdateDataModel}),locationData!==undefined?/*#__PURE__*/_jsx(AttachmentFileCore,{locationData:{instanceId:locationData.instanceId,processId:OPTs.PROCESS_BUSQUEDADESCARTE,activityId:OPTs.ACT_NONE}}):null]}),/*#__PURE__*/_jsxs(CardFooter,{style:{textAlign:\"right\"},children:[/*#__PURE__*/_jsxs(Button,{color:\"danger\",type:\"button\",style:{margin:'5px'},onClick:function onClick(){toggleModalCloseOptions();},children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-arrow-left-bold-circle-outline mid-12px\"}),\" \",props.t(\"Exit\")]}),/*#__PURE__*/_jsxs(Button,{color:\"success\",type:\"button\",style:{margin:'5px'},onClick:function onClick(){toggleModalAdvanceOptions();},children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-arrow-right-bold-circle-outline mid-12px\"}),\" \",props.t(\"Advance\")]})]})]}),locationData!==undefined&&locationData.customerId!==null&&locationData.customerId!==undefined&&locationData.customerId.length>0?/*#__PURE__*/_jsx(LogProcess,{locationData:{instanceId:locationData.instanceId,transactId:locationData.transactionId,clientId:locationData.customerId,customerName:\"admin\",processId:OPTs.PROCESS_BUSQUEDADESCARTE,activityId:OPTs.ACT_NONE}}):null]}),/*#__PURE__*/_jsx(FormGoogle,{searchGoogleTerms:searchGoogleTerms,isOpen:displayModalGoogle,toggle:function toggle(){toggleGoogleModal();}}),/*#__PURE__*/_jsx(ModalCloseOptions,{onSaveProcess:onSaveProcess,isOpen:displayModalCloseOptions,toggle:function toggle(){toggleModalCloseOptions();}}),/*#__PURE__*/_jsx(ModalAdvanceOptions,{onSaveAdvanceProcess:onSaveAdvanceProcess,isOpen:displayModalAdvanceOptions,toggle:function toggle(){toggleModalAdvanceOptions();}}),/*#__PURE__*/_jsx(ModalEndProcess,{onSaveEndProcess:onSaveEndProcess,isOpen:displayModalEndProcess,toggle:function toggle(){toggleModalEndProcess();}}),successSave_dlg?/*#__PURE__*/_jsx(SweetAlert,{success:true,title:props.t(\"SuccessDialog\"),onConfirm:function onConfirm(){setsuccessSave_dlg(false);history.push(url.URL_DASHBOARD);},children:props.t(\"SuccessSaveMessage\")}):null,error_dlg?/*#__PURE__*/_jsx(SweetAlert,{error:true,title:props.t(\"ErrorDialog\"),onConfirm:function onConfirm(){seterror_dlg(false);},children:error_msg}):null,info_dlg?/*#__PURE__*/_jsx(SweetAlert,{info:true,title:props.t(\"SuccessDialog\"),onConfirm:function onConfirm(){setinfo_dlg(false);},children:info_msg}):null]})});};export default withTranslation()(BandejaEntrada);","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/pages/CommercialCredit/3_Cumplimiento/BusquedaCoincidencia/index.js"],"names":["React","useState","useLocation","useHistory","LoadingOverlay","OPTs","url","Row","Col","Card","CardBody","Label","CardFooter","Button","AvForm","AvField","Link","Breadcrumbs","withTranslation","SweetAlert","FormBusqueda","FormResultados","FormObservaciones","FormGoogle","ModalCloseOptions","ModalAdvanceOptions","LogProcess","ModalEndProcess","AttachmentFileCore","BackendServices","CoreServices","BpmServices","BusquedaDescarteModel","BandejaEntrada","props","history","location","data","locationData","setLocationData","undefined","selectedData","setSelectedData","dataList","setDataList","displayModalGoogle","setDisplayModalGoogle","searchGoogleTerms","setSearchGoogleTerms","displayModalCloseOptions","setDisplayModalCloseOptions","displayModalAdvanceOptions","setDisplayModalAdvanceOptions","displayModalEndProcess","setDisplayModalEndProcess","isActiveLoading","setIsActiveLoading","successSave_dlg","setsuccessSave_dlg","error_dlg","seterror_dlg","error_msg","seterror_msg","info_dlg","setinfo_dlg","info_msg","setinfo_msg","useEffect","initializeData","InputData","taskStatus","apiBpmServices","startedStatusTask","taskId","then","iniresult","push","URL_DASHBOARD","apiBackendServices","consultarBusquedaDescarte","transactionId","UpdateDataModel","getRequestModel","catch","error","console","searchWhatchList","values","apiCoreServices","postWhatchList","status","result","length","t","errorCode","finally","removeBodyCss","document","body","classList","add","onGoogleSearch","q","toggleGoogleModal","toggleModalCloseOptions","toggleModalAdvanceOptions","toggleModalEndProcess","onSaveProcess","option","OPT_PREFINALIZARPROCESO","instanceId","customerId","responsible","guardarUsuarioProspecto","userData","transactId","compliance","OPT_ENVIARCUMPLIMIENTO","guardarBusquedaDescarte","descarteData","OPT_LISTAEXCLUSION","guardarCumplimiento","saveJBPMProcess","OPT_FINALIZARPROCESO","abortProcess","OPT_SALVAPARCIAL","PROCESS_CUMPLIMIENTO","toString","ACT_NONE","updatevariables","PROCESS_LISTAEXCLUSION","log","completedStatusTask","onSaveEndProcess","endProcessComment","txtComment","onSaveAdvanceProcess","observationsComp","onScreenOption","processId","PROCESS_BUSQUEDADESCARTE","activityId","textAlign","margin","clientId","customerName"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\"\r\nimport PropTypes from 'prop-types';\r\nimport { useLocation, useHistory } from 'react-router-dom'\r\nimport LoadingOverlay from 'react-loading-overlay';\r\nimport * as OPTs from \"../../../../helpers/options_helper\"\r\nimport * as url from \"../../../../helpers/url_helper\"\r\n\r\nimport {\r\n  Row,\r\n  Col,\r\n  Card,\r\n  CardBody,\r\n  Label,\r\n  CardFooter,\r\n  Button\r\n} from \"reactstrap\"\r\n\r\nimport { AvForm, AvField } from \"availity-reactstrap-validation\"\r\n\r\n\r\nimport { Link } from \"react-router-dom\"\r\n\r\n//Import Breadcrumb\r\nimport Breadcrumbs from \"../../../../components/Common/Breadcrumb\"\r\n\r\n//i18n\r\nimport { withTranslation } from \"react-i18next\"\r\n//Import SweetAlert\r\nimport SweetAlert from \"react-bootstrap-sweetalert\"\r\n\r\nimport FormBusqueda from \"./FormBusqueda\"\r\nimport FormResultados from \"./FormResultados\"\r\nimport FormObservaciones from \"./FormObservaciones\"\r\nimport FormGoogle from \"./FormGoogle\"\r\nimport ModalCloseOptions from \"./ModalCloseOptions\"\r\nimport ModalAdvanceOptions from \"./ModalAdvanceOptions\"\r\nimport LogProcess from \"../../../../components/LogProcess/index\";\r\nimport ModalEndProcess from \"../../../../components/EndProcess/ModalEndProcess\";\r\nimport AttachmentFileCore from \"../../../../components/Common/AttachmentFileCore\";\r\n\r\nimport {BackendServices,CoreServices,BpmServices,} from \"../../../../services\";\r\nimport { BusquedaDescarteModel } from \"../../../../models\";\r\n\r\nconst BandejaEntrada = props => {\r\n\r\n  const history = useHistory();\r\n  const location = useLocation()\r\n\r\n  //Data que recibimos en el location\r\n  const [locationData, setLocationData] = useState(location.data);  \r\n  //Entidad Busqueda y Descarte\r\n  const [selectedData, setSelectedData] = useState(undefined);  \r\n  //Resultado de Lista Negra\r\n  const [dataList, setDataList] = useState([]);\r\n\r\n  const [displayModalGoogle, setDisplayModalGoogle] = useState(false);\r\n  const [searchGoogleTerms, setSearchGoogleTerms] = useState([]);\r\n  const [displayModalCloseOptions, setDisplayModalCloseOptions] = useState(false);\r\n  const [displayModalAdvanceOptions, setDisplayModalAdvanceOptions] = useState(false);\r\n  const [displayModalEndProcess, setDisplayModalEndProcess] = useState(false);\r\n  const [isActiveLoading, setIsActiveLoading] = useState(false);\r\n  const [successSave_dlg, setsuccessSave_dlg] = useState(false);  \r\n  const [error_dlg, seterror_dlg] = useState(false);\r\n  const [error_msg, seterror_msg] = useState(\"\");\r\n  const [info_dlg, setinfo_dlg] = useState(false)\r\n  const [info_msg, setinfo_msg] = useState(\"\")\r\n\r\n  //On Mounting (componentDidMount)\r\n  React.useEffect(() => {\r\n    setLocationData(location.data);\r\n\r\n    initializeData(location.data);    \r\n  }, []);\r\n\r\n  //Caraga Inicial\r\n  function initializeData(InputData) {            \r\n        \r\n    if(InputData!==undefined && InputData!== null){\r\n      \r\n      //chequear si la tarea no ha sido iniciada\r\n      if(InputData.taskStatus === \"Ready\"){        \r\n        const apiBpmServices = new BpmServices();\r\n        //Iniciamos la nueva tarea en BPM   \r\n        apiBpmServices.startedStatusTask(InputData.taskId)\r\n        .then((iniresult) => {                       \r\n          if(iniresult===undefined){\r\n            history.push(url.URL_DASHBOARD);\r\n          }                \r\n        })\r\n      }\r\n\r\n      const apiBackendServices = new BackendServices();\r\n      // Buscar en BD los datos de esta actividad\r\n      //var parameters = {processId:InputData.instanceId,transactId:InputData.transactionId,activityId:InputData.activityId}   \r\n      apiBackendServices.consultarBusquedaDescarte(InputData.transactionId)\r\n        .then((data) => {\r\n          if(data!== null && data !==undefined){\r\n            UpdateDataModel(data);\r\n          }\r\n          else{\r\n            //Nuevo Proceso            \r\n            data = BusquedaDescarteModel.getRequestModel();\r\n            UpdateDataModel(data);        \r\n          }\r\n      })\r\n      .catch((error) => {    \r\n        console.error('api error: ', error);\r\n      });\r\n    }    \r\n    else{      \r\n      history.push(url.URL_DASHBOARD);      \r\n    }\r\n  }\r\n\r\n  function searchWhatchList(values) {\r\n    \r\n    setIsActiveLoading(true);\r\n    const apiCoreServices = new CoreServices()\r\n    apiCoreServices.postWhatchList(values)\r\n      .then((data) => {\r\n\r\n        if(data.status === 200){\r\n\r\n          if(data.result.length > 0){\r\n            setDataList(data.result);            \r\n          }\r\n          else{\r\n            setinfo_msg(props.t('NoResults'));\r\n            setinfo_dlg(true)\r\n          }\r\n        }\r\n        else{\r\n          seterror_msg(props.t('ErrorCode')+\": \" + data.error.errorCode + \"  \" +props.t('ErrorMsg')+\": \" + data.error.errorCode);\r\n          seterror_dlg(true)\r\n        }\r\n\r\n      })\r\n      .catch((error) => {\r\n\r\n        console.error('Error fetching documents', error);\r\n\r\n      }).finally (() => {\r\n\r\n        setIsActiveLoading(false);\r\n\r\n      })\r\n  }\r\n  \r\n\r\n  function removeBodyCss() {\r\n    document.body.classList.add(\"no_padding\")\r\n  }\r\n\r\n  function onGoogleSearch(q) {\r\n    setSearchGoogleTerms(q);\r\n    setDisplayModalGoogle(!displayModalGoogle);\r\n    removeBodyCss();\r\n  }\r\n\r\n  function toggleGoogleModal() {\r\n    setDisplayModalGoogle(!displayModalGoogle);\r\n  }\r\n\r\n  //Modal Opciones al Salir\r\n  function toggleModalCloseOptions() {\r\n    setDisplayModalCloseOptions(!displayModalCloseOptions);\r\n  }\r\n\r\n  //Modal Para mostrar las opciones al Avanzar\r\n  function toggleModalAdvanceOptions() {\r\n    /* ---------------------------------------------------------------------------------------------- */\r\n    /*                             Aqui avanzamos al modal de descripcion                             */\r\n    /* ---------------------------------------------------------------------------------------------- */\r\n    setDisplayModalAdvanceOptions(!displayModalAdvanceOptions);\r\n  }\r\n\r\n  //Modal Para mostrar Comentario de Fin de Proceso\r\n  function toggleModalEndProcess() {\r\n    setDisplayModalEndProcess(true);\r\n  }\r\n\r\n  //////////////////////////////////////////////////////////////\r\n  //////////////////////////////////////////////////////////////\r\n\r\n  //Salvando el Proceso y le pasamos una opcion: 1-Finalizar Proceso, 2- Salvarlo, 3- A Cumplimmineto, 4- Avanzar a IGR\r\n  function onSaveProcess(option){\r\n    \r\n    if(option === OPTs.OPT_PREFINALIZARPROCESO){\r\n      toggleModalEndProcess();\r\n      return;\r\n    }\r\n    \r\n    selectedData.instanceId = locationData.instanceId !== null && locationData.instanceId !== undefined? locationData.instanceId:selectedData.instanceId;\r\n    selectedData.customerId = locationData.customerId !== null && locationData.customerId !== undefined? locationData.customerId:selectedData.customerId;\r\n    selectedData.responsible = \"admin\";\r\n\r\n    const apiBackendServices = new BackendServices();        \r\n    //Guardar el usuario prospecto    \r\n    apiBackendServices.guardarUsuarioProspecto(selectedData)\r\n    .then((userData) => {\r\n      \r\n      if(userData!==undefined){\r\n        selectedData.transactId = userData.transactId !== null && userData.transactId !== undefined? userData.transactId:selectedData.transactId;\r\n        selectedData.customerId = userData.customerId !== null && userData.customerId !== undefined? userData.customerId:selectedData.customerId;\r\n        selectedData.compliance = option === OPTs.OPT_ENVIARCUMPLIMIENTO?true:false;\r\n\r\n        UpdateDataModel(selectedData);\r\n        \r\n        //Guardar busqueda y descarte\r\n        apiBackendServices.guardarBusquedaDescarte(selectedData)\r\n          .then((descarteData) => {\r\n            if(descarteData!==undefined){\r\n              \r\n              if(option === OPTs.OPT_LISTAEXCLUSION){\r\n                //Guardar Cumplimiento\r\n                apiBackendServices.guardarCumplimiento(selectedData)\r\n                  .then((descarteData) => {\r\n                    if(descarteData!==undefined){          \r\n                      saveJBPMProcess(option);\r\n                    }\r\n                    else{\r\n                      //Mensaje ERROR\r\n                      seterror_msg(props.t(\"ErrorSaveMessage\"))\r\n                      seterror_dlg(true)\r\n                    }\r\n                  });\r\n                }\r\n                else{\r\n                  saveJBPMProcess(option);\r\n                }              \r\n            }\r\n            else{\r\n              //Mensaje ERROR\r\n              seterror_msg(props.t(\"ErrorSaveMessage\"))\r\n              seterror_dlg(true)\r\n            }\r\n        });\r\n      }\r\n      else{\r\n        //Mensaje ERROR\r\n        seterror_msg(props.t(\"ErrorSaveMessage\"))\r\n        seterror_dlg(true)\r\n      }\r\n    })\r\n    .catch((error) => {    \r\n      console.error('api error: ', error);\r\n    }); \r\n  }\r\n\r\n  function saveJBPMProcess(option){    \r\n    \r\n    const apiBpmServices = new BpmServices();\r\n\r\n    switch(option){\r\n      case OPTs.OPT_FINALIZARPROCESO: {\r\n        \r\n        apiBpmServices.abortProcess(locationData.instanceId)\r\n          .then((data) => {\r\n            if(data!==undefined){              \r\n              history.push(url.URL_DASHBOARD);            }\r\n            else{\r\n              //Mensaje ERROR\r\n              seterror_msg(props.t(\"TheProcessCouldNotFinish\"))\r\n              seterror_dlg(true)\r\n            }\r\n        });\r\n        break;\r\n      }\r\n      case OPTs.OPT_SALVAPARCIAL: {\r\n        var values = {\r\n          \"processId\":OPTs.PROCESS_CUMPLIMIENTO.toString(),\r\n          \"activityId\":OPTs.ACT_NONE.toString(),                    \r\n          \"transactionId\":selectedData.transactId.toString(),\r\n          \"customerId\":selectedData.customerId.toString(),                      \r\n          \"applicationNumber\":\"\",\r\n          \"procedureNumber\":\"\" ,\r\n          //\"decision\":\"no\"          \r\n      };\r\n        apiBpmServices.updatevariables(locationData.instanceId,values)\r\n          .then((data) => {\r\n            if(data!==undefined){              \r\n              setsuccessSave_dlg(true);    \r\n            }\r\n            else{\r\n              //Mensaje ERROR\r\n              seterror_msg(props.t(\"ErrorSaveMessage\"))\r\n              seterror_dlg(true)\r\n            }\r\n        });\r\n\r\n        break;\r\n      }\r\n      case OPTs.OPT_LISTAEXCLUSION: {\r\n\r\n        var values = {\r\n          \"processId\":OPTs.PROCESS_LISTAEXCLUSION.toString(),\r\n          \"activityId\":OPTs.ACT_NONE.toString(),                    \r\n          \"transactionId\":selectedData.transactId.toString(),\r\n          \"customerId\":selectedData.customerId.toString(),                      \r\n          \"applicationNumber\":\"\",\r\n          \"procedureNumber\":\"\" ,\r\n          \"decision\":\"si\"          \r\n      };\r\n      console.log(\"saveJBPMProcess value\",values,locationData.taskId);\r\n        apiBpmServices.completedStatusTask(locationData.taskId,values)\r\n          .then((data) => {\r\n            if(data!==undefined){              \r\n              setsuccessSave_dlg(true);    \r\n            }\r\n            else{\r\n              //Mensaje ERROR\r\n              seterror_msg(props.t(\"ErrorSaveMessage\"))\r\n              seterror_dlg(true)\r\n            }\r\n        });\r\n        break;\r\n      }      \r\n    }\r\n  }\r\n\r\n  //salvar comentario de end process\r\n  function onSaveEndProcess(values){\r\n    \r\n    //Salvar los comentarios en Bitacora    \r\n    selectedData.endProcessComment = values.txtComment;\r\n\r\n    UpdateDataModel(selectedData);\r\n\r\n    onSaveProcess(OPTs.OPT_FINALIZARPROCESO);\r\n  }\r\n\r\n  //salvar comentario de end process\r\n  function onSaveAdvanceProcess(values){\r\n    \r\n    //Salvar los comentarios en Bitacora    \r\n    selectedData.observationsComp = values.txtComment;\r\n\r\n    UpdateDataModel(selectedData);\r\n\r\n    onSaveProcess(OPTs.OPT_LISTAEXCLUSION);\r\n  }\r\n\r\n  //Actualizamos El Modelo de Datos segun va cambiando\r\n  function UpdateDataModel(data) {\r\n    setSelectedData(data);                  \r\n  }\r\n  \r\n  return (\r\n    <React.Fragment>\r\n      <div className=\"page-content\">\r\n\r\n        <Breadcrumbs title={props.t(\"CommercialCredit\")} breadcrumbItem={props.t(\"Compliance\")} />\r\n\r\n        <LoadingOverlay active={isActiveLoading} spinner text={props.t(\"WaitingPlease\")}>\r\n\r\n          <Card>\r\n            <CardBody>\r\n\r\n              <FormBusqueda onSubmit={searchWhatchList} onGoogleSearch={onGoogleSearch} selectedData={selectedData} updateDataModel={UpdateDataModel} />\r\n\r\n              {dataList.length > 0 && (\r\n                <FormResultados results={dataList} onScreenOption={props.onScreenOption} />\r\n              )}\r\n\r\n              <FormObservaciones selectedData={selectedData} updateDataModel={UpdateDataModel} />\r\n\r\n              { \r\n            (locationData!==undefined)?\r\n            (<AttachmentFileCore locationData={{instanceId:locationData.instanceId,processId:OPTs.PROCESS_BUSQUEDADESCARTE,activityId:OPTs.ACT_NONE}} />)\r\n            :null\r\n          }\r\n            </CardBody>\r\n\r\n            <CardFooter style={{ textAlign: \"right\" }}>\r\n              <Button color=\"danger\" type=\"button\" style={{ margin: '5px' }} onClick={() => { toggleModalCloseOptions() }}><i className=\"mdi mdi-arrow-left-bold-circle-outline mid-12px\"></i> {props.t(\"Exit\")}</Button>\r\n              <Button color=\"success\" type=\"button\" style={{ margin: '5px' }} onClick={() => { toggleModalAdvanceOptions() }}><i className=\"mdi mdi-arrow-right-bold-circle-outline mid-12px\"></i> {props.t(\"Advance\")}</Button>\r\n            </CardFooter>\r\n\r\n          </Card>\r\n\r\n\r\n          { (locationData!==undefined && locationData.customerId!==null && locationData.customerId!==undefined && locationData.customerId.length > 0)?\r\n        (<LogProcess locationData={{instanceId:locationData.instanceId,transactId: locationData.transactionId,clientId: locationData.customerId,\r\n          customerName:\"admin\",processId:OPTs.PROCESS_BUSQUEDADESCARTE,activityId:OPTs.ACT_NONE}}/>)\r\n        :null}\r\n        \r\n        </LoadingOverlay>\r\n\r\n\r\n        <FormGoogle searchGoogleTerms={ searchGoogleTerms } isOpen={ displayModalGoogle } toggle={ () => { toggleGoogleModal() } } />\r\n\r\n        <ModalCloseOptions onSaveProcess={ onSaveProcess } isOpen={ displayModalCloseOptions } toggle={ () => { toggleModalCloseOptions() } } />\r\n\r\n        <ModalAdvanceOptions onSaveAdvanceProcess={ onSaveAdvanceProcess } isOpen={ displayModalAdvanceOptions } toggle={ () => { toggleModalAdvanceOptions() } } />\r\n\r\n        <ModalEndProcess onSaveEndProcess={ onSaveEndProcess } isOpen={ displayModalEndProcess } toggle={ () => { toggleModalEndProcess() } } />     \r\n\r\n\r\n\r\n{successSave_dlg ? (\r\n    <SweetAlert\r\n      success\r\n      title={props.t(\"SuccessDialog\")}\r\n      onConfirm={() => {\r\n        setsuccessSave_dlg(false)\r\n        \r\n        history.push(url.URL_DASHBOARD);\r\n      }}\r\n    >\r\n      {props.t(\"SuccessSaveMessage\")}\r\n    </SweetAlert>\r\n  ) : null}\r\n\r\n  {error_dlg ? (\r\n    <SweetAlert\r\n      error\r\n      title={props.t(\"ErrorDialog\")}\r\n      onConfirm={() => {\r\n        seterror_dlg(false)\r\n      }}\r\n    >\r\n      {error_msg}\r\n    </SweetAlert>\r\n  ) : null}\r\n\r\n\r\n{info_dlg ? (\r\n            <SweetAlert\r\n              info\r\n              title={props.t(\"SuccessDialog\")}\r\n              onConfirm={() => {\r\n                setinfo_dlg(false)\r\n              }}\r\n            >\r\n              {info_msg}\r\n            </SweetAlert>\r\n          ) : null}\r\n\r\n      </div>\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\n\r\nexport default (withTranslation()(BandejaEntrada))\r\n"]},"metadata":{},"sourceType":"module"}