{"ast":null,"code":"import _createForOfIteratorHelper from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _regeneratorRuntime from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import{BackendServices,CoreServices}from\"../services\";var backendServices=new BackendServices();var coreServices=new CoreServices();var AutoSaveData=/*#__PURE__*/function(){function AutoSaveData(){_classCallCheck(this,AutoSaveData);}_createClass(AutoSaveData,[{key:\"saveInitialData\",value://salvamos deudas de un tramite\nfunction(){var _saveInitialData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(transactionId){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:this.saveDebts(transactionId);this.saveAccountMovements(transactionId);this.saveCorporateExhibition(transactionId);this.saveCorporateExhibitionByClients(transactionId);this.saveFacilities(transactionId);case 5:case\"end\":return _context.stop();}}},_callee,this);}));function saveInitialData(_x){return _saveInitialData.apply(this,arguments);}return saveInitialData;}()//salvamos exposicion por tramite\n},{key:\"saveCorporateExhibition\",value:function(){var _saveCorporateExhibition=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(transactionId){var dataResult,i,datoSent;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return backendServices.getExposicionCorporativaBD(transactionId);case 3:dataResult=_context2.sent;if(!(dataResult!==undefined&&dataResult!==null&&dataResult.length>0)){_context2.next=6;break;}return _context2.abrupt(\"return\");case 6:_context2.next=8;return coreServices.getCorporateExhibition(transactionId);case 8:dataResult=_context2.sent;i=0;case 10:if(!(i<dataResult.length)){_context2.next=17;break;}datoSent={\"transactId\":Number(transactionId),//\"accountNumber\": data.name,\n//\"t24ClientId\": data.customerNumberT24,\n\"description\":dataResult[i].name,\"approved\":dataResult[i].approved,\"currentBalance\":dataResult[i].balance,\"proposed\":dataResult[i].proposal,\"ltv\":0,\"difference\":dataResult[i].variation,\"guarantee\":0};_context2.next=14;return backendServices.saveExposicionCorporativaBD(datoSent);case 14:i++;_context2.next=10;break;case 17:_context2.next=21;break;case 19:_context2.prev=19;_context2.t0=_context2[\"catch\"](0);case 21:case\"end\":return _context2.stop();}}},_callee2,null,[[0,19]]);}));function saveCorporateExhibition(_x2){return _saveCorporateExhibition.apply(this,arguments);}return saveCorporateExhibition;}()//salvamos exposicion por tramite\n},{key:\"saveCorporateExhibitionByClients\",value:function(){var _saveCorporateExhibitionByClients=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(transactionId){var dataResult,debtors,i,partyId,debtorName,p,datoSent;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return backendServices.getExposicionCorporativaClienteBD(transactionId);case 3:dataResult=_context3.sent;if(!(dataResult!==undefined&&dataResult!==null&&dataResult.length>0)){_context3.next=6;break;}return _context3.abrupt(\"return\");case 6:_context3.next=8;return backendServices.consultarDeudores(transactionId);case 8:debtors=_context3.sent;if(!(debtors===null||debtors===undefined)){_context3.next=11;break;}return _context3.abrupt(\"return\",undefined);case 11:console.log(\"debtors\",debtors);i=0;case 13:if(!(i<debtors.length)){_context3.next=31;break;}partyId=debtors[i].customerNumberT24;debtorName=debtors[i]!==undefined?debtors[i].typePerson==\"2\"?debtors[i].name:debtors[i].name+\" \"+debtors[i].name2+\" \"+debtors[i].lastName+\" \"+debtors[i].lastName2:\"\";_context3.next=18;return coreServices.getCorporateExhibitionByClients(partyId);case 18:dataResult=_context3.sent;p=0;case 20:if(!(p<dataResult.length)){_context3.next=28;break;}datoSent={\"transactId\":Number(transactionId),\"accountNumber\":debtorName,\"t24ClientId\":partyId,\"description\":dataResult[p].name,\"approved\":dataResult[p].approved,\"currentBalance\":dataResult[p].balance,\"proposed\":dataResult[p].proposal,\"ltv\":0,\"difference\":dataResult[p].variation,\"guarantee\":0};console.log(\"saveCorporateExhibitionByClients\",datoSent);_context3.next=25;return backendServices.saveExposicionCorporativaClienteBD(datoSent);case 25:p++;_context3.next=20;break;case 28:i++;_context3.next=13;break;case 31:_context3.next=35;break;case 33:_context3.prev=33;_context3.t0=_context3[\"catch\"](0);case 35:case\"end\":return _context3.stop();}}},_callee3,null,[[0,33]]);}));function saveCorporateExhibitionByClients(_x3){return _saveCorporateExhibitionByClients.apply(this,arguments);}return saveCorporateExhibitionByClients;}()//salvamos facilidades por tramite\n},{key:\"saveFacilities\",value:function(){var _saveFacilities=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(transactionId){var request,dataResult,i,_dataResult$i$facilit,_request$0$requestId,datoSent;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return backendServices.consultGeneralDataPropCred(transactionId);case 3:request=_context4.sent;console.log(request);_context4.next=7;return backendServices.consultarFacilidadesT24(request[0].requestId);case 7:dataResult=_context4.sent;if(!(dataResult!==undefined&&dataResult!==null&&dataResult.length>0)){_context4.next=10;break;}return _context4.abrupt(\"return\");case 10:_context4.next=12;return coreServices.getFacilitiesByTransaction(transactionId);case 12:dataResult=_context4.sent;i=0;case 14:if(!(i<dataResult.length)){_context4.next=21;break;}datoSent={\"facilityNumber\":dataResult[i].AcctId,\"cr\":dataResult[i].AcctId,\"amount\":dataResult[i].approvedAmount,\"debtor\":dataResult[i].debtorName,\"clientTypeId\":dataResult[i].debtorId,\"balance\":dataResult[i].actualBalance,\"purpose\":\"\",\"sublimits\":\"\",\"proposalRate\":0,\"noSubsidyRate\":0,\"effectiveRate\":0,\"feci\":false,\"termDays\":0,\"termDescription\":\"\",\"ltv\":0,\"finantialConditions\":\" \",\"environmentRiskCategory\":0,\"covenant\":\" \",\"environmentRiskOpinion\":\" \",\"finantialCovenant\":\" \",\"legalDocumentation\":\"  \",\"otherConditions\":\" \",\"creditRiskOpinion\":\" \",\"provision\":\" \",\"proposalTypeId\":\"\",\"proposalTypeName\":\"\",\"facilityTypeId\":(_dataResult$i$facilit=dataResult[i].facilityType)!==null&&_dataResult$i$facilit!==void 0?_dataResult$i$facilit:\"\",\"termType\":\"\",\"origin\":\"CORE\",\"applyEscrow\":false,\"facilityId\":0,\"requestId\":(_request$0$requestId=request[0].requestId)!==null&&_request$0$requestId!==void 0?_request$0$requestId:\"\",\"startingAmount\":0,\"term\":\"\"};_context4.next=18;return backendServices.newFacilityPropCred(datoSent);case 18:i++;_context4.next=14;break;case 21:_context4.next=25;break;case 23:_context4.prev=23;_context4.t0=_context4[\"catch\"](0);case 25:case\"end\":return _context4.stop();}}},_callee4,null,[[0,23]]);}));function saveFacilities(_x4){return _saveFacilities.apply(this,arguments);}return saveFacilities;}()//salvamos deudas a Corto y largo Plazo\n},{key:\"saveDebts\",value:function(){var _saveDebts=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(transactionId){var checkCP,checkLP,dataResult,_iterator,_step,short,dat,_iterator2,_step2,long,dat1;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;checkCP=false;checkLP=false;_context5.next=5;return backendServices.consultBankingRelationsDebtsCP(transactionId);case 5:dataResult=_context5.sent;if(dataResult!==undefined&&dataResult!==null&&dataResult.getBankingRelationCPDTOList.length>0){}else{checkCP=true;}_context5.next=9;return backendServices.consultBankRelationsDebtsLP(transactionId);case 9:dataResult=_context5.sent;if(dataResult!==undefined&&dataResult!==null&&dataResult.bankingRelationLPDTOList.length>0){}else{checkLP=true;}if(!(!checkCP&&!checkLP)){_context5.next=13;break;}return _context5.abrupt(\"return\");case 13:_context5.next=15;return coreServices.getAllTermDebtsByTransaction(transactionId);case 15:dataResult=_context5.sent;if(!checkCP){_context5.next=36;break;}_iterator=_createForOfIteratorHelper(dataResult.shortTermresult);_context5.prev=18;_iterator.s();case 20:if((_step=_iterator.n()).done){_context5.next=28;break;}short=_step.value;console.log(\"shortTermresult\",short);dat={\"facilityType\":short.facilityType,\"amount\":Number(short.approvedAmount.toFixed(2)),\"date\":short.startDate,\"expirationDate\":short.endDate,\"debitBalance1\":Number(short.balance.toFixed(2)),\"debitBalance2\":0,\"debitBalance3\":0,\"paymentHistory\":short.paymentHistory,\"rate\":0,\"fee\":0,\"bail\":0,\"fundDestiny\":\"\",status:true,\"bank\":short.bank,\"transactId\":Number(transactionId)};_context5.next=26;return backendServices.newBankingRelationsDebtsCP(dat);case 26:_context5.next=20;break;case 28:_context5.next=33;break;case 30:_context5.prev=30;_context5.t0=_context5[\"catch\"](18);_iterator.e(_context5.t0);case 33:_context5.prev=33;_iterator.f();return _context5.finish(33);case 36:if(!checkLP){_context5.next=55;break;}_iterator2=_createForOfIteratorHelper(dataResult.longTermresult);_context5.prev=38;_iterator2.s();case 40:if((_step2=_iterator2.n()).done){_context5.next=47;break;}long=_step2.value;dat1={\"transactId\":Number(transactionId),\"bank\":long.bank,\"facilityType\":long.facilityType,\"amount\":Number(long.approvedAmount.toFixed(2)),\"date\":long.startDate,\"expirationDate\":long.endDate,\"debitBalance1\":Number(long.balance.toFixed(2)),\"debitBalance2\":0,\"debitBalance3\":0,\"paymentHistory\":long.paymentHistory,\"rate\":0,\"fee\":0,\"bail\":\" \",\"fundDestiny\":\" \",status:true};_context5.next=45;return backendServices.newBankingRelationsDebtsLP(dat1);case 45:_context5.next=40;break;case 47:_context5.next=52;break;case 49:_context5.prev=49;_context5.t1=_context5[\"catch\"](38);_iterator2.e(_context5.t1);case 52:_context5.prev=52;_iterator2.f();return _context5.finish(52);case 55:_context5.next=60;break;case 57:_context5.prev=57;_context5.t2=_context5[\"catch\"](0);console.error(\"newBankingRelationsDebts\",_context5.t2);case 60:case\"end\":return _context5.stop();}}},_callee5,null,[[0,57],[18,30,33,36],[38,49,52,55]]);}));function saveDebts(_x5){return _saveDebts.apply(this,arguments);}return saveDebts;}()//salvamos facilidades por tramite\n},{key:\"saveAccountMovements\",value:function(){var _saveAccountMovements=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(transactionId){var dataResult,i,cuenta,j,k,jsonSet;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.prev=0;_context6.next=3;return backendServices.consultMovementsBank(transactionId);case 3:dataResult=_context6.sent;if(!(dataResult!==undefined&&dataResult!==null&&(dataResult.bankBanesco.length>0||dataResult.bankOthersBank.length>0))){_context6.next=6;break;}return _context6.abrupt(\"return\");case 6:_context6.next=8;return coreServices.getAccountMovementsByTransaction(transactionId);case 8:dataResult=_context6.sent;i=0;case 10:if(!(i<dataResult.length)){_context6.next=29;break;}//aqui cargamos por cuentas\ncuenta=dataResult[i].AcctId;j=0;case 13:if(!(j<dataResult[i].dataByYear.length)){_context6.next=26;break;}console.log(\"data[i].dataByYear\",dataResult[i].dataByYear);k=0;case 16:if(!(k<dataResult[i].dataByYear[j].dataresult.length)){_context6.next=23;break;}jsonSet={\"trasactId\":Number(transactionId),\"year\":dataResult[i].dataByYear[j].dataresult[k].year,\"month\":dataResult[i].dataByYear[j].dataresult[k].month,\"deposits\":dataResult[i].dataByYear[j].dataresult[k].deposits,\"averageBalance\":dataResult[i].dataByYear[j].dataresult[k].amount,\"observations\":\"\",\"accountNumber\":cuenta,\"t24\":true};_context6.next=20;return backendServices.newMovementsAccountsIGR(jsonSet);case 20:k++;_context6.next=16;break;case 23:j++;_context6.next=13;break;case 26:i++;_context6.next=10;break;case 29:_context6.next=33;break;case 31:_context6.prev=31;_context6.t0=_context6[\"catch\"](0);case 33:case\"end\":return _context6.stop();}}},_callee6,null,[[0,31]]);}));function saveAccountMovements(_x6){return _saveAccountMovements.apply(this,arguments);}return saveAccountMovements;}()}]);return AutoSaveData;}();export{AutoSaveData as default};","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/helpers/AutoSaveData.js"],"names":["BackendServices","CoreServices","backendServices","coreServices","AutoSaveData","transactionId","saveDebts","saveAccountMovements","saveCorporateExhibition","saveCorporateExhibitionByClients","saveFacilities","getExposicionCorporativaBD","dataResult","undefined","length","getCorporateExhibition","i","datoSent","Number","name","approved","balance","proposal","variation","saveExposicionCorporativaBD","getExposicionCorporativaClienteBD","consultarDeudores","debtors","console","log","partyId","customerNumberT24","debtorName","typePerson","name2","lastName","lastName2","getCorporateExhibitionByClients","p","saveExposicionCorporativaClienteBD","consultGeneralDataPropCred","request","consultarFacilidadesT24","requestId","getFacilitiesByTransaction","AcctId","approvedAmount","debtorId","actualBalance","facilityType","newFacilityPropCred","checkCP","checkLP","consultBankingRelationsDebtsCP","getBankingRelationCPDTOList","consultBankRelationsDebtsLP","bankingRelationLPDTOList","getAllTermDebtsByTransaction","shortTermresult","short","dat","toFixed","startDate","endDate","paymentHistory","status","bank","newBankingRelationsDebtsCP","longTermresult","long","dat1","newBankingRelationsDebtsLP","error","consultMovementsBank","bankBanesco","bankOthersBank","getAccountMovementsByTransaction","cuenta","j","dataByYear","k","dataresult","jsonSet","year","month","deposits","amount","newMovementsAccountsIGR"],"mappings":"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","sourcesContent":["\r\nimport { BackendServices, CoreServices } from \"../services\";\r\n\r\nconst backendServices = new BackendServices();\r\nconst coreServices = new CoreServices();\r\n\r\nexport default class AutoSaveData {\r\n\r\n\r\n  //salvamos deudas de un tramite\r\n  async saveInitialData(transactionId) {\r\n    this.saveDebts(transactionId);\r\n    this.saveAccountMovements(transactionId);\r\n    this.saveCorporateExhibition(transactionId);\r\n    this.saveCorporateExhibitionByClients(transactionId);\r\n    this.saveFacilities(transactionId);\r\n  }\r\n\r\n  //salvamos exposicion por tramite\r\n  async saveCorporateExhibition(transactionId) {\r\n    try {\r\n\r\n      var dataResult = await backendServices.getExposicionCorporativaBD(transactionId);\r\n      if (dataResult !== undefined && dataResult !== null && dataResult.length > 0) {\r\n        return;\r\n      }\r\n\r\n      dataResult = await coreServices.getCorporateExhibition(transactionId)\r\n      for (let i = 0; i < dataResult.length; i++) {\r\n        let datoSent = {\r\n          \"transactId\": Number(transactionId),\r\n          //\"accountNumber\": data.name,\r\n          //\"t24ClientId\": data.customerNumberT24,\r\n          \"description\": dataResult[i].name,\r\n          \"approved\": dataResult[i].approved,\r\n          \"currentBalance\": dataResult[i].balance,\r\n          \"proposed\": dataResult[i].proposal,\r\n          \"ltv\": 0,\r\n          \"difference\": dataResult[i].variation,\r\n          \"guarantee\":0,\r\n        }\r\n        await backendServices.saveExposicionCorporativaBD(datoSent)\r\n      }\r\n    }\r\n    catch (err) { }\r\n  }\r\n\r\n  //salvamos exposicion por tramite\r\n  async saveCorporateExhibitionByClients(transactionId) {\r\n    try {\r\n         \r\n      var dataResult = await backendServices.getExposicionCorporativaClienteBD(transactionId);\r\n         if (dataResult !== undefined && dataResult !== null && dataResult.length > 0) {\r\n          return;\r\n        }\r\n      \r\n      var debtors = await backendServices.consultarDeudores(transactionId);\r\n      if (debtors === null || debtors === undefined) {\r\n            return undefined;\r\n        }\r\n        \r\n        console.log(\"debtors\",debtors);\r\n        \r\n        for (var i = 0; i < debtors.length; i++) {\r\n          var partyId = debtors[i].customerNumberT24;          \r\n          var debtorName = debtors[i] !== undefined ? (debtors[i].typePerson == \"2\" ? debtors[i].name : (debtors[i].name + \" \" + debtors[i].name2 + \" \" + debtors[i].lastName + \" \" + debtors[i].lastName2)) : \"\";\r\n          dataResult = await coreServices.getCorporateExhibitionByClients(partyId)\r\n          for (let p = 0; p < dataResult.length; p++) {\r\n        let datoSent = {\r\n          \"transactId\": Number(transactionId),\r\n          \"accountNumber\": debtorName,\r\n          \"t24ClientId\": partyId,\r\n          \"description\": dataResult[p].name,\r\n          \"approved\": dataResult[p].approved,\r\n          \"currentBalance\": dataResult[p].balance,\r\n          \"proposed\": dataResult[p].proposal,\r\n          \"ltv\": 0,\r\n          \"difference\": dataResult[p].variation,\r\n          \"guarantee\":0,\r\n        }\r\n        console.log(\"saveCorporateExhibitionByClients\",datoSent);\r\n        await backendServices.saveExposicionCorporativaClienteBD(datoSent)\r\n      }\r\n        }\r\n\r\n      \r\n    }\r\n    catch (err) { }\r\n  }\r\n\r\n  //salvamos facilidades por tramite\r\n  async saveFacilities(transactionId) {\r\n    try {\r\n\r\n      var request = await backendServices.consultGeneralDataPropCred(transactionId);\r\n      console.log(request);\r\n      var dataResult = await backendServices.consultarFacilidadesT24(request[0].requestId);\r\n      if (dataResult !== undefined && dataResult !== null && dataResult.length > 0) {\r\n        return;\r\n      }\r\n\r\n      dataResult = await coreServices.getFacilitiesByTransaction(transactionId)\r\n      for (let i = 0; i < dataResult.length; i++) {\r\n        let datoSent = {\r\n          \"facilityNumber\": dataResult[i].AcctId,\r\n          \"cr\": dataResult[i].AcctId,\r\n          \"amount\": dataResult[i].approvedAmount,\r\n          \"debtor\": dataResult[i].debtorName,\r\n          \"clientTypeId\": dataResult[i].debtorId,\r\n          \"balance\": dataResult[i].actualBalance,\r\n          \"purpose\": \"\",\r\n          \"sublimits\": \"\",\r\n          \"proposalRate\": 0,\r\n          \"noSubsidyRate\": 0,\r\n          \"effectiveRate\": 0,\r\n          \"feci\": false,\r\n          \"termDays\": 0,\r\n          \"termDescription\": \"\",\r\n          \"ltv\": 0,\r\n          \"finantialConditions\": \" \",\r\n          \"environmentRiskCategory\": 0,\r\n          \"covenant\": \" \",\r\n          \"environmentRiskOpinion\": \" \",\r\n          \"finantialCovenant\": \" \",\r\n          \"legalDocumentation\": \"  \",\r\n          \"otherConditions\": \" \",\r\n          \"creditRiskOpinion\": \" \",\r\n          \"provision\": \" \",\r\n          \"proposalTypeId\": \"\",\r\n          \"proposalTypeName\": \"\",\r\n          \"facilityTypeId\": dataResult[i].facilityType ?? \"\",\r\n          \"termType\": \"\",\r\n          \"origin\": \"CORE\",\r\n          \"applyEscrow\": false,\r\n          \"facilityId\": 0,\r\n          \"requestId\": request[0].requestId ?? \"\",\r\n          \"startingAmount\": 0,\r\n          \"term\": \"\"\r\n        }\r\n        await backendServices.newFacilityPropCred(datoSent)\r\n      }\r\n    }\r\n    catch (err) { }\r\n  }\r\n\r\n  //salvamos deudas a Corto y largo Plazo\r\n  async saveDebts(transactionId) {\r\n    try {\r\n\r\n      var checkCP = false;\r\n      var checkLP = false;\r\n\r\n      var dataResult = await backendServices.consultBankingRelationsDebtsCP(transactionId);\r\n      if (dataResult !== undefined && dataResult !== null && dataResult.getBankingRelationCPDTOList.length > 0) { }\r\n      else {\r\n        checkCP = true;\r\n      }\r\n      dataResult = await backendServices.consultBankRelationsDebtsLP(transactionId);\r\n      if (dataResult !== undefined && dataResult !== null && dataResult.bankingRelationLPDTOList.length > 0) { }\r\n      else {\r\n        checkLP = true;\r\n      }\r\n\r\n      if (!checkCP && !checkLP) {\r\n        return;\r\n      }\r\n\r\n      dataResult = await coreServices.getAllTermDebtsByTransaction(transactionId);\r\n      \r\n      if (checkCP) {\r\n        for (var short of dataResult.shortTermresult) {\r\n          console.log(\"shortTermresult\",short);\r\n          var dat = {\r\n            \"facilityType\": short.facilityType,\r\n            \"amount\": Number(short.approvedAmount.toFixed(2)),\r\n            \"date\": short.startDate,\r\n            \"expirationDate\": short.endDate,\r\n            \"debitBalance1\": Number(short.balance.toFixed(2)),\r\n            \"debitBalance2\": 0,\r\n            \"debitBalance3\": 0,\r\n            \"paymentHistory\": short.paymentHistory,\r\n            \"rate\": 0,\r\n            \"fee\": 0,\r\n            \"bail\": 0,\r\n            \"fundDestiny\": \"\",\r\n            status: true,\r\n            \"bank\": short.bank,\r\n            \"transactId\": Number(transactionId)\r\n          }\r\n          await backendServices.newBankingRelationsDebtsCP(dat)\r\n        }\r\n      }\r\n\r\n      if (checkLP) {\r\n        for (var long of dataResult.longTermresult) {\r\n          var dat1 = {\r\n            \"transactId\": Number(transactionId),\r\n            \"bank\": long.bank,\r\n            \"facilityType\": long.facilityType,\r\n            \"amount\": Number(long.approvedAmount.toFixed(2)),\r\n            \"date\": long.startDate,\r\n            \"expirationDate\": long.endDate,\r\n            \"debitBalance1\": Number(long.balance.toFixed(2)),\r\n            \"debitBalance2\": 0,\r\n            \"debitBalance3\": 0,\r\n            \"paymentHistory\": long.paymentHistory,\r\n            \"rate\": 0,\r\n            \"fee\": 0,\r\n            \"bail\": \" \",\r\n            \"fundDestiny\": \" \",\r\n            status: true,\r\n          }\r\n          await backendServices.newBankingRelationsDebtsLP(dat1)\r\n        }\r\n      }\r\n\r\n    }\r\n    catch (err) { console.error(\"newBankingRelationsDebts\",err)}\r\n  }\r\n\r\n  //salvamos facilidades por tramite\r\n  async saveAccountMovements(transactionId) {\r\n    try {\r\n\r\n      var dataResult = await backendServices.consultMovementsBank(transactionId);\r\n      \r\n      if (dataResult !== undefined && dataResult !== null && (dataResult.bankBanesco.length > 0 || dataResult.bankOthersBank.length > 0)) {\r\n        return;\r\n      }\r\n\r\n      dataResult = await coreServices.getAccountMovementsByTransaction(transactionId)\r\n      for (let i = 0; i < dataResult.length; i++) {\r\n        //aqui cargamos por cuentas\r\n        let cuenta = dataResult[i].AcctId;\r\n        for (let j = 0; j < dataResult[i].dataByYear.length; j++) {\r\n          console.log(\"data[i].dataByYear\", dataResult[i].dataByYear);\r\n          for (let k = 0; k < dataResult[i].dataByYear[j].dataresult.length; k++) {\r\n            let jsonSet = {\r\n              \"trasactId\": Number(transactionId),\r\n              \"year\": dataResult[i].dataByYear[j].dataresult[k].year,\r\n              \"month\": dataResult[i].dataByYear[j].dataresult[k].month,\r\n              \"deposits\": dataResult[i].dataByYear[j].dataresult[k].deposits,\r\n              \"averageBalance\": dataResult[i].dataByYear[j].dataresult[k].amount,\r\n              \"observations\": \"\",\r\n              \"accountNumber\": cuenta,\r\n              \"t24\": true\r\n            }\r\n            await backendServices.newMovementsAccountsIGR(jsonSet);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    catch (err) { }\r\n  }\r\n\r\n}"]},"metadata":{},"sourceType":"module"}