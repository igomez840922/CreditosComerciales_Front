{"ast":null,"code":"import _createForOfIteratorHelper from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _regeneratorRuntime from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import{useTranslation,withTranslation}from\"react-i18next\";import*as opt from\"../../../../../helpers/options_helper\";import{Row,Col,Button,Label,Input,Modal,Card,CardBody,CardFooter,InputGroup}from\"reactstrap\";import{AvForm,AvField,AvGroup}from\"availity-reactstrap-validation\";import Select from\"react-select\";import Currency from\"../../../../../helpers/currency\";import{BackendServices,CoreServices,BpmServices}from\"../../../../../services\";import SessionHelper from\"../../../../../helpers/SessionHelper\";import moment from\"moment\";import{GetMontNumberByName,GetMontNameByNumber,Capitalize,OnlyNumber}from'../../../../../helpers/commons';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ModalReciprocidad=function ModalReciprocidad(props){var _parseFloat,_parseFloat2;var currencyData=new Currency();var _useTranslation=useTranslation(),t=_useTranslation.t,i18n=_useTranslation.i18n;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),campoRequeridoAno=_useState2[0],setcampoRequeridoAno=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),campoRequeridoMes=_useState4[0],setcampoRequeridoMes=_useState4[1];var _useState5=useState(\"0000\"),_useState6=_slicedToArray(_useState5,2),year=_useState6[0],setyear=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),month=_useState8[0],setmonth=_useState8[1];var _useState9=useState(undefined),_useState10=_slicedToArray(_useState9,2),mesSelect=_useState10[0],setmesSelect=_useState10[1];var meses=[{label:t(\"January\"),value:t(\"January\")},{label:t(\"February\"),value:t(\"February\")},{label:t(\"March\"),value:t(\"March\")},{label:t(\"April\"),value:t(\"April\")},{label:t(\"May\"),value:t(\"May\")},{label:t(\"June\"),value:t(\"June\")},{label:t(\"July\"),value:t(\"July\")},{label:t(\"August\"),value:t(\"August\")},{label:t(\"September\"),value:t(\"September\")},{label:t(\"October\"),value:t(\"October\")},{label:t(\"November\"),value:t(\"November\")},{label:t(\"December\"),value:t(\"December\")}];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),mainDebtor=_useState12[0],setmainDebtor=_useState12[1];var _useState13=useState(new CoreServices()),_useState14=_slicedToArray(_useState13,2),coreServices=_useState14[0],setcoreServices=_useState14[1];var _useState15=useState(new BackendServices()),_useState16=_slicedToArray(_useState15,2),backendServices=_useState16[0],setbackendServices=_useState16[1];var _useState17=useState(new SessionHelper()),_useState18=_slicedToArray(_useState17,2),sessionHelper=_useState18[0],setsessionHelper=_useState18[1];var _useState19=useState(null),_useState20=_slicedToArray(_useState19,2),deposits=_useState20[0],setdeposits=_useState20[1];var _useState21=useState(null),_useState22=_slicedToArray(_useState21,2),averageBalance=_useState22[0],setaverageBalance=_useState22[1];var _useState23=useState(null),_useState24=_slicedToArray(_useState23,2),debts=_useState24[0],setdebts=_useState24[1];var _useState25=useState(null),_useState26=_slicedToArray(_useState25,2),reciprocity=_useState26[0],setreciprocity=_useState26[1];var _useState27=useState(null),_useState28=_slicedToArray(_useState27,2),sow=_useState28[0],setsow=_useState28[1];var _useState29=useState(null),_useState30=_slicedToArray(_useState29,2),sales=_useState30[0],setsales=_useState30[1];React.useEffect(function(){var _props$dataRecipro$de,_props$dataRecipro,_props$dataRecipro$av,_props$dataRecipro2,_props$dataRecipro$re,_props$dataRecipro3,_props$dataRecipro$so,_props$dataRecipro4,_props$dataRecipro$sa,_props$dataRecipro5,_props$dataRecipro$ye,_props$dataRecipro6;setdeposits(currencyData.format((_props$dataRecipro$de=props===null||props===void 0?void 0:(_props$dataRecipro=props.dataRecipro)===null||_props$dataRecipro===void 0?void 0:_props$dataRecipro.deposits)!==null&&_props$dataRecipro$de!==void 0?_props$dataRecipro$de:0));setaverageBalance(currencyData.format((_props$dataRecipro$av=props===null||props===void 0?void 0:(_props$dataRecipro2=props.dataRecipro)===null||_props$dataRecipro2===void 0?void 0:_props$dataRecipro2.averageBalance)!==null&&_props$dataRecipro$av!==void 0?_props$dataRecipro$av:0));setreciprocity(currencyData.format((_props$dataRecipro$re=props===null||props===void 0?void 0:(_props$dataRecipro3=props.dataRecipro)===null||_props$dataRecipro3===void 0?void 0:_props$dataRecipro3.reciprocity)!==null&&_props$dataRecipro$re!==void 0?_props$dataRecipro$re:0)+\"%\");setsow((_props$dataRecipro$so=props===null||props===void 0?void 0:(_props$dataRecipro4=props.dataRecipro)===null||_props$dataRecipro4===void 0?void 0:_props$dataRecipro4.sow)!==null&&_props$dataRecipro$so!==void 0?_props$dataRecipro$so:0);setsales(currencyData.format((_props$dataRecipro$sa=props===null||props===void 0?void 0:(_props$dataRecipro5=props.dataRecipro)===null||_props$dataRecipro5===void 0?void 0:_props$dataRecipro5.sales)!==null&&_props$dataRecipro$sa!==void 0?_props$dataRecipro$sa:0));var result=sessionHelper.get(opt.VARNAME_LOCATIONDATA);if(result!==undefined&&result!==null){loadMainDebtor(result.transactionId);}// Read Api Service data\nvar defaultVal=null;setmesSelect(undefined);setyear((_props$dataRecipro$ye=(_props$dataRecipro6=props.dataRecipro)===null||_props$dataRecipro6===void 0?void 0:_props$dataRecipro6.year)!==null&&_props$dataRecipro$ye!==void 0?_props$dataRecipro$ye:\"0000\");try{var _props$dataRecipro7;// console.log(meses.length );\n// console.log(props.dataRecipro.month );\n// console.log(mesSelect);\nif(meses.length>0&&props.dataRecipro.month!=null){defaultVal=meses.find(function(x){return x.value.toUpperCase()==props.dataRecipro.month.toUpperCase();});if(defaultVal!==undefined){setmesSelect(defaultVal);setmonth(defaultVal.value.toUpperCase());}}else{defaultVal=meses[0];setmesSelect(defaultVal);setmonth(defaultVal.value.toUpperCase());}getDeposits((_props$dataRecipro7=props.dataRecipro)===null||_props$dataRecipro7===void 0?void 0:_props$dataRecipro7.year);}catch(err){}},[props.isOpen]);React.useEffect(function(){getReciprocityT24();getDebts();},[year,month,mainDebtor]);React.useEffect(function(){calculateData();},[sales,deposits,averageBalance,reciprocity,sow,debts]);//cargar deudor principal\nfunction loadMainDebtor(_x){return _loadMainDebtor.apply(this,arguments);}// Submitimos formulario para busqueda de clientes\nfunction _loadMainDebtor(){_loadMainDebtor=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(transactionId){var result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return backendServices.consultPrincipalDebtor(transactionId);case 2:result=_context.sent;if(result!==undefined&&result!==null){setmainDebtor(result);}case 4:case\"end\":return _context.stop();}}},_callee);}));return _loadMainDebtor.apply(this,arguments);}function handleSubmit(event,errors,values){var _values$sales,_values$deposits,_values$sow$replace,_mesSelect$value;values.requestDate=document.getElementById(\"requestDate\").value;console.log(values,errors,event);event.preventDefault();if(errors.length>0){return;}// values.sales = sales !== null ? sales : props.dataRecipro.sales;\n// values.averageBalance = averageBalance !== null ? averageBalance : props.dataRecipro.averageBalance;\n// values.deposits = deposits !== null ? deposits : props.dataRecipro.deposits;\n// values.reciprocity = reciprocity !== null ? reciprocity : props.dataRecipro.reciprocity;\n// values.sow = sow !== null ? sow : props.dataRecipro.sow;\n// values.year = year !== null ? year : props.dataRecipro.year;\n// values.month = mesSelect?.value ?? \"Enero\";\nvalues.sales=Number(currencyData.getRealValue((_values$sales=values===null||values===void 0?void 0:values.sales)!==null&&_values$sales!==void 0?_values$sales:0));// values.averageBalance = averageBalance !== null ? averageBalance : props.dataRecipro.averageBalance;\nvalues.averageBalance=\"\";values.deposits=Number(currencyData.getRealValue((_values$deposits=values===null||values===void 0?void 0:values.deposits)!==null&&_values$deposits!==void 0?_values$deposits:0));values.reciprocity=reciprocity!==null?reciprocity.replace(\"%\",\"\"):props.dataRecipro.reciprocity.replace(\"%\",\"\");values.sow=Number(currencyData.getRealValue((_values$sow$replace=values===null||values===void 0?void 0:values.sow.replace(\"%\",\"\"))!==null&&_values$sow$replace!==void 0?_values$sow$replace:0));values.year=year!==null?year:props.dataRecipro.year;values.month=(_mesSelect$value=mesSelect===null||mesSelect===void 0?void 0:mesSelect.value)!==null&&_mesSelect$value!==void 0?_mesSelect$value:\"Enero\";// return\nif(props.tipo==\"guardar\"){props.dataManagament(values,props.tipo);}else{values.reciprocity_id=props.dataRecipro.reciprocity_id;props.dataManagament(values,props.tipo);}// props.onSubmit(values);\n}function getReciprocityT24(){return _getReciprocityT.apply(this,arguments);}//carga las deudas \nfunction _getReciprocityT(){_getReciprocityT=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var result,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(mainDebtor!==null&&year!==null&&year>1995&&year<=Number(moment().format(\"YYYY\"))&&month!==null)){_context2.next=6;break;}result=sessionHelper.get(opt.VARNAME_LOCATIONDATA);_context2.next=4;return coreServices.getReciprocityByYearByTransaction(result.transactionId,year);case 4:data=_context2.sent;//await coreServices.getReciprocity(mainDebtor?.customerNumberT24, year,month);\nif(data!==undefined){// setdeposits(currencyData.formatTable(data.deposits ?? 0))\nsetaverageBalance(currencyData.getRealValue(data.averageAmt));}case 6:case\"end\":return _context2.stop();}}},_callee2);}));return _getReciprocityT.apply(this,arguments);}function getDebts(){return _getDebts.apply(this,arguments);}function _getDebts(){_getDebts=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var monthNum,date,result,shortDebts,longDebts,sowData,_iterator,_step,short,_iterator2,_step2,long;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!(mainDebtor!==null&&year!==null&&year>1995&&year<=Number(moment().format(\"YYYY\"))&&month!==null)){_context3.next=21;break;}monthNum=GetMontNumberByName(month);date=year+\"-\"+monthNum;result=sessionHelper.get(opt.VARNAME_LOCATIONDATA);if(!(result!==undefined&&result!==null)){_context3.next=21;break;}_context3.next=7;return backendServices.consultBankingRelationsDebtsCP(result.transactionId);case 7:shortDebts=_context3.sent;if(shortDebts!==undefined&&shortDebts.getBankingRelationCPDTOList.length>0){shortDebts=shortDebts.getBankingRelationCPDTOList.filter(function(element){return element.status===true;//&& element.date.indexOf(date) >= 0\n});}_context3.next=11;return backendServices.consultBankRelationsDebtsLP(result.transactionId);case 11:longDebts=_context3.sent;if(longDebts!==undefined&&longDebts.bankingRelationLPDTOList.length>0){longDebts=longDebts.bankingRelationLPDTOList.filter(function(element){return element.status===true;//&& element.date.indexOf(date) >= 0\n});}sowData={otherBank:0,banesco:0,total:0,sow:0};sowData.otherBank=0;sowData.banesco=0;////////////////////////////////////////////////\nif(shortDebts!==null&&Array.isArray(shortDebts)){_iterator=_createForOfIteratorHelper(shortDebts);try{for(_iterator.s();!(_step=_iterator.n()).done;){short=_step.value;if(short.bank.toLowerCase().indexOf('banesco')>=0){if(short.facilityType.toLowerCase().indexOf('créd')>=0||short.facilityType.toLowerCase().indexOf('cred')>=0||short.facilityType.toLowerCase().indexOf('tdc')>=0||short.facilityType.toLowerCase().indexOf('tarj')>=0||short.facilityType.toLowerCase().indexOf('sobregiro')>=0||short.facilityType.toLowerCase().indexOf('sobregiros')>=0||short.facilityType.toLowerCase().indexOf('lc')>=0||short.facilityType.toLowerCase().indexOf('l.')>=0||short.facilityType.toLowerCase().indexOf('linea')>=0||short.facilityType.toLowerCase().indexOf('línea')>=0){console.log(\"linea short\",short.facilityType);sowData.banesco+=Number(short.amount);sowData.banesco+=Number(short.amount);}else if(short.facilityType.toLowerCase().indexOf('nueva')>=0||short.facilityType.toLowerCase().indexOf('nuevo')>=0){sowData.banesco+=Number(short.amount);}else{sowData.banesco+=Number(short.debitBalance1)+Number(short.debitBalance2)+Number(short.debitBalance3);sowData.banesco+=Number(short.debitBalance1)+Number(short.debitBalance2)+Number(short.debitBalance3);}}else{if(short.facilityType.toLowerCase().indexOf('créd')>=0||short.facilityType.toLowerCase().indexOf('cred')>=0||short.facilityType.toLowerCase().indexOf('tdc')>=0||short.facilityType.toLowerCase().indexOf('tarj')>=0||short.facilityType.toLowerCase().indexOf('sobregiro')>=0||short.facilityType.toLowerCase().indexOf('sobregiros')>=0||short.facilityType.toLowerCase().indexOf('lc')>=0||short.facilityType.toLowerCase().indexOf('l.')>=0||short.facilityType.toLowerCase().indexOf('linea')>=0||short.facilityType.toLowerCase().indexOf('línea')>=0){sowData.otherBank+=Number(short.amount);sowData.otherBank+=Number(short.amount);}else if(short.facilityType.toLowerCase().indexOf('nueva')>=0||short.facilityType.toLowerCase().indexOf('nuevo')>=0){sowData.otherBank+=Number(short.amount);}else{sowData.otherBank+=Number(short.debitBalance1)+Number(short.debitBalance2)+Number(short.debitBalance3);sowData.otherBank+=Number(short.debitBalance1)+Number(short.debitBalance2)+Number(short.debitBalance3);}//sowApproved.otherBank += Number(short.amount)\n//sowProposal.otherBank += Number(short.debitBalance1) + Number(short.debitBalance2) + Number(short.debitBalance3)\n}}}catch(err){_iterator.e(err);}finally{_iterator.f();}}if(longDebts!==null&&Array.isArray(longDebts)){_iterator2=_createForOfIteratorHelper(longDebts);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){long=_step2.value;if(long.bank.toLowerCase().indexOf('banesco')>=0){if(long.facilityType.toLowerCase().indexOf('créd')>=0||long.facilityType.toLowerCase().indexOf('cred')>=0||long.facilityType.toLowerCase().indexOf('tdc')>=0||long.facilityType.toLowerCase().indexOf('tarj')>=0||long.facilityType.toLowerCase().indexOf('sobregiro')>=0||long.facilityType.toLowerCase().indexOf('sobregiros')>=0||long.facilityType.toLowerCase().indexOf('lc')>=0||long.facilityType.toLowerCase().indexOf('l.')>=0||long.facilityType.toLowerCase().indexOf('linea')>=0||long.facilityType.toLowerCase().indexOf('línea')>=0){console.log(\"linea long\",long.facilityType);sowData.banesco+=Number(long.amount);sowData.banesco+=Number(long.amount);}else if(long.facilityType.toLowerCase().indexOf('nueva')>=0||long.facilityType.toLowerCase().indexOf('nuevo')>=0){sowData.banesco+=Number(long.amount);}else{sowData.banesco+=Number(long.debitBalance1)+Number(long.debitBalance2)+Number(long.debitBalance3);sowData.banesco+=Number(long.debitBalance1)+Number(long.debitBalance2)+Number(long.debitBalance3);}}else{if(long.facilityType.toLowerCase().indexOf('créd')>=0||long.facilityType.toLowerCase().indexOf('cred')>=0||long.facilityType.toLowerCase().indexOf('tdc')>=0||long.facilityType.toLowerCase().indexOf('tarj')>=0||long.facilityType.toLowerCase().indexOf('sobregiro')>=0||long.facilityType.toLowerCase().indexOf('sobregiros')>=0||long.facilityType.toLowerCase().indexOf('lc')>=0||long.facilityType.toLowerCase().indexOf('l.')>=0||long.facilityType.toLowerCase().indexOf('linea')>=0||long.facilityType.toLowerCase().indexOf('línea')>=0){sowData.otherBank+=Number(long.amount);sowData.otherBank+=Number(long.amount);}else if(long.facilityType.toLowerCase().indexOf('nueva')>=0||long.facilityType.toLowerCase().indexOf('nuevo')>=0){sowData.otherBank+=Number(long.amount);}else{sowData.otherBank+=Number(long.debitBalance1)+Number(long.debitBalance2)+Number(long.debitBalance3);sowData.otherBank+=Number(long.debitBalance1)+Number(long.debitBalance2)+Number(long.debitBalance3);}//sowApproved.otherBank += Number(short.amount)\n//sowProposal.otherBank += Number(short.debitBalance1) + Number(short.debitBalance2) + Number(short.debitBalance3)\n}}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}}sowData.total=sowData.banesco+sowData.otherBank;sowData.sow=sowData.total>0?Number(sowData.banesco/sowData.total*100):0;setdebts(sowData);case 21:case\"end\":return _context3.stop();}}},_callee3);}));return _getDebts.apply(this,arguments);}function calculateData(){return _calculateData.apply(this,arguments);}function _calculateData(){_calculateData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var _document$getElementB,_deposit$toFixed;var year,deposit,recipro;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:year=+((_document$getElementB=document.getElementById(\"requestDate\"))===null||_document$getElementB===void 0?void 0:_document$getElementB.value.split('-')[0]);_context4.next=3;return getDeposits(year).then(function(resp){return resp;});case 3:deposit=_context4.sent;setdeposits(currencyData.format((_deposit$toFixed=deposit.toFixed(2))!==null&&_deposit$toFixed!==void 0?_deposit$toFixed:0));if(sales>0){recipro=Number(deposit!==null&&deposit!==void 0?deposit:0)/Number(sales)*100;setreciprocity(currencyData.format(Number(recipro).toFixed(2))+\"%\");}//Calcular SOW\nif(debts!==null){//sowShort,sowLong\nsetsow(debts.sow);}case 7:case\"end\":return _context4.stop();}}},_callee4);}));return _calculateData.apply(this,arguments);}function check(e){var tecla=document.all?e.keyCode:e.which;//Tecla de retroceso para borrar, siempre la permite\nif(tecla==45){e.preventDefault();return true;}return false;}function getDeposits(year){return new Promise(function(resolve){if(!year)resolve(0);var result=sessionHelper.get(opt.VARNAME_LOCATIONDATA);backendServices.consultMovementsBank(result.transactionId).then(function(resp){if(resp.bankOthersBank.length>0||resp.bankBanesco.length>0){var totalDepositsBanesco=resp.bankOthersBank.filter(function(bank){return+bank.year===year&&bank.status;}).reduce(function(acu,crr){return acu+crr.deposits;},0);var totalDepositsOthers=resp.bankBanesco.filter(function(bank){return+bank.year===year&&bank.status;}).reduce(function(acu,crr){return acu+crr.deposits;},0);var totalDeposits=+totalDepositsBanesco+ +totalDepositsOthers.toFixed(2);resolve(totalDeposits);}else{resolve(0);}});});}return/*#__PURE__*/_jsxs(Modal,{size:\"md\",isOpen:props.isOpen,toggle:props.toggle,centered:true,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"modal-title mt-0\",children:t(\"Reciprocity\")}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:props.toggle,\"data-dismiss\":\"modal\",className:\"close\",\"aria-label\":\"Close\",children:/*#__PURE__*/_jsx(\"span\",{\"aria-hidden\":\"true\",children:\"\\xD7\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-body\",style:{backgroundColor:\"#f3f5f7\"},children:/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{xl:\"12\",children:/*#__PURE__*/_jsx(AvForm,{id:\"frmSearch\",className:\"needs-validation\",onSubmit:handleSubmit,children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(CardBody,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:\"6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"idYear\",children:t(\"Date\")}),/*#__PURE__*/_jsx(\"input\",{className:\"form-control\",name:\"requestDate\",type:\"month\",id:\"requestDate\",max:moment().format(\"YYYY-MM\"),onKeyDown:function onKeyDown(e){e.preventDefault();},onChange:function onChange(e){setyear(e.target.value.split(\"-\")[0]);var monthselect=e.target.value.split(\"-\")[1];monthselect=GetMontNameByNumber(Number(monthselect));setmonth(monthselect);monthselect=Capitalize(monthselect);setmesSelect(meses.find(function(x){return x.value===monthselect;}));},value:moment(year+\"-\"+(mesSelect!==undefined?GetMontNumberByName(mesSelect.value.toUpperCase()):\"01\")).format(\"YYYY-MM\")// validate={{\n//   max: { value: moment().format(\"YYYY-MM\"), errorMessage: t(\"InvalidField\") },\n// }}\n})]})}),/*#__PURE__*/_jsx(Col,{md:\"6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"sales\",children:t(\"Sales\")}),/*#__PURE__*/_jsx(AvField,{className:\"form-control\",type:\"text\",name:\"sales\",id:\"sales\",onChange:function onChange(e){setsales(currencyData.getRealValue(e.target.value));},value:currencyData.format(sales!==null&&sales!==void 0?sales:0),pattern:\"^[0-9,.]*$\",onKeyUp:function onKeyUp(e){var x=currencyData.getRealValue(e.target.value);e.target.value=currencyData.format(x);}})]})}),/*#__PURE__*/_jsx(Col,{md:\"6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"deposits\",children:t(\"Deposits\")}),/*#__PURE__*/_jsx(AvField,{className:\"form-control\",type:\"text\",name:\"deposits\",onKeyDown:function onKeyDown(e){e.preventDefault();},tabIndex:\"0\",onChange:function onChange(e){setdeposits(currencyData.getRealValue(e.target.value));},value:currencyData.format((_parseFloat=parseFloat(currencyData.getRealValue(deposits!==null&&deposits!==void 0?deposits:0)))===null||_parseFloat===void 0?void 0:_parseFloat.toFixed(2)),id:\"deposits\",pattern:\"^[0-9,.]*$\",onKeyUp:function onKeyUp(e){var x=currencyData.getRealValue(e.target.value);e.target.value=currencyData.format(x);}})]})}),/*#__PURE__*/_jsx(Col,{md:\"6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"reciprocity\",children:t(\"Reciprocity\")}),/*#__PURE__*/_jsx(AvField,{className:\"form-control\",type:\"text\",name:\"reciprocity\",onChange:function onChange(e){setreciprocity(currencyData.getRealValue(e.target.value));},value:reciprocity,id:\"reciprocity\",onKeyPress:function onKeyPress(e){},onKeyUp:function onKeyUp(e){var x=currencyData.getRealValue(e.target.value.replace('%',''));e.target.value=currencyData.format(x)+\"%\";}})]})}),/*#__PURE__*/_jsx(Col,{md:\"6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"sow\",children:t(\"ActualSow\")}),/*#__PURE__*/_jsx(AvField,{className:\"form-control\"// type=\"number\"\n,type:\"text\",min:0,name:\"sow\",onKeyDown:function onKeyDown(e){e.preventDefault();},value:\"\".concat((_parseFloat2=parseFloat(sow))===null||_parseFloat2===void 0?void 0:_parseFloat2.toFixed(2),\"%\"),onChange:function onChange(e){setsow(currencyData.getRealValue(e.target.value.toFixed(2)));},onKeyPress:function onKeyPress(e){return OnlyNumber(e);},id:\"sow\"// pattern=\"^[0-9,.]*$\"\n// onKeyUp={(e) => { let x = currencyData.getRealValue(e.target.value); e.target.value = currencyData.format(x); }}\n})]})}),/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"description\",children:t(\"Description\")}),/*#__PURE__*/_jsx(AvField,{type:\"textarea\",name:\"description\",id:\"description\",maxLength:\"1000\",rows:\"7\",value:props.dataRecipro.description})]})})]})}),/*#__PURE__*/_jsxs(CardFooter,{style:{textAlign:\"right\"},children:[/*#__PURE__*/_jsxs(Button,{id:\"btnNew\",color:\"danger\",type:\"button\",style:{margin:'5px'},onClick:props.toggle,\"data-dismiss\":\"modal\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi mdi-cancel mid-12px\"}),\" \",t(\"Cancel\")]}),props.botones?/*#__PURE__*/_jsxs(Button,{id:\"btnSearch\",color:\"success\",type:\"submit\",style:{margin:'5px'},children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-content-save mdi-12px\"}),\" \",\" \",props.tipo==\"guardar\"?t(\"Save\"):t(\"Save\")]}):null]})]})})})})})]});};export default ModalReciprocidad;","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/pages/CommercialCredit/4_InformeGestionReforzado/FormularioIGR/Secciones/ModalReciprocidad.js"],"names":["React","useState","useTranslation","withTranslation","opt","Row","Col","Button","Label","Input","Modal","Card","CardBody","CardFooter","InputGroup","AvForm","AvField","AvGroup","Select","Currency","BackendServices","CoreServices","BpmServices","SessionHelper","moment","GetMontNumberByName","GetMontNameByNumber","Capitalize","OnlyNumber","ModalReciprocidad","props","currencyData","t","i18n","campoRequeridoAno","setcampoRequeridoAno","campoRequeridoMes","setcampoRequeridoMes","year","setyear","month","setmonth","undefined","mesSelect","setmesSelect","meses","label","value","mainDebtor","setmainDebtor","coreServices","setcoreServices","backendServices","setbackendServices","sessionHelper","setsessionHelper","deposits","setdeposits","averageBalance","setaverageBalance","debts","setdebts","reciprocity","setreciprocity","sow","setsow","sales","setsales","useEffect","format","dataRecipro","result","get","VARNAME_LOCATIONDATA","loadMainDebtor","transactionId","defaultVal","length","find","x","toUpperCase","getDeposits","err","isOpen","getReciprocityT24","getDebts","calculateData","consultPrincipalDebtor","handleSubmit","event","errors","values","requestDate","document","getElementById","console","log","preventDefault","Number","getRealValue","replace","tipo","dataManagament","reciprocity_id","getReciprocityByYearByTransaction","data","averageAmt","monthNum","date","consultBankingRelationsDebtsCP","shortDebts","getBankingRelationCPDTOList","filter","element","status","consultBankRelationsDebtsLP","longDebts","bankingRelationLPDTOList","sowData","otherBank","banesco","total","Array","isArray","short","bank","toLowerCase","indexOf","facilityType","amount","debitBalance1","debitBalance2","debitBalance3","long","split","then","resp","deposit","toFixed","recipro","check","e","tecla","all","keyCode","which","Promise","resolve","consultMovementsBank","bankOthersBank","bankBanesco","totalDepositsBanesco","reduce","acu","crr","totalDepositsOthers","totalDeposits","toggle","backgroundColor","target","monthselect","parseFloat","description","textAlign","margin","botones"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\"\r\nimport { useTranslation, withTranslation } from \"react-i18next\"\r\nimport PropTypes from 'prop-types';\r\nimport * as opt from \"../../../../../helpers/options_helper\"\r\nimport {\r\n  Row,\r\n  Col,\r\n  Button,\r\n  Label,\r\n  Input,\r\n  Modal,\r\n  Card,\r\n  CardBody,\r\n  CardFooter,\r\n  InputGroup,\r\n} from \"reactstrap\"\r\nimport { AvForm, AvField, AvGroup } from \"availity-reactstrap-validation\"\r\nimport Select from \"react-select\";\r\nimport Currency from \"../../../../../helpers/currency\";\r\nimport { BackendServices, CoreServices, BpmServices, } from \"../../../../../services\";\r\nimport SessionHelper from \"../../../../../helpers/SessionHelper\";\r\nimport moment from \"moment\";\r\n\r\nimport { GetMontNumberByName, GetMontNameByNumber, Capitalize, OnlyNumber } from '../../../../../helpers/commons'\r\n\r\nconst ModalReciprocidad = (props) => {\r\n  const currencyData = new Currency();\r\n  const { t, i18n } = useTranslation();\r\n  const [campoRequeridoAno, setcampoRequeridoAno] = useState(false);\r\n  const [campoRequeridoMes, setcampoRequeridoMes] = useState(false);\r\n  const [year, setyear] = useState(\"0000\");\r\n  const [month, setmonth] = useState(null);\r\n  const [mesSelect, setmesSelect] = useState(undefined);\r\n  const meses = [{ label: t(\"January\"), value: t(\"January\") }\r\n    , { label: t(\"February\"), value: t(\"February\") },\r\n  { label: t(\"March\"), value: t(\"March\") },\r\n  { label: t(\"April\"), value: t(\"April\") },\r\n  { label: t(\"May\"), value: t(\"May\") },\r\n  { label: t(\"June\"), value: t(\"June\") },\r\n  { label: t(\"July\"), value: t(\"July\") },\r\n  { label: t(\"August\"), value: t(\"August\") },\r\n  { label: t(\"September\"), value: t(\"September\") },\r\n  { label: t(\"October\"), value: t(\"October\") },\r\n  { label: t(\"November\"), value: t(\"November\") },\r\n  { label: t(\"December\"), value: t(\"December\") }];\r\n\r\n  const [mainDebtor, setmainDebtor] = useState(null);\r\n\r\n  const [coreServices, setcoreServices] = useState(new CoreServices());\r\n  const [backendServices, setbackendServices] = useState(new BackendServices());\r\n  const [sessionHelper, setsessionHelper] = useState(new SessionHelper());\r\n\r\n  const [deposits, setdeposits] = useState(null)\r\n  const [averageBalance, setaverageBalance] = useState(null)\r\n  const [debts, setdebts] = useState(null)\r\n\r\n  const [reciprocity, setreciprocity] = useState(null)\r\n  const [sow, setsow] = useState(null)\r\n  const [sales, setsales] = useState(null)\r\n\r\n  React.useEffect(() => {\r\n    setdeposits(currencyData.format(props?.dataRecipro?.deposits ?? 0))\r\n    setaverageBalance(currencyData.format(props?.dataRecipro?.averageBalance ?? 0))\r\n    setreciprocity(currencyData.format(props?.dataRecipro?.reciprocity ?? 0) + \"%\")\r\n    setsow((props?.dataRecipro?.sow ?? 0))\r\n    setsales(currencyData.format(props?.dataRecipro?.sales ?? 0))\r\n    var result = sessionHelper.get(opt.VARNAME_LOCATIONDATA);\r\n    if (result !== undefined && result !== null) {\r\n      loadMainDebtor(result.transactionId)\r\n    }\r\n    // Read Api Service data\r\n    var defaultVal = null;\r\n    setmesSelect(undefined)\r\n\r\n    setyear(props.dataRecipro?.year ?? \"0000\")\r\n    try {\r\n      // console.log(meses.length );\r\n      // console.log(props.dataRecipro.month );\r\n      // console.log(mesSelect);\r\n      if (meses.length > 0 && props.dataRecipro.month != null) {\r\n        defaultVal = meses.find(x => (x.value).toUpperCase() == (props.dataRecipro.month).toUpperCase());\r\n        if (defaultVal !== undefined) {\r\n          setmesSelect(defaultVal);\r\n          setmonth(defaultVal.value.toUpperCase())\r\n        }\r\n      }\r\n      else {\r\n        defaultVal = meses[0];\r\n        setmesSelect(defaultVal);\r\n        setmonth(defaultVal.value.toUpperCase());\r\n      }\r\n\r\n      getDeposits(props.dataRecipro?.year);\r\n\r\n    }\r\n    catch (err) { }\r\n  }, [props.isOpen]);\r\n\r\n  React.useEffect(() => {\r\n    getReciprocityT24();\r\n    getDebts();\r\n  }, [year, month, mainDebtor]);\r\n\r\n  React.useEffect(() => {\r\n    calculateData()\r\n  }, [sales, deposits, averageBalance, reciprocity, sow, debts]);\r\n\r\n  //cargar deudor principal\r\n  async function loadMainDebtor(transactionId) {\r\n    var result = await backendServices.consultPrincipalDebtor(transactionId)\r\n    if (result !== undefined && result !== null) {\r\n      setmainDebtor(result);\r\n    }\r\n  }\r\n\r\n  // Submitimos formulario para busqueda de clientes\r\n  function handleSubmit(event, errors, values) {\r\n    values.requestDate = document.getElementById(\"requestDate\").value\r\n\r\n    console.log(values, errors, event)\r\n    event.preventDefault();\r\n    if (errors.length > 0) {\r\n      return;\r\n    }\r\n\r\n    // values.sales = sales !== null ? sales : props.dataRecipro.sales;\r\n    // values.averageBalance = averageBalance !== null ? averageBalance : props.dataRecipro.averageBalance;\r\n    // values.deposits = deposits !== null ? deposits : props.dataRecipro.deposits;\r\n    // values.reciprocity = reciprocity !== null ? reciprocity : props.dataRecipro.reciprocity;\r\n    // values.sow = sow !== null ? sow : props.dataRecipro.sow;\r\n    // values.year = year !== null ? year : props.dataRecipro.year;\r\n    // values.month = mesSelect?.value ?? \"Enero\";\r\n    values.sales = Number(currencyData.getRealValue(values?.sales ?? 0));\r\n    // values.averageBalance = averageBalance !== null ? averageBalance : props.dataRecipro.averageBalance;\r\n    values.averageBalance = \"\";\r\n    values.deposits = Number(currencyData.getRealValue(values?.deposits ?? 0));\r\n    values.reciprocity = reciprocity !== null ? reciprocity.replace(\"%\", \"\") : props.dataRecipro.reciprocity.replace(\"%\", \"\");\r\n    values.sow = Number(currencyData.getRealValue((values?.sow.replace(\"%\", \"\")) ?? 0));\r\n    values.year = year !== null ? year : props.dataRecipro.year;\r\n    values.month = mesSelect?.value ?? \"Enero\";\r\n    // return\r\n    if (props.tipo == \"guardar\") {\r\n      props.dataManagament(values, props.tipo);\r\n    } else {\r\n      values.reciprocity_id = props.dataRecipro.reciprocity_id;\r\n      props.dataManagament(values, props.tipo);\r\n    }\r\n    // props.onSubmit(values);\r\n  }\r\n\r\n  async function getReciprocityT24() {\r\n    if (mainDebtor !== null && year !== null && year > 1995 && year <= Number(moment().format(\"YYYY\")) && month !== null) {\r\n      var result = sessionHelper.get(opt.VARNAME_LOCATIONDATA);\r\n      var data = await coreServices.getReciprocityByYearByTransaction(result.transactionId, year);//await coreServices.getReciprocity(mainDebtor?.customerNumberT24, year,month);\r\n      if (data !== undefined) {\r\n        // setdeposits(currencyData.formatTable(data.deposits ?? 0))\r\n        setaverageBalance(currencyData.getRealValue(data.averageAmt))\r\n      }\r\n    }\r\n  }\r\n\r\n  //carga las deudas \r\n  async function getDebts() {\r\n    if (mainDebtor !== null && year !== null && year > 1995 && year <= Number(moment().format(\"YYYY\")) && month !== null) {\r\n\r\n      var monthNum = GetMontNumberByName(month);\r\n      var date = year + \"-\" + monthNum;\r\n\r\n      var result = sessionHelper.get(opt.VARNAME_LOCATIONDATA);\r\n      if (result !== undefined && result !== null) {\r\n        var shortDebts = await backendServices.consultBankingRelationsDebtsCP(result.transactionId)\r\n        if (shortDebts !== undefined && shortDebts.getBankingRelationCPDTOList.length > 0) {\r\n          shortDebts = shortDebts.getBankingRelationCPDTOList.filter((element) => {\r\n            return (element.status === true);//&& element.date.indexOf(date) >= 0\r\n          })\r\n        }\r\n\r\n        var longDebts = await backendServices.consultBankRelationsDebtsLP(result.transactionId)\r\n        if (longDebts !== undefined && longDebts.bankingRelationLPDTOList.length > 0) {\r\n          longDebts = longDebts.bankingRelationLPDTOList.filter((element) => {\r\n            return (element.status === true);//&& element.date.indexOf(date) >= 0\r\n          })\r\n        }\r\n\r\n\r\n        var sowData = { otherBank: 0, banesco: 0, total: 0, sow: 0 }\r\n        sowData.otherBank = 0;\r\n        sowData.banesco = 0;\r\n        ////////////////////////////////////////////////\r\n        if (shortDebts !== null && Array.isArray(shortDebts)) {\r\n          for (var short of shortDebts) {\r\n\r\n            if (short.bank.toLowerCase().indexOf('banesco') >= 0) {\r\n\r\n              if (short.facilityType.toLowerCase().indexOf('créd') >= 0 || short.facilityType.toLowerCase().indexOf('cred') >= 0 || short.facilityType.toLowerCase().indexOf('tdc') >= 0 || short.facilityType.toLowerCase().indexOf('tarj') >= 0 || short.facilityType.toLowerCase().indexOf('sobregiro') >= 0 || short.facilityType.toLowerCase().indexOf('sobregiros') >= 0 || short.facilityType.toLowerCase().indexOf('lc') >= 0 || short.facilityType.toLowerCase().indexOf('l.') >= 0 || short.facilityType.toLowerCase().indexOf('linea') >= 0 || short.facilityType.toLowerCase().indexOf('línea') >= 0) {\r\n                console.log(\"linea short\", short.facilityType)\r\n                sowData.banesco += Number(short.amount)\r\n                sowData.banesco += Number(short.amount)\r\n              }\r\n              else if (short.facilityType.toLowerCase().indexOf('nueva') >= 0 || short.facilityType.toLowerCase().indexOf('nuevo') >= 0) {\r\n                sowData.banesco += Number(short.amount)\r\n              }\r\n              else {\r\n                sowData.banesco += Number(short.debitBalance1) + Number(short.debitBalance2) + Number(short.debitBalance3)\r\n                sowData.banesco += Number(short.debitBalance1) + Number(short.debitBalance2) + Number(short.debitBalance3)\r\n              }\r\n            }\r\n            else {\r\n              if (short.facilityType.toLowerCase().indexOf('créd') >= 0 || short.facilityType.toLowerCase().indexOf('cred') >= 0 || short.facilityType.toLowerCase().indexOf('tdc') >= 0 || short.facilityType.toLowerCase().indexOf('tarj') >= 0 || short.facilityType.toLowerCase().indexOf('sobregiro') >= 0 || short.facilityType.toLowerCase().indexOf('sobregiros') >= 0 || short.facilityType.toLowerCase().indexOf('lc') >= 0 || short.facilityType.toLowerCase().indexOf('l.') >= 0 || short.facilityType.toLowerCase().indexOf('linea') >= 0 || short.facilityType.toLowerCase().indexOf('línea') >= 0) {\r\n                sowData.otherBank += Number(short.amount)\r\n                sowData.otherBank += Number(short.amount)\r\n              }\r\n              else if (short.facilityType.toLowerCase().indexOf('nueva') >= 0 || short.facilityType.toLowerCase().indexOf('nuevo') >= 0) {\r\n                sowData.otherBank += Number(short.amount)\r\n              }\r\n              else {\r\n                sowData.otherBank += Number(short.debitBalance1) + Number(short.debitBalance2) + Number(short.debitBalance3)\r\n                sowData.otherBank += Number(short.debitBalance1) + Number(short.debitBalance2) + Number(short.debitBalance3)\r\n              }\r\n              //sowApproved.otherBank += Number(short.amount)\r\n              //sowProposal.otherBank += Number(short.debitBalance1) + Number(short.debitBalance2) + Number(short.debitBalance3)\r\n            }\r\n          }\r\n        }\r\n        if (longDebts !== null && Array.isArray(longDebts)) {\r\n          for (var long of longDebts) {\r\n\r\n            if (long.bank.toLowerCase().indexOf('banesco') >= 0) {\r\n\r\n              if (long.facilityType.toLowerCase().indexOf('créd') >= 0 || long.facilityType.toLowerCase().indexOf('cred') >= 0 || long.facilityType.toLowerCase().indexOf('tdc') >= 0 || long.facilityType.toLowerCase().indexOf('tarj') >= 0 || long.facilityType.toLowerCase().indexOf('sobregiro') >= 0 || long.facilityType.toLowerCase().indexOf('sobregiros') >= 0 || long.facilityType.toLowerCase().indexOf('lc') >= 0 || long.facilityType.toLowerCase().indexOf('l.') >= 0 || long.facilityType.toLowerCase().indexOf('linea') >= 0 || long.facilityType.toLowerCase().indexOf('línea') >= 0) {\r\n                console.log(\"linea long\", long.facilityType)\r\n                sowData.banesco += Number(long.amount)\r\n                sowData.banesco += Number(long.amount)\r\n              }\r\n              else if (long.facilityType.toLowerCase().indexOf('nueva') >= 0 || long.facilityType.toLowerCase().indexOf('nuevo') >= 0) {\r\n                sowData.banesco += Number(long.amount)\r\n              }\r\n              else {\r\n                sowData.banesco += Number(long.debitBalance1) + Number(long.debitBalance2) + Number(long.debitBalance3)\r\n                sowData.banesco += Number(long.debitBalance1) + Number(long.debitBalance2) + Number(long.debitBalance3)\r\n              }\r\n            }\r\n            else {\r\n              if (long.facilityType.toLowerCase().indexOf('créd') >= 0 || long.facilityType.toLowerCase().indexOf('cred') >= 0 || long.facilityType.toLowerCase().indexOf('tdc') >= 0 || long.facilityType.toLowerCase().indexOf('tarj') >= 0 || long.facilityType.toLowerCase().indexOf('sobregiro') >= 0 || long.facilityType.toLowerCase().indexOf('sobregiros') >= 0 || long.facilityType.toLowerCase().indexOf('lc') >= 0 || long.facilityType.toLowerCase().indexOf('l.') >= 0 || long.facilityType.toLowerCase().indexOf('linea') >= 0 || long.facilityType.toLowerCase().indexOf('línea') >= 0) {\r\n                sowData.otherBank += Number(long.amount)\r\n                sowData.otherBank += Number(long.amount)\r\n              }\r\n              else if (long.facilityType.toLowerCase().indexOf('nueva') >= 0 || long.facilityType.toLowerCase().indexOf('nuevo') >= 0) {\r\n                sowData.otherBank += Number(long.amount)\r\n              }\r\n              else {\r\n                sowData.otherBank += Number(long.debitBalance1) + Number(long.debitBalance2) + Number(long.debitBalance3)\r\n                sowData.otherBank += Number(long.debitBalance1) + Number(long.debitBalance2) + Number(long.debitBalance3)\r\n              }\r\n              //sowApproved.otherBank += Number(short.amount)\r\n              //sowProposal.otherBank += Number(short.debitBalance1) + Number(short.debitBalance2) + Number(short.debitBalance3)\r\n            }\r\n          }\r\n        }\r\n\r\n\r\n        sowData.total = sowData.banesco + sowData.otherBank;\r\n        sowData.sow = sowData.total > 0 ? Number(sowData.banesco / sowData.total * 100) : 0;\r\n\r\n        setdebts(sowData)\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n  async function calculateData() {\r\n\r\n    let year = +document.getElementById(\"requestDate\")?.value.split('-')[0];\r\n    let deposit = await getDeposits(year).then(resp => resp);\r\n    setdeposits(currencyData.format(deposit.toFixed(2) ?? 0));\r\n\r\n    if (sales > 0) {\r\n      var recipro = (Number((deposit ?? 0)) / Number(sales)) * 100;\r\n      setreciprocity(currencyData.format(Number(recipro).toFixed(2)) + \"%\")\r\n    }\r\n\r\n    //Calcular SOW\r\n    if (debts !== null) {\r\n      //sowShort,sowLong\r\n      setsow((debts.sow));\r\n    }\r\n\r\n  }\r\n\r\n  function check(e) {\r\n    let tecla = (document.all) ? e.keyCode : e.which;\r\n    //Tecla de retroceso para borrar, siempre la permite\r\n    if (tecla == 45) {\r\n      e.preventDefault();\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  function getDeposits(year) {\r\n    return new Promise((resolve) => {\r\n      if (!year)\r\n        resolve(0);\r\n      var result = sessionHelper.get(opt.VARNAME_LOCATIONDATA);\r\n      backendServices.consultMovementsBank(result.transactionId).then(resp => {\r\n        if (resp.bankOthersBank.length > 0 || resp.bankBanesco.length > 0) {\r\n          let totalDepositsBanesco = resp.bankOthersBank.filter(bank => +bank.year === year && bank.status).reduce((acu, crr) => acu + crr.deposits, 0);\r\n          let totalDepositsOthers = resp.bankBanesco.filter(bank => +bank.year === year && bank.status).reduce((acu, crr) => acu + crr.deposits, 0);\r\n          let totalDeposits = +totalDepositsBanesco + +totalDepositsOthers.toFixed(2);\r\n          resolve(totalDeposits);\r\n        } else {\r\n          resolve(0);\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  return (\r\n    <Modal\r\n      size=\"md\"\r\n      isOpen={props.isOpen}\r\n      toggle={props.toggle}\r\n      centered={true}>\r\n      <div className=\"modal-header\">\r\n        <h5 className=\"modal-title mt-0\">{t(\"Reciprocity\")}</h5>\r\n        <button\r\n          type=\"button\"\r\n          onClick={props.toggle}\r\n          data-dismiss=\"modal\"\r\n          className=\"close\"\r\n          aria-label=\"Close\">\r\n          <span aria-hidden=\"true\">&times;</span>\r\n        </button>\r\n      </div>\r\n      <div className=\"modal-body\" style={{ backgroundColor: \"#f3f5f7\" }}>\r\n        <Row>\r\n          <Col xl=\"12\">\r\n            <AvForm id=\"frmSearch\" className=\"needs-validation\" onSubmit={handleSubmit}>\r\n              <Card>\r\n                <CardBody>\r\n                  <Row>\r\n                    {/* {mesSelect !== undefined ?mesSelect.value:\"01\"} */}\r\n                    <Col md=\"6\">\r\n                      <div className=\"mb-3\">\r\n                        <Label htmlFor=\"idYear\">{t(\"Date\")}</Label>\r\n\r\n                        <input\r\n                          className=\"form-control\"\r\n                          name=\"requestDate\"\r\n                          type=\"month\"\r\n                          id=\"requestDate\"\r\n                          max={moment().format(\"YYYY-MM\")}\r\n                          onKeyDown={(e) => { e.preventDefault(); }}\r\n                          onChange={(e) => {\r\n                            setyear(e.target.value.split(\"-\")[0]);\r\n                            var monthselect = e.target.value.split(\"-\")[1];\r\n                            monthselect = GetMontNameByNumber(Number(monthselect));\r\n                            setmonth(monthselect); monthselect = Capitalize(monthselect);\r\n                            setmesSelect(meses.find(x => x.value === monthselect));\r\n                          }}\r\n                          value={moment(year + \"-\" + (mesSelect !== undefined ? GetMontNumberByName(mesSelect.value.toUpperCase()) : \"01\")).format(\"YYYY-MM\")}\r\n                        // validate={{\r\n                        //   max: { value: moment().format(\"YYYY-MM\"), errorMessage: t(\"InvalidField\") },\r\n                        // }}\r\n                        />\r\n                      </div>\r\n                    </Col>\r\n\r\n                    {/*\r\n                    <Col md=\"3\">\r\n                      <div className=\"mb-3\">\r\n                        <Label htmlFor=\"idYear\">{t(\"Year\")}</Label>\r\n                        <AvField\r\n                          className=\"form-control\"\r\n                          type=\"text\"\r\n                          name=\"year\"\r\n                          id=\"year\"\r\n                          onChange={(e) => { setyear(e.target.value);}}\r\n                          value={props.dataRecipro.year}\r\n                          validate={{\r\n                            required: { value: true, errorMessage: t(\"Required Field\") },\r\n                            number: { value: true, errorMessage: t(\"InvalidField\") },\r\n                          }}\r\n                        />\r\n                      </div>\r\n                    </Col>\r\n                    <Col md=\"3\">\r\n                      <div className=\"mb-3\">\r\n                        <Label htmlFor=\"idMonth\">{t(\"Month\")}</Label>\r\n                        <Select noOptionsMessage={() => \"\"} \r\n                          onChange={(e) => { setmesSelect(meses.find(x => x.value === e.value)); setmonth(e.value);}}\r\n                          options={meses}\r\n                          id=\"sustainableCustomer\"\r\n                          classNamePrefix=\"select2-selection\"\r\n                          placeholder={t(\"toselect\")}\r\n                          value={mesSelect}\r\n                        // value={props.dataRecipro.mes}\r\n                        />\r\n                        {campoRequeridoMes ?\r\n                          <p className=\"message-error-parrafo\">{t(\"Required Field\")}</p>\r\n                          : null}\r\n                      </div>\r\n                    </Col>\r\n                        */}\r\n                    <Col md=\"6\">\r\n                      <div className=\"mb-3\">\r\n                        <Label htmlFor=\"sales\">{t(\"Sales\")}</Label>\r\n                        <AvField\r\n                          className=\"form-control\"\r\n                          type=\"text\"\r\n                          name=\"sales\"\r\n                          id=\"sales\"\r\n                          onChange={(e) => { setsales(currencyData.getRealValue(e.target.value)); }}\r\n                          value={currencyData.format(sales ?? 0)}\r\n                          pattern=\"^[0-9,.]*$\"\r\n                          onKeyUp={(e) => { let x = currencyData.getRealValue(e.target.value); e.target.value = currencyData.format(x); }}\r\n                        />\r\n                      </div>\r\n                    </Col>\r\n                    <Col md=\"6\">\r\n                      <div className=\"mb-3\">\r\n                        <Label htmlFor=\"deposits\">{t(\"Deposits\")}</Label>\r\n                        <AvField\r\n                          className=\"form-control\"\r\n                          type=\"text\"\r\n                          name=\"deposits\"\r\n                          onKeyDown={(e) => { e.preventDefault(); }}\r\n                          tabIndex=\"0\"\r\n                          onChange={(e) => { setdeposits(currencyData.getRealValue(e.target.value)); }}\r\n                          value={currencyData.format(parseFloat(currencyData.getRealValue(deposits ?? 0))?.toFixed(2))}\r\n                          id=\"deposits\"\r\n                          pattern=\"^[0-9,.]*$\"\r\n                          onKeyUp={(e) => { let x = currencyData.getRealValue(e.target.value); e.target.value = currencyData.format(x); }}\r\n                        />\r\n                      </div>\r\n                    </Col>\r\n                    {/* <Col md=\"3\">\r\n                      <div className=\"mb-3\">\r\n                        <Label htmlFor=\"averagebalance\">{t(\"AverageBalance\")}</Label>\r\n                        <AvField\r\n                          className=\"form-control\"\r\n                          type=\"text\"\r\n                          name=\"averageBalance\"\r\n                          onChange={(e) => { setaverageBalance(currencyData.getRealValue(e.target.value)); }}\r\n                          value={averageBalance}\r\n                          id=\"averageBalance\"\r\n                          pattern=\"^[0-9,.]*$\"\r\n                          onKeyUp={(e) => { let x = currencyData.getRealValue(e.target.value); e.target.value = currencyData.format(x); }}\r\n                        />\r\n                      </div>\r\n                    </Col> */}\r\n                    <Col md=\"6\">\r\n                      <div className=\"mb-3\">\r\n                        <Label htmlFor=\"reciprocity\">{t(\"Reciprocity\")}</Label>\r\n                        <AvField\r\n                          className=\"form-control\"\r\n                          type=\"text\"\r\n                          name=\"reciprocity\"\r\n                          onChange={(e) => { setreciprocity(currencyData.getRealValue(e.target.value)); }}\r\n                          value={reciprocity}\r\n                          id=\"reciprocity\"\r\n                          onKeyPress={(e) => { }}\r\n                          onKeyUp={(e) => { let x = currencyData.getRealValue(e.target.value.replace('%', '')); e.target.value = currencyData.format(x) + \"%\"; }}\r\n                        />\r\n                      </div>\r\n                    </Col>\r\n                    <Col md=\"6\">\r\n                      <div className=\"mb-3\">\r\n                        <Label htmlFor=\"sow\">{t(\"ActualSow\")}</Label>\r\n                        <AvField\r\n                          className=\"form-control\"\r\n                          // type=\"number\"\r\n                          type=\"text\"\r\n                          min={0}\r\n                          name=\"sow\"\r\n                          onKeyDown={(e) => { e.preventDefault(); }}\r\n                          value={`${parseFloat(sow)?.toFixed(2)}%`}\r\n                          onChange={(e) => { setsow(currencyData.getRealValue(e.target.value.toFixed(2))); }}\r\n                          onKeyPress={(e) => { return OnlyNumber(e) }}\r\n                          id=\"sow\"\r\n                        // pattern=\"^[0-9,.]*$\"\r\n                        // onKeyUp={(e) => { let x = currencyData.getRealValue(e.target.value); e.target.value = currencyData.format(x); }}\r\n                        />\r\n                      </div>\r\n                    </Col>\r\n                    <Col md=\"12\">\r\n                      <div className=\"mb-3\">\r\n                        <Label htmlFor=\"description\">{t(\"Description\")}</Label>\r\n                        <AvField\r\n                          type=\"textarea\"\r\n                          name=\"description\"\r\n                          id=\"description\"\r\n                          maxLength=\"1000\"\r\n                          rows=\"7\"\r\n                          value={props.dataRecipro.description}\r\n                        />\r\n                      </div>\r\n                    </Col>\r\n                  </Row>\r\n                </CardBody>\r\n                <CardFooter style={{ textAlign: \"right\" }}>\r\n                  <Button id=\"btnNew\" color=\"danger\" type=\"button\" style={{ margin: '5px' }} onClick={props.toggle} data-dismiss=\"modal\">\r\n                    <i className=\"mdi mdi mdi-cancel mid-12px\"></i>{\" \"}{t(\"Cancel\")}\r\n                  </Button>\r\n                  {props.botones ?\r\n                    <Button id=\"btnSearch\" color=\"success\" type=\"submit\" style={{ margin: '5px' }}><i className=\"mdi mdi-content-save mdi-12px\"></i>\r\n                      {\" \"} {props.tipo == \"guardar\" ? t(\"Save\") : t(\"Save\")}\r\n                    </Button> : null}\r\n                </CardFooter>\r\n              </Card>\r\n            </AvForm>\r\n          </Col>\r\n        </Row>\r\n      </div>\r\n    </Modal>\r\n  );\r\n};\r\nModalReciprocidad.propTypes = {\r\n  isOpen: PropTypes.bool,\r\n  toggle: PropTypes.func,\r\n  partyId: PropTypes.string\r\n};\r\n\r\nexport default ModalReciprocidad;\r\n"]},"metadata":{},"sourceType":"module"}