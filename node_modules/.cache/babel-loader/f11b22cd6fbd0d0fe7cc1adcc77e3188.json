{"ast":null,"code":"import _objectSpread from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import{translationHelpers}from'../../helpers/translation-helper';import{Row,Col,Card,CardBody,Button,Label,Input,CardHeader,CardTitle,InputGroup,Table,CardFooter}from\"reactstrap\";import AvField from'availity-reactstrap-validation/lib/AvField';import AvForm from'availity-reactstrap-validation/lib/AvForm';import{Link}from\"react-router-dom\";import ModalPolicy from\"../Attachments/ModalPolicy\";import SweetAlert from\"react-bootstrap-sweetalert\";import{BackendServices,CoreServices,BpmServices}from\"../../services\";import LoadingOverlay from\"react-loading-overlay\";import HeaderSections from\"../Common/HeaderSections\";import{useLocation,useHistory}from'react-router-dom';import*as url from\"../../helpers/url_helper\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var CreditPolicyReview=function CreditPolicyReview(props){var location=useLocation();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),displayModal=_useState2[0],setDisplayModal=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),actions=_useState4[0],setActions=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),SusscessDialog=_useState6[0],setSusscessDialog=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),dataRows=_useState8[0],setdataRows=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),DataSend=_useState10[0],setDataSend=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),confirm_alert=_useState12[0],setconfirm_alert=_useState12[1];var _useState13=useState(location.data),_useState14=_slicedToArray(_useState13,2),dataLocation=_useState14[0],setData=_useState14[1];var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),dataDelete=_useState16[0],setDataDelete=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),error_dlg=_useState18[0],seterror_dlg=_useState18[1];var _useState19=useState(\"\"),_useState20=_slicedToArray(_useState19,2),error_msg=_useState20[0],seterror_msg=_useState20[1];var _useState21=useState(false),_useState22=_slicedToArray(_useState21,2),isActiveLoading=_useState22[0],setIsActiveLoading=_useState22[1];var history=useHistory();var _useState23=useState(null),_useState24=_slicedToArray(_useState23,2),locationData=_useState24[0],setLocationData=_useState24[1];var _translationHelpers=translationHelpers('commercial_credit','common'),_translationHelpers2=_slicedToArray(_translationHelpers,2),t=_translationHelpers2[0],c=_translationHelpers2[1];var dataStorage;React.useEffect(function(){// Read Api Service data\nif(location.data!==null&&location.data!==undefined){if(location.data.transactionId===undefined||location.data.transactionId.length<=0){//location.data.transactionId = 0;\n//checkAndCreateProcedure(location.data);\nhistory.push(url.URL_DASHBOARD);return;}else{sessionStorage.setItem('locationData',JSON.stringify(location.data));setLocationData(location.data);dataStorage=location.data;}}else{//chequeamos si tenemos guardado en session\nvar result=sessionStorage.getItem('locationData');if(result!==undefined&&result!==null){result=JSON.parse(result);setLocationData(result);dataStorage=result;}}LoadData(dataStorage);},[]);if(!props.policies){return null;}function LoadData(dataLocation){var _dataLocation$transac;var backendServices=new BackendServices();backendServices.consultarPoliticaCredito((_dataLocation$transac=dataLocation===null||dataLocation===void 0?void 0:dataLocation.transactionId)!==null&&_dataLocation$transac!==void 0?_dataLocation$transac:0).then(function(resp){setdataRows(resp.map(function(policy,index){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:policy.parameter}),/*#__PURE__*/_jsx(\"td\",{children:policy.condition}),/*#__PURE__*/_jsx(\"td\",{children:policy.comply?'Si':'No'}),/*#__PURE__*/_jsx(\"td\",{children:policy.observations}),!props.preview&&/*#__PURE__*/_jsxs(\"td\",{style:{textAlign:\"right\"},children:[/*#__PURE__*/_jsx(Button,{type:\"button\",color:\"link\",onClick:function onClick(resp){editarSowActual(policy);},className:\"btn btn-link\",children:/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-border-color mdi-24px\"})}),/*#__PURE__*/_jsx(Button,{type:\"button\",color:\"link\",onClick:function onClick(resp){eliminarSowActual(policy);},className:\"btn btn-link\",children:/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-trash-can-outline mdi-24px\"})})]})]},'row-'+policy.id+'-'+index);}));});}// setdataRows(props.policies.map((policy) => {\n//   return policy.conditions.map((condition, index) => (\n//     <tr key={'row-' + policy.id + '-' + index}>\n//       <th>{index === 0 ? policy.parameter : ''}</th>\n//       <td>{condition.title}</td>\n//       <td>\n//         <AvField\n//           className=\"form-control\"\n//           name={\"comply[\" + index + \"]\"}\n//           type=\"select\"\n//           id={\"comply-\" + index}\n//           value=\"N/A\">\n//           <option>{c(\"Yes\")}</option>\n//           <option>{c(\"No\")}</option>\n//           <option>{c(\"N/A\")}</option>\n//         </AvField>\n//       </td>\n//       <td>{condition.observations[0]}</td>\n//     </tr>\n//   )\n//   )\n// }\n// ));\nfunction toggleModal(){setDisplayModal(!displayModal);}function handleSubmit(event,errors,values){event.preventDefault();if(errors.length>0){return;}// props.onSubmit(values);\n}function DataUpdate(values){setIsActiveLoading(true);var datos=_objectSpread(_objectSpread({},values),{},{transactId:locationData.transactionId});var backendServices=new BackendServices();backendServices.actualizarPoliticaCredito(datos).then(function(resp){if(resp.statusCode==\"200\"){setSusscessDialog(true);}else{seterror_dlg(true);seterror_msg(props.t(\"TheProcessCouldNotFinish\"));}setIsActiveLoading(false);}).catch(function(err){seterror_dlg(true);setIsActiveLoading(false);});}function DataInsert(values){setIsActiveLoading(true);var datos=_objectSpread(_objectSpread({},values),{},{transactId:+locationData.transactionId,debtorId:props.debtorId});var backendServices=new BackendServices();backendServices.nuevoPoliticaCredito(datos).then(function(resp){if(resp.statusCode==\"200\"){setSusscessDialog(true);// LoadData();\n}else{seterror_dlg(true);seterror_msg(props.t(\"TheProcessCouldNotFinish\"));}setIsActiveLoading(false);}).catch(function(err){setIsActiveLoading(false);});}function editarSowActual(data){toggleModal();setActions('edit');setDataSend(data);}function eliminarSowActual(data){setDataDelete(data);setconfirm_alert(true);}function InsertShowCurrent(){setActions('new');setDataSend(null);}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"d-flex flex-row justify-content-between\",children:/*#__PURE__*/_jsx(HeaderSections,{title:\"Credit Policy Review\",t:t})}),/*#__PURE__*/_jsx(AvForm,{id:\"frmSearch\",className:\"needs-validation\",onSubmit:handleSubmit,children:/*#__PURE__*/_jsx(LoadingOverlay,{active:isActiveLoading,spinner:true,text:t(\"WaitingPlease\"),children:/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{lg:\"12\",children:/*#__PURE__*/_jsx(\"div\",{className:\"table-responsive\",children:/*#__PURE__*/_jsxs(Table,{className:\"table mb-0\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"table-light\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:t(\"Parameters\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"Conditions\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"Comply\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"Observations\")}),!props.preview&&/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsxs(Link,{to:\"#\",className:\"float-end\",onClick:function onClick(){toggleModal();InsertShowCurrent();},children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-plus-box-multiple-outline mdi-24px\"}),t(\"\")]})})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:dataRows})]})})})})})}),error_dlg?/*#__PURE__*/_jsx(SweetAlert,{error:true,title:t(\"ErrorDialog\"),onConfirm:function onConfirm(){seterror_dlg(false);},children:error_msg}):null,displayModal&&/*#__PURE__*/_jsx(ModalPolicy,{isOpen:displayModal,toggle:toggleModal,DataUpdate:DataUpdate,DataInsert:DataInsert,actions:actions,DataSend:DataSend}),SusscessDialog?/*#__PURE__*/_jsx(SweetAlert,{success:true,title:t(\"SuccessDialog\"),onConfirm:function onConfirm(){setSusscessDialog(false);LoadData(locationData);},children:t(\"SuccessSaveMessage\")}):null,confirm_alert?/*#__PURE__*/_jsx(SweetAlert,{title:t(\"Areyousure\"),warning:true,showCancel:true,confirmButtonText:t(\"Yesdeleteit\"),confirmBtnBsStyle:\"success\",cancelBtnBsStyle:\"danger\",onConfirm:function onConfirm(){setIsActiveLoading(true);var backendServices=new BackendServices();backendServices.eliminarPoliticaCredit(locationData.transactionId,dataDelete.debtorId,dataDelete.itemId).then(function(resp){setIsActiveLoading(false);if(resp.statusCode==\"500\"){setconfirm_alert(false);seterror_dlg(true);}else{setconfirm_alert(false);setSusscessDialog(true);}}).catch(function(error){setIsActiveLoading(false);setconfirm_alert(false);seterror_dlg(true);});},onCancel:function onCancel(){return setconfirm_alert(false);},children:t(\"Youwontbeabletorevertthis\")}):null]});};export default CreditPolicyReview;","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/components/InformeFinanciero/CreditPolicyReview.js"],"names":["React","useEffect","useState","translationHelpers","Row","Col","Card","CardBody","Button","Label","Input","CardHeader","CardTitle","InputGroup","Table","CardFooter","AvField","AvForm","Link","ModalPolicy","SweetAlert","BackendServices","CoreServices","BpmServices","LoadingOverlay","HeaderSections","useLocation","useHistory","url","CreditPolicyReview","props","location","displayModal","setDisplayModal","actions","setActions","SusscessDialog","setSusscessDialog","dataRows","setdataRows","DataSend","setDataSend","confirm_alert","setconfirm_alert","data","dataLocation","setData","dataDelete","setDataDelete","error_dlg","seterror_dlg","error_msg","seterror_msg","isActiveLoading","setIsActiveLoading","history","locationData","setLocationData","t","c","dataStorage","undefined","transactionId","length","push","URL_DASHBOARD","sessionStorage","setItem","JSON","stringify","result","getItem","parse","LoadData","policies","backendServices","consultarPoliticaCredito","then","resp","map","policy","index","parameter","condition","comply","observations","preview","textAlign","editarSowActual","eliminarSowActual","id","toggleModal","handleSubmit","event","errors","values","preventDefault","DataUpdate","datos","transactId","actualizarPoliticaCredito","statusCode","catch","err","DataInsert","debtorId","nuevoPoliticaCredito","InsertShowCurrent","eliminarPoliticaCredit","itemId","error"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\"\r\n\r\nimport PropTypes from 'prop-types';\r\nimport { translationHelpers } from '../../helpers/translation-helper';\r\n\r\nimport {\r\n  Row,\r\n  Col,\r\n  Card,\r\n  CardBody,\r\n  Button,\r\n  Label,\r\n  Input,\r\n  CardHeader,\r\n  CardTitle,\r\n  InputGroup,\r\n  Table,\r\n  CardFooter\r\n} from \"reactstrap\"\r\n\r\nimport AvField from 'availity-reactstrap-validation/lib/AvField';\r\nimport AvForm from 'availity-reactstrap-validation/lib/AvForm';\r\nimport { Link } from \"react-router-dom\";\r\nimport ModalPolicy from \"../Attachments/ModalPolicy\";\r\nimport SweetAlert from \"react-bootstrap-sweetalert\"\r\nimport { BackendServices, CoreServices, BpmServices, } from \"../../services\";\r\nimport LoadingOverlay from \"react-loading-overlay\";\r\nimport HeaderSections from \"../Common/HeaderSections\";\r\nimport { useLocation, useHistory } from 'react-router-dom'\r\nimport * as url from \"../../helpers/url_helper\"\r\n\r\nconst CreditPolicyReview = (props) => {\r\n\r\n  const location = useLocation()\r\n\r\n  const [displayModal, setDisplayModal] = useState(false);\r\n  const [actions, setActions] = useState('');\r\n  const [SusscessDialog, setSusscessDialog] = useState(false);\r\n  const [dataRows, setdataRows] = useState(null);\r\n  const [DataSend, setDataSend] = useState(null);\r\n  const [confirm_alert, setconfirm_alert] = useState(false)\r\n  const [dataLocation, setData] = useState(location.data);\r\n  const [dataDelete, setDataDelete] = useState([]);\r\n  const [error_dlg, seterror_dlg] = useState(false);\r\n  const [error_msg, seterror_msg] = useState(\"\");\r\n  const [isActiveLoading, setIsActiveLoading] = useState(false);\r\n\r\n  const history = useHistory();\r\n  const [locationData, setLocationData] = useState(null);\r\n\r\n  const [t, c] = translationHelpers('commercial_credit', 'common');\r\n\r\n  let dataStorage;\r\n  React.useEffect(() => {\r\n    // Read Api Service data\r\n    if (location.data !== null && location.data !== undefined) {\r\n      if (location.data.transactionId === undefined || location.data.transactionId.length <= 0) {\r\n        //location.data.transactionId = 0;\r\n        //checkAndCreateProcedure(location.data);\r\n        history.push(url.URL_DASHBOARD);\r\n        return;\r\n      } else {\r\n        sessionStorage.setItem('locationData', JSON.stringify(location.data));\r\n        setLocationData(location.data);\r\n        dataStorage = location.data;\r\n      }\r\n    } else {\r\n      //chequeamos si tenemos guardado en session\r\n      var result = sessionStorage.getItem('locationData');\r\n      if (result !== undefined && result !== null) {\r\n        result = JSON.parse(result);\r\n        setLocationData(result);\r\n        dataStorage = result;\r\n      }\r\n    }\r\n\r\n    LoadData(dataStorage);\r\n  }, []);\r\n\r\n\r\n  if (!props.policies) {\r\n    return null;\r\n  }\r\n\r\n\r\n\r\n  function LoadData(dataLocation) {\r\n    const backendServices = new BackendServices();\r\n    backendServices.consultarPoliticaCredito(dataLocation?.transactionId ?? 0).then(resp => {\r\n      setdataRows(resp.map((policy, index) => {\r\n        return (\r\n          <tr key={'row-' + policy.id + '-' + index}>\r\n            <th>{policy.parameter}</th>\r\n            <td>{policy.condition}</td>\r\n            <td>\r\n              {policy.comply ? 'Si' : 'No'}\r\n            </td>\r\n            <td>{policy.observations}</td>\r\n            {!props.preview && <td style={{ textAlign: \"right\" }}>\r\n              <Button type=\"button\" color=\"link\" onClick={(resp) => { editarSowActual(policy) }} className=\"btn btn-link\" ><i className=\"mdi mdi-border-color mdi-24px\"></i></Button>\r\n              <Button type=\"button\" color=\"link\" onClick={(resp) => { eliminarSowActual(policy) }} className=\"btn btn-link\" ><i className=\"mdi mdi-trash-can-outline mdi-24px\"></i></Button>\r\n            </td>}\r\n          </tr>\r\n\r\n        )\r\n      }\r\n      ));\r\n    });\r\n\r\n  }\r\n\r\n  // setdataRows(props.policies.map((policy) => {\r\n  //   return policy.conditions.map((condition, index) => (\r\n  //     <tr key={'row-' + policy.id + '-' + index}>\r\n  //       <th>{index === 0 ? policy.parameter : ''}</th>\r\n  //       <td>{condition.title}</td>\r\n  //       <td>\r\n  //         <AvField\r\n  //           className=\"form-control\"\r\n  //           name={\"comply[\" + index + \"]\"}\r\n  //           type=\"select\"\r\n  //           id={\"comply-\" + index}\r\n  //           value=\"N/A\">\r\n  //           <option>{c(\"Yes\")}</option>\r\n  //           <option>{c(\"No\")}</option>\r\n  //           <option>{c(\"N/A\")}</option>\r\n  //         </AvField>\r\n  //       </td>\r\n  //       <td>{condition.observations[0]}</td>\r\n  //     </tr>\r\n  //   )\r\n  //   )\r\n  // }\r\n  // ));\r\n\r\n  function toggleModal() {\r\n    setDisplayModal(!displayModal);\r\n  }\r\n\r\n  function handleSubmit(event, errors, values) {\r\n    event.preventDefault();\r\n    if (errors.length > 0) {\r\n      return;\r\n    }\r\n    // props.onSubmit(values);\r\n  }\r\n\r\n  function DataUpdate(values) {\r\n    setIsActiveLoading(true);\r\n    let datos = { ...values, transactId: locationData.transactionId };\r\n    const backendServices = new BackendServices();\r\n\r\n    backendServices.actualizarPoliticaCredito(datos).then(resp => {\r\n      if (resp.statusCode == \"200\") {\r\n        setSusscessDialog(true);\r\n      } else {\r\n        seterror_dlg(true)\r\n        seterror_msg(props.t(\"TheProcessCouldNotFinish\"))\r\n      }\r\n      setIsActiveLoading(false);\r\n    }).catch(err => {\r\n      seterror_dlg(true)\r\n      setIsActiveLoading(false);\r\n    });\r\n  }\r\n\r\n  function DataInsert(values) {\r\n    setIsActiveLoading(true);\r\n    let datos = { ...values, transactId: +locationData.transactionId, debtorId: props.debtorId };\r\n    const backendServices = new BackendServices();\r\n\r\n    backendServices.nuevoPoliticaCredito(datos).then(resp => {\r\n      if (resp.statusCode == \"200\") {\r\n        setSusscessDialog(true);\r\n        // LoadData();\r\n      } else {\r\n        seterror_dlg(true);\r\n        seterror_msg(props.t(\"TheProcessCouldNotFinish\"))\r\n      }\r\n      setIsActiveLoading(false);\r\n    }).catch(err => {\r\n      setIsActiveLoading(false);\r\n    });\r\n  }\r\n\r\n  function editarSowActual(data) {\r\n    toggleModal();\r\n    setActions('edit');\r\n    setDataSend(data);\r\n  }\r\n\r\n  function eliminarSowActual(data) {\r\n    setDataDelete(data)\r\n    setconfirm_alert(true);\r\n  }\r\n\r\n  function InsertShowCurrent() {\r\n    setActions('new');\r\n    setDataSend(null);\r\n  }\r\n\r\n\r\n  return (\r\n    <>\r\n      {/* <Card> */}\r\n      {/* <CardBody> */}\r\n      <div className=\"d-flex flex-row justify-content-between\">\r\n        {/* <h4 className=\"card-title\">{t(\"Credit Policy Review\")}</h4> */}\r\n        <HeaderSections title=\"Credit Policy Review\" t={t}></HeaderSections>\r\n\r\n      </div>\r\n      {/* <p className=\"card-title-desc\"></p> */}\r\n      <AvForm id=\"frmSearch\" className=\"needs-validation\" onSubmit={handleSubmit}>\r\n        <LoadingOverlay active={isActiveLoading} spinner text={t(\"WaitingPlease\")}>\r\n          <Row>\r\n            <Col lg=\"12\">\r\n              <div className=\"table-responsive\">\r\n                <Table className=\"table mb-0\">\r\n                  <thead className=\"table-light\">\r\n                    <tr>\r\n                      <th>{t(\"Parameters\")}</th>\r\n                      <th>{t(\"Conditions\")}</th>\r\n                      <th>{t(\"Comply\")}</th>\r\n                      <th>{t(\"Observations\")}</th>\r\n                      {!props.preview && <th>\r\n                        <Link to=\"#\" className=\"float-end\" onClick={() => { toggleModal(); InsertShowCurrent() }}>\r\n                          <i className=\"mdi mdi-plus-box-multiple-outline mdi-24px\"></i>{t(\"\")}\r\n                        </Link>\r\n                      </th>}\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    {dataRows}\r\n                  </tbody>\r\n                </Table>\r\n              </div>\r\n            </Col>\r\n          </Row>\r\n        </LoadingOverlay>\r\n      </AvForm>\r\n      {error_dlg ? (\r\n        <SweetAlert\r\n          error\r\n          title={t(\"ErrorDialog\")}\r\n          onConfirm={() => {\r\n            seterror_dlg(false)\r\n\r\n          }}\r\n        >\r\n          {error_msg}\r\n        </SweetAlert>\r\n      ) : null}\r\n      {/* </CardBody> */}\r\n      {displayModal &&\r\n        <ModalPolicy\r\n          isOpen={displayModal}\r\n          toggle={toggleModal}\r\n          DataUpdate={DataUpdate}\r\n          DataInsert={DataInsert}\r\n          actions={actions}\r\n          DataSend={DataSend}\r\n        />}\r\n\r\n      {\r\n        SusscessDialog ? (\r\n          <SweetAlert\r\n            success\r\n            title={t(\"SuccessDialog\")}\r\n            onConfirm={() => {\r\n              setSusscessDialog(false)\r\n              LoadData(locationData);\r\n            }}\r\n          >\r\n            {t(\"SuccessSaveMessage\")}\r\n          </SweetAlert>\r\n        ) : null\r\n      }\r\n\r\n      {\r\n        confirm_alert ? (\r\n          <SweetAlert\r\n            title={t(\"Areyousure\")}\r\n            warning\r\n            showCancel\r\n            confirmButtonText={t(\"Yesdeleteit\")}\r\n            confirmBtnBsStyle=\"success\"\r\n            cancelBtnBsStyle=\"danger\"\r\n            onConfirm={() => {\r\n              setIsActiveLoading(true);\r\n              const backendServices = new BackendServices();\r\n              backendServices.eliminarPoliticaCredit(locationData.transactionId, dataDelete.debtorId, dataDelete.itemId).then(resp => {\r\n                setIsActiveLoading(false);\r\n                if (resp.statusCode == \"500\") {\r\n                  setconfirm_alert(false)\r\n                  seterror_dlg(true)\r\n                } else {\r\n                  setconfirm_alert(false)\r\n                  setSusscessDialog(true)\r\n                }\r\n              }).catch(error => {\r\n                setIsActiveLoading(false);\r\n                setconfirm_alert(false)\r\n                seterror_dlg(true)\r\n              })\r\n            }}\r\n            onCancel={() => setconfirm_alert(false)}\r\n          >\r\n            {t(\"Youwontbeabletorevertthis\")}\r\n          </SweetAlert>\r\n        ) : null\r\n      }\r\n      {/* </Card> */}\r\n    </>\r\n  );\r\n};\r\n\r\nCreditPolicyReview.propTypes = {\r\n  policies: PropTypes.array\r\n};\r\n\r\nexport default CreditPolicyReview;\r\n"]},"metadata":{},"sourceType":"module"}