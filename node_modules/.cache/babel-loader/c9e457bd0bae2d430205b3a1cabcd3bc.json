{"ast":null,"code":"import _toConsumableArray from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useContext,useState,useEffect,useRef}from\"react\";import{translationHelpers}from'../../helpers';import{Link,useLocation}from\"react-router-dom\";import{Button,Row,Col}from\"reactstrap\";import{AvForm}from\"availity-reactstrap-validation\";import CustomerSection from\"./facilities/modalNewFacility/CustomerSection\";import ProposalSection from\"./facilities/modalNewFacility/ProposalSection\";import InterestRateSection from\"./facilities/modalNewFacility/InterestRateSection\";import CommissionSection from\"./facilities/modalNewFacility/CommissionSection\";import TermsSection from\"./facilities/modalNewFacility/TermsSection\";import DisbursementSection from\"./facilities/modalNewFacility/DisbursementSection\";import WarrantsSection from\"./facilities/modalNewFacility/WarrantsSection\";import SuretiesSection from\"./facilities/modalNewFacility/SuretiesSection\";import FinancialConditionsSection from\"./facilities/modalNewFacility/FinancialConditionsSection\";import LtvSection from\"./facilities/modalNewFacility/LtvSection\";import AmbientalRiskSection from\"./facilities/modalNewFacility/AmbientalRiskSection\";import FinantialCovenantSection from\"./facilities/modalNewFacility/FinantialCovenantSection\";import LegalDocumentationSection from\"./facilities/modalNewFacility/LegalDocumentationSection\";import ProvisionSection from\"./facilities/modalNewFacility/ProvisionSection\";import CreditRiskSection from\"./facilities/modalNewFacility/CreditRiskSection\";import OtherConditionsSection from\"./facilities/modalNewFacility/OtherConditionsSection\";import{BackendServices,CoreServices}from\"../../services\";import CreditProposalContext from\"./CreditProposalContext\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var FormNewFacility=/*#__PURE__*/React.forwardRef(function(props,ref){var _useState=useState({\"requestId\":\"XYZ892022\",\"cr\":\"\",\"amount\":0,\"debtor\":\"\",\"clientTypeId\":0,\"balance\":0,\"proposalTypeId\":\"\",\"proposalTypeName\":\"\",\"facilityTypeId\":\"\",\"purpose\":\"\",\"sublimits\":\"\",\"proposalRate\":0,\"noSubsidyRate\":0,\"effectiveRate\":0,\"feci\":true,\"termDays\":0,\"termDescription\":\"\",\"ltv\":0,\"finantialConditions\":\"\",\"environmentRiskCategory\":0,\"covenant\":\"\",\"environmentRiskOpinion\":\"\",\"finantialCovenant\":\"\",\"legalDocumentation\":\"\",\"creditRiskOpinion\":\"\",\"provision\":\"\",\"numero\":\"\",\"otherConditions\":\"\"}),_useState2=_slicedToArray(_useState,2),dataSet=_useState2[0],setdataSet=_useState2[1];var _useState3=useState({tipoPropuestaRequerido:false,subPropuestaRequerido:false,tipoFacilidadRequerido:false}),_useState4=_slicedToArray(_useState3,2),dataValidation=_useState4[0],setdataValidation=_useState4[1];var context=useContext(CreditProposalContext);var propostalSectionRef=useRef();var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),formValid=_useState6[0],setFormValid=_useState6[1];var location=useLocation();var _useState7=useState(location.data),_useState8=_slicedToArray(_useState7,2),dataLocation=_useState8[0],setData=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),commissions=_useState10[0],setCommissions=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),disbursementTerms=_useState12[0],setDisbursementTerms=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),paymentPrograms=_useState14[0],setPaymentPrograms=_useState14[1];var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),disbursementMethods=_useState16[0],setDisbursementMethods=_useState16[1];var _useState17=useState([]),_useState18=_slicedToArray(_useState17,2),warrants=_useState18[0],setWarrants=_useState18[1];var _useState19=useState([]),_useState20=_slicedToArray(_useState19,2),sureties=_useState20[0],setSureties=_useState20[1];var _useState21=useState([]),_useState22=_slicedToArray(_useState21,2),otherconditions=_useState22[0],setOtherconditions=_useState22[1];var _translationHelpers=translationHelpers('commercial_credit','common'),_translationHelpers2=_slicedToArray(_translationHelpers,2),t=_translationHelpers2[0],c=_translationHelpers2[1];React.useImperativeHandle(ref,function(){return{submit:function submit(){var validate=arguments.length>0&&arguments[0]!==undefined?arguments[0]:true;var form=document.getElementById('formNewFacility');if(validate){if(formValid){form.requestSubmit();return true;}return false;}else{form.requestSubmit();return true;}},getFormValidation:function getFormValidation(){return formValid;}};});// services\nvar backendServices=new BackendServices();useEffect(function(){// Read Api Service Data\nvar transactionId=context.transactionId;backendServices.consultPrincipalDebtor(transactionId).then(function(resp){dataSet.numero=resp.clientDocId;setdataSet(dataSet);});backendServices.consultFacilidadPropCred(12,\"XYZ432022\").then(function(resp){if(resp!=undefined){dataSet.cr=resp.cr;dataSet.amount=resp.amount;dataSet.debtor=resp.debtor;dataSet.clientTypeId=resp.clientTypeId;dataSet.balance=resp.balance;dataSet.proposalTypeId=resp.proposalTypeId;dataSet.proposalTypeName=resp.proposalTypeName;dataSet.facilityTypeId=resp.facilityTypeId;dataSet.purpose=resp.purpose;dataSet.sublimits=resp.sublimits;dataSet.proposalRate=resp.proposalRate;dataSet.noSubsidyRate=resp.noSubsidyRate;dataSet.effectiveRate=resp.effectiveRate;dataSet.feci=resp.feci;dataSet.termDays=resp.termDays;dataSet.termDescription=resp.termDescription;dataSet.ltv=resp.ltv;dataSet.finantialConditions=resp.finantialConditions;dataSet.environmentRiskCategory=resp.environmentRiskCategory;dataSet.covenant=resp.covenant;dataSet.environmentRiskOpinion=resp.environmentRiskOpinion;dataSet.finantialCovenant=resp.finantialCovenant;dataSet.legalDocumentation=resp.legalDocumentation;dataSet.creditRiskOpinion=resp.creditRiskOpinion;dataSet.provision=resp.provision;dataSet.otherConditions=resp.provision;setdataSet(dataSet);}});},[]);function handleSubmit(event,errors,values){if(propostalSectionRef.current.dataReturn.proposalTypeId==null){dataValidation.tipoPropuestaRequerido=true;setdataValidation(dataValidation);return;}else{values.proposalTypeId=propostalSectionRef.current.dataReturn.proposalTypeId;dataValidation.tipoPropuestaRequerido=false;setdataValidation(dataValidation);}if(propostalSectionRef.current.dataReturn.proposalTypeName==null){dataValidation.subPropuestaRequerido=true;setdataValidation(dataValidation);return;}else{values.proposalTypeName=propostalSectionRef.current.dataReturn.proposalTypeName;dataValidation.subPropuestaRequerido=false;setdataValidation(dataValidation);}if(propostalSectionRef.current.dataReturn.facilityTypeId==null){dataValidation.tipoFacilidadRequerido=true;setdataValidation(dataValidation);return;}else{values.facilityTypeId=propostalSectionRef.current.dataReturn.facilityTypeId;dataValidation.tipoFacilidadRequerido=false;setdataValidation(dataValidation);}event.preventDefault();if(errors.length>0){return;}if(event.target.id!=='formNewFacility'){return;}values.amount=Number(values.amount);values.clientTypeId=Number(1);values.balance=Number(values.balance);values.proposalRate=Number(values.proposalRate);values.noSubsidyRate=Number(values.noSubsidyRate);values.effectiveRate=Number(values.effectiveRate);values.feci=values.feci==\"true\"?true:false;values.termDays=Number(values.termDays);values.environmentRiskCategory=Number(values.environmentRiskCategory);console.log('submit new facility',values);saveNewFacility(values).then(function(result){// props.onSave(values);\nprops.onDismiss();});}function saveNewFacility(values){var requestId=context.requestId;var data=Object.assign({requestId:requestId},values);return backendServices.newFacilityPropCred(data);}function handleCancel(){props.onDismiss();}function handleNewCommission(newItem){var newCommissions=[].concat(_toConsumableArray(commissions),[newItem]);setCommissions(newCommissions);}function handleDeleteCommission(item){var itemIndex=commissions.indexOf(item);if(itemIndex===-1){return;}var newCommissions=_toConsumableArray(commissions);newCommissions.splice(itemIndex,1);setCommissions(newCommissions);}function handleNewDisbursementTerm(newItem){var newDisbursementTerms=[].concat(_toConsumableArray(disbursementTerms),[newItem]);setDisbursementTerms(newDisbursementTerms);}function handleDeleteDisbursementTerm(item){var itemIndex=disbursementTerms.indexOf(item);if(itemIndex===-1){return;}var newDisbursementTerms=_toConsumableArray(disbursementTerms);newDisbursementTerms.splice(itemIndex,1);setDisbursementTerms(newDisbursementTerms);}function handleNewPaymentProgram(newItem){var newPaymentPrograms=[].concat(_toConsumableArray(paymentPrograms),[newItem]);setPaymentPrograms(newPaymentPrograms);}function handleDeletePaymentProgram(item){var itemIndex=paymentPrograms.indexOf(item);if(itemIndex===-1){return;}var newPaymentPrograms=_toConsumableArray(paymentPrograms);newPaymentPrograms.splice(itemIndex,1);setPaymentPrograms(newPaymentPrograms);}function handleNewDisbursementMethod(newItem){var newDisbursementMethods=[].concat(_toConsumableArray(disbursementMethods),[newItem]);setDisbursementMethods(newDisbursementMethods);}function handleDeleteDisbursementMethod(item){var itemIndex=disbursementMethods.indexOf(item);if(itemIndex===-1){return;}var newDisbursementMethods=_toConsumableArray(disbursementMethods);newDisbursementMethods.splice(itemIndex,1);setDisbursementMethods(newDisbursementMethods);}function handleNewWarrant(newItem){var newWarrants=[].concat(_toConsumableArray(warrants),[newItem]);setWarrants(newWarrants);}function handleDeleteWarrant(item){var itemIndex=warrants.indexOf(item);if(itemIndex===-1){return;}var newWarrants=_toConsumableArray(warrants);newWarrants.splice(itemIndex,1);setWarrants(newWarrants);}function handleNewSurety(newItem){var newSureties=[].concat(_toConsumableArray(sureties),[newItem]);setSureties(newSureties);}function handleDeleteSurety(item){console.log('delete surety',item);var itemIndex=sureties.indexOf(item);if(itemIndex===-1){return;}var newSureties=_toConsumableArray(sureties);newSureties.splice(itemIndex,1);setSureties(newSureties);}function handleNewOtherCondition(newItem){var newOtherConditions=[].concat(_toConsumableArray(otherconditions),[newItem]);setOtherconditions(newOtherConditions);}return/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(\"h5\",{children:t(\"Facility\")}),/*#__PURE__*/_jsx(\"p\",{className:\"card-title-desc\"}),/*#__PURE__*/_jsxs(AvForm,{id:\"formNewFacility\",className:\"needs-validation\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(Row,{className:\"mb-3\",children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsx(CustomerSection,{dataLocation:dataLocation,validation:dataValidation,dataSet:dataSet,identificationList:props.identificationList})})}),/*#__PURE__*/_jsx(Row,{className:\"mb-3\",children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsx(ProposalSection,{validation:dataValidation,dataSet:dataSet,ref:propostalSectionRef})})}),/*#__PURE__*/_jsx(Row,{className:\"mb-3\",children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsx(InterestRateSection,{validation:dataValidation,dataSet:dataSet})})}),/*#__PURE__*/_jsx(Row,{className:\"mb-3\",children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsx(CommissionSection,{validation:dataValidation,dataSet:dataSet,items:commissions,onSaveItem:handleNewCommission,onDeleteItem:handleDeleteCommission})})}),/*#__PURE__*/_jsx(Row,{className:\"mb-3\",children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsx(TermsSection,{validation:dataValidation,dataSet:dataSet})})}),/*#__PURE__*/_jsx(Row,{className:\"mb-3\",children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsx(DisbursementSection,{validation:dataValidation,dataSet:dataSet,disbursementTerms:disbursementTerms,onSaveDisbursementTerm:handleNewDisbursementTerm,onDeleteDisbursementTerm:handleDeleteDisbursementTerm,paymentPrograms:paymentPrograms,onSavePaymentProgram:handleNewPaymentProgram,onDeletePaymentProgram:handleDeletePaymentProgram,disbursementMethods:disbursementMethods,onSaveDisbursementMethod:handleNewDisbursementMethod,onDeleteDisbursementMethod:handleDeleteDisbursementMethod})})}),/*#__PURE__*/_jsx(Row,{className:\"mb-3\",children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsx(WarrantsSection,{validation:dataValidation,dataSet:dataSet,warrants:warrants,onSaveItem:handleNewWarrant,onDeleteItem:handleDeleteWarrant})})}),/*#__PURE__*/_jsx(Row,{className:\"mb-3\",children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsx(LtvSection,{validation:dataValidation,dataSet:dataSet})})}),/*#__PURE__*/_jsx(Row,{className:\"mb-3\",children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsx(SuretiesSection,{validation:dataValidation,dataSet:dataSet,sureties:sureties,onSaveItem:handleNewSurety,onDeleteItem:handleDeleteSurety})})}),/*#__PURE__*/_jsx(Row,{className:\"mb-3\",children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsx(FinancialConditionsSection,{validation:dataValidation,dataSet:dataSet})})}),/*#__PURE__*/_jsx(Row,{className:\"mb-3\",children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsx(AmbientalRiskSection,{validation:dataValidation,dataSet:dataSet})})}),/*#__PURE__*/_jsx(Row,{className:\"mb-3\",children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsx(FinantialCovenantSection,{validation:dataValidation,dataSet:dataSet})})}),/*#__PURE__*/_jsx(Row,{className:\"mb-3\",children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsx(LegalDocumentationSection,{validation:dataValidation,dataSet:dataSet})})}),/*#__PURE__*/_jsx(Row,{className:\"mb-3\",children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsx(OtherConditionsSection,{validation:dataValidation,dataSet:dataSet,otherconditions:otherconditions,onSaveOtherConditions:handleNewOtherCondition})})}),/*#__PURE__*/_jsx(Row,{className:\"mb-3\",children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsx(CreditRiskSection,{validation:dataValidation,dataSet:dataSet})})}),/*#__PURE__*/_jsx(Row,{className:\"mb-3\",children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsx(ProvisionSection,{validation:dataValidation,dataSet:dataSet})})}),/*#__PURE__*/_jsx(Row,{className:\"my-2\",children:/*#__PURE__*/_jsxs(Col,{xl:\"12 text-end\",children:[/*#__PURE__*/_jsx(Link,{to:\"#\",className:\"btn btn-dark\",onClick:handleCancel,style:{margin:'5px'},children:c(\"Cancel\")}),/*#__PURE__*/_jsx(Button,{className:\"btn btn-primary\",type:\"submit\",color:\"success\",style:{margin:'5px'},children:c(\"Save\")})]})})]})]});});export default FormNewFacility;","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/components/PropuestaCreditoComercial/FormNewFacility.js"],"names":["React","useContext","useState","useEffect","useRef","translationHelpers","Link","useLocation","Button","Row","Col","AvForm","CustomerSection","ProposalSection","InterestRateSection","CommissionSection","TermsSection","DisbursementSection","WarrantsSection","SuretiesSection","FinancialConditionsSection","LtvSection","AmbientalRiskSection","FinantialCovenantSection","LegalDocumentationSection","ProvisionSection","CreditRiskSection","OtherConditionsSection","BackendServices","CoreServices","CreditProposalContext","FormNewFacility","forwardRef","props","ref","dataSet","setdataSet","tipoPropuestaRequerido","subPropuestaRequerido","tipoFacilidadRequerido","dataValidation","setdataValidation","context","propostalSectionRef","formValid","setFormValid","location","data","dataLocation","setData","commissions","setCommissions","disbursementTerms","setDisbursementTerms","paymentPrograms","setPaymentPrograms","disbursementMethods","setDisbursementMethods","warrants","setWarrants","sureties","setSureties","otherconditions","setOtherconditions","t","c","useImperativeHandle","submit","validate","form","document","getElementById","requestSubmit","getFormValidation","backendServices","transactionId","consultPrincipalDebtor","then","resp","numero","clientDocId","consultFacilidadPropCred","undefined","cr","amount","debtor","clientTypeId","balance","proposalTypeId","proposalTypeName","facilityTypeId","purpose","sublimits","proposalRate","noSubsidyRate","effectiveRate","feci","termDays","termDescription","ltv","finantialConditions","environmentRiskCategory","covenant","environmentRiskOpinion","finantialCovenant","legalDocumentation","creditRiskOpinion","provision","otherConditions","handleSubmit","event","errors","values","current","dataReturn","preventDefault","length","target","id","Number","console","log","saveNewFacility","result","onDismiss","requestId","Object","assign","newFacilityPropCred","handleCancel","handleNewCommission","newItem","newCommissions","handleDeleteCommission","item","itemIndex","indexOf","splice","handleNewDisbursementTerm","newDisbursementTerms","handleDeleteDisbursementTerm","handleNewPaymentProgram","newPaymentPrograms","handleDeletePaymentProgram","handleNewDisbursementMethod","newDisbursementMethods","handleDeleteDisbursementMethod","handleNewWarrant","newWarrants","handleDeleteWarrant","handleNewSurety","newSureties","handleDeleteSurety","handleNewOtherCondition","newOtherConditions","identificationList","margin"],"mappings":"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","sourcesContent":["import React, { useContext, useState, useEffect, useRef } from \"react\"\r\nimport PropTypes from 'prop-types'\r\nimport { translationHelpers } from '../../helpers';\r\nimport { Link, useLocation } from \"react-router-dom\"\r\nimport {\r\n  Button,\r\n  Row,\r\n  Col,\r\n} from \"reactstrap\"\r\nimport { AvForm } from \"availity-reactstrap-validation\"\r\nimport CustomerSection from \"./facilities/modalNewFacility/CustomerSection\";\r\nimport ProposalSection from \"./facilities/modalNewFacility/ProposalSection\"\r\nimport InterestRateSection from \"./facilities/modalNewFacility/InterestRateSection\"\r\nimport CommissionSection from \"./facilities/modalNewFacility/CommissionSection\"\r\nimport TermsSection from \"./facilities/modalNewFacility/TermsSection\"\r\nimport DisbursementSection from \"./facilities/modalNewFacility/DisbursementSection\"\r\nimport WarrantsSection from \"./facilities/modalNewFacility/WarrantsSection\"\r\nimport SuretiesSection from \"./facilities/modalNewFacility/SuretiesSection\"\r\nimport FinancialConditionsSection from \"./facilities/modalNewFacility/FinancialConditionsSection\"\r\nimport LtvSection from \"./facilities/modalNewFacility/LtvSection\"\r\nimport AmbientalRiskSection from \"./facilities/modalNewFacility/AmbientalRiskSection\"\r\nimport FinantialCovenantSection from \"./facilities/modalNewFacility/FinantialCovenantSection\"\r\nimport LegalDocumentationSection from \"./facilities/modalNewFacility/LegalDocumentationSection\"\r\nimport ProvisionSection from \"./facilities/modalNewFacility/ProvisionSection\"\r\nimport CreditRiskSection from \"./facilities/modalNewFacility/CreditRiskSection\"\r\nimport OtherConditionsSection from \"./facilities/modalNewFacility/OtherConditionsSection\"\r\nimport { BackendServices, CoreServices } from \"../../services\";\r\nimport CreditProposalContext from \"./CreditProposalContext\";\r\n\r\n\r\nconst FormNewFacility = React.forwardRef((props, ref) => {\r\n  const [dataSet, setdataSet] = useState({\r\n    \"requestId\": \"XYZ892022\",\r\n    \"cr\": \"\",\r\n    \"amount\": 0,\r\n    \"debtor\": \"\",\r\n    \"clientTypeId\": 0,\r\n    \"balance\": 0,\r\n    \"proposalTypeId\": \"\",\r\n    \"proposalTypeName\": \"\",\r\n    \"facilityTypeId\": \"\",\r\n    \"purpose\": \"\",\r\n    \"sublimits\": \"\",\r\n    \"proposalRate\": 0,\r\n    \"noSubsidyRate\": 0,\r\n    \"effectiveRate\": 0,\r\n    \"feci\": true,\r\n    \"termDays\": 0,\r\n    \"termDescription\": \"\",\r\n    \"ltv\": 0,\r\n    \"finantialConditions\": \"\",\r\n    \"environmentRiskCategory\": 0,\r\n    \"covenant\": \"\",\r\n    \"environmentRiskOpinion\": \"\",\r\n    \"finantialCovenant\": \"\",\r\n    \"legalDocumentation\": \"\",\r\n    \"creditRiskOpinion\": \"\",\r\n    \"provision\": \"\",\r\n    \"numero\": \"\",\r\n    \"otherConditions\": \"\",\r\n  });\r\n\r\n  const [dataValidation, setdataValidation] = useState({\r\n    tipoPropuestaRequerido: false,\r\n    subPropuestaRequerido: false,\r\n    tipoFacilidadRequerido: false,\r\n  });\r\n\r\n  const context = useContext(CreditProposalContext);\r\n  const propostalSectionRef = useRef();\r\n  const [formValid, setFormValid] = useState(false);\r\n\r\n  const location = useLocation();\r\n  const [dataLocation, setData] = useState(location.data);\r\n  const [commissions, setCommissions] = useState([]);\r\n  const [disbursementTerms, setDisbursementTerms] = useState([]);\r\n  const [paymentPrograms, setPaymentPrograms] = useState([]);\r\n  const [disbursementMethods, setDisbursementMethods] = useState([]);\r\n  const [warrants, setWarrants] = useState([]);\r\n  const [sureties, setSureties] = useState([]);\r\n  const [otherconditions, setOtherconditions] = useState([]);\r\n  const [t, c] = translationHelpers('commercial_credit', 'common');\r\n  React.useImperativeHandle(ref, () => ({\r\n    submit: (validate = true) => {\r\n      const form = document.getElementById('formNewFacility');\r\n      if (validate) {\r\n        if (formValid) {\r\n          form.requestSubmit();\r\n          return true;\r\n        }\r\n        return false;\r\n      }\r\n      else {\r\n        form.requestSubmit();\r\n        return true;\r\n      }\r\n    },\r\n    getFormValidation: () => {\r\n      return formValid;\r\n    }\r\n  }));\r\n  // services\r\n  const backendServices = new BackendServices();\r\n\r\n  useEffect(() => {\r\n    // Read Api Service Data\r\n    const { transactionId } = context;\r\n    backendServices.consultPrincipalDebtor(transactionId).then(resp => {\r\n      dataSet.numero = resp.clientDocId\r\n      setdataSet(dataSet);\r\n    });\r\n    backendServices.consultFacilidadPropCred(12, \"XYZ432022\").then(resp => {\r\n      if (resp != undefined) {\r\n        dataSet.cr = resp.cr;\r\n        dataSet.amount = resp.amount;\r\n        dataSet.debtor = resp.debtor;\r\n        dataSet.clientTypeId = resp.clientTypeId;\r\n        dataSet.balance = resp.balance;\r\n        dataSet.proposalTypeId = resp.proposalTypeId;\r\n        dataSet.proposalTypeName = resp.proposalTypeName;\r\n        dataSet.facilityTypeId = resp.facilityTypeId;\r\n        dataSet.purpose = resp.purpose;\r\n        dataSet.sublimits = resp.sublimits;\r\n        dataSet.proposalRate = resp.proposalRate;\r\n        dataSet.noSubsidyRate = resp.noSubsidyRate;\r\n        dataSet.effectiveRate = resp.effectiveRate;\r\n        dataSet.feci = resp.feci;\r\n        dataSet.termDays = resp.termDays;\r\n        dataSet.termDescription = resp.termDescription;\r\n        dataSet.ltv = resp.ltv;\r\n        dataSet.finantialConditions = resp.finantialConditions;\r\n        dataSet.environmentRiskCategory = resp.environmentRiskCategory;\r\n        dataSet.covenant = resp.covenant;\r\n        dataSet.environmentRiskOpinion = resp.environmentRiskOpinion;\r\n        dataSet.finantialCovenant = resp.finantialCovenant;\r\n        dataSet.legalDocumentation = resp.legalDocumentation;\r\n        dataSet.creditRiskOpinion = resp.creditRiskOpinion;\r\n        dataSet.provision = resp.provision;\r\n        dataSet.otherConditions = resp.provision;\r\n        setdataSet(dataSet);\r\n      }\r\n    })\r\n  }, []);\r\n\r\n  function handleSubmit(event, errors, values) {\r\n    if (propostalSectionRef.current.dataReturn.proposalTypeId == null) {\r\n      dataValidation.tipoPropuestaRequerido = true;\r\n      setdataValidation(dataValidation);\r\n      return;\r\n    } else {\r\n      values.proposalTypeId = propostalSectionRef.current.dataReturn.proposalTypeId;\r\n      dataValidation.tipoPropuestaRequerido = false;\r\n      setdataValidation(dataValidation);\r\n    }\r\n    if (propostalSectionRef.current.dataReturn.proposalTypeName == null) {\r\n      dataValidation.subPropuestaRequerido = true;\r\n      setdataValidation(dataValidation);\r\n      return;\r\n    } else {\r\n      values.proposalTypeName = propostalSectionRef.current.dataReturn.proposalTypeName;\r\n      dataValidation.subPropuestaRequerido = false;\r\n      setdataValidation(dataValidation);\r\n    }\r\n    if (propostalSectionRef.current.dataReturn.facilityTypeId == null) {\r\n      dataValidation.tipoFacilidadRequerido = true;\r\n      setdataValidation(dataValidation);\r\n      return;\r\n    } else {\r\n      values.facilityTypeId = propostalSectionRef.current.dataReturn.facilityTypeId;\r\n      dataValidation.tipoFacilidadRequerido = false;\r\n      setdataValidation(dataValidation);\r\n    }\r\n    event.preventDefault();\r\n    if (errors.length > 0) {\r\n      return;\r\n    }\r\n    if (event.target.id !== 'formNewFacility') {\r\n      return;\r\n    }\r\n    values.amount = Number(values.amount);\r\n    values.clientTypeId = Number(1);\r\n    values.balance = Number(values.balance);\r\n    values.proposalRate = Number(values.proposalRate);\r\n    values.noSubsidyRate = Number(values.noSubsidyRate);\r\n    values.effectiveRate = Number(values.effectiveRate);\r\n    values.feci = values.feci == \"true\" ? true : false;\r\n    values.termDays = Number(values.termDays);\r\n    values.environmentRiskCategory = Number(values.environmentRiskCategory);\r\n    console.log('submit new facility', values);\r\n    saveNewFacility(values)\r\n      .then((result) => {\r\n        // props.onSave(values);\r\n        props.onDismiss();\r\n      });\r\n  }\r\n\r\n  function saveNewFacility(values) {\r\n    const { requestId } = context;\r\n    const data = Object.assign({\r\n      requestId\r\n    }, values);\r\n    return backendServices.newFacilityPropCred(data);\r\n  }\r\n\r\n  function handleCancel() {\r\n    props.onDismiss();\r\n  }\r\n\r\n  function handleNewCommission(newItem) {\r\n    const newCommissions = [...commissions, newItem];\r\n    setCommissions(newCommissions);\r\n  }\r\n\r\n  function handleDeleteCommission(item) {\r\n    const itemIndex = commissions.indexOf(item);\r\n    if (itemIndex === -1) {\r\n      return;\r\n    }\r\n    const newCommissions = [...commissions];\r\n    newCommissions.splice(itemIndex, 1);\r\n    setCommissions(newCommissions);\r\n  }\r\n\r\n  function handleNewDisbursementTerm(newItem) {\r\n    const newDisbursementTerms = [...disbursementTerms, newItem];\r\n    setDisbursementTerms(newDisbursementTerms);\r\n  }\r\n\r\n  function handleDeleteDisbursementTerm(item) {\r\n    const itemIndex = disbursementTerms.indexOf(item);\r\n    if (itemIndex === -1) {\r\n      return;\r\n    }\r\n    const newDisbursementTerms = [...disbursementTerms];\r\n    newDisbursementTerms.splice(itemIndex, 1);\r\n    setDisbursementTerms(newDisbursementTerms);\r\n  }\r\n\r\n  function handleNewPaymentProgram(newItem) {\r\n    const newPaymentPrograms = [...paymentPrograms, newItem];\r\n    setPaymentPrograms(newPaymentPrograms);\r\n  }\r\n\r\n  function handleDeletePaymentProgram(item) {\r\n    const itemIndex = paymentPrograms.indexOf(item);\r\n    if (itemIndex === -1) {\r\n      return;\r\n    }\r\n    const newPaymentPrograms = [...paymentPrograms];\r\n    newPaymentPrograms.splice(itemIndex, 1);\r\n    setPaymentPrograms(newPaymentPrograms);\r\n  }\r\n\r\n  function handleNewDisbursementMethod(newItem) {\r\n    const newDisbursementMethods = [...disbursementMethods, newItem];\r\n    setDisbursementMethods(newDisbursementMethods);\r\n  }\r\n\r\n  function handleDeleteDisbursementMethod(item) {\r\n    const itemIndex = disbursementMethods.indexOf(item);\r\n    if (itemIndex === -1) {\r\n      return;\r\n    }\r\n    const newDisbursementMethods = [...disbursementMethods];\r\n    newDisbursementMethods.splice(itemIndex, 1);\r\n    setDisbursementMethods(newDisbursementMethods);\r\n  }\r\n\r\n  function handleNewWarrant(newItem) {\r\n    const newWarrants = [...warrants, newItem];\r\n    setWarrants(newWarrants);\r\n  }\r\n\r\n  function handleDeleteWarrant(item) {\r\n    const itemIndex = warrants.indexOf(item);\r\n    if (itemIndex === -1) {\r\n      return;\r\n    }\r\n    const newWarrants = [...warrants];\r\n    newWarrants.splice(itemIndex, 1);\r\n    setWarrants(newWarrants);\r\n  }\r\n\r\n  function handleNewSurety(newItem) {\r\n    const newSureties = [...sureties, newItem];\r\n    setSureties(newSureties);\r\n  }\r\n\r\n  function handleDeleteSurety(item) {\r\n    console.log('delete surety', item);\r\n    const itemIndex = sureties.indexOf(item);\r\n    if (itemIndex === -1) {\r\n      return;\r\n    }\r\n    const newSureties = [...sureties];\r\n    newSureties.splice(itemIndex, 1);\r\n    setSureties(newSureties);\r\n  }\r\n\r\n  function handleNewOtherCondition(newItem) {\r\n    const newOtherConditions = [...otherconditions, newItem];\r\n    setOtherconditions(newOtherConditions);\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <h5>{t(\"Facility\")}</h5>\r\n      <p className=\"card-title-desc\"></p>\r\n\r\n      <AvForm id=\"formNewFacility\" className=\"needs-validation\" onSubmit={handleSubmit}>\r\n        <Row className=\"mb-3\">\r\n          <Col md=\"12\">\r\n            <CustomerSection dataLocation={dataLocation} validation={dataValidation} dataSet={dataSet} identificationList={props.identificationList} />\r\n          </Col>\r\n        </Row>\r\n        <Row className=\"mb-3\">\r\n          <Col md=\"12\">\r\n            <ProposalSection validation={dataValidation} dataSet={dataSet} ref={propostalSectionRef} />\r\n          </Col>\r\n        </Row>\r\n        <Row className=\"mb-3\">\r\n          <Col md=\"12\">\r\n            <InterestRateSection validation={dataValidation} dataSet={dataSet} />\r\n          </Col>\r\n        </Row>\r\n        <Row className=\"mb-3\">\r\n          <Col md=\"12\">\r\n            <CommissionSection validation={dataValidation} dataSet={dataSet} items={commissions}\r\n              onSaveItem={handleNewCommission}\r\n              onDeleteItem={handleDeleteCommission} />\r\n          </Col>\r\n        </Row>\r\n        <Row className=\"mb-3\">\r\n          <Col md=\"12\">\r\n            <TermsSection validation={dataValidation} dataSet={dataSet} />\r\n          </Col>\r\n        </Row>\r\n        <Row className=\"mb-3\">\r\n          <Col md=\"12\">\r\n            <DisbursementSection validation={dataValidation} dataSet={dataSet} disbursementTerms={disbursementTerms}\r\n              onSaveDisbursementTerm={handleNewDisbursementTerm}\r\n              onDeleteDisbursementTerm={handleDeleteDisbursementTerm}\r\n              paymentPrograms={paymentPrograms}\r\n              onSavePaymentProgram={handleNewPaymentProgram}\r\n              onDeletePaymentProgram={handleDeletePaymentProgram}\r\n              disbursementMethods={disbursementMethods}\r\n              onSaveDisbursementMethod={handleNewDisbursementMethod}\r\n              onDeleteDisbursementMethod={handleDeleteDisbursementMethod} />\r\n          </Col>\r\n        </Row>\r\n        <Row className=\"mb-3\">\r\n          <Col md=\"12\">\r\n            <WarrantsSection validation={dataValidation} dataSet={dataSet} warrants={warrants}\r\n              onSaveItem={handleNewWarrant}\r\n              onDeleteItem={handleDeleteWarrant} />\r\n          </Col>\r\n        </Row>\r\n        <Row className=\"mb-3\">\r\n          <Col md=\"12\">\r\n            <LtvSection validation={dataValidation} dataSet={dataSet} />\r\n          </Col>\r\n        </Row>\r\n        <Row className=\"mb-3\">\r\n          <Col md=\"12\">\r\n            <SuretiesSection validation={dataValidation} dataSet={dataSet} sureties={sureties}\r\n              onSaveItem={handleNewSurety}\r\n              onDeleteItem={handleDeleteSurety} />\r\n          </Col>\r\n        </Row>\r\n        <Row className=\"mb-3\">\r\n          <Col md=\"12\">\r\n            <FinancialConditionsSection validation={dataValidation} dataSet={dataSet} />\r\n          </Col>\r\n        </Row>\r\n        <Row className=\"mb-3\">\r\n          <Col md=\"12\">\r\n            <AmbientalRiskSection validation={dataValidation} dataSet={dataSet} />\r\n          </Col>\r\n        </Row>\r\n        <Row className=\"mb-3\">\r\n          <Col md=\"12\">\r\n            <FinantialCovenantSection validation={dataValidation} dataSet={dataSet} />\r\n          </Col>\r\n        </Row>\r\n        <Row className=\"mb-3\">\r\n          <Col md=\"12\">\r\n            <LegalDocumentationSection validation={dataValidation} dataSet={dataSet} />\r\n          </Col>\r\n        </Row>\r\n        <Row className=\"mb-3\">\r\n          <Col md=\"12\">\r\n            <OtherConditionsSection validation={dataValidation} dataSet={dataSet} otherconditions={otherconditions} onSaveOtherConditions={handleNewOtherCondition} />\r\n          </Col>\r\n        </Row>\r\n        <Row className=\"mb-3\">\r\n          <Col md=\"12\">\r\n            <CreditRiskSection validation={dataValidation} dataSet={dataSet} />\r\n          </Col>\r\n        </Row>\r\n        <Row className=\"mb-3\">\r\n          <Col md=\"12\">\r\n            <ProvisionSection validation={dataValidation} dataSet={dataSet} />\r\n          </Col>\r\n        </Row>\r\n\r\n        <Row className=\"my-2\">\r\n          <Col xl=\"12 text-end\">\r\n            <Link to=\"#\" className=\"btn btn-dark\"\r\n              onClick={handleCancel} style={{ margin: '5px' }}>\r\n              {c(\"Cancel\")}\r\n            </Link>\r\n            <Button className=\"btn btn-primary\" type=\"submit\" color=\"success\" style={{ margin: '5px' }}>\r\n              {c(\"Save\")}\r\n            </Button>\r\n          </Col>\r\n        </Row>\r\n      </AvForm>\r\n\r\n    </React.Fragment>\r\n  )\r\n});\r\n\r\nFormNewFacility.propTypes = {\r\n  isOpen: PropTypes.bool,\r\n  onDismiss: PropTypes.func,\r\n  onSave: PropTypes.func\r\n};\r\n\r\n\r\nexport default FormNewFacility;\r\n"]},"metadata":{},"sourceType":"module"}