{"ast":null,"code":"var _jsxFileName = \"D:\\\\_PROJECTS\\\\_SOAINT\\\\JBPM\\\\App\\\\banescocreditoscomerciales\\\\src\\\\pages\\\\CommercialCredit\\\\17_RiesgoCredito\\\\riesgoCredito\\\\Conclusiones.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect, useContext, useImperativeHandle, forwardRef } from 'react';\nimport PropTypes from 'prop-types';\nimport { useTranslation, withTranslation } from \"react-i18next\";\nimport { useLocation, useHistory } from 'react-router-dom';\nimport { Card, CardBody, Row, Col, Button, Label } from \"reactstrap\";\nimport { AvForm, AvField, AvGroup } from \"availity-reactstrap-validation\";\nimport RiesgoCreditoContext from '../RiesgoCreditoContext';\nimport ServicioRiesgoCredito from '../../../../services/RiesgoCredito/RiesgoCredito';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst FormConclusiones = /*#__PURE__*/forwardRef(_c = _s((props, ref) => {\n  _s();\n\n  const history = useHistory();\n  const location = useLocation();\n  const {\n    t,\n    i18n\n  } = useTranslation();\n  const [formValid, setFormValid] = useState(false);\n  const [conclusions, setConclusions] = useState('');\n  const [isUpdatingRecord, setIsUpdatingRecord] = useState(false);\n  const [locationData, setLocationData] = useState(null); // services\n\n  const context = useContext(RiesgoCreditoContext);\n  const servicioRiesgoCredito = new ServicioRiesgoCredito();\n  useImperativeHandle(ref, () => ({\n    submit: () => {\n      const form = document.getElementById('formRiesgoCreditoConclusiones');\n      form.requestSubmit();\n      return formValid;\n    },\n    getFormValidation: () => {\n      return formValid;\n    }\n  }));\n  useEffect(() => {\n    let dataSession = null;\n\n    if (location.data !== null && location.data !== undefined) {\n      if (location.data.transactionId === undefined || location.data.transactionId.length <= 0) {//location.data.transactionId = 0;\n        //checkAndCreateProcedure(location.data);\n      } else {\n        sessionStorage.setItem('locationData', JSON.stringify(location.data));\n        setLocationData(location.data);\n        dataSession = location.data;\n      }\n    } else {\n      //chequeamos si tenemos guardado en session\n      var result = sessionStorage.getItem('locationData');\n\n      if (result !== undefined && result !== null) {\n        result = JSON.parse(result);\n        setLocationData(result);\n        dataSession = result;\n      }\n    } // load data\n\n\n    servicioRiesgoCredito.consultarRiesgoCreditoComercial(dataSession.transactionId).then(info => {\n      console.log(\"riesgo\", info);\n\n      if (info.transactId) {\n        setIsUpdatingRecord(true);\n      }\n\n      setConclusions(info.conclusions);\n    }).catch(error => {\n      console.error('error fetch riesgo credito', error);\n    });\n  }, []);\n\n  function handleSubmit(event, errors, values) {\n    event.preventDefault();\n    const isValid = errors.length === 0;\n    setFormValid(isValid);\n\n    if (isValid) {\n      servicioRiesgoCredito.guardarInformacionRiesgoCredito(locationData.transactionId, values, isUpdatingRecord).then(result => {\n        props.onSaveSuccess();\n      }).catch(error => {\n        console.error('save error', error);\n      });\n    }\n  }\n\n  return /*#__PURE__*/_jsxDEV(Card, {\n    children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n      className: \"card-sub-title\",\n      children: t(\"ConclusionsAndRecomendations\")\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(CardBody, {\n      children: /*#__PURE__*/_jsxDEV(AvForm, {\n        id: \"formRiesgoCreditoConclusiones\",\n        className: \"needs-validation\",\n        onSubmit: handleSubmit,\n        children: /*#__PURE__*/_jsxDEV(Row, {\n          className: \"my-3\",\n          children: /*#__PURE__*/_jsxDEV(Col, {\n            md: \"12\",\n            children: /*#__PURE__*/_jsxDEV(AvGroup, {\n              children: [/*#__PURE__*/_jsxDEV(Label, {\n                htmlFor: \"conclusions\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 108,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(AvField, {\n                className: \"form-control\",\n                name: \"conclusions\",\n                type: \"textarea\",\n                disabled: (props === null || props === void 0 ? void 0 : props.validacion) ? true : false,\n                id: \"conclusions\",\n                value: conclusions,\n                rows: \"7\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 109,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 107,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 100,\n    columnNumber: 5\n  }, this);\n}, \"Ah4L3XZeHum3vYUG3+oVl97226k=\", false, function () {\n  return [useHistory, useLocation, useTranslation, useImperativeHandle];\n}));\n_c2 = FormConclusiones;\nFormConclusiones.propTypes = {\n  onSaveSuccess: PropTypes.func\n};\nexport default FormConclusiones;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"FormConclusiones$forwardRef\");\n$RefreshReg$(_c2, \"FormConclusiones\");","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/pages/CommercialCredit/17_RiesgoCredito/riesgoCredito/Conclusiones.js"],"names":["useState","useEffect","useContext","useImperativeHandle","forwardRef","PropTypes","useTranslation","withTranslation","useLocation","useHistory","Card","CardBody","Row","Col","Button","Label","AvForm","AvField","AvGroup","RiesgoCreditoContext","ServicioRiesgoCredito","FormConclusiones","props","ref","history","location","t","i18n","formValid","setFormValid","conclusions","setConclusions","isUpdatingRecord","setIsUpdatingRecord","locationData","setLocationData","context","servicioRiesgoCredito","submit","form","document","getElementById","requestSubmit","getFormValidation","dataSession","data","undefined","transactionId","length","sessionStorage","setItem","JSON","stringify","result","getItem","parse","consultarRiesgoCreditoComercial","then","info","console","log","transactId","catch","error","handleSubmit","event","errors","values","preventDefault","isValid","guardarInformacionRiesgoCredito","onSaveSuccess","validacion","propTypes","func"],"mappings":"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","sourcesContent":["import { useState, useEffect, useContext, useImperativeHandle, forwardRef } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { useTranslation, withTranslation } from \"react-i18next\"\r\nimport { useLocation, useHistory } from 'react-router-dom'\r\n\r\n\r\nimport {\r\n  Card,\r\n  CardBody,\r\n  Row,\r\n  Col,\r\n  Button,\r\n  Label\r\n} from \"reactstrap\"\r\n\r\nimport { AvForm, AvField, AvGroup } from \"availity-reactstrap-validation\"\r\nimport RiesgoCreditoContext from '../RiesgoCreditoContext';\r\nimport ServicioRiesgoCredito from '../../../../services/RiesgoCredito/RiesgoCredito';\r\n\r\nconst FormConclusiones = forwardRef((props, ref) => {\r\n  const history = useHistory();\r\n  const location = useLocation()\r\n  const { t, i18n } = useTranslation();\r\n\r\n  const [formValid, setFormValid] = useState(false);\r\n  const [conclusions, setConclusions] = useState('');\r\n  const [isUpdatingRecord, setIsUpdatingRecord] = useState(false);\r\n  const [locationData, setLocationData] = useState(null);\r\n\r\n  // services\r\n  const context = useContext(RiesgoCreditoContext);\r\n  const servicioRiesgoCredito = new ServicioRiesgoCredito();\r\n\r\n\r\n  useImperativeHandle(ref, () => ({\r\n    submit: () => {\r\n      const form = document.getElementById('formRiesgoCreditoConclusiones');\r\n      form.requestSubmit();\r\n      return formValid;\r\n    },\r\n    getFormValidation: () => {\r\n      return formValid;\r\n    }\r\n  }));\r\n\r\n  useEffect(() => {\r\n    let dataSession=null;\r\n    if (location.data !== null && location.data !== undefined) {\r\n      if (location.data.transactionId === undefined || location.data.transactionId.length <= 0) {\r\n        //location.data.transactionId = 0;\r\n        //checkAndCreateProcedure(location.data);\r\n      }\r\n      else {\r\n        sessionStorage.setItem('locationData', JSON.stringify(location.data));\r\n        setLocationData(location.data);\r\n        dataSession=location.data;\r\n      }\r\n    }\r\n    else {\r\n      //chequeamos si tenemos guardado en session\r\n      var result = sessionStorage.getItem('locationData');\r\n      if (result !== undefined && result !== null) {\r\n        result = JSON.parse(result);\r\n        setLocationData(result);\r\n        dataSession=result\r\n      }\r\n    }\r\n    // load data\r\n    servicioRiesgoCredito.consultarRiesgoCreditoComercial(dataSession.transactionId)\r\n      .then((info) => {\r\n\r\n        console.log(\"riesgo\", info);\r\n        if (info.transactId) {\r\n          setIsUpdatingRecord(true);\r\n        }\r\n        setConclusions(info.conclusions);\r\n      })\r\n      .catch((error) => {\r\n        console.error('error fetch riesgo credito', error);\r\n      });\r\n  }, []);\r\n\r\n  function handleSubmit(event, errors, values) {\r\n    event.preventDefault();\r\n    const isValid = errors.length === 0;\r\n    setFormValid(isValid);\r\n    if (isValid) {\r\n      servicioRiesgoCredito.guardarInformacionRiesgoCredito(locationData.transactionId, values, isUpdatingRecord)\r\n        .then((result) => {\r\n          props.onSaveSuccess();\r\n        })\r\n        .catch((error) => {\r\n          console.error('save error', error);\r\n        });\r\n    }\r\n  }\r\n\r\n\r\n  return (\r\n    <Card>\r\n      <h5 className=\"card-sub-title\">{t(\"ConclusionsAndRecomendations\")}</h5>\r\n\r\n      <CardBody>\r\n        <AvForm id=\"formRiesgoCreditoConclusiones\" className=\"needs-validation\" onSubmit={handleSubmit}>\r\n          <Row className=\"my-3\">\r\n            <Col md=\"12\">\r\n              <AvGroup>\r\n                <Label htmlFor=\"conclusions\"></Label>\r\n                <AvField className=\"form-control\"\r\n                  name=\"conclusions\"\r\n                  type=\"textarea\"\r\n                  disabled={props?.validacion ? true : false}\r\n                  id=\"conclusions\"\r\n                  value={conclusions}\r\n                  rows=\"7\" />\r\n              </AvGroup>\r\n            </Col>\r\n          </Row>\r\n        </AvForm>\r\n      </CardBody>\r\n    </Card>\r\n  );\r\n});\r\n\r\n\r\nFormConclusiones.propTypes = {\r\n  onSaveSuccess: PropTypes.func\r\n};\r\n\r\nexport default FormConclusiones;\r\n"]},"metadata":{},"sourceType":"module"}