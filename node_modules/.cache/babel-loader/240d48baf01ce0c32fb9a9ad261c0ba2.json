{"ast":null,"code":"import _objectSpread from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import LogProcess from\"../../../components/LogProcess\";import{LogProcessModel}from\"../../../models/Common/LogProcessModel\";import FormDetalles from\"../../CommercialCredit/16_RiesgoAmbiental/riesgoAmbiental/FormDetalles\";import AspectosAmbientales from\"../../CommercialCredit/4_InformeGestionReforzado/FormularioIGR/Secciones/AspectosAmbientales\";import GeneralesEmpresaIGRPreview from\"./GeneralesEmpresaIGRPreview\";import{Card,CardBody,Row,Col,Button,Label}from\"reactstrap\";import AttachmentFileCore from\"../../../components/Common/AttachmentFileCore\";import{AttachmentFileInputModel}from\"../../../models/Common/AttachmentFileInputModel\";import*as OPTs from\"../../../helpers/options_helper\";import HeaderSections from'../../../components/Common/HeaderSections';import{useEffect,useState}from\"react\";import{AvForm,AvGroup}from\"availity-reactstrap-validation\";import Switch from\"react-switch\";import{useTranslation}from'react-i18next';import Flatpickr from\"react-flatpickr\";import moment from\"moment\";import{BackendServices}from\"../../../services\";import{useHistory,useLocation}from\"react-router-dom\";import*as url from\"../../../helpers/url_helper\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Offsymbol=function Offsymbol(){return/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",justifyContent:\"center\",alignItems:\"center\",height:\"100%\",fontSize:12,color:\"#fff\",paddingRight:2},children:[\" \",\"No\"]});};var OnSymbol=function OnSymbol(){return/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",justifyContent:\"center\",alignItems:\"center\",height:\"100%\",fontSize:12,color:\"#fff\",paddingRight:2},children:[\" \",\"Si\"]});};var PreviewHistorical=function PreviewHistorical(props){var _props$closingPreview,_props$autonomyBank,_props$closingPreview2,_props$autonomyBank2,_props$autonomyBank3;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),reputationResearch=_useState2[0],setReputationResearch=_useState2[1];var _useTranslation=useTranslation(),t=_useTranslation.t,i18n=_useTranslation.i18n;var _useState3=useState(props.closingPreview),_useState4=_slicedToArray(_useState3,2),environemntCovenantClosing=_useState4[0],setEnvironemntCovenantClosing=_useState4[1];var _useState5=useState(undefined),_useState6=_slicedToArray(_useState5,2),environemntRisk=_useState6[0],setEnvironemntRisk=_useState6[1];var _useState7=useState(props.dateClosing),_useState8=_slicedToArray(_useState7,2),fechaSet=_useState8[0],setfechaSet=_useState8[1];var backendServices=new BackendServices();var location=useLocation();var history=useHistory();useEffect(function(){console.log({props:props},!(props===null||props===void 0?void 0:props.autonomyBank));var dataSession;if(location.data!==null&&location.data!==undefined){if(location.data.transactionId===undefined||location.data.transactionId.length<=0){//location.data.transactionId = 0;\n//checkAndCreateProcedure(location.data);\nhistory.push(url.URL_DASHBOARD);}else{sessionStorage.setItem('locationData',JSON.stringify(location.data));dataSession=location.data;}}else{//chequeamos si tenemos guardado en session\nvar result=sessionStorage.getItem('locationData');if(result!==undefined&&result!==null){result=JSON.parse(result);dataSession=result;}}loadEnvironmentalRiskOthers(dataSession);},[]);useEffect(function(){var datos=_objectSpread(_objectSpread({},environemntRisk),{},{closingComplianceDate:fechaSet,closingCompliance:environemntCovenantClosing});console.log({datos:datos});},[fechaSet,environemntCovenantClosing]);function loadEnvironmentalRiskOthers(locationData){backendServices.getEnvironmentalRiskInfo(locationData.transactionId).then(function(environmentalRiskInf){setEnvironemntRisk(environmentalRiskInf);}).catch(function(err){console.log(err);});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(GeneralesEmpresaIGRPreview,{transactId:props.transactId}),props.title!=\"Historical Preview\"?/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardBody,{children:[/*#__PURE__*/_jsx(AspectosAmbientales,{setReputationResearch:setReputationResearch,reputationResearch:reputationResearch,previsualizar:true,previsualizarHistoria:true,activeTab:\"18\",locationData:{transactionId:props.transactId,transactId:props.transactId}}),/*#__PURE__*/_jsx(FormDetalles,{previsualizarHistoria:true,locationData:{transactionId:props.transactId,transactId:props.transactId}}),/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(HeaderSections,{title:\"Attach Compliance Support\"}),/*#__PURE__*/_jsxs(AvForm,{children:[/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsxs(Col,{md:\"4\",className:\"\",children:[/*#__PURE__*/_jsxs(Label,{className:\"form-check-label\",htmlFor:\"isProjectLocatedProtectedNaturalArea\",children:[t(\"Closing\"),\" Covenants\"]}),/*#__PURE__*/_jsxs(AvGroup,{check:true,className:\"m-0\",children:[/*#__PURE__*/_jsx(Switch,{name:\"isProjectLocatedProtectedNaturalArea\",uncheckedIcon:/*#__PURE__*/_jsx(Offsymbol,{}),checkedIcon:/*#__PURE__*/_jsx(OnSymbol,{}),onColor:\"#007943\",id:\"check1\",disabled:((_props$closingPreview=props===null||props===void 0?void 0:props.closingPreview)!==null&&_props$closingPreview!==void 0?_props$closingPreview:false)||((_props$autonomyBank=props===null||props===void 0?void 0:props.autonomyBank)!==null&&_props$autonomyBank!==void 0?_props$autonomyBank:false),className:\"form-label\",onChange:function onChange(){setEnvironemntCovenantClosing(!environemntCovenantClosing);},checked:environemntCovenantClosing}),'   ']})]})}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{md:\"3\",className:\"mt-3\",children:/*#__PURE__*/_jsxs(AvGroup,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"birthDate\",children:t(\"Compliance Date\")}),/*#__PURE__*/_jsx(Flatpickr,{id:\"issuedDate\",name:\"issuedDate\",className:\"form-control d-block\",placeholder:OPTs.FORMAT_DATE_SHOW,disabled:((_props$closingPreview2=props===null||props===void 0?void 0:props.closingPreview)!==null&&_props$closingPreview2!==void 0?_props$closingPreview2:false)||((_props$autonomyBank2=props===null||props===void 0?void 0:props.autonomyBank)!==null&&_props$autonomyBank2!==void 0?_props$autonomyBank2:false),options:{dateFormat:OPTs.FORMAT_DATE,//maxDate: new Date().setFullYear(new Date().getFullYear() - 18),\ndefaultDate:fechaSet},onChange:function onChange(selectedDates,dateStr,instance){var date=moment(dateStr,\"DD/MM/YYYY\").format(\"YYYY-MM-DD\");setfechaSet(date);}})]})})})]}),/*#__PURE__*/_jsx(AttachmentFileCore,{preview:(_props$autonomyBank3=props===null||props===void 0?void 0:props.autonomyBank)!==null&&_props$autonomyBank3!==void 0?_props$autonomyBank3:false,attachmentFileInputModel:new AttachmentFileInputModel(props.transactI,OPTs.PROCESS_EVIROMENTRISK,OPTs.ACT_ASPECTOSAMBIENTALES)})]})]})}):null,!(props===null||props===void 0?void 0:props.autonomyBank)&&/*#__PURE__*/_jsx(LogProcess,{logProcessModel:new LogProcessModel(props.instanceId,props.transactId,0,\"\",\"\"),preview:true})]});};export default PreviewHistorical;","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/pages/Dashboard/modal/PreviewHistorical.js"],"names":["LogProcess","LogProcessModel","FormDetalles","AspectosAmbientales","GeneralesEmpresaIGRPreview","Card","CardBody","Row","Col","Button","Label","AttachmentFileCore","AttachmentFileInputModel","OPTs","HeaderSections","useEffect","useState","AvForm","AvGroup","Switch","useTranslation","Flatpickr","moment","BackendServices","useHistory","useLocation","url","Offsymbol","display","justifyContent","alignItems","height","fontSize","color","paddingRight","OnSymbol","PreviewHistorical","props","reputationResearch","setReputationResearch","t","i18n","closingPreview","environemntCovenantClosing","setEnvironemntCovenantClosing","undefined","environemntRisk","setEnvironemntRisk","dateClosing","fechaSet","setfechaSet","backendServices","location","history","console","log","autonomyBank","dataSession","data","transactionId","length","push","URL_DASHBOARD","sessionStorage","setItem","JSON","stringify","result","getItem","parse","loadEnvironmentalRiskOthers","datos","closingComplianceDate","closingCompliance","locationData","getEnvironmentalRiskInfo","then","environmentalRiskInf","catch","err","transactId","title","FORMAT_DATE_SHOW","dateFormat","FORMAT_DATE","defaultDate","selectedDates","dateStr","instance","date","format","transactI","PROCESS_EVIROMENTRISK","ACT_ASPECTOSAMBIENTALES","instanceId"],"mappings":"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","sourcesContent":["import LogProcess from \"../../../components/LogProcess\";\r\nimport { LogProcessModel } from \"../../../models/Common/LogProcessModel\";\r\nimport FormDetalles from \"../../CommercialCredit/16_RiesgoAmbiental/riesgoAmbiental/FormDetalles\";\r\nimport AspectosAmbientales from \"../../CommercialCredit/4_InformeGestionReforzado/FormularioIGR/Secciones/AspectosAmbientales\";\r\nimport GeneralesEmpresaIGRPreview from \"./GeneralesEmpresaIGRPreview\";\r\nimport {\r\n    Card,\r\n    CardBody,\r\n    Row,\r\n    Col,\r\n    Button,\r\n    Label\r\n} from \"reactstrap\"\r\nimport AttachmentFileCore from \"../../../components/Common/AttachmentFileCore\";\r\nimport { AttachmentFileInputModel } from \"../../../models/Common/AttachmentFileInputModel\";\r\nimport * as OPTs from \"../../../helpers/options_helper\";\r\nimport HeaderSections from '../../../components/Common/HeaderSections';\r\nimport { useEffect, useState } from \"react\";\r\nimport { AvForm, AvGroup } from \"availity-reactstrap-validation\";\r\nimport Switch from \"react-switch\";\r\nimport { useTranslation } from 'react-i18next'\r\n\r\nimport Flatpickr from \"react-flatpickr\";\r\nimport moment from \"moment\";\r\nimport { BackendServices } from \"../../../services\";\r\nimport { useHistory, useLocation } from \"react-router-dom\";\r\nimport * as url from \"../../../helpers/url_helper\"\r\n\r\n\r\nconst Offsymbol = () => {\r\n    return (\r\n        <div\r\n            style={{\r\n                display: \"flex\",\r\n                justifyContent: \"center\",\r\n                alignItems: \"center\",\r\n                height: \"100%\",\r\n                fontSize: 12,\r\n                color: \"#fff\",\r\n                paddingRight: 2,\r\n            }}\r\n        >\r\n            {\" \"}\r\n            No\r\n        </div>\r\n    );\r\n};\r\n\r\nconst OnSymbol = () => {\r\n    return (\r\n        <div\r\n            style={{\r\n                display: \"flex\",\r\n                justifyContent: \"center\",\r\n                alignItems: \"center\",\r\n                height: \"100%\",\r\n                fontSize: 12,\r\n                color: \"#fff\",\r\n                paddingRight: 2,\r\n            }}\r\n        >\r\n            {\" \"}\r\n            Si\r\n        </div>\r\n    );\r\n};\r\n\r\nconst PreviewHistorical = (props) => {\r\n    const [reputationResearch, setReputationResearch] = useState('');\r\n    const { t, i18n } = useTranslation();\r\n\r\n    const [environemntCovenantClosing, setEnvironemntCovenantClosing] = useState(props.closingPreview)\r\n    const [environemntRisk, setEnvironemntRisk] = useState(undefined)\r\n    const [fechaSet, setfechaSet] = useState(props.dateClosing)\r\n\r\n    const backendServices = new BackendServices();\r\n    const location = useLocation();\r\n    const history = useHistory();\r\n\r\n\r\n    useEffect(() => {\r\n        console.log({ props }, !props?.autonomyBank)\r\n        let dataSession;\r\n\r\n        if (location.data !== null && location.data !== undefined) {\r\n            if (location.data.transactionId === undefined || location.data.transactionId.length <= 0) {\r\n                //location.data.transactionId = 0;\r\n                //checkAndCreateProcedure(location.data);\r\n                history.push(url.URL_DASHBOARD);\r\n            }\r\n            else {\r\n                sessionStorage.setItem('locationData', JSON.stringify(location.data));\r\n                dataSession = location.data;\r\n            }\r\n        }\r\n        else {\r\n            //chequeamos si tenemos guardado en session\r\n            var result = sessionStorage.getItem('locationData');\r\n            if (result !== undefined && result !== null) {\r\n                result = JSON.parse(result);\r\n                dataSession = result;\r\n            }\r\n        }\r\n\r\n\r\n        loadEnvironmentalRiskOthers(dataSession)\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        let datos = { ...environemntRisk, closingComplianceDate: fechaSet, closingCompliance: environemntCovenantClosing };\r\n        console.log({ datos })\r\n    }, [fechaSet, environemntCovenantClosing])\r\n\r\n\r\n    function loadEnvironmentalRiskOthers(locationData) {\r\n        backendServices.getEnvironmentalRiskInfo(locationData.transactionId).then(environmentalRiskInf => {\r\n            setEnvironemntRisk(environmentalRiskInf)\r\n        }).catch(err => {\r\n            console.log(err)\r\n        })\r\n    }\r\n\r\n\r\n    return (\r\n        <>\r\n            <GeneralesEmpresaIGRPreview transactId={props.transactId} />\r\n            {props.title != \"Historical Preview\" ?\r\n                <Card>\r\n                    <CardBody>\r\n                        <AspectosAmbientales setReputationResearch={setReputationResearch} reputationResearch={reputationResearch} previsualizar={true} previsualizarHistoria={true} activeTab=\"18\" locationData={{ transactionId: props.transactId, transactId: props.transactId }} />\r\n                        <FormDetalles previsualizarHistoria={true} locationData={{ transactionId: props.transactId, transactId: props.transactId }} />\r\n                        {<>\r\n                            <HeaderSections title=\"Attach Compliance Support\" />\r\n                            <AvForm>\r\n                                <Row>\r\n                                    <Col md=\"4\" className=\"\">\r\n                                        <Label className=\"form-check-label\" htmlFor=\"isProjectLocatedProtectedNaturalArea\">{t(\"Closing\")} Covenants</Label>\r\n                                        <AvGroup check className=\"m-0\">\r\n                                            <Switch name=\"isProjectLocatedProtectedNaturalArea\"\r\n                                                uncheckedIcon={<Offsymbol />}\r\n                                                checkedIcon={<OnSymbol />}\r\n                                                onColor=\"#007943\"\r\n                                                id=\"check1\"\r\n                                                disabled={(props?.closingPreview ?? false) || (props?.autonomyBank ?? false)}\r\n                                                className=\"form-label\"\r\n                                                onChange={() => {\r\n                                                    setEnvironemntCovenantClosing(!environemntCovenantClosing);\r\n                                                }}\r\n                                                checked={environemntCovenantClosing}\r\n                                            />\r\n                                            {'   '}\r\n                                        </AvGroup>\r\n                                    </Col>\r\n                                </Row>\r\n                                <Row>\r\n                                    <Col md=\"3\" className=\"mt-3\">\r\n                                        <AvGroup className=\"mb-3\">\r\n                                            <Label htmlFor=\"birthDate\">{t(\"Compliance Date\")}</Label>\r\n                                            <Flatpickr\r\n                                                id=\"issuedDate\"\r\n                                                name=\"issuedDate\"\r\n                                                className=\"form-control d-block\"\r\n                                                placeholder={OPTs.FORMAT_DATE_SHOW}\r\n                                                disabled={(props?.closingPreview ?? false) || (props?.autonomyBank ?? false)}\r\n                                                options={{\r\n                                                    dateFormat: OPTs.FORMAT_DATE,\r\n                                                    //maxDate: new Date().setFullYear(new Date().getFullYear() - 18),\r\n                                                    defaultDate: fechaSet\r\n                                                }}\r\n                                                onChange={(selectedDates, dateStr, instance) => {\r\n                                                    let date = moment(dateStr, \"DD/MM/YYYY\").format(\"YYYY-MM-DD\");\r\n                                                    setfechaSet(date)\r\n                                                }}\r\n                                            />\r\n\r\n                                        </AvGroup>\r\n                                    </Col>\r\n                                </Row>\r\n                            </AvForm>\r\n                            <AttachmentFileCore preview={props?.autonomyBank ?? false} attachmentFileInputModel={new AttachmentFileInputModel(props.transactI, OPTs.PROCESS_EVIROMENTRISK, OPTs.ACT_ASPECTOSAMBIENTALES)} />\r\n                        </>}\r\n                    </CardBody>\r\n                </Card> : null}\r\n            {!props?.autonomyBank && <LogProcess logProcessModel={new LogProcessModel(props.instanceId, props.transactId, 0, \"\", \"\")} preview={true} />}\r\n        </>\r\n    );\r\n}\r\n\r\nexport default PreviewHistorical;"]},"metadata":{},"sourceType":"module"}