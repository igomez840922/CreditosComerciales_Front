{"ast":null,"code":"import _slicedToArray from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useImperativeHandle,forwardRef,useContext,useEffect}from'react';import{translationHelpers}from'../../../../helpers';import RiesgoAmbientalContext from'../RiesgoAmbientalContext';import{Card,CardBody,Row,Col,Button,Label}from\"reactstrap\";import Switch from\"react-switch\";import{AvForm,AvField,AvGroup,AvInput}from\"availity-reactstrap-validation\";import{BackendServices,CoreServices}from\"../../../../services\";import{useTranslation}from'react-i18next';import moment from\"moment\";import\"flatpickr/dist/themes/material_blue.css\";import Flatpickr from\"react-flatpickr\";import*as OPTs from\"../../../../helpers/options_helper\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Offsymbol=function Offsymbol(){return/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",justifyContent:\"center\",alignItems:\"center\",height:\"100%\",fontSize:12,color:\"#fff\",paddingRight:2},children:[\" \",\"No\"]});};var OnSymbol=function OnSymbol(){return/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",justifyContent:\"center\",alignItems:\"center\",height:\"100%\",fontSize:12,color:\"#fff\",paddingRight:2},children:[\" \",\"Si\"]});};var FormDetalles=/*#__PURE__*/forwardRef(function(props,ref){React.useImperativeHandle(ref,function(){return{validateForm:function validateForm(){var form=document.getElementById('frmDetalleAmbiental');form.requestSubmit();},getFormValidation:function getFormValidation(){return formValid;},dataReturn:dataReturn,fechaSet:fechaSet};});var _useTranslation=useTranslation(),t=_useTranslation.t,i18n=_useTranslation.i18n;var _useState=useState(true),_useState2=_slicedToArray(_useState,2),displayCovenantDetails=_useState2[0],setDisplayCovenantDetails=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),formValid=_useState4[0],setFormValid=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isUpdatingRecord=_useState6[0],setUpdatingRecord=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),environmentCovenant=_useState8[0],setEnvironemntCovenant=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),detail=_useState10[0],setDetail=_useState10[1];var _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),compliance=_useState12[0],setCompliance=_useState12[1];var _useState13=useState(''),_useState14=_slicedToArray(_useState13,2),detected=_useState14[0],setDetected=_useState14[1];var _useState15=useState(''),_useState16=_slicedToArray(_useState15,2),term=_useState16[0],setTerm=_useState16[1];var _useState17=useState(''),_useState18=_slicedToArray(_useState17,2),recommendations=_useState18[0],setRecommendations=_useState18[1];var _useState19=useState(''),_useState20=_slicedToArray(_useState19,2),conclusions=_useState20[0],setConclusions=_useState20[1];var _useState21=useState(''),_useState22=_slicedToArray(_useState21,2),dataReturn=_useState22[0],setdataReturn=_useState22[1];var _useState23=useState(props.locationData),_useState24=_slicedToArray(_useState23,2),locationData=_useState24[0],setLocationData=_useState24[1];//Servicios\nvar _useState25=useState(new BackendServices()),_useState26=_slicedToArray(_useState25,2),backendServices=_useState26[0],setbackendServices=_useState26[1];//const [bpmServices, setbpmServices] = useState(new BpmServices());\n//const [coreServices, setcoreServices] = useState(new CoreServices());\nvar _useState27=useState(''),_useState28=_slicedToArray(_useState27,2),fechaSet=_useState28[0],setfechaSet=_useState28[1];var _useState29=useState(''),_useState30=_slicedToArray(_useState29,2),validationTransactId=_useState30[0],setValidationTransactId=_useState30[1];useEffect(function(){// load data        \nbackendServices.getEnvironmentalRiskInfo(locationData.transactionId).then(function(info){console.log(info);if(info.serviceStatus.statusCode==\"204\"){setUpdatingRecord(true);setEnvironemntCovenant(info.environmentCovenant);setDetail(info.detail);setCompliance(info.compliance);setDetected(info.detected);setTerm(info.term);setRecommendations(info.recommendations);setConclusions(info.conclusions);setfechaSet(\" \");setValidationTransactId(locationData.transactionId);}else{setUpdatingRecord(true);setEnvironemntCovenant(info.environmentCovenant);setDetail(info.detail);setCompliance(info.compliance);setDetected(info.detected);setTerm(info.term);setRecommendations(info.recommendations);setConclusions(info.conclusions);info.complianceDate&&setfechaSet(moment(info.complianceDate).format(\"DD-MM-YYYY\"));setValidationTransactId(locationData.transactionId);}}).catch(function(error){console.log('error fetch detalles',error);});},[]);function handleCovenantChange(event){setDisplayCovenantDetails(event.target.value==='Si'?true:false);}function handleSubmit(event,errors,values){values.environmentCovenant=environmentCovenant;event.preventDefault();if(errors.length>0){setFormValid(false);return;}setdataReturn(values);event.preventDefault();var isValid=errors.length===0;setFormValid(isValid);}return/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(\"h5\",{className:\"card-sub-title\",children:t(\"OtherDetails\")}),/*#__PURE__*/_jsx(CardBody,{children:/*#__PURE__*/_jsxs(AvForm,{id:\"frmDetalleAmbiental\",className:\"needs-validation\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(Row,{className:\"my-3\",children:/*#__PURE__*/_jsxs(Col,{md:\"12\",children:[/*#__PURE__*/_jsxs(Label,{className:\"form-check-label\",htmlFor:\"isProjectLocatedProtectedNaturalArea\",children:[\" \",t(\"Covenants Ambientales\")]}),/*#__PURE__*/_jsxs(AvGroup,{check:true,className:\"mb-3\",children:[/*#__PURE__*/_jsx(Switch,{name:\"isProjectLocatedProtectedNaturalArea\",uncheckedIcon:/*#__PURE__*/_jsx(Offsymbol,{}),checkedIcon:/*#__PURE__*/_jsx(OnSymbol,{}),onColor:\"#007943\",id:\"check1\",disabled:(props===null||props===void 0?void 0:props.previsualizarHistoria)?true:false,className:\"form-label\",onChange:function onChange(){setEnvironemntCovenant(!environmentCovenant);},checked:environmentCovenant}),'   ']})]})}),environmentCovenant&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{md:\"3\",children:/*#__PURE__*/_jsxs(AvGroup,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"birthDate\",children:t(\"Compliance Date\")}),validationTransactId&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Flatpickr,{id:\"issuedDate\",name:\"issuedDate\",className:\"form-control d-block\",placeholder:OPTs.FORMAT_DATE_SHOW,disabled:(props===null||props===void 0?void 0:props.previsualizarHistoria)?true:false,options:{dateFormat:OPTs.FORMAT_DATE,//maxDate: new Date().setFullYear(new Date().getFullYear() - 18),\ndefaultDate:fechaSet},onChange:function onChange(selectedDates,dateStr,instance){setfechaSet(moment(dateStr,\"DD/MM/YYYY\").format(\"YYYY-MM-DD\"));}}),fechaSet==\" \"?/*#__PURE__*/_jsx(\"p\",{className:\"message-error-parrafo\",children:t(\"Required\")}):null]})]})})}),/*#__PURE__*/_jsxs(Row,{className:\"my-3\",children:[/*#__PURE__*/_jsx(Col,{md:\"4\",children:/*#__PURE__*/_jsxs(AvGroup,{children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"detail\",children:t(\"Detalle\")}),/*#__PURE__*/_jsx(AvField,{className:\"form-control\",name:\"detail\",type:\"text\",id:\"detail\",disabled:(props===null||props===void 0?void 0:props.previsualizarHistoria)?true:false,value:detail})]})}),/*#__PURE__*/_jsx(Col,{md:\"4\",children:/*#__PURE__*/_jsxs(AvGroup,{children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"compliance\",children:t(\"Cumplimiento\")}),/*#__PURE__*/_jsx(AvField,{className:\"form-control\",name:\"compliance\",type:\"text\",id:\"compliance\",disabled:(props===null||props===void 0?void 0:props.previsualizarHistoria)?true:false,value:compliance})]})}),/*#__PURE__*/_jsx(Col,{md:\"4\",children:/*#__PURE__*/_jsxs(AvGroup,{children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"term\",children:t(\"Plazo\")}),/*#__PURE__*/_jsx(AvField,{className:\"form-control\",name:\"term\",type:\"text\",id:\"term\",disabled:(props===null||props===void 0?void 0:props.previsualizarHistoria)?true:false,value:term})]})})]}),/*#__PURE__*/_jsx(Row,{className:\"my-3\",children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsxs(AvGroup,{children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"detected\",children:t(\"Situacion Detectada\")}),/*#__PURE__*/_jsx(AvField,{className:\"form-control\",name:\"detected\",type:\"textarea\",id:\"detected\",disabled:(props===null||props===void 0?void 0:props.previsualizarHistoria)?true:false,value:detected,rows:\"7\"})]})})})]}),/*#__PURE__*/_jsx(Row,{className:\"my-3\",children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsxs(AvGroup,{children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"recommendations\",children:t(\"Recomendaciones\")}),/*#__PURE__*/_jsx(AvField,{className:\"form-control\",name:\"recommendations\",type:\"textarea\",id:\"recommendations\",disabled:(props===null||props===void 0?void 0:props.previsualizarHistoria)?true:false,value:recommendations,rows:\"7\"})]})})}),/*#__PURE__*/_jsx(Row,{className:\"my-3\",children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsxs(AvGroup,{children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"conclusions\",children:t(\"Conclusiones\")}),/*#__PURE__*/_jsx(AvField,{className:\"form-control\",name:\"conclusions\",type:\"textarea\",id:\"conclusions\",disabled:(props===null||props===void 0?void 0:props.previsualizarHistoria)?true:false,value:conclusions,rows:\"7\"})]})})})]})})]})});});export default FormDetalles;","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/pages/CommercialCredit/16_RiesgoAmbiental/riesgoAmbiental/FormDetalles.js"],"names":["React","useState","useImperativeHandle","forwardRef","useContext","useEffect","translationHelpers","RiesgoAmbientalContext","Card","CardBody","Row","Col","Button","Label","Switch","AvForm","AvField","AvGroup","AvInput","BackendServices","CoreServices","useTranslation","moment","Flatpickr","OPTs","Offsymbol","display","justifyContent","alignItems","height","fontSize","color","paddingRight","OnSymbol","FormDetalles","props","ref","validateForm","form","document","getElementById","requestSubmit","getFormValidation","formValid","dataReturn","fechaSet","t","i18n","displayCovenantDetails","setDisplayCovenantDetails","setFormValid","isUpdatingRecord","setUpdatingRecord","environmentCovenant","setEnvironemntCovenant","detail","setDetail","compliance","setCompliance","detected","setDetected","term","setTerm","recommendations","setRecommendations","conclusions","setConclusions","setdataReturn","locationData","setLocationData","backendServices","setbackendServices","setfechaSet","validationTransactId","setValidationTransactId","getEnvironmentalRiskInfo","transactionId","then","info","console","log","serviceStatus","statusCode","complianceDate","format","catch","error","handleCovenantChange","event","target","value","handleSubmit","errors","values","preventDefault","length","isValid","previsualizarHistoria","FORMAT_DATE_SHOW","dateFormat","FORMAT_DATE","defaultDate","selectedDates","dateStr","instance"],"mappings":"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","sourcesContent":["import React, { useState, useImperativeHandle, forwardRef, useContext, useEffect } from 'react';\r\n\r\nimport PropTypes from 'prop-types';\r\nimport { translationHelpers } from '../../../../helpers';\r\nimport RiesgoAmbientalContext from '../RiesgoAmbientalContext';\r\n\r\nimport {\r\n  Card,\r\n  CardBody,\r\n  Row,\r\n  Col,\r\n  Button,\r\n  Label\r\n} from \"reactstrap\"\r\nimport Switch from \"react-switch\";\r\n\r\nimport { AvForm, AvField, AvGroup, AvInput } from \"availity-reactstrap-validation\"\r\nimport { BackendServices, CoreServices } from \"../../../../services\"\r\nimport { useTranslation } from 'react-i18next'\r\n\r\nimport moment from \"moment\";\r\nimport \"flatpickr/dist/themes/material_blue.css\";\r\nimport Flatpickr from \"react-flatpickr\";\r\nimport * as OPTs from \"../../../../helpers/options_helper\"\r\n\r\nconst Offsymbol = () => {\r\n  return (\r\n    <div\r\n      style={{\r\n        display: \"flex\",\r\n        justifyContent: \"center\",\r\n        alignItems: \"center\",\r\n        height: \"100%\",\r\n        fontSize: 12,\r\n        color: \"#fff\",\r\n        paddingRight: 2,\r\n      }}\r\n    >\r\n      {\" \"}\r\n      No\r\n    </div>\r\n  );\r\n};\r\n\r\nconst OnSymbol = () => {\r\n  return (\r\n    <div\r\n      style={{\r\n        display: \"flex\",\r\n        justifyContent: \"center\",\r\n        alignItems: \"center\",\r\n        height: \"100%\",\r\n        fontSize: 12,\r\n        color: \"#fff\",\r\n        paddingRight: 2,\r\n      }}\r\n    >\r\n      {\" \"}\r\n      Si\r\n    </div>\r\n  );\r\n};\r\n\r\nconst FormDetalles = forwardRef((props, ref) => {\r\n\r\n  React.useImperativeHandle(ref, () => ({\r\n    validateForm: () => {\r\n      const form = document.getElementById('frmDetalleAmbiental');\r\n      form.requestSubmit();\r\n    },\r\n    getFormValidation: () => {\r\n      return formValid;\r\n    }, dataReturn, fechaSet\r\n  }))\r\n  const { t, i18n } = useTranslation();\r\n\r\n  const [displayCovenantDetails, setDisplayCovenantDetails] = useState(true);\r\n  const [formValid, setFormValid] = useState(false);\r\n  const [isUpdatingRecord, setUpdatingRecord] = useState(false);\r\n  const [environmentCovenant, setEnvironemntCovenant] = useState(false);\r\n  const [detail, setDetail] = useState('');\r\n  const [compliance, setCompliance] = useState('');\r\n  const [detected, setDetected] = useState('');\r\n  const [term, setTerm] = useState('');\r\n  const [recommendations, setRecommendations] = useState('');\r\n  const [conclusions, setConclusions] = useState('');\r\n  const [dataReturn, setdataReturn] = useState('');\r\n  const [locationData, setLocationData] = useState(props.locationData);\r\n\r\n  //Servicios\r\n  const [backendServices, setbackendServices] = useState(new BackendServices());\r\n  //const [bpmServices, setbpmServices] = useState(new BpmServices());\r\n  //const [coreServices, setcoreServices] = useState(new CoreServices());\r\n  const [fechaSet, setfechaSet] = useState('');\r\n  const [validationTransactId, setValidationTransactId] = useState('');\r\n\r\n  useEffect(() => {\r\n    // load data        \r\n    backendServices.getEnvironmentalRiskInfo(locationData.transactionId)\r\n      .then((info) => {\r\n        console.log(info)\r\n        if (info.serviceStatus.statusCode == \"204\") {\r\n          setUpdatingRecord(true);\r\n          setEnvironemntCovenant(info.environmentCovenant);\r\n          setDetail(info.detail);\r\n          setCompliance(info.compliance);\r\n          setDetected(info.detected);\r\n          setTerm(info.term);\r\n          setRecommendations(info.recommendations);\r\n          setConclusions(info.conclusions);\r\n          setfechaSet(\" \")\r\n          setValidationTransactId(locationData.transactionId)\r\n        } else {\r\n          setUpdatingRecord(true);\r\n          setEnvironemntCovenant(info.environmentCovenant);\r\n          setDetail(info.detail);\r\n          setCompliance(info.compliance);\r\n          setDetected(info.detected);\r\n          setTerm(info.term);\r\n          setRecommendations(info.recommendations);\r\n          setConclusions(info.conclusions);\r\n          info.complianceDate && setfechaSet(moment(info.complianceDate).format(\"DD-MM-YYYY\"))\r\n          setValidationTransactId(locationData.transactionId)\r\n        }\r\n      })\r\n      .catch((error) => {\r\n        console.log('error fetch detalles', error);\r\n      })\r\n\r\n  }, []);\r\n\r\n  function handleCovenantChange(event) {\r\n    setDisplayCovenantDetails(event.target.value === 'Si' ? true : false);\r\n  }\r\n\r\n  function handleSubmit(event, errors, values) {\r\n    values.environmentCovenant = environmentCovenant;\r\n    event.preventDefault();\r\n    if (errors.length > 0) {\r\n      setFormValid(false);\r\n      return;\r\n    }\r\n    setdataReturn(values)\r\n    event.preventDefault();\r\n    const isValid = errors.length === 0;\r\n    setFormValid(isValid);\r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n\r\n      <Card>\r\n        <h5 className=\"card-sub-title\">{t(\"OtherDetails\")}</h5>\r\n\r\n        <CardBody>\r\n          <AvForm id=\"frmDetalleAmbiental\" className=\"needs-validation\" onSubmit={handleSubmit}>\r\n            <Row className=\"my-3\">\r\n              <Col md=\"12\">\r\n                <Label className=\"form-check-label\" htmlFor=\"isProjectLocatedProtectedNaturalArea\"> {t(\"Covenants Ambientales\")}</Label>\r\n                <AvGroup check className=\"mb-3\">\r\n                  <Switch name=\"isProjectLocatedProtectedNaturalArea\"\r\n                    uncheckedIcon={<Offsymbol />}\r\n                    checkedIcon={<OnSymbol />}\r\n                    onColor=\"#007943\"\r\n                    id=\"check1\"\r\n                    disabled={props?.previsualizarHistoria ? true : false}\r\n                    className=\"form-label\"\r\n                    onChange={() => {\r\n                      setEnvironemntCovenant(!environmentCovenant);\r\n                    }}\r\n                    checked={environmentCovenant}\r\n                  />\r\n                  {'   '}\r\n                </AvGroup>\r\n                {/* <AvGroup>\r\n                  <Label htmlFor=\"environmentCovenant\">{t(\"Covenants Ambientales\")}</Label>\r\n                  <AvField\r\n                    className=\"form-control\"\r\n                    name=\"environmentCovenant\"\r\n                    type=\"select\"\r\n                    id=\"environmentCovenant\"\r\n                    value={environmentCovenant}\r\n                    onChange={handleCovenantChange}>\r\n                    <option value={true}>{t(\"Yes\")}</option>\r\n                    <option value={false}>{t(\"No\")}</option>\r\n                  </AvField>\r\n                </AvGroup> */}\r\n              </Col>\r\n            </Row>\r\n            {environmentCovenant && (\r\n              <>\r\n                <Row>\r\n                  <Col md=\"3\">\r\n                    <AvGroup className=\"mb-3\">\r\n                      <Label htmlFor=\"birthDate\">{t(\"Compliance Date\")}</Label>\r\n                      {validationTransactId && <><Flatpickr\r\n                        id=\"issuedDate\"\r\n                        name=\"issuedDate\"\r\n                        className=\"form-control d-block\"\r\n                        placeholder={OPTs.FORMAT_DATE_SHOW}\r\n                        disabled={props?.previsualizarHistoria ? true : false}\r\n                        options={{\r\n                          dateFormat: OPTs.FORMAT_DATE,\r\n                          //maxDate: new Date().setFullYear(new Date().getFullYear() - 18),\r\n                          defaultDate: fechaSet\r\n                        }}\r\n                        onChange={(selectedDates, dateStr, instance) => { setfechaSet(moment(dateStr, \"DD/MM/YYYY\").format(\"YYYY-MM-DD\")) }}\r\n                      />\r\n                        {fechaSet == \" \" ? <p className=\"message-error-parrafo\">{t(\"Required\")}</p> : null}</>\r\n                      }\r\n\r\n                    </AvGroup>\r\n                  </Col>\r\n\r\n                </Row>\r\n                <Row className=\"my-3\">\r\n                  <Col md=\"4\">\r\n                    <AvGroup>\r\n                      <Label htmlFor=\"detail\">{t(\"Detalle\")}</Label>\r\n                      <AvField className=\"form-control\"\r\n                        name=\"detail\"\r\n                        type=\"text\"\r\n                        id=\"detail\"\r\n                        disabled={props?.previsualizarHistoria ? true : false}\r\n                        value={detail} />\r\n                    </AvGroup>\r\n                  </Col>\r\n                  <Col md=\"4\">\r\n                    <AvGroup>\r\n                      <Label htmlFor=\"compliance\">{t(\"Cumplimiento\")}</Label>\r\n                      <AvField className=\"form-control\"\r\n                        name=\"compliance\"\r\n                        type=\"text\"\r\n                        id=\"compliance\"\r\n                        disabled={props?.previsualizarHistoria ? true : false}\r\n                        value={compliance} />\r\n                    </AvGroup>\r\n                  </Col>\r\n                  <Col md=\"4\">\r\n                    <AvGroup>\r\n                      <Label htmlFor=\"term\">{t(\"Plazo\")}</Label>\r\n                      <AvField className=\"form-control\"\r\n                        name=\"term\"\r\n                        type=\"text\"\r\n                        id=\"term\"\r\n                        disabled={props?.previsualizarHistoria ? true : false}\r\n                        value={term} />\r\n                    </AvGroup>\r\n                  </Col>\r\n                </Row>\r\n\r\n                <Row className=\"my-3\">\r\n                  <Col md=\"12\">\r\n                    <AvGroup>\r\n                      <Label htmlFor=\"detected\">{t(\"Situacion Detectada\")}</Label>\r\n                      <AvField className=\"form-control\"\r\n                        name=\"detected\"\r\n                        type=\"textarea\"\r\n                        id=\"detected\"\r\n                        disabled={props?.previsualizarHistoria ? true : false}\r\n                        value={detected}\r\n                        rows=\"7\" />\r\n                    </AvGroup>\r\n                  </Col>\r\n                </Row>\r\n              </>\r\n            )}\r\n\r\n            <Row className=\"my-3\">\r\n              <Col md=\"12\">\r\n                <AvGroup>\r\n                  <Label htmlFor=\"recommendations\">{t(\"Recomendaciones\")}</Label>\r\n                  <AvField className=\"form-control\"\r\n                    name=\"recommendations\"\r\n                    type=\"textarea\"\r\n                    id=\"recommendations\"\r\n                    disabled={props?.previsualizarHistoria ? true : false}\r\n                    value={recommendations}\r\n                    rows=\"7\" />\r\n                </AvGroup>\r\n              </Col>\r\n            </Row>\r\n\r\n            <Row className=\"my-3\">\r\n              <Col md=\"12\">\r\n                <AvGroup>\r\n                  <Label htmlFor=\"conclusions\">{t(\"Conclusiones\")}</Label>\r\n                  <AvField className=\"form-control\"\r\n                    name=\"conclusions\"\r\n                    type=\"textarea\"\r\n                    id=\"conclusions\"\r\n                    disabled={props?.previsualizarHistoria ? true : false}\r\n                    value={conclusions}\r\n                    rows=\"7\" />\r\n                </AvGroup>\r\n              </Col>\r\n            </Row>\r\n\r\n          </AvForm>\r\n\r\n        </CardBody>\r\n      </Card>\r\n\r\n\r\n    </React.Fragment>\r\n  );\r\n});\r\n\r\n\r\nFormDetalles.propTypes = {\r\n  onSubmit: PropTypes.func.isRequired,\r\n  locationData: PropTypes.any,\r\n};\r\n\r\nexport default FormDetalles;\r\n"]},"metadata":{},"sourceType":"module"}