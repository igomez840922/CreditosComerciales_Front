{"ast":null,"code":"import _slicedToArray from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import{withTranslation}from\"react-i18next\";import{Row,Col,Button,Label,Input,Modal,Card,CardBody,CardFooter}from\"reactstrap\";import{AvForm,AvField}from\"availity-reactstrap-validation\";import Services from\"../../services/BackendServices/Services\";import{useLocation,useHistory}from'react-router-dom';import{useTranslation}from'react-i18next';import toastr from\"toastr\";import\"toastr/build/toastr.min.css\";import Alert from'react-bootstrap/Alert';import LocalStorageHelper from\"../../helpers/LocalStorageHelper\";import*as opt from\"../../helpers/options_helper\";import{BackendServices}from\"../../services/index\";import{Select}from'antd';import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var Offsymbol=function Offsymbol(){var Option=Select.Option;return/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",justifyContent:\"center\",alignItems:\"center\",height:\"100%\",fontSize:12,color:\"#fff\",paddingRight:2},children:[\" \",\"No\"]});};var OnSymbol=function OnSymbol(){return/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",justifyContent:\"center\",alignItems:\"center\",height:\"100%\",fontSize:12,color:\"#fff\",paddingRight:2},children:[\" \",\"Si\"]});};/* ---------------------------------------------------------------------------------------------- */ /*                  Funcion para mostrar el modal para guardar la bitacora manual                 */ /* ---------------------------------------------------------------------------------------------- */var ModalBitacora=function ModalBitacora(props){var _useTranslation=useTranslation(),t=_useTranslation.t,i18n=_useTranslation.i18n;var _useState=useState(props.logProcessModel),_useState2=_slicedToArray(_useState,2),logProcessModel=_useState2[0],setlogProcessModel=_useState2[1];var _useState3=useState(new LocalStorageHelper()),_useState4=_slicedToArray(_useState3,2),localStorageHelper=_useState4[0],setlocalStorageHelper=_useState4[1];var _useState5=useState(new BackendServices()),_useState6=_slicedToArray(_useState5,2),backendServices=_useState6[0],setbackendServices=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),mainDebtor=_useState8[0],setmainDebtor=_useState8[1];var _useState9=useState({show:false,msg:\"\",isError:false}),_useState10=_slicedToArray(_useState9,2),msgData=_useState10[0],setmsgData=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),listDevolution=_useState12[0],setlistDevolution=_useState12[1];var _useState13=useState(\"\"),_useState14=_slicedToArray(_useState13,2),listDevolutionSelect=_useState14[0],setListDevolutionSelect=_useState14[1];useEffect(function(){if(logProcessModel!==undefined&&logProcessModel!==null){loadMainDebtor(logProcessModel.transactId);}},[]);function loadMainDebtor(transactionId){// consultarDeudorPrincipal\nPromise.allSettled([backendServices.consultPrincipalDebtor(transactionId),backendServices.getDevolutionCatalog()]).then(function(allPromise){var _allPromise=_slicedToArray(allPromise,2),debtor=_allPromise[0].value,devolutionCatalog=_allPromise[1].value;if(debtor!==undefined){setmainDebtor(debtor);setlistDevolution(devolutionCatalog.map(function(list){return{Code:list.id,Description:list.description};}));}}).catch(function(err){console.log(err);});}//mostrar mensaje \nfunction showMessage(message){var isError=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;setmsgData({show:true,msg:message,isError:isError});}function handleSubmit(event,errors,values){event.preventDefault();if(errors.length>0){return;}onSaveLogProcess(values.txtComment);}function onSaveLogProcess(observations){var _credentials$usr,_mainDebtor$personId;var credentials=localStorageHelper.get(opt.VARNAME_USRCREDENTIAL);logProcessModel.responsible=(_credentials$usr=credentials===null||credentials===void 0?void 0:credentials.usr)!==null&&_credentials$usr!==void 0?_credentials$usr:\"admin\";logProcessModel.clientId=(_mainDebtor$personId=mainDebtor===null||mainDebtor===void 0?void 0:mainDebtor.personId)!==null&&_mainDebtor$personId!==void 0?_mainDebtor$personId:logProcessModel.clientId;logProcessModel.observations=observations;logProcessModel.devolutionId=listDevolutionSelect===null||listDevolutionSelect===void 0?void 0:listDevolutionSelect.Code;logProcessModel.devolutionDesc=listDevolutionSelect===null||listDevolutionSelect===void 0?void 0:listDevolutionSelect.Description;logProcessModel.statusDescription=t(\"Returned\");backendServices.saveHistorical(logProcessModel).then(function(resp){//console.log(\"saveHistorical\",resp);\nif(resp!==undefined){props.successSaved();props.toggle();}else{//Mensaje ERROR\nshowMessage(t(\"ErrorSaveMessage\"),true);}props.successSaved();props.toggle();}).catch(function(err){showMessage(err.message,true);});}return/*#__PURE__*/_jsxs(Modal,{size:\"xl\",isOpen:props.isOpen,toggle:props.toggle,centered:true,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"modal-title mt-0\",children:props.recommend?\"\".concat(props.t(props.recommendTitle)):props.t(\"NewLog\")}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:props.toggle,className:\"close\",\"data-dismiss\":\"modal\",\"aria-label\":\"Close\",children:/*#__PURE__*/_jsx(\"span\",{\"aria-hidden\":\"true\",children:\"\\xD7\"})})]}),/*#__PURE__*/_jsxs(AvForm,{id:\"frmNewLog\",className:\"needs-validation\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-body\",children:[!props.recommend&&/*#__PURE__*/_jsxs(Row,{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"authType\",children:t(\"Return List\")}),/*#__PURE__*/_jsx(Select,{disabled:false,noOptionsMessage:function noOptionsMessage(){return\"\";},showSearch:true,style:{width:\"100%\"},placeholder:t(\"SearchtoSelect\"),optionFilterProp:\"children\",defaultValue:JSON.stringify(listDevolution===null||listDevolution===void 0?void 0:listDevolution.find(function(aut){return aut.Code===(listDevolutionSelect===null||listDevolutionSelect===void 0?void 0:listDevolutionSelect.authType);})),onChange:function onChange(e){var listDevolution=JSON.parse(e);setListDevolutionSelect(listDevolution);},filterOption:function filterOption(input,option){var _option$children;return((_option$children=option.children)===null||_option$children===void 0?void 0:_option$children.toLowerCase().indexOf(input.toLowerCase()))>=0;},children:(listDevolution===null||listDevolution===void 0?void 0:listDevolution.length)>0?listDevolution===null||listDevolution===void 0?void 0:listDevolution.map(function(item,index){return/*#__PURE__*/_jsx(Option,{value:JSON.stringify(item),children:item.Description},index);}):null})]}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(Label,{htmlFor:\"txtComment\",children:t(\"Comment\")}),/*#__PURE__*/_jsx(AvField,{className:\"form-control\",name:\"txtComment\",type:\"textarea\",rows:7,validate:{required:{value:true,errorMessage:t(\"Required Field\")}}})]})})}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{md:\"12\",children:/*#__PURE__*/_jsx(Alert,{show:msgData.show,variant:msgData.isError?\"danger\":\"success\",dismissible:true,onClose:function onClose(){setmsgData({show:false,msg:\"\",isError:false});},children:msgData.msg})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-footer\",children:[/*#__PURE__*/_jsxs(Button,{color:\"danger\",style:{margin:'5px 0px'},type:\"button\",onClick:function onClick(){props.toggle();},children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-cancel mid-12px\"}),\" \",props.t(\"Cancel\")]}),/*#__PURE__*/_jsxs(Button,{color:\"success\",type:\"submit\",style:{margin:'5px'},children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-content-save  mid-12px\"}),\" \",props.t(\"Save\")]})]})]})]});};export default withTranslation()(ModalBitacora);","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/components/Common/ModalBitacora.js"],"names":["React","useEffect","useState","withTranslation","Row","Col","Button","Label","Input","Modal","Card","CardBody","CardFooter","AvForm","AvField","Services","useLocation","useHistory","useTranslation","toastr","Alert","LocalStorageHelper","opt","BackendServices","Select","Offsymbol","Option","display","justifyContent","alignItems","height","fontSize","color","paddingRight","OnSymbol","ModalBitacora","props","t","i18n","logProcessModel","setlogProcessModel","localStorageHelper","setlocalStorageHelper","backendServices","setbackendServices","mainDebtor","setmainDebtor","show","msg","isError","msgData","setmsgData","listDevolution","setlistDevolution","listDevolutionSelect","setListDevolutionSelect","undefined","loadMainDebtor","transactId","transactionId","Promise","allSettled","consultPrincipalDebtor","getDevolutionCatalog","then","allPromise","debtor","value","devolutionCatalog","map","list","Code","id","Description","description","catch","err","console","log","showMessage","message","handleSubmit","event","errors","values","preventDefault","length","onSaveLogProcess","txtComment","observations","credentials","get","VARNAME_USRCREDENTIAL","responsible","usr","clientId","personId","devolutionId","devolutionDesc","statusDescription","saveHistorical","resp","successSaved","toggle","isOpen","recommend","recommendTitle","width","JSON","stringify","find","aut","authType","e","parse","input","option","children","toLowerCase","indexOf","item","index","required","errorMessage","margin"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\"\r\nimport { withTranslation } from \"react-i18next\"\r\nimport PropTypes from 'prop-types';\r\nimport { Row, Col, Button, Label, Input, Modal, Card, CardBody, CardFooter } from \"reactstrap\"\r\nimport { AvForm, AvField } from \"availity-reactstrap-validation\"\r\nimport Services from \"../../services/BackendServices/Services\";\r\nimport { useLocation, useHistory } from 'react-router-dom'\r\nimport { useTranslation } from 'react-i18next'\r\nimport toastr from \"toastr\";\r\nimport \"toastr/build/toastr.min.css\";\r\n\r\nimport Alert from 'react-bootstrap/Alert'\r\n\r\nimport LocalStorageHelper from \"../../helpers/LocalStorageHelper\";\r\nimport * as opt from \"../../helpers/options_helper\";\r\nimport { BackendServices } from \"../../services/index\";\r\n\r\nimport { Select } from 'antd';\r\n\r\nconst Offsymbol = () => {\r\n  const { Option } = Select;\r\n  return (\r\n    <div\r\n      style={{\r\n        display: \"flex\",\r\n        justifyContent: \"center\",\r\n        alignItems: \"center\",\r\n        height: \"100%\",\r\n        fontSize: 12,\r\n        color: \"#fff\",\r\n        paddingRight: 2,\r\n      }}\r\n    >\r\n      {\" \"}\r\n      No\r\n    </div>\r\n  );\r\n};\r\nconst OnSymbol = () => {\r\n  return (\r\n    <div\r\n      style={{\r\n        display: \"flex\",\r\n        justifyContent: \"center\",\r\n        alignItems: \"center\",\r\n        height: \"100%\",\r\n        fontSize: 12,\r\n        color: \"#fff\",\r\n        paddingRight: 2,\r\n      }}\r\n    >\r\n      {\" \"}\r\n      Si\r\n    </div>\r\n  );\r\n};\r\n\r\n\r\n/* ---------------------------------------------------------------------------------------------- */\r\n/*                  Funcion para mostrar el modal para guardar la bitacora manual                 */\r\n/* ---------------------------------------------------------------------------------------------- */\r\nconst ModalBitacora = (props) => {\r\n\r\n\r\n  const { t, i18n } = useTranslation();\r\n  const [logProcessModel, setlogProcessModel] = useState(props.logProcessModel);\r\n  const [localStorageHelper, setlocalStorageHelper] = useState(new LocalStorageHelper());\r\n  const [backendServices, setbackendServices] = useState(new BackendServices());\r\n\r\n  const [mainDebtor, setmainDebtor] = useState(null);\r\n  const [msgData, setmsgData] = useState({ show: false, msg: \"\", isError: false });\r\n\r\n  const [listDevolution, setlistDevolution] = useState([]);\r\n  const [listDevolutionSelect, setListDevolutionSelect] = useState(\"\");\r\n\r\n\r\n  useEffect(() => {\r\n\r\n\r\n    if (logProcessModel !== undefined && logProcessModel !== null) {\r\n      loadMainDebtor(logProcessModel.transactId);\r\n    }\r\n  }, []);\r\n\r\n  function loadMainDebtor(transactionId) {\r\n    // consultarDeudorPrincipal\r\n    Promise.allSettled([\r\n      backendServices.consultPrincipalDebtor(transactionId),\r\n      backendServices.getDevolutionCatalog()\r\n    ]).then(allPromise => {\r\n      const [{ value: debtor }, { value: devolutionCatalog }] = allPromise;\r\n      if (debtor !== undefined) {\r\n        setmainDebtor(debtor);\r\n        setlistDevolution(devolutionCatalog.map(list => ({ Code: list.id, Description: list.description })));\r\n      }\r\n\r\n    }).catch(err => { console.log(err) });\r\n  }\r\n\r\n  //mostrar mensaje \r\n  function showMessage(message, isError = false) {\r\n    setmsgData({ show: true, msg: message, isError: isError })\r\n  }\r\n\r\n\r\n  function handleSubmit(event, errors, values) {\r\n    event.preventDefault();\r\n    if (errors.length > 0) {\r\n      return;\r\n    }\r\n    onSaveLogProcess(values.txtComment);\r\n  }\r\n\r\n  function onSaveLogProcess(observations) {\r\n\r\n    var credentials = localStorageHelper.get(opt.VARNAME_USRCREDENTIAL);\r\n\r\n    logProcessModel.responsible = credentials?.usr ?? \"admin\"\r\n    logProcessModel.clientId = mainDebtor?.personId ?? logProcessModel.clientId;\r\n    logProcessModel.observations = observations;\r\n    logProcessModel.devolutionId = listDevolutionSelect?.Code;\r\n    logProcessModel.devolutionDesc = listDevolutionSelect?.Description;\r\n    logProcessModel.statusDescription = t(\"Returned\");\r\n\r\n    backendServices.saveHistorical(logProcessModel)\r\n      .then(resp => {\r\n        //console.log(\"saveHistorical\",resp);\r\n        if (resp !== undefined) {\r\n          props.successSaved()\r\n          props.toggle()\r\n        }\r\n        else {\r\n          //Mensaje ERROR\r\n          showMessage(t(\"ErrorSaveMessage\"), true);\r\n        }\r\n\r\n        props.successSaved()\r\n        props.toggle()\r\n\r\n      }).catch(err => {\r\n        showMessage(err.message, true);\r\n      });\r\n  }\r\n\r\n\r\n  return (\r\n    <Modal\r\n      size=\"xl\"\r\n      isOpen={props.isOpen}\r\n      toggle={props.toggle}\r\n      centered={true}>\r\n      <div className=\"modal-header\">\r\n        <h5 className=\"modal-title mt-0\">{props.recommend ? `${props.t(props.recommendTitle)}` : props.t(\"NewLog\")}</h5>\r\n        <button\r\n          type=\"button\"\r\n          onClick={props.toggle}\r\n          className=\"close\"\r\n          data-dismiss=\"modal\"\r\n          aria-label=\"Close\">\r\n          <span aria-hidden=\"true\">&times;</span>\r\n        </button>\r\n      </div>\r\n\r\n      <AvForm id=\"frmNewLog\" className=\"needs-validation\" onSubmit={handleSubmit}>\r\n        <div className=\"modal-body\">\r\n          {!props.recommend && <Row className=\"mb-3\">\r\n            <Label htmlFor=\"authType\">{t(\"Return List\")}</Label>\r\n            <Select disabled={false} noOptionsMessage={() => \"\"}\r\n              showSearch\r\n              style={{ width: \"100%\" }}\r\n              placeholder={t(\"SearchtoSelect\")}\r\n              optionFilterProp=\"children\"\r\n              defaultValue={JSON.stringify(listDevolution?.find(aut => aut.Code === listDevolutionSelect?.authType))}\r\n              onChange={(e) => {\r\n                let listDevolution = JSON.parse(e)\r\n                setListDevolutionSelect(listDevolution)\r\n              }}\r\n              filterOption={(input, option) =>\r\n                option.children?.toLowerCase().indexOf(input.toLowerCase()) >= 0\r\n              }\r\n            >\r\n              {listDevolution?.length > 0 ?\r\n                listDevolution?.map((item, index) => (\r\n                  <Option key={index} value={JSON.stringify(item)}>{item.Description}</Option>\r\n                ))\r\n                : null}\r\n            </Select>\r\n          </Row>}\r\n          <Row>\r\n            <Col md=\"12\">\r\n              <div className=\"mb-3\">\r\n                <Label htmlFor=\"txtComment\">{t(\"Comment\")}</Label>\r\n                <AvField\r\n                  className=\"form-control\"\r\n                  name=\"txtComment\"\r\n                  type=\"textarea\"\r\n                  rows={7}\r\n                  validate={{\r\n                    required: { value: true, errorMessage: t(\"Required Field\") }\r\n                  }}\r\n                />\r\n              </div>\r\n            </Col>\r\n          </Row>\r\n\r\n          <Row>\r\n            <Col md=\"12\">\r\n              <Alert show={msgData.show} variant={msgData.isError ? \"danger\" : \"success\"} dismissible onClose={() => { setmsgData({ show: false, msg: \"\", isError: false }) }}>\r\n                {msgData.msg}\r\n              </Alert>\r\n            </Col>\r\n          </Row>\r\n\r\n        </div>\r\n        <div className=\"modal-footer\">\r\n          <Button color=\"danger\" style={{ margin: '5px 0px' }} type=\"button\" onClick={() => { props.toggle() }}>\r\n            <i className=\"mdi mdi-cancel mid-12px\"></i> {props.t(\"Cancel\")}\r\n          </Button>\r\n          <Button color=\"success\" type=\"submit\" style={{ margin: '5px' }} >\r\n            <i className=\"mdi mdi-content-save  mid-12px\"></i> {props.t(\"Save\")}\r\n          </Button>\r\n        </div>\r\n      </AvForm>\r\n\r\n    </Modal>\r\n  );\r\n};\r\n\r\nModalBitacora.propTypes = {\r\n  isOpen: PropTypes.bool,\r\n  toggle: PropTypes.func,\r\n  successSaved: PropTypes.func,\r\n  logProcessModel: PropTypes.any, //LogProcessModel\r\n};\r\n\r\nexport default (withTranslation()(ModalBitacora));\r\n"]},"metadata":{},"sourceType":"module"}