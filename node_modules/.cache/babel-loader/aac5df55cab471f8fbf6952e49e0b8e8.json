{"ast":null,"code":"import _regeneratorRuntime from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{useTranslation}from'react-i18next';import Select from\"react-select\";import{useLocation,useHistory}from'react-router-dom';import LoadingOverlay from'react-loading-overlay';import{Row,Col,Card,CardBody,Button,Label,Table,Pagination,PaginationItem,PaginationLink,CardFooter}from\"reactstrap\";import{AvForm,AvField}from\"availity-reactstrap-validation\";import{Link}from\"react-router-dom\";import{CoreServices,BackendServices}from'../../services';import Currency from'../../helpers/currency';import{uniq_key}from'../../helpers/unq_key';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";;var AccountMovementsHistory=function AccountMovementsHistory(props){var currencyData=new Currency();var _useTranslation=useTranslation(),t=_useTranslation.t,i18n=_useTranslation.i18n;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),dataRows=_useState2[0],setDataRows=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isActiveLoading=_useState4[0],setIsActiveLoading=_useState4[1];var _useState5=useState(new BackendServices()),_useState6=_slicedToArray(_useState5,2),apiServiceBackend=_useState6[0],setapiServiceBackend=_useState6[1];var _useState7=useState(new CoreServices()),_useState8=_slicedToArray(_useState7,2),apiCoreServices=_useState8[0],setCoreServices=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),dataMovimientos=_useState10[0],setdataMovimientos=_useState10[1];//On Mounting (componentDidMount)\nReact.useEffect(function(){fetchData();},[]);function fetchData(){loadData();}function groupBy(collection,property){var i=0,val,index,values=[],result=[];for(;i<collection.length;i++){val=collection[i][property];index=values.indexOf(val);if(index>-1)result[index].push(collection[i]);else{values.push(val);result.push([collection[i]]);}}return result;}//cargar lista de facilidades\nfunction loadData(){return _loadData.apply(this,arguments);}function _loadData(){_loadData=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _props$transactionId;var core,_args=arguments;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:core=_args.length>0&&_args[0]!==undefined?_args[0]:false;setIsActiveLoading(true);_context.next=4;return apiServiceBackend.consultMovementsBank((_props$transactionId=props===null||props===void 0?void 0:props.transactionId)!==null&&_props$transactionId!==void 0?_props$transactionId:0).then(function(resp){setIsActiveLoading(false);if(resp!==undefined&&resp!==null&&resp.bankBanesco.length>0){setIsActiveLoading(false);//toca dibujar la tabla\n//toca dibujar la tabla\nif(resp.bankBanesco.length>0){resp=Array.from(new Set(resp.bankBanesco.map(function(_ref){var accountNumber=_ref.accountNumber,averageBalance=_ref.averageBalance,deposits=_ref.deposits,month=_ref.month,year=_ref.year,status=_ref.status;return JSON.stringify({accountNumber:accountNumber,averageBalance:averageBalance,deposits:deposits,month:month,year:year,status:status});}))).map(JSON.parse);// console.log(\"ssdadasda\",groupBy(resp,\"accountNumber\"));\n// let newJson=groupBy(resp,\"accountNumber\");\n// console.log(\"ssdadasda\",groupBy(resp,\"accountNumber\"));\n// let newJson=groupBy(resp,\"accountNumber\");\nsetdataMovimientos(resp.map(function(data,index,arr){var _resp,_arr,_data$averageBalance,_data$deposits,_arr2,_arr3,_movementsYear$reduce,_movementsYear$reduce2,_movementsYear$reduce3,_movementsYear$reduce4;var movementsYear=(_resp=resp)===null||_resp===void 0?void 0:_resp.filter(function(movement){return movement.year===data.year&&movement.status&&movement.accountNumber===data.accountNumber;});return data.status?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:((_arr=arr[index-1])===null||_arr===void 0?void 0:_arr.accountNumber)!=data.accountNumber&&data.accountNumber}),/*#__PURE__*/_jsx(\"td\",{children:data.year}),/*#__PURE__*/_jsx(\"td\",{children:data.month}),/*#__PURE__*/_jsxs(\"td\",{children:[\"$\",currencyData.formatTable((_data$averageBalance=data.averageBalance)!==null&&_data$averageBalance!==void 0?_data$averageBalance:0)]}),/*#__PURE__*/_jsxs(\"td\",{children:[\"$\",currencyData.formatTable((_data$deposits=data.deposits)!==null&&_data$deposits!==void 0?_data$deposits:0)]})]},uniq_key()+\"1\"),(data.year!==((_arr2=arr[index+1])===null||_arr2===void 0?void 0:_arr2.year)||data.accountNumber!==((_arr3=arr[index+1])===null||_arr3===void 0?void 0:_arr3.accountNumber))&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"b\",{children:t(\"Total\")})}),/*#__PURE__*/_jsx(\"td\",{}),/*#__PURE__*/_jsxs(\"th\",{children:[\"$\",currencyData.formatTable((_movementsYear$reduce=movementsYear===null||movementsYear===void 0?void 0:movementsYear.reduce(function(acu,crr){return acu+crr.averageBalance;},0).toFixed(2))!==null&&_movementsYear$reduce!==void 0?_movementsYear$reduce:0)]}),/*#__PURE__*/_jsxs(\"th\",{children:[\"$\",currencyData.formatTable((_movementsYear$reduce2=movementsYear===null||movementsYear===void 0?void 0:movementsYear.reduce(function(acu,crr){return acu+crr.deposits;},0).toFixed(2))!==null&&_movementsYear$reduce2!==void 0?_movementsYear$reduce2:0)]}),/*#__PURE__*/_jsx(\"td\",{})]},uniq_key()+\"2\"),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{}),/*#__PURE__*/_jsx(\"th\",{children:/*#__PURE__*/_jsx(\"b\",{children:t(\"Average\")})}),/*#__PURE__*/_jsx(\"td\",{}),/*#__PURE__*/_jsxs(\"th\",{children:[\"$\",currencyData.formatTable((_movementsYear$reduce3=movementsYear===null||movementsYear===void 0?void 0:movementsYear.reduce(function(acu,crr){return acu+crr.averageBalance/movementsYear.length;},0).toFixed(2))!==null&&_movementsYear$reduce3!==void 0?_movementsYear$reduce3:0)]}),/*#__PURE__*/_jsxs(\"th\",{children:[\"$\",currencyData.formatTable((_movementsYear$reduce4=movementsYear===null||movementsYear===void 0?void 0:movementsYear.reduce(function(acu,crr){return acu+crr.deposits/movementsYear.length;},0).toFixed(2))!==null&&_movementsYear$reduce4!==void 0?_movementsYear$reduce4:0)]}),/*#__PURE__*/_jsx(\"td\",{})]},uniq_key()+\"3\")]})]}):null;}));}else{setdataMovimientos(/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"6\",style:{textAlign:'center'},children:t(\"NoData\")})},uniq_key()+\"2\"));}}else{if(core){setIsActiveLoading(false);return;}}});case 4:case\"end\":return _context.stop();}}},_callee);}));return _loadData.apply(this,arguments);}function getUniqueListBy(arr,key){return _toConsumableArray(new Map(arr.map(function(item){return[item[key],item];})).values());}return/*#__PURE__*/_jsx(LoadingOverlay,{active:isActiveLoading,spinner:true,text:t(\"WaitingPlease\"),children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{md:\"6\",children:/*#__PURE__*/_jsx(\"h5\",{className:\"card-sub-title\",children:t(\"AccountMovementsHistory\")+\" - Banesco\"})})}),/*#__PURE__*/_jsx(CardBody,{children:/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(Col,{md:\"12\",className:\"table-responsive styled-table-div\",children:/*#__PURE__*/_jsxs(Table,{className:\"table table-striped table-hover styled-table table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:t(\"Account\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"Year\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"Month\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"AverageAmount\")}),/*#__PURE__*/_jsx(\"th\",{children:t(\"Deposits\")})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:dataMovimientos})]})})})})]})});};//export default (withTranslation()(DatosGenerales));\nexport default AccountMovementsHistory;","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/components/Common/AccountMovementsHistory.js"],"names":["React","useState","useTranslation","Select","useLocation","useHistory","LoadingOverlay","Row","Col","Card","CardBody","Button","Label","Table","Pagination","PaginationItem","PaginationLink","CardFooter","AvForm","AvField","Link","CoreServices","BackendServices","Currency","uniq_key","AccountMovementsHistory","props","currencyData","t","i18n","dataRows","setDataRows","isActiveLoading","setIsActiveLoading","apiServiceBackend","setapiServiceBackend","apiCoreServices","setCoreServices","dataMovimientos","setdataMovimientos","useEffect","fetchData","loadData","groupBy","collection","property","i","val","index","values","result","length","indexOf","push","core","consultMovementsBank","transactionId","then","resp","undefined","bankBanesco","Array","from","Set","map","accountNumber","averageBalance","deposits","month","year","status","JSON","stringify","parse","data","arr","movementsYear","filter","movement","formatTable","reduce","acu","crr","toFixed","textAlign","getUniqueListBy","key","Map","item"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { useTranslation } from 'react-i18next'\r\nimport Select from \"react-select\";\r\nimport { useLocation, useHistory } from 'react-router-dom'\r\nimport LoadingOverlay from 'react-loading-overlay';\r\n\r\nimport {\r\n  Row,\r\n  Col,\r\n  Card,\r\n  CardBody,\r\n  Button,\r\n  Label,\r\n  Table,\r\n  Pagination,\r\n  PaginationItem,\r\n  PaginationLink,\r\n  CardFooter,\r\n} from \"reactstrap\"\r\n\r\nimport { AvForm, AvField } from \"availity-reactstrap-validation\"\r\nimport { Link } from \"react-router-dom\"\r\n\r\nimport { CoreServices, BackendServices } from '../../services';\r\nimport Currency from '../../helpers/currency'; import { uniq_key } from '../../helpers/unq_key';\r\n;\r\n\r\nconst AccountMovementsHistory = (props) => {\r\n  const currencyData = new Currency();\r\n  const { t, i18n } = useTranslation();\r\n\r\n  const [dataRows, setDataRows] = useState([]);\r\n  const [isActiveLoading, setIsActiveLoading] = useState(false);\r\n\r\n  const [apiServiceBackend, setapiServiceBackend] = useState(new BackendServices());\r\n  const [apiCoreServices, setCoreServices] = useState(new CoreServices());\r\n\r\n  const [dataMovimientos, setdataMovimientos] = useState(null);\r\n  //On Mounting (componentDidMount)\r\n  React.useEffect(() => {\r\n    fetchData();\r\n  }, []);\r\n\r\n  function fetchData() {\r\n    loadData();\r\n  }\r\n  function groupBy(collection, property) {\r\n    var i = 0, val, index,\r\n      values = [], result = [];\r\n    for (; i < collection.length; i++) {\r\n      val = collection[i][property];\r\n      index = values.indexOf(val);\r\n      if (index > -1)\r\n        result[index].push(collection[i]);\r\n      else {\r\n        values.push(val);\r\n        result.push([collection[i]]);\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n  //cargar lista de facilidades\r\n  async function loadData(core = false) {\r\n\r\n    setIsActiveLoading(true)\r\n    await apiServiceBackend.consultMovementsBank(props?.transactionId ?? 0).then(resp => {\r\n      setIsActiveLoading(false)\r\n      if (resp !== undefined && resp !== null && resp.bankBanesco.length > 0) {\r\n        setIsActiveLoading(false)\r\n        //toca dibujar la tabla\r\n        if (resp.bankBanesco.length > 0) {\r\n\r\n          resp = Array.from(new Set(resp.bankBanesco.map(({ accountNumber, averageBalance, deposits, month, year, status }) => JSON.stringify({ accountNumber, averageBalance, deposits, month, year, status })))).map(JSON.parse);\r\n          // console.log(\"ssdadasda\",groupBy(resp,\"accountNumber\"));\r\n          // let newJson=groupBy(resp,\"accountNumber\");\r\n          setdataMovimientos(resp.map((data, index, arr) => {\r\n            let movementsYear = resp?.filter(movement => movement.year === data.year && movement.status && movement.accountNumber === data.accountNumber);\r\n            return (\r\n              data.status ?\r\n                <>\r\n                  <tr key={uniq_key() + \"1\"}>\r\n                    <th>{arr[index - 1]?.accountNumber != data.accountNumber && data.accountNumber}</th>\r\n                    <td>{data.year}</td>\r\n                    <td>{data.month}</td>\r\n                    <td>${currencyData.formatTable(data.averageBalance ?? 0)}</td>\r\n                    <td>${currencyData.formatTable(data.deposits ?? 0)}</td>\r\n\r\n                  </tr>\r\n                  {(data.year !== arr[index + 1]?.year || data.accountNumber !== arr[index + 1]?.accountNumber) && (\r\n                    <>\r\n                      <tr key={uniq_key() + \"2\"}>\r\n                        <td></td>\r\n                        <th><b>{t(\"Total\")}</b></th>\r\n                        <td></td>\r\n                        <th>${currencyData.formatTable(movementsYear?.reduce((acu, crr) => acu + crr.averageBalance, 0).toFixed(2) ?? 0)}</th>\r\n                        <th>${currencyData.formatTable(movementsYear?.reduce((acu, crr) => acu + crr.deposits, 0).toFixed(2) ?? 0)}</th>\r\n                        <td></td>\r\n                      </tr>\r\n                      <tr key={uniq_key() + \"3\"}>\r\n                        <td></td>\r\n                        <th><b>{t(\"Average\")}</b></th>\r\n                        <td></td>\r\n                        <th>${currencyData.formatTable(movementsYear?.reduce((acu, crr) => acu + crr.averageBalance / movementsYear.length, 0).toFixed(2) ?? 0)}</th>\r\n                        <th>${currencyData.formatTable(movementsYear?.reduce((acu, crr) => acu + crr.deposits / movementsYear.length, 0).toFixed(2) ?? 0)}</th>\r\n                        <td></td>\r\n                      </tr>\r\n                    </>\r\n                  )}\r\n                </>\r\n                : null)\r\n          }\r\n          ));\r\n        } else {\r\n          setdataMovimientos(\r\n            <tr key={uniq_key() + \"2\"}>\r\n              <td colSpan=\"6\" style={{ textAlign: 'center' }}>{t(\"NoData\")}</td>\r\n            </tr>);\r\n        }\r\n      } else {\r\n        if (core) {\r\n          setIsActiveLoading(false)\r\n          return;\r\n        }\r\n      }\r\n\r\n    });\r\n  }\r\n\r\n  function getUniqueListBy(arr, key) {\r\n    return [...new Map(arr.map(item => [item[key], item])).values()]\r\n  }\r\n\r\n  return (\r\n\r\n    <LoadingOverlay active={isActiveLoading} spinner text={t(\"WaitingPlease\")}>\r\n\r\n      <Card>\r\n\r\n        <Row>\r\n          <Col md=\"6\">\r\n            <h5 className=\"card-sub-title\">{t(\"AccountMovementsHistory\") + \" - Banesco\"}</h5>\r\n          </Col>\r\n        </Row>\r\n\r\n        <CardBody>\r\n\r\n          <Row>\r\n            <Col md=\"12\" className=\"table-responsive styled-table-div\">\r\n              <Table className=\"table table-striped table-hover styled-table table\">\r\n                <thead>\r\n                  <tr>\r\n                    <th>{t(\"Account\")}</th>\r\n                    <th>{t(\"Year\")}</th>\r\n                    <th>{t(\"Month\")}</th>\r\n                    <th>{t(\"AverageAmount\")}</th>\r\n                    <th>{t(\"Deposits\")}</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {/* {dataRows.length > 0 ? dataRows : null} */}\r\n                  {dataMovimientos}\r\n                </tbody>\r\n              </Table>\r\n            </Col>\r\n          </Row>\r\n        </CardBody>\r\n      </Card>\r\n\r\n    </LoadingOverlay>\r\n\r\n  )\r\n}\r\n\r\nAccountMovementsHistory.propTypes = {\r\n  customerNumberT24: PropTypes.string\r\n}\r\n\r\n//export default (withTranslation()(DatosGenerales));\r\nexport default AccountMovementsHistory;\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}