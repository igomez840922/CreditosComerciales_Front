{"ast":null,"code":"import _regeneratorRuntime from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import Currency from\"../../../../helpers/currency\";import{BackendServices,CoreServices}from\"../../../../services\";var TreasuryCurve=/*#__PURE__*/function(){function TreasuryCurve(){_classCallCheck(this,TreasuryCurve);this.backendServices=new BackendServices();this.coreServices=new CoreServices();this.currencyData=new Currency();//chequeamos si tenemos guardado en session\nvar result=sessionStorage.getItem('locationData');if(result!==undefined&&result!==null){result=JSON.parse(result);this.location=result;}}_createClass(TreasuryCurve,[{key:\"initial\",value:function initial(){var _this=this;var location=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.location;return new Promise(function(resolve,reject){_this.backendServices.consultGeneralDataIGR(location.transactionId).then(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(resp){var _catalogue$find;var bankIGR,catalogue,bank,code,treasuryCurveCat;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:bankIGR={\"AGROPECUARIO\":\"AGRO\",\"CORPORATIVO\":\"CORPORATIVA\",\"EMPRESAS\":\"EMPRESA\",\"INTERINO\":\"INTERINO\",\"BANCA INTERNACIONAL\":\"INTERNACIONAL\",\"PYME\":\"PYME\"};_context.next=3;return _this.coreServices.getTreasuryCurveCatalogo1().then(function(resp){return resp===null||resp===void 0?void 0:resp.Records;});case 3:catalogue=_context.sent;bank=resp.bank.name;code=(_catalogue$find=catalogue.find(function(catalog){return catalog.Description===bankIGR[bank];}))===null||_catalogue$find===void 0?void 0:_catalogue$find.Code;_context.next=8;return _this.coreServices.getTreasuryCurveCatalogoChild(code).then(function(resp){return resp===null||resp===void 0?void 0:resp.Records;});case 8:treasuryCurveCat=_context.sent;_this.treasuryCurve=(treasuryCurveCat===null||treasuryCurveCat===void 0?void 0:treasuryCurveCat.length)>0?_this.currencyData.orderByJSON(treasuryCurveCat,'Code','asc'):[];resolve();case 11:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}()).catch(function(err){resolve();console.error(err);});});}},{key:\"getTreasuryCurve\",value:function getTreasuryCurve(_ref2){var term=_ref2.term,termType=_ref2.termType;var termDiv=termType==='D'?30:12;return term=termType==='M'&&term>=10&&term<=12?1:termType==='Y'?term:term/termDiv,termType=termType==='D'?'M':'Y',termType==='M'&&term>=10?this.getTreasuryCurve({term:term,termType:termType}):{term:term,termType:termType};}},{key:\"showTreasuryCurve\",value:function showTreasuryCurve(_ref3){var _this$treasuryCurve,_this$treasuryCurve2,_treasuryCurves$find;var proposalRate=_ref3.proposalRate,termType=_ref3.termType;console.log(proposalRate,termType,((_this$treasuryCurve=this.treasuryCurve)===null||_this$treasuryCurve===void 0?void 0:_this$treasuryCurve.length)===0);if(!proposalRate||!termType||((_this$treasuryCurve2=this.treasuryCurve)===null||_this$treasuryCurve2===void 0?void 0:_this$treasuryCurve2.length)===0)return;var param={term:proposalRate,termType:termType==='AÑOS'?'Y':termType[0]};var treasuryCurveTerm=this.getTreasuryCurve(param);var treasuryCurves=this.treasuryCurve.filter(function(treasuryCurve){return new RegExp(treasuryCurveTerm.termType,'gi').test(treasuryCurve.Code);});return(_treasuryCurves$find=treasuryCurves.find(function(treasury){return treasuryCurveTerm.term<=treasury.Code.split('')[0];}))!==null&&_treasuryCurves$find!==void 0?_treasuryCurves$find:treasuryCurves.at(-1);}}]);return TreasuryCurve;}();export{TreasuryCurve as default};","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/pages/CommercialCredit/5_PropuestaCredito/Secciones/treasuryCurve.model.js"],"names":["Currency","BackendServices","CoreServices","TreasuryCurve","backendServices","coreServices","currencyData","result","sessionStorage","getItem","undefined","JSON","parse","location","Promise","resolve","reject","consultGeneralDataIGR","transactionId","then","resp","bankIGR","getTreasuryCurveCatalogo1","Records","catalogue","bank","name","code","find","catalog","Description","Code","getTreasuryCurveCatalogoChild","treasuryCurveCat","treasuryCurve","length","orderByJSON","catch","err","console","error","term","termType","termDiv","getTreasuryCurve","proposalRate","log","param","treasuryCurveTerm","treasuryCurves","filter","RegExp","test","treasury","split","at"],"mappings":"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","sourcesContent":["import Currency from \"../../../../helpers/currency\";\r\nimport { BackendServices, CoreServices } from \"../../../../services\";\r\n\r\n\r\nexport default class TreasuryCurve {\r\n\r\n    treasuryCurve;\r\n    backendServices = new BackendServices();\r\n    coreServices = new CoreServices();\r\n    currencyData = new Currency();\r\n\r\n    constructor() {\r\n\r\n        //chequeamos si tenemos guardado en session\r\n        var result = sessionStorage.getItem('locationData');\r\n        if (result !== undefined && result !== null) {\r\n            result = JSON.parse(result);\r\n            this.location = result;\r\n        }\r\n\r\n    }\r\n\r\n    initial(location = this.location) {\r\n        return new Promise((resolve, reject) => {\r\n            this.backendServices.consultGeneralDataIGR(location.transactionId).then(async resp => {\r\n                let bankIGR = {\r\n                    \"AGROPECUARIO\": \"AGRO\",\r\n                    \"CORPORATIVO\": \"CORPORATIVA\",\r\n                    \"EMPRESAS\": \"EMPRESA\",\r\n                    \"INTERINO\": \"INTERINO\",\r\n                    \"BANCA INTERNACIONAL\": \"INTERNACIONAL\",\r\n                    \"PYME\": \"PYME\",\r\n                }\r\n\r\n                let catalogue = await this.coreServices.getTreasuryCurveCatalogo1().then(resp => resp?.Records);\r\n                let bank = resp.bank.name;\r\n                let code = catalogue.find(catalog => catalog.Description === bankIGR[bank])?.Code;\r\n                let treasuryCurveCat = await this.coreServices.getTreasuryCurveCatalogoChild(code).then(resp => resp?.Records);\r\n\r\n                this.treasuryCurve = treasuryCurveCat?.length > 0 ? this.currencyData.orderByJSON(treasuryCurveCat, 'Code', 'asc') : [];\r\n                resolve();\r\n            }).catch(err => { resolve(); console.error(err) })\r\n        })\r\n    }\r\n\r\n    getTreasuryCurve({ term, termType }) {\r\n        let termDiv = termType === 'D' ? 30 : 12;\r\n        return term = termType === 'M' && term >= 10 && term <= 12 ? 1 : (termType === 'Y' ? term : term / termDiv), termType = termType === 'D' ? 'M' : 'Y', termType === 'M' && term >= 10 ? this.getTreasuryCurve({ term, termType }) : { term, termType }\r\n    }\r\n\r\n    showTreasuryCurve({ proposalRate, termType }) {\r\n        console.log(proposalRate, termType, this.treasuryCurve?.length === 0)\r\n        if (!proposalRate || !termType || this.treasuryCurve?.length === 0)\r\n            return\r\n\r\n        let param = { term: proposalRate, termType: termType === 'AÑOS' ? 'Y' : termType[0] }\r\n        let treasuryCurveTerm = this.getTreasuryCurve(param);\r\n\r\n        let treasuryCurves = this.treasuryCurve.filter(treasuryCurve => new RegExp(treasuryCurveTerm.termType, 'gi').test(treasuryCurve.Code))\r\n\r\n        return treasuryCurves.find(treasury => treasuryCurveTerm.term <= treasury.Code.split('')[0]) ?? treasuryCurves.at(-1);\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}