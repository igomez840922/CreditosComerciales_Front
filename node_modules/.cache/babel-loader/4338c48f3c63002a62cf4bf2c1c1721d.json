{"ast":null,"code":"import _slicedToArray from\"D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import{useLocation,useHistory}from'react-router-dom';import LoadingOverlay from'react-loading-overlay';import*as OPTs from\"../../../../helpers/options_helper\";import*as url from\"../../../../helpers/url_helper\";import{Row,Col,Card,CardBody,Label,CardFooter,Button}from\"reactstrap\";import{AvForm,AvField}from\"availity-reactstrap-validation\";import{Link}from\"react-router-dom\";//Import Breadcrumb\nimport Breadcrumbs from\"../../../../components/Common/Breadcrumb\";//i18n\nimport{withTranslation}from\"react-i18next\";//Import SweetAlert\nimport SweetAlert from\"react-bootstrap-sweetalert\";import FormBusqueda from\"./FormBusqueda\";import FormResultados from\"./FormResultados\";import FormObservaciones from\"./FormObservaciones\";import FormGoogle from\"./FormGoogle\";import ModalCloseOptions from\"./ModalCloseOptions\";import ModalAdvanceOptions from\"./ModalAdvanceOptions\";import LogProcess from\"../../../../components/LogProcess/index\";import ModalEndProcess from\"../../../../components/EndProcess/ModalEndProcess\";import AttachmentFileCore from\"../../../../components/Common/AttachmentFileCore\";import{BackendServices,CoreServices,BpmServices}from\"../../../../services\";import{BusquedaDescarteModel}from\"../../../../models\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var BandejaEntrada=function BandejaEntrada(props){var history=useHistory();var location=useLocation();//Data que recibimos en el location\nvar _useState=useState(undefined),_useState2=_slicedToArray(_useState,2),locationData=_useState2[0],setLocationData=_useState2[1];//Entidad Busqueda y Descarte\nvar _useState3=useState(undefined),_useState4=_slicedToArray(_useState3,2),selectedData=_useState4[0],setSelectedData=_useState4[1];//Resultado de Lista Negra\nvar _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),dataList=_useState6[0],setDataList=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),displayModalGoogle=_useState8[0],setDisplayModalGoogle=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),searchGoogleTerms=_useState10[0],setSearchGoogleTerms=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),displayModalCloseOptions=_useState12[0],setDisplayModalCloseOptions=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),displayModalAdvanceOptions=_useState14[0],setDisplayModalAdvanceOptions=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),displayModalEndProcess=_useState16[0],setDisplayModalEndProcess=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),isActiveLoading=_useState18[0],setIsActiveLoading=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),successSave_dlg=_useState20[0],setsuccessSave_dlg=_useState20[1];var _useState21=useState(false),_useState22=_slicedToArray(_useState21,2),error_dlg=_useState22[0],seterror_dlg=_useState22[1];var _useState23=useState(\"\"),_useState24=_slicedToArray(_useState23,2),error_msg=_useState24[0],seterror_msg=_useState24[1];var _useState25=useState(false),_useState26=_slicedToArray(_useState25,2),info_dlg=_useState26[0],setinfo_dlg=_useState26[1];var _useState27=useState(\"\"),_useState28=_slicedToArray(_useState27,2),info_msg=_useState28[0],setinfo_msg=_useState28[1];//On Mounting (componentDidMount)\nReact.useEffect(function(){if(location.data!==null&&location.data!==undefined){console.log(\"BandejaEntrada\",location.data);setLocationData(location.data);initializeData(location.data);}},[]);//Caraga Inicial\nfunction initializeData(InputData){if(InputData!==undefined&&InputData!==null){var apiBackendServices=new BackendServices();// Buscar en BD los datos de esta actividad\n//var parameters = {processId:InputData.processId,transactId:InputData.transactionId,activityId:InputData.activityId}      \napiBackendServices.consultarBusquedaDescarte(InputData.transactionId).then(function(data){if(data!==null&&data!==undefined){UpdateDataModel(data);}else{//Nuevo Proceso            \ndata=BusquedaDescarteModel.getRequestModel();UpdateDataModel(data);}}).catch(function(error){console.error('api error: ',error);});}else{history.push(url.URL_DASHBOARD);}}function searchWhatchList(values){setIsActiveLoading(true);var apiCoreServices=new CoreServices();apiCoreServices.postWhatchList(values).then(function(data){if(data.status===200){if(data.result.length>0){setDataList(data.result);}else{setinfo_msg(props.t('NoResults'));setinfo_dlg(true);}}else{seterror_msg(props.t('ErrorCode')+\": \"+data.error.errorCode+\"  \"+props.t('ErrorMsg')+\": \"+data.error.errorCode);seterror_dlg(true);}}).catch(function(error){console.error('Error fetching documents',error);}).finally(function(){setIsActiveLoading(false);});}function removeBodyCss(){document.body.classList.add(\"no_padding\");}function onGoogleSearch(q){setSearchGoogleTerms(q);setDisplayModalGoogle(!displayModalGoogle);removeBodyCss();}function toggleGoogleModal(){setDisplayModalGoogle(!displayModalGoogle);}//Modal Opciones al Salir\nfunction toggleModalCloseOptions(){setDisplayModalCloseOptions(!displayModalCloseOptions);}//Modal Para mostrar las opciones al Avanzar\nfunction toggleModalAdvanceOptions(){setDisplayModalAdvanceOptions(!displayModalAdvanceOptions);}//Modal Para mostrar Comentario de Fin de Proceso\nfunction toggleModalEndProcess(){setDisplayModalEndProcess(!displayModalEndProcess);}//Salvando el Proceso y le pasamos una opcion: 1-Finalizar Proceso, 2- Salvarlo, 3- A Cumplimmineto, 4- Avanzar a IGR\nfunction onSaveProcess(option){if(option===OPTs.OPT_PREFINALIZARPROCESO){toggleModalEndProcess();return;}selectedData.instanceId=locationData.instanceId!==null&&locationData.instanceId!==undefined?locationData.instanceId:selectedData.instanceId;selectedData.customerId=locationData.customerId!==null&&locationData.customerId!==undefined?locationData.customerId:selectedData.customerId;selectedData.responsible=\"admin\";console.log(\"onSaveProcess\",selectedData);var apiBackendServices=new BackendServices();//Guardar el usuario prospecto    \napiBackendServices.guardarUsuarioProspecto(selectedData).then(function(userData){if(userData!==undefined){selectedData.transactId=userData.transactId!==null&&userData.transactId!==undefined?userData.transactId:selectedData.transactId;selectedData.customerId=userData.customerId!==null&&userData.customerId!==undefined?userData.customerId:selectedData.customerId;selectedData.compliance=option===OPTs.OPT_ENVIARCUMPLIMIENTO?true:false;UpdateDataModel(selectedData);//Guardar busqueda y descarte\napiBackendServices.guardarBusquedaDescarte(selectedData).then(function(descarteData){if(descarteData!==undefined){saveJBPMProcess(option);}else{//Mensaje ERROR\nseterror_msg(props.t(\"ErrorSaveMessage\"));seterror_dlg(true);}}).catch(function(error){console.error('api error: ',error);});}else{//Mensaje ERROR\nseterror_msg(props.t(\"ErrorSaveMessage\"));seterror_dlg(true);}}).catch(function(error){console.error('api error: ',error);});}function saveJBPMProcess(option){//console.error('saveJBPMProcess: ', option);\nvar apiBpmServices=new BpmServices();switch(option){case OPTs.OPT_FINALIZARPROCESO:{apiBpmServices.abortProcess(locationData.instanceId).then(function(data){if(data!==undefined){history.push(url.URL_DASHBOARD);}else{//Mensaje ERROR\nseterror_msg(props.t(\"TheProcessCouldNotFinish\"));seterror_dlg(true);}});break;}case OPTs.OPT_SALVAPARCIAL:{var values={\"processId\":OPTs.PROCESS_BUSQUEDADESCARTE.toString(),\"activityId\":OPTs.ACT_NONE.toString(),\"transactionId\":selectedData.transactId.toString(),\"customerId\":selectedData.customerId.toString(),\"applicationNumber\":\"\",\"procedureNumber\":\"\"//\"decision\":\"no\"          \n};apiBpmServices.updatevariables(locationData.instanceId,values).then(function(data){if(data!==undefined){setsuccessSave_dlg(true);}else{//Mensaje ERROR\nseterror_msg(props.t(\"ErrorSaveMessage\"));seterror_dlg(true);}});break;}case OPTs.OPT_ENVIARCUMPLIMIENTO:{var values={\"processId\":OPTs.PROCESS_CUMPLIMIENTO.toString(),\"activityId\":OPTs.ACT_NONE.toString(),\"transactionId\":selectedData.transactId.toString(),\"customerId\":selectedData.customerId.toString(),\"applicationNumber\":\"\",\"procedureNumber\":\"\",\"decision\":\"si\"};apiBpmServices.completedStatusTask(locationData.taskId,values).then(function(data){if(data!==undefined){setsuccessSave_dlg(true);}else{//Mensaje ERROR\nseterror_msg(props.t(\"ErrorSaveMessage\"));seterror_dlg(true);}});break;}case OPTs.OPT_LISTAEXCLUSION:{var values={\"processId\":OPTs.PROCESS_LISTAEXCLUSION.toString(),\"activityId\":OPTs.ACT_NONE.toString(),\"transactionId\":selectedData.transactId.toString(),\"customerId\":selectedData.customerId.toString(),\"applicationNumber\":\"\",\"procedureNumber\":\"\",\"decision\":\"no\"};apiBpmServices.completedStatusTask(locationData.taskId,values).then(function(data){if(data!==undefined){setsuccessSave_dlg(true);}else{//Mensaje ERROR\nseterror_msg(props.t(\"ErrorSaveMessage\"));seterror_dlg(true);}});break;}}}//salvar comentario de end process\nfunction onSaveEndProcess(values){//Salvar los comentarios en Bitacora    \nselectedData.endProcessComment=values.txtComment;UpdateDataModel(selectedData);onSaveProcess(OPTs.OPT_FINALIZARPROCESO);}//Actualizamos El Modelo de Datos segun va cambiando\nfunction UpdateDataModel(data){setSelectedData(data);}return/*#__PURE__*/_jsx(React.Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"page-content\",children:[/*#__PURE__*/_jsx(Breadcrumbs,{title:props.t(\"CommercialCredit\"),breadcrumbItem:props.t(\"SearchDiscard\")}),/*#__PURE__*/_jsxs(LoadingOverlay,{active:isActiveLoading,spinner:true,text:props.t(\"WaitingPlease\"),children:[/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(CardBody,{children:[/*#__PURE__*/_jsx(FormBusqueda,{onSubmit:searchWhatchList,onGoogleSearch:onGoogleSearch,selectedData:selectedData,updateDataModel:UpdateDataModel}),dataList.length>0&&/*#__PURE__*/_jsx(FormResultados,{results:dataList,onScreenOption:props.onScreenOption}),/*#__PURE__*/_jsx(FormObservaciones,{selectedData:selectedData,updateDataModel:UpdateDataModel}),locationData!==undefined?/*#__PURE__*/_jsx(AttachmentFileCore,{locationData:{instanceId:locationData.instanceId,processId:OPTs.PROCESS_BUSQUEDADESCARTE,activityId:OPTs.ACT_NONE}}):null]}),/*#__PURE__*/_jsxs(CardFooter,{style:{textAlign:\"right\"},children:[/*#__PURE__*/_jsxs(Button,{color:\"danger\",type:\"button\",style:{margin:'5px'},onClick:function onClick(){toggleModalCloseOptions();},children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-arrow-left-bold-circle-outline mid-12px\"}),\" \",props.t(\"Exit\")]}),/*#__PURE__*/_jsxs(Button,{color:\"success\",type:\"button\",style:{margin:'5px'},onClick:function onClick(){toggleModalAdvanceOptions();},children:[/*#__PURE__*/_jsx(\"i\",{className:\"mdi mdi-arrow-right-bold-circle-outline mid-12px\"}),\" \",props.t(\"Advance\")]})]})]}),locationData!==undefined&&locationData.customerId!==null&&locationData.customerId!==undefined&&locationData.customerId.length>0?/*#__PURE__*/_jsx(LogProcess,{locationData:{instanceId:locationData.instanceId,transactId:locationData.transactionId,clientId:locationData.customerId,customerName:\"admin\",processId:OPTs.PROCESS_BUSQUEDADESCARTE,activityId:OPTs.ACT_NONE}}):null]}),/*#__PURE__*/_jsx(FormGoogle,{searchGoogleTerms:searchGoogleTerms,isOpen:displayModalGoogle,toggle:function toggle(){toggleGoogleModal();}}),/*#__PURE__*/_jsx(ModalCloseOptions,{onSaveProcess:onSaveProcess,isOpen:displayModalCloseOptions,toggle:function toggle(){toggleModalCloseOptions();}}),/*#__PURE__*/_jsx(ModalAdvanceOptions,{onSaveProcess:onSaveProcess,isOpen:displayModalAdvanceOptions,toggle:function toggle(){toggleModalAdvanceOptions();}}),/*#__PURE__*/_jsx(ModalEndProcess,{onSaveEndProcess:onSaveEndProcess,isOpen:displayModalEndProcess,toggle:function toggle(){toggleModalEndProcess();}}),successSave_dlg?/*#__PURE__*/_jsx(SweetAlert,{success:true,title:props.t(\"SuccessDialog\"),onConfirm:function onConfirm(){setsuccessSave_dlg(false);history.push(url.URL_DASHBOARD);},children:props.t(\"SuccessSaveMessage\")}):null,error_dlg?/*#__PURE__*/_jsx(SweetAlert,{error:true,title:props.t(\"ErrorDialog\"),onConfirm:function onConfirm(){seterror_dlg(false);},children:error_msg}):null,info_dlg?/*#__PURE__*/_jsx(SweetAlert,{info:true,title:props.t(\"SuccessDialog\"),onConfirm:function onConfirm(){setinfo_dlg(false);},children:info_msg}):null]})});};export default withTranslation()(BandejaEntrada);","map":{"version":3,"sources":["D:/_PROJECTS/_SOAINT/JBPM/App/banescocreditoscomerciales/src/pages/CommercialCredit/2_ValidarPresolicitud/BusquedaCoincidencia/index.js"],"names":["React","useState","useLocation","useHistory","LoadingOverlay","OPTs","url","Row","Col","Card","CardBody","Label","CardFooter","Button","AvForm","AvField","Link","Breadcrumbs","withTranslation","SweetAlert","FormBusqueda","FormResultados","FormObservaciones","FormGoogle","ModalCloseOptions","ModalAdvanceOptions","LogProcess","ModalEndProcess","AttachmentFileCore","BackendServices","CoreServices","BpmServices","BusquedaDescarteModel","BandejaEntrada","props","history","location","undefined","locationData","setLocationData","selectedData","setSelectedData","dataList","setDataList","displayModalGoogle","setDisplayModalGoogle","searchGoogleTerms","setSearchGoogleTerms","displayModalCloseOptions","setDisplayModalCloseOptions","displayModalAdvanceOptions","setDisplayModalAdvanceOptions","displayModalEndProcess","setDisplayModalEndProcess","isActiveLoading","setIsActiveLoading","successSave_dlg","setsuccessSave_dlg","error_dlg","seterror_dlg","error_msg","seterror_msg","info_dlg","setinfo_dlg","info_msg","setinfo_msg","useEffect","data","console","log","initializeData","InputData","apiBackendServices","consultarBusquedaDescarte","transactionId","then","UpdateDataModel","getRequestModel","catch","error","push","URL_DASHBOARD","searchWhatchList","values","apiCoreServices","postWhatchList","status","result","length","t","errorCode","finally","removeBodyCss","document","body","classList","add","onGoogleSearch","q","toggleGoogleModal","toggleModalCloseOptions","toggleModalAdvanceOptions","toggleModalEndProcess","onSaveProcess","option","OPT_PREFINALIZARPROCESO","instanceId","customerId","responsible","guardarUsuarioProspecto","userData","transactId","compliance","OPT_ENVIARCUMPLIMIENTO","guardarBusquedaDescarte","descarteData","saveJBPMProcess","apiBpmServices","OPT_FINALIZARPROCESO","abortProcess","OPT_SALVAPARCIAL","PROCESS_BUSQUEDADESCARTE","toString","ACT_NONE","updatevariables","PROCESS_CUMPLIMIENTO","completedStatusTask","taskId","OPT_LISTAEXCLUSION","PROCESS_LISTAEXCLUSION","onSaveEndProcess","endProcessComment","txtComment","onScreenOption","processId","activityId","textAlign","margin","clientId","customerName"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\"\r\nimport PropTypes from 'prop-types';\r\nimport { useLocation,useHistory } from 'react-router-dom'\r\nimport LoadingOverlay from 'react-loading-overlay';\r\nimport * as OPTs from \"../../../../helpers/options_helper\"\r\nimport * as url from \"../../../../helpers/url_helper\"\r\n\r\nimport {\r\n  Row,\r\n  Col,\r\n  Card,\r\n  CardBody,\r\n  Label,\r\n  CardFooter,\r\n  Button,\r\n} from \"reactstrap\"\r\n\r\nimport { AvForm, AvField } from \"availity-reactstrap-validation\"\r\nimport { Link } from \"react-router-dom\"\r\n//Import Breadcrumb\r\nimport Breadcrumbs from \"../../../../components/Common/Breadcrumb\"\r\n//i18n\r\nimport { withTranslation } from \"react-i18next\"\r\n//Import SweetAlert\r\nimport SweetAlert from \"react-bootstrap-sweetalert\"\r\n\r\nimport FormBusqueda from \"./FormBusqueda\"\r\nimport FormResultados from \"./FormResultados\"\r\nimport FormObservaciones from \"./FormObservaciones\"\r\nimport FormGoogle from \"./FormGoogle\"\r\nimport ModalCloseOptions from \"./ModalCloseOptions\"\r\nimport ModalAdvanceOptions from \"./ModalAdvanceOptions\"\r\nimport LogProcess from \"../../../../components/LogProcess/index\";\r\nimport ModalEndProcess from \"../../../../components/EndProcess/ModalEndProcess\";\r\nimport AttachmentFileCore from \"../../../../components/Common/AttachmentFileCore\";\r\n\r\n\r\nimport {BackendServices,CoreServices,BpmServices,} from \"../../../../services\";\r\nimport { BusquedaDescarteModel } from \"../../../../models\";\r\n\r\nconst BandejaEntrada = props => {\r\n  \r\n  const history = useHistory();\r\n  const location = useLocation();\r\n\r\n  //Data que recibimos en el location\r\n  const [locationData, setLocationData] = useState(undefined);  \r\n  //Entidad Busqueda y Descarte\r\n  const [selectedData, setSelectedData] = useState(undefined);  \r\n  //Resultado de Lista Negra\r\n  const [dataList, setDataList] = useState([]);\r\n\r\n  const [displayModalGoogle, setDisplayModalGoogle] = useState(false);\r\n  const [searchGoogleTerms, setSearchGoogleTerms] = useState([]);\r\n  const [displayModalCloseOptions, setDisplayModalCloseOptions] = useState(false);\r\n  const [displayModalAdvanceOptions, setDisplayModalAdvanceOptions] = useState(false);\r\n  const [displayModalEndProcess, setDisplayModalEndProcess] = useState(false);\r\n     \r\n  const [isActiveLoading, setIsActiveLoading] = useState(false);\r\n  const [successSave_dlg, setsuccessSave_dlg] = useState(false)\r\n  const [error_dlg, seterror_dlg] = useState(false)\r\n  const [error_msg, seterror_msg] = useState(\"\")\r\n  const [info_dlg, setinfo_dlg] = useState(false)\r\n  const [info_msg, setinfo_msg] = useState(\"\")\r\n  \r\n  //On Mounting (componentDidMount)\r\n  React.useEffect(() => {\r\n    if(location.data!==null && location.data!==undefined){\r\n      console.log(\"BandejaEntrada\",location.data);\r\n      setLocationData(location.data);\r\n      initializeData(location.data);    \r\n    }    \r\n  }, []);\r\n\r\n  //Caraga Inicial\r\n  function initializeData(InputData) {    \r\n        \r\n    if(InputData!==undefined && InputData!== null){\r\n\r\n      const apiBackendServices = new BackendServices();\r\n      \r\n      // Buscar en BD los datos de esta actividad\r\n      //var parameters = {processId:InputData.processId,transactId:InputData.transactionId,activityId:InputData.activityId}      \r\n      apiBackendServices.consultarBusquedaDescarte(InputData.transactionId)\r\n        .then((data) => {\r\n          if(data!== null && data !==undefined){\r\n            UpdateDataModel(data);\r\n          }\r\n          else{\r\n            //Nuevo Proceso            \r\n            data = BusquedaDescarteModel.getRequestModel();\r\n            UpdateDataModel(data);        \r\n          }\r\n      })\r\n      .catch((error) => {    \r\n        console.error('api error: ', error);\r\n      });\r\n    }    \r\n    else{      \r\n      history.push(url.URL_DASHBOARD);      \r\n    }\r\n  }\r\n\r\n  function searchWhatchList(values) {\r\n    \r\n    setIsActiveLoading(true);\r\n    const apiCoreServices = new CoreServices()\r\n    apiCoreServices.postWhatchList(values)\r\n      .then((data) => {\r\n        if(data.status === 200){\r\n\r\n          if(data.result.length > 0){\r\n            setDataList(data.result);            \r\n          }\r\n          else{\r\n            setinfo_msg(props.t('NoResults'));\r\n            setinfo_dlg(true)\r\n          }\r\n        }\r\n        else{\r\n          seterror_msg(props.t('ErrorCode')+\": \" + data.error.errorCode + \"  \" +props.t('ErrorMsg')+\": \" + data.error.errorCode);\r\n          seterror_dlg(true)\r\n        }\r\n\r\n      })\r\n      .catch((error) => {\r\n\r\n        console.error('Error fetching documents', error);\r\n\r\n      }).finally (() => {\r\n\r\n        setIsActiveLoading(false);\r\n\r\n      })\r\n  }\r\n  \r\n  function removeBodyCss() {\r\n    document.body.classList.add(\"no_padding\")\r\n  }\r\n\r\n  function onGoogleSearch(q) {    \r\n    setSearchGoogleTerms(q);\r\n    setDisplayModalGoogle(!displayModalGoogle);\r\n    removeBodyCss();\r\n  }\r\n\r\n  function toggleGoogleModal() {\r\n    setDisplayModalGoogle(!displayModalGoogle);\r\n  }\r\n\r\n  //Modal Opciones al Salir\r\n  function toggleModalCloseOptions() {\r\n    setDisplayModalCloseOptions(!displayModalCloseOptions);\r\n  }\r\n\r\n  //Modal Para mostrar las opciones al Avanzar\r\n  function toggleModalAdvanceOptions() {\r\n    setDisplayModalAdvanceOptions(!displayModalAdvanceOptions);\r\n  }\r\n\r\n  //Modal Para mostrar Comentario de Fin de Proceso\r\n  function toggleModalEndProcess() {\r\n    setDisplayModalEndProcess(!displayModalEndProcess);\r\n  }\r\n\r\n  //Salvando el Proceso y le pasamos una opcion: 1-Finalizar Proceso, 2- Salvarlo, 3- A Cumplimmineto, 4- Avanzar a IGR\r\n  function onSaveProcess(option){\r\n    \r\n    if(option === OPTs.OPT_PREFINALIZARPROCESO){\r\n      toggleModalEndProcess();\r\n      return;\r\n    }\r\n    \r\n    selectedData.instanceId = locationData.instanceId !== null && locationData.instanceId !== undefined? locationData.instanceId:selectedData.instanceId;\r\n    selectedData.customerId = locationData.customerId !== null && locationData.customerId !== undefined? locationData.customerId:selectedData.customerId;\r\n    selectedData.responsible = \"admin\";\r\n\r\n    console.log(\"onSaveProcess\",selectedData);\r\n    const apiBackendServices = new BackendServices();        \r\n    //Guardar el usuario prospecto    \r\n    apiBackendServices.guardarUsuarioProspecto(selectedData)\r\n    .then((userData) => {\r\n      \r\n      if(userData!==undefined){\r\n        selectedData.transactId = userData.transactId !== null && userData.transactId !== undefined? userData.transactId:selectedData.transactId;\r\n        selectedData.customerId = userData.customerId !== null && userData.customerId !== undefined? userData.customerId:selectedData.customerId;\r\n        selectedData.compliance = option === OPTs.OPT_ENVIARCUMPLIMIENTO?true:false;\r\n\r\n        UpdateDataModel(selectedData);\r\n        \r\n        //Guardar busqueda y descarte\r\n        apiBackendServices.guardarBusquedaDescarte(selectedData)\r\n          .then((descarteData) => {\r\n            if(descarteData!==undefined){\r\n              \r\n              saveJBPMProcess(option);\r\n            }\r\n            else{\r\n              //Mensaje ERROR\r\n              seterror_msg(props.t(\"ErrorSaveMessage\"))\r\n              seterror_dlg(true)\r\n            }\r\n        })\r\n        .catch((error) => {    \r\n          console.error('api error: ', error);\r\n        });\r\n      }\r\n      else{\r\n        //Mensaje ERROR\r\n        seterror_msg(props.t(\"ErrorSaveMessage\"))\r\n              seterror_dlg(true)\r\n      }\r\n    })\r\n    .catch((error) => {    \r\n      console.error('api error: ', error);\r\n    }); \r\n  }\r\n\r\n  function saveJBPMProcess(option){    \r\n    \r\n    //console.error('saveJBPMProcess: ', option);\r\n    const apiBpmServices = new BpmServices();\r\n\r\n    switch(option){\r\n      case OPTs.OPT_FINALIZARPROCESO: {\r\n        \r\n        apiBpmServices.abortProcess(locationData.instanceId)\r\n          .then((data) => {\r\n            if(data!==undefined){              \r\n              history.push(url.URL_DASHBOARD);            }\r\n            else{\r\n              //Mensaje ERROR\r\n              seterror_msg(props.t(\"TheProcessCouldNotFinish\"))\r\n              seterror_dlg(true)\r\n            }\r\n        });\r\n        break;\r\n      }\r\n      case OPTs.OPT_SALVAPARCIAL: {\r\n        var values = {\r\n          \"processId\":OPTs.PROCESS_BUSQUEDADESCARTE.toString(),\r\n          \"activityId\":OPTs.ACT_NONE.toString(),                    \r\n          \"transactionId\":selectedData.transactId.toString(),\r\n          \"customerId\":selectedData.customerId.toString(),                      \r\n          \"applicationNumber\":\"\",\r\n          \"procedureNumber\":\"\" ,\r\n          //\"decision\":\"no\"          \r\n      };\r\n        apiBpmServices.updatevariables(locationData.instanceId,values)\r\n          .then((data) => {\r\n            if(data!==undefined){              \r\n              setsuccessSave_dlg(true);    \r\n            }\r\n            else{\r\n              //Mensaje ERROR\r\n              seterror_msg(props.t(\"ErrorSaveMessage\"))\r\n              seterror_dlg(true)\r\n            }\r\n        });\r\n\r\n        break;\r\n      }\r\n      case OPTs.OPT_ENVIARCUMPLIMIENTO: {\r\n\r\n        var values = {\r\n          \"processId\":OPTs.PROCESS_CUMPLIMIENTO.toString(),\r\n          \"activityId\":OPTs.ACT_NONE.toString(),                    \r\n          \"transactionId\":selectedData.transactId.toString(),\r\n          \"customerId\":selectedData.customerId.toString(),                      \r\n          \"applicationNumber\":\"\",\r\n          \"procedureNumber\":\"\" ,\r\n          \"decision\":\"si\"          \r\n      };\r\n        apiBpmServices.completedStatusTask(locationData.taskId,values)\r\n          .then((data) => {\r\n            if(data!==undefined){              \r\n              setsuccessSave_dlg(true);    \r\n            }\r\n            else{\r\n              //Mensaje ERROR\r\n              seterror_msg(props.t(\"ErrorSaveMessage\"))\r\n              seterror_dlg(true)\r\n            }\r\n        });\r\n\r\n        break;\r\n      }\r\n      case OPTs.OPT_LISTAEXCLUSION: {\r\n\r\n        var values = {\r\n          \"processId\":OPTs.PROCESS_LISTAEXCLUSION.toString(),\r\n          \"activityId\":OPTs.ACT_NONE.toString(),                    \r\n          \"transactionId\":selectedData.transactId.toString(),\r\n          \"customerId\":selectedData.customerId.toString(),                      \r\n          \"applicationNumber\":\"\",\r\n          \"procedureNumber\":\"\" ,\r\n          \"decision\":\"no\"          \r\n      };\r\n        apiBpmServices.completedStatusTask(locationData.taskId,values)\r\n          .then((data) => {\r\n            if(data!==undefined){              \r\n              setsuccessSave_dlg(true);    \r\n            }\r\n            else{\r\n              //Mensaje ERROR\r\n              seterror_msg(props.t(\"ErrorSaveMessage\"))\r\n              seterror_dlg(true)\r\n            }\r\n        });\r\n        break;\r\n      }      \r\n    }\r\n  }\r\n\r\n  //salvar comentario de end process\r\n  function onSaveEndProcess(values){\r\n    \r\n    //Salvar los comentarios en Bitacora    \r\n    selectedData.endProcessComment = values.txtComment;\r\n\r\n    UpdateDataModel(selectedData);\r\n\r\n    onSaveProcess(OPTs.OPT_FINALIZARPROCESO);\r\n  }\r\n\r\n  //Actualizamos El Modelo de Datos segun va cambiando\r\n  function UpdateDataModel(data) {\r\n    setSelectedData(data);                  \r\n  }\r\n\r\n  return (\r\n    <React.Fragment>\r\n      <div className=\"page-content\">\r\n        \r\n        <Breadcrumbs title={props.t(\"CommercialCredit\")} breadcrumbItem={props.t(\"SearchDiscard\")} />\r\n\r\n        <LoadingOverlay active={isActiveLoading} spinner text={props.t(\"WaitingPlease\")}>\r\n        \r\n        <Card>\r\n            <CardBody>\r\n\r\n                <FormBusqueda onSubmit={ searchWhatchList }  onGoogleSearch={ onGoogleSearch } selectedData={selectedData} updateDataModel={UpdateDataModel}/>\r\n              \r\n                { dataList.length > 0 && (\r\n                  <FormResultados results={ dataList } onScreenOption={props.onScreenOption}/>                  \r\n                )}\r\n\r\n                <FormObservaciones selectedData={selectedData} updateDataModel={UpdateDataModel}/>\r\n\r\n                { \r\n            (locationData!==undefined)?\r\n            (<AttachmentFileCore locationData={{instanceId:locationData.instanceId,processId:OPTs.PROCESS_BUSQUEDADESCARTE,activityId:OPTs.ACT_NONE}} />)\r\n            :null\r\n          }\r\n\r\n            </CardBody>\r\n\r\n            <CardFooter style={{textAlign:\"right\"}}>  \r\n                  <Button color=\"danger\" type=\"button\" style={{ margin: '5px' }} onClick={() => { toggleModalCloseOptions() }}><i className=\"mdi mdi-arrow-left-bold-circle-outline mid-12px\"></i> {props.t(\"Exit\")}</Button>\r\n                  <Button color=\"success\" type=\"button\" style={{ margin: '5px' }} onClick={() => { toggleModalAdvanceOptions() }}><i className=\"mdi mdi-arrow-right-bold-circle-outline mid-12px\"></i> {props.t(\"Advance\")}</Button>\r\n              </CardFooter>\r\n              \r\n        </Card>\r\n\r\n        { (locationData!==undefined && locationData.customerId!==null && locationData.customerId!==undefined && locationData.customerId.length > 0)?\r\n        (<LogProcess locationData={{instanceId:locationData.instanceId,transactId: locationData.transactionId,clientId: locationData.customerId,\r\n          customerName:\"admin\",processId:OPTs.PROCESS_BUSQUEDADESCARTE,activityId:OPTs.ACT_NONE}}/>)\r\n        :null}\r\n        \r\n      </LoadingOverlay>\r\n\r\n        <FormGoogle searchGoogleTerms={ searchGoogleTerms } isOpen={ displayModalGoogle } toggle={ () => { toggleGoogleModal() } } />\r\n\r\n        <ModalCloseOptions onSaveProcess={ onSaveProcess } isOpen={ displayModalCloseOptions } toggle={ () => { toggleModalCloseOptions() } } />\r\n\r\n        <ModalAdvanceOptions onSaveProcess={ onSaveProcess } isOpen={ displayModalAdvanceOptions } toggle={ () => { toggleModalAdvanceOptions() } } />\r\n\r\n        <ModalEndProcess onSaveEndProcess={ onSaveEndProcess } isOpen={ displayModalEndProcess } toggle={ () => { toggleModalEndProcess() } } />        \r\n\r\n        {successSave_dlg ? (\r\n            <SweetAlert\r\n              success\r\n              title={props.t(\"SuccessDialog\")}\r\n              onConfirm={() => {\r\n                setsuccessSave_dlg(false)\r\n                \r\n                history.push(url.URL_DASHBOARD);\r\n              }}\r\n            >\r\n              {props.t(\"SuccessSaveMessage\")}\r\n            </SweetAlert>\r\n          ) : null}\r\n\r\n          {error_dlg ? (\r\n            <SweetAlert\r\n              error\r\n              title={props.t(\"ErrorDialog\")}\r\n              onConfirm={() => {\r\n                seterror_dlg(false)\r\n              }}\r\n            >\r\n              {error_msg}\r\n            </SweetAlert>\r\n          ) : null}\r\n\r\n          {info_dlg ? (\r\n            <SweetAlert\r\n              info\r\n              title={props.t(\"SuccessDialog\")}\r\n              onConfirm={() => {\r\n                setinfo_dlg(false)\r\n              }}\r\n            >\r\n              {info_msg}\r\n            </SweetAlert>\r\n          ) : null}\r\n\r\n      </div>      \r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\n\r\nexport default (withTranslation()(BandejaEntrada))\r\n"]},"metadata":{},"sourceType":"module"}